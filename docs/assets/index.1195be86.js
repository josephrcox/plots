(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function e(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerpolicy&&(a.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?a.credentials="include":n.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function t(n){if(n.ep)return;n.ep=!0;const a=e(n);fetch(n.href,a)}})();function J(){}function ko(o){return o()}function On(){return Object.create(null)}function ot(o){o.forEach(ko)}function Co(o){return typeof o=="function"}function Fe(o,e){return o!=o?e==e:o!==e||o&&typeof o=="object"||typeof o=="function"}function Eo(o){return Object.keys(o).length===0}function zo(o,...e){if(o==null)return J;const t=o.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function le(o,e,t){o.$$.on_destroy.push(zo(e,t))}function W(o,e,t){return o.set(t),e}function s(o,e){o.appendChild(e)}function x(o,e,t){o.insertBefore(e,t||null)}function b(o){o.parentNode.removeChild(o)}function en(o,e){for(let t=0;t<o.length;t+=1)o[t]&&o[t].d(e)}function p(o){return document.createElement(o)}function _(o){return document.createTextNode(o)}function w(){return _(" ")}function Le(){return _("")}function ee(o,e,t,n){return o.addEventListener(e,t,n),()=>o.removeEventListener(e,t,n)}function d(o,e,t){t==null?o.removeAttribute(e):o.getAttribute(e)!==t&&o.setAttribute(e,t)}function No(o){return o===""?null:+o}function qo(o){return Array.from(o.childNodes)}function H(o,e){e=""+e,o.wholeText!==e&&(o.data=e)}function Bn(o,e){o.value=e==null?"":e}let kt;function bt(o){kt=o}function Oo(){if(!kt)throw new Error("Function called outside component initialization");return kt}function Tt(o){Oo().$$.on_mount.push(o)}const vt=[],Qt=[],Mt=[],Mn=[],Io=Promise.resolve();let Zt=!1;function $o(){Zt||(Zt=!0,Io.then(So))}function Bo(){return $o(),Io}function Jt(o){Mt.push(o)}const Kt=new Set;let Bt=0;function So(){const o=kt;do{for(;Bt<vt.length;){const e=vt[Bt];Bt++,bt(e),Mo(e.$$)}for(bt(null),vt.length=0,Bt=0;Qt.length;)Qt.pop()();for(let e=0;e<Mt.length;e+=1){const t=Mt[e];Kt.has(t)||(Kt.add(t),t())}Mt.length=0}while(vt.length);for(;Mn.length;)Mn.pop()();Zt=!1,Kt.clear(),bt(o)}function Mo(o){if(o.fragment!==null){o.update(),ot(o.before_update);const e=o.dirty;o.dirty=[-1],o.fragment&&o.fragment.p(o.ctx,e),o.after_update.forEach(Jt)}}const Dt=new Set;let nt;function Oe(){nt={r:0,c:[],p:nt}}function Be(){nt.r||ot(nt.c),nt=nt.p}function j(o,e){o&&o.i&&(Dt.delete(o),o.i(e))}function K(o,e,t,n){if(o&&o.o){if(Dt.has(o))return;Dt.add(o),nt.c.push(()=>{Dt.delete(o),n&&(t&&o.d(1),n())}),o.o(e)}else n&&n()}function Do(o,e){o.d(1),e.delete(o.key)}function Ho(o,e,t,n,a,i,l,r,m,c,u,f){let h=o.length,F=i.length,y=h;const C={};for(;y--;)C[o[y].key]=y;const z=[],N=new Map,E=new Map;for(y=F;y--;){const q=f(a,i,y),A=t(q);let I=l.get(A);I?n&&I.p(q,e):(I=c(A,q),I.c()),N.set(A,z[y]=I),A in C&&E.set(A,Math.abs(y-C[A]))}const P=new Set,T=new Set;function M(q){j(q,1),q.m(r,u),l.set(q.key,q),u=q.first,F--}for(;h&&F;){const q=z[F-1],A=o[h-1],I=q.key,g=A.key;q===A?(u=q.first,h--,F--):N.has(g)?!l.has(I)||P.has(I)?M(q):T.has(g)?h--:E.get(I)>E.get(g)?(T.add(I),M(q)):(P.add(g),h--):(m(A,l),h--)}for(;h--;){const q=o[h];N.has(q.key)||m(q,l)}for(;F;)M(z[F-1]);return z}function qe(o){o&&o.c()}function Ee(o,e,t,n){const{fragment:a,on_mount:i,on_destroy:l,after_update:r}=o.$$;a&&a.m(e,t),n||Jt(()=>{const m=i.map(ko).filter(Co);l?l.push(...m):ot(m),o.$$.on_mount=[]}),r.forEach(Jt)}function ze(o,e){const t=o.$$;t.fragment!==null&&(ot(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function To(o,e){o.$$.dirty[0]===-1&&(vt.push(o),$o(),o.$$.dirty.fill(0)),o.$$.dirty[e/31|0]|=1<<e%31}function Me(o,e,t,n,a,i,l,r=[-1]){const m=kt;bt(o);const c=o.$$={fragment:null,ctx:null,props:i,update:J,not_equal:a,bound:On(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(m?m.$$.context:[])),callbacks:On(),dirty:r,skip_bound:!1,root:e.target||m.$$.root};l&&l(c.root);let u=!1;if(c.ctx=t?t(o,e.props||{},(f,h,...F)=>{const y=F.length?F[0]:h;return c.ctx&&a(c.ctx[f],c.ctx[f]=y)&&(!c.skip_bound&&c.bound[f]&&c.bound[f](y),u&&To(o,f)),h}):[],c.update(),u=!0,ot(c.before_update),c.fragment=n?n(c.ctx):!1,e.target){if(e.hydrate){const f=qo(e.target);c.fragment&&c.fragment.l(f),f.forEach(b)}else c.fragment&&c.fragment.c();e.intro&&j(o.$$.fragment),Ee(o,e.target,e.anchor,e.customElement),So()}bt(m)}class De{$destroy(){ze(this,1),this.$destroy=J}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const a=n.indexOf(t);a!==-1&&n.splice(a,1)}}$set(e){this.$$set&&!Eo(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const mt=[];function lt(o,e=J){let t;const n=new Set;function a(r){if(Fe(o,r)&&(o=r,t)){const m=!mt.length;for(const c of n)c[1](),mt.push(c,o);if(m){for(let c=0;c<mt.length;c+=2)mt[c][0](mt[c+1]);mt.length=0}}}function i(r){a(r(o))}function l(r,m=J){const c=[r,m];return n.add(c),n.size===1&&(t=e(a)||J),r(o),()=>{n.delete(c),n.size===0&&(t(),t=null)}}return{set:a,update:i,subscribe:l}}const Go={plots:[],lastChangeDay:0,townLog:"",townInfo:{name:"Your town",gold:1e3,gold_from_tourism:0,population_count:0,population_max:0,employees:0,happiness:100,health:100,knowledge_points:0},hasCityHall:!1,hasBank:!1,modifiers:{happiness:1,health:1},economy_and_laws:{tax_rate:0,max_tax_rate:1,balanceSheetHistory:[],lastMonthProfit:0},plotCounts:[],environment:{day:0,year:1,climate:-1},difficulty:0,endGoal:"land",endGameDetails:null},xe="plots_db_v2";let V=lt(JSON.parse(localStorage.getItem(xe))||null);function Ro(o,e){let t={...Go};t.economy_and_laws.max_tax_rate=Math.random()*(.5-.2)+.2,t.endGoal=e;let n=[];const a=o=="0"?6:o=="1"?Math.floor(Math.random()*4)+7:o=="2"?Math.floor(Math.random()*9)+12:35;for(let i=0;i<a;i++){n.push([]);for(let l=0;l<a;l++)n[i][l]={id:Math.random().toString(36).substring(2,9),active:!1,x:i,y:l,type:-1}}t.plots=n,localStorage.reset=!1,localStorage.setItem(xe,JSON.stringify(t)),V.set(t),location.reload()}function Po(){console.log("RELOADING"),localStorage.removeItem(xe),V.set(null),location.reload()}let ae=lt({visible:!1,x:0,y:0}),ht=lt({}),xt=lt(!1),Yt=lt(!1),Ht=lt(2e3);lt(localStorage.getItem("showUnaffordablePlotOptions")==="true");const ie=[{id:"res_small",title:"\u{1F3E0} Residential (small)",subtitle:"for living",type:"residential",description:"A few basic homes that can hold 16 people.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:16},styling:"background-color: #e15f00"},{id:"res_medium",title:"\u{1F3D8}\uFE0F Residential (medium)",subtitle:"for living",type:"residential",description:"A few high-density buildings that can hold 64 people.",revenue_per_week:0,requirements:{gold:500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:64},styling:"background-color: #e15f00"},{id:"res_large",title:"\u{1F3E2} Residential (large)",subtitle:"for living",type:"residential",description:"Many high-density buildings that can hold 256 people.",revenue_per_week:0,requirements:{gold:1500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:256},styling:"background-color: #e15f00"},{id:"cafe",title:"\u2615\uFE0F Small caf\xE9",subtitle:"for recreation & food",type:"food",description:"Great for eating & relaxing, not great for long-term health.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:16,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:.95},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #d24646;"},{id:"carrot_farm",title:"\u{1F955} Carrot farm",subtitle:"for farming",type:"farm",description:"Farm for making carrots, makes money by selling them.",revenue_per_week:6,requirements:{gold:25,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"apple_orchard",title:"\u{1F34E} Apple orchard",subtitle:"for farming",type:"farm",description:"A bunch of trees that make apples, makes money by selling them and by selling apple-related products.",revenue_per_week:8,requirements:{gold:50,plots:[],employees:4,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"bakery",title:"\u{1F956} Bakery",subtitle:"for baking",type:"farm",description:"Makes money by selling bread.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:3,climate:null,knowledge:0},effect_modifiers:{happiness:1.11,health:.92},immediate_variable_changes:{happiness:25,health:0,population:0},styling:"background-color: #008000;"},{id:"grocery",title:"\u{1F3EA} Grocery store",subtitle:"for living",type:"food",description:"People get hungry. This is where they go to get food.",revenue_per_week:40,requirements:{gold:320,plots:[],employees:24,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"fishery",title:"\u{1F420} Fishery",subtitle:"for fishing",type:"food",description:"Carve out some land, pour some water, and fish for fun & food.",revenue_per_week:25,requirements:{gold:400,plots:[],employees:9,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"library",title:"\u{1F4D5} Library",subtitle:"for reading",type:"recreation",description:"Reading makes people very happy, but doesn't make money.",revenue_per_week:0,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:1},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #4169e1;"},{id:"pub",title:"\u{1F37B} Pub",subtitle:"for hanging",type:"recreation",description:"Makes money, and somehow generates communal knowledge.",revenue_per_week:50,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:.7},immediate_variable_changes:{happiness:10,health:-25,population:0},styling:"background-color: #4169e1;"},{id:"church",title:"\u26EA\uFE0F Church",subtitle:"for worship & community",type:"recreation",description:"This can make some people happy, but doesn't make money.",revenue_per_week:0,requirements:{gold:100,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"stables",title:"\u{1F434} Stables",subtitle:"for friends",type:"recreation",description:"People love horses. This makes them happy, and can generate some money through lessons.",revenue_per_week:10,requirements:{gold:220,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"blacksmith",title:"\u2694\uFE0F Blacksmith",subtitle:"for making shiny things",type:"shop",description:"Sometimes problems can only be dealt with by a hunk of metal. Makes money by selling weapons, tools, & armor.",revenue_per_week:50,requirements:{gold:1300,plots:[],employees:13,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1.5},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"inn",title:"\u{1F6CC} Village Inn",subtitle:"for a night out",type:"tourism",description:"Generates tourism gold that can be used if you have a bank.",revenue_per_week:0,enables_tourism:!0,tourism_revenue_per_week:15,requirements:{gold:1500,plots:[],employees:14,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"park_small",title:"\u{1F332} Small park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"A few benches and a small grassy area.",revenue_per_week:0,requirements:{gold:80,plots:[],employees:1,climate:null,knowledge:0},effect_modifiers:{happiness:1.01,health:1.05},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_medium",title:"\u{1F6DD} Medium park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Benches, grass, and a couple of swingsets.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.02,health:1.08},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_large",title:"\u{1F3AA} Large park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Same as the medium park, with a nice fountain in the middle and occasional events run by the employees.",revenue_per_week:0,requirements:{gold:300,plots:[],employees:4,climate:null,size:2,knowledge:0},effect_modifiers:{happiness:1.09,health:1.1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #ffff00;"},{id:"school_small",title:"\u{1F4DA} Small school",subtitle:"for learning",type:"education",description:"A place where children can learn and grow, and where adults can learn new skills. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:2,requirements:{gold:850,plots:[],employees:20,climate:null,size:1,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:15,health:3,population:0},styling:"background-color: #4caf50;"},{id:"school_large",title:"\u{1F68C} Large school",subtitle:"for learning",type:"education",description:"A larger school. Produces knowledge",revenue_per_week:0,knowledge_points_per_month:8,requirements:{gold:1300,plots:[],employees:40,climate:null,size:2,knowledge:10},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:5,health:3,population:0},styling:"background-color: #4caf50;"},{id:"university",title:"\u{1F3EB} University",subtitle:"for learning",type:"education",description:"The supreme learning institution. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:25,requirements:{gold:3500,plots:[],employees:64,climate:null,size:2,knowledge:100},effect_modifiers:{happiness:1.25,health:1},immediate_variable_changes:{happiness:25,health:25,population:0},styling:"background-color: #4caf50;"},{id:"small_hospital",title:"\u{1F691} Small hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from minor injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:800,plots:[],employees:8,climate:null,size:1,knowledge:50},effect_modifiers:{happiness:1.25,health:1.5},immediate_variable_changes:{happiness:5,health:50,population:0},styling:"background-color: #ff0000;"},{id:"large_hospital",title:"\u{1F3E5} Large hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from all injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:4e3,plots:[],employees:64,climate:null,size:1,knowledge:200},effect_modifiers:{happiness:1.25,health:2.5},immediate_variable_changes:{happiness:5,health:75,population:0},styling:"background-color: #ff0000;"},{id:"bank",title:"\u{1F3E6} Bank",subtitle:"for storing and accessing funds",type:"bank",description:"Rich get richer.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:64,climate:null,size:1,knowledge:300},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"},{id:"city-hall",title:"\u{1F5F3}\uFE0F City Hall",subtitle:"for bureaucracy",type:"federal",description:"For running the government.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:24,climate:null,size:1,knowledge:500},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"}],Pe={unemployment_num:" people can't find jobs.",bored:"People are bored. Try making some new buildings.",vairety:"People don't like going to the same places over and over again. Try making some new buildings.",nobody_home:"Nobody can live here. Build some residential buildings.",leave_town_num:" people left town because they were unhappy.",new_people_num:" new people moved to town.",people_want_to_move_in:"People want to move in. Build more homes.",high_tax_rate:"People are unhappy with the high tax rate.",very_high_tax_rate:"People are extremely unhappy with the high tax rate.",sickAndDying:"People are sick and dying.",sickAndLeaving:"People are sick and leaving town.",happiness_zero:"The town has fallen into chaos due to extreme unhappiness.",health_zero:"The town has fallen into chaos due to extreme sickness.",population_zero:"The town has been condemned due to lack of population.",win:{land:"You have filled the grid with buildings. You win!"}};function Dn(o){let e,t,n=ie[o[0].type].title+"",a,i;return{c(){e=p("div"),t=p("span"),a=_(n),d(t,"data-size",i=ie[o[0].type].requirements.size),d(t,"class","svelte-18cb8zy"),d(e,"class","svelte-18cb8zy")},m(l,r){x(l,e,r),s(e,t),s(t,a)},p(l,r){r&1&&n!==(n=ie[l[0].type].title+"")&&H(a,n),r&1&&i!==(i=ie[l[0].type].requirements.size)&&d(t,"data-size",i)},d(l){l&&b(e)}}}function Uo(o){let e,t,n,a,i,l,r,m,c,u,f,h,F=o[0].type>-1&&Dn(o);return{c(){e=p("div"),F&&F.c(),d(e,"class","plot_container svelte-18cb8zy"),d(e,"data-active",t=o[0].active),d(e,"data-id",n=o[0].id),d(e,"data-x",a=o[0].x),d(e,"data-y",i=o[0].y),d(e,"data-optionindex",l=o[0].optionIndex),d(e,"data-canbeupgraded",o[1]),d(e,"style",o[2]),d(e,"data-type",r=o[0].type),d(e,"data-referenceplotx",m=o[0].referencePlot!==void 0?o[0].referencePlot[0]:null),d(e,"data-referenceploty",c=o[0].referencePlot!==void 0?o[0].referencePlot[1]:null),d(e,"data-size",u=o[0].type>-1?ie[o[0].type].requirements.size:null)},m(y,C){x(y,e,C),F&&F.m(e,null),f||(h=ee(e,"click",o[3]),f=!0)},p(y,[C]){y[0].type>-1?F?F.p(y,C):(F=Dn(y),F.c(),F.m(e,null)):F&&(F.d(1),F=null),C&1&&t!==(t=y[0].active)&&d(e,"data-active",t),C&1&&n!==(n=y[0].id)&&d(e,"data-id",n),C&1&&a!==(a=y[0].x)&&d(e,"data-x",a),C&1&&i!==(i=y[0].y)&&d(e,"data-y",i),C&1&&l!==(l=y[0].optionIndex)&&d(e,"data-optionindex",l),C&2&&d(e,"data-canbeupgraded",y[1]),C&4&&d(e,"style",y[2]),C&1&&r!==(r=y[0].type)&&d(e,"data-type",r),C&1&&m!==(m=y[0].referencePlot!==void 0?y[0].referencePlot[0]:null)&&d(e,"data-referenceplotx",m),C&1&&c!==(c=y[0].referencePlot!==void 0?y[0].referencePlot[1]:null)&&d(e,"data-referenceploty",c),C&1&&u!==(u=y[0].type>-1?ie[y[0].type].requirements.size:null)&&d(e,"data-size",u)},i:J,o:J,d(y){y&&b(e),F&&F.d(),f=!1,h()}}}function jo(o,e,t){let n,a,i,l;le(o,ae,y=>t(5,n=y)),le(o,V,y=>t(6,a=y)),le(o,xt,y=>t(7,i=y)),le(o,ht,y=>t(8,l=y));let{data:r={id:0,active:!1,x:0,y:0,type:-1,styling:"",referencePlot:[]}}=e,{canBeUpgraded:m=!1}=e;function c(...y){f()}let u=r.styling;Tt(async()=>{r.type>=0&&ie[r.type].styling&&t(2,u=ie[r.type].styling)});function f(){r.type>=0&&ie[r.type].styling&&t(2,u=ie[r.type].styling),r.type<0&&t(2,u="")}function h(y,C,z){let N=document.querySelectorAll(".plot_container");if(i==!1){if(r.referencePlot!=null&&r.referencePlot[0]!==null&&C==null&&z==null&&r.referencePlot[1]!==void 0)return h(y,r.referencePlot[0],r.referencePlot[1]);!r.active&&!m?(W(ht,l={},l),W(ae,n.visible=!1,n),N.forEach(E=>{E.classList.remove("selected")})):(C!=null&&z!=null?(W(ae,n.x=C,n),W(ae,n.y=z,n)):(W(ae,n.x=r.x,n),W(ae,n.y=r.y,n)),W(ae,n.visible=!0,n),N.forEach(E=>{E.classList.remove("selected")}),C!=null&&z!=null?document.querySelector(`.plot_container[data-x="${C}"][data-y="${z}"]`).classList.add("selected"):document.querySelector(`.plot_container[data-id="${r.id}"]`).classList.add("selected"))}}function F(y){i==!1&&(W(V,a.plots[r.x][r.y].type=y,a),W(ae,n.visible=!1,n))}return o.$$set=y=>{"data"in y&&t(0,r=y.data),"canBeUpgraded"in y&&t(1,m=y.canBeUpgraded)},o.$$.update=()=>{o.$$.dirty&1&&c(r)},[r,m,u,h,F]}class Ao extends De{constructor(e){super(),Me(this,e,jo,Uo,Fe,{data:0,canBeUpgraded:1,changePlotType:4})}get changePlotType(){return this.$$.ctx[4]}}const _e={land:{short_title:"Fill the grid",description_title:"You win by filling up all possible plots in the grid, and by meeting some requirements.",win:"You have filled the grid with buildings. You win!",requirements:{0:{population_count:200,happiness:100,health:100,employment:1},1:{population_count:500,happiness:100,health:100,employment:1},2:{population_count:1e3,happiness:100,health:100,employment:1}}}};function Ze(o,e){e===void 0&&(e=0);var t=Math.pow(10,e);o=parseFloat((o*t).toFixed(11));var n=Math.round(o)/t;return+n.toFixed(e)}function Lo(o,e,t){let n,a,i;le(o,Ht,g=>t(5,n=g)),le(o,V,g=>t(6,a=g)),le(o,xt,g=>t(7,i=g));let l=a;function r(){i==!1&&l.endGameDetails==null&&V!=null&&(l.environment.day+=1,l.environment.day%7==0&&(u(),z(),T(),M(),F(),E()),l.environment.day%30===0&&(q(),C(),f(),h()),l.environment.day%90==0&&(y(),P()),N(),c(),m(),V.set(l),localStorage.setItem(xe,JSON.stringify(l)))}function m(){if(l.endGoal=="land"&&l.townInfo.population_max==l.townInfo.population_count&&l.townInfo.happiness>=_e.land.requirements[l.difficulty].happiness&&l.townInfo.health>=_e.land.requirements[l.difficulty].health&&l.townInfo.employees/l.townInfo.population_count>=_e.land.requirements[l.difficulty].employment){let g=!0;for(let v=0;v<l.plots.length;v++)for(let S=0;S<l.plots[v].length;S++)if(l.plots[v][S].active==!1){g=!1;break}g&&(l.endGameDetails={msg:_e.land.win,win:!0})}}function c(){l.townInfo.happiness<=0&&(l.townInfo.happiness=0,l.endGameDetails={msg:Pe.happiness_zero,win:!1}),l.townInfo.health<=0&&(l.townInfo.health=0,l.endGameDetails={msg:Pe.health_zero,win:!1}),l.townInfo.population_count<=0&&l.townInfo.population_max>0&&(l.townInfo.population_count=0,l.endGameDetails={msg:Pe.population_zero,win:!1})}function u(){let g=l.townInfo.population_count-l.townInfo.employees;g>0&&(l.modifiers.happiness-=g*9e-4,A(g+Pe.unemployment_num))}function f(){a.hasBank}function h(){a.hasCityHall}function F(){let g=l.townInfo.health,v=0;g>50||g<Math.random()*50&&(g<25?(A(Pe.sickAndDying),l.townInfo.happiness-=10,v=Math.round(l.townInfo.population_count*.1)):(A(Pe.sickAndLeaving),l.townInfo.happiness-=5,v=Math.round(l.townInfo.population_count*.05)),l.townInfo.population_count-=v,l.townInfo.employees-=v)}function y(){l.lastChangeDay+(Math.random()*160+50)<l.environment.day&&(l.townInfo.population_count>0&&(l.townInfo.population_count-=1,l.townInfo.employees-=1,l.modifiers.happiness-=.01),A(Pe.bored))}function C(){if(l.townInfo.population_count<l.townInfo.population_max&&l.townInfo.happiness>50){let g=l.townInfo.population_max-l.townInfo.population_count,v=Math.round(l.townInfo.happiness/100*g);l.townInfo.population_count+=v,l.townInfo.population_count>l.townInfo.population_max&&(l.townInfo.population_count=l.townInfo.population_max),l.townInfo.employees+=v,l.townInfo.employees>l.townInfo.population_count&&(l.townInfo.employees=l.townInfo.population_count),A(v+Pe.new_people_num)}if(l.townInfo.happiness<50&&l.townInfo.population_count>0){let g=Math.round((100-l.townInfo.happiness)/5);l.townInfo.population_count-=g,l.townInfo.employees>0&&(l.townInfo.employees-=g),A(g+Pe.leave_town_num)}else l.townInfo.population_count==l.townInfo.population_max&&A(Pe.people_want_to_move_in)}function z(){const g=Math.random();if(l.economy_and_laws.tax_rate>l.economy_and_laws.max_tax_rate){const v=l.difficulty==0?.7:l.difficulty==1?.4:.2;g<v&&l.economy_and_laws.tax_rate>l.economy_and_laws.max_tax_rate*2?(l.modifiers.happiness-=.03,A(Pe.very_high_tax_rate+"  ("+l.economy_and_laws.tax_rate+"%)")):(l.modifiers.happiness-=.01,A(Pe.high_tax_rate+"  ("+l.economy_and_laws.tax_rate*100+"%)"))}}function N(){l.townInfo.happiness<0&&(l.townInfo.happiness=0),l.townInfo.health<0&&(l.townInfo.health=0),l.townInfo.gold<0&&(l.townInfo.gold=0),l.townInfo.employees<0&&(l.townInfo.employees=0),l.townInfo.knowledge_points<0&&(l.townInfo.knowledge_points=0),l.townInfo.population_count<0&&(l.townInfo.population_count=0),l.townInfo.population_max==0&&A(Pe.nobody_home),l.economy_and_laws.lastMonthProfit=Ze(l.economy_and_laws.lastMonthProfit,2),l.townInfo.gold=Ze(l.townInfo.gold,2),l.townInfo.population_count=Ze(l.townInfo.population_count,0),l.townInfo.employees=Ze(l.townInfo.employees,0),l.townInfo.population_max=Ze(l.townInfo.population_max,0),l.townInfo.happiness=Ze(l.townInfo.happiness,2),l.townInfo.health=Ze(l.townInfo.health,2),l.townInfo.happiness>300&&(l.townInfo.happiness=300),l.townInfo.health>300&&(l.townInfo.health=300),l.modifiers.happiness<.5&&(l.modifiers.happiness=.5),l.modifiers.health<.5&&(l.modifiers.health=.5)}function E(){if(l.modifiers.happiness>1){let g=l.modifiers.happiness-1;l.modifiers.happiness-=g*.08,l.modifiers.happiness<1.05&&(l.modifiers.happiness=1)}if(l.modifiers.health>1){let g=l.modifiers.health-1;l.modifiers.health-=g*.08,l.modifiers.health<1.05&&(l.modifiers.health=1)}}function P(){if(l.townInfo.happiness>150){let g=l.townInfo.happiness-150;l.townInfo.happiness-=g*.08,l.townInfo.happiness<150&&(l.townInfo.happiness=150)}if(l.townInfo.health>150){let g=l.townInfo.health-150;l.townInfo.health-=g*.08,l.townInfo.health<150&&(l.townInfo.health=150)}}function T(){l.economy_and_laws.lastMonthProfit=0;for(let g=0;g<l.plots.length;g++)for(let v=0;v<l.plots[g].length;v++)if(l.plots[g][v].active==!0&&l.plots[g][v].type>-1){let S=ie[l.plots[g][v].type],Q=I(S.revenue_per_week);l.townInfo.gold+=Q,l.economy_and_laws.lastMonthProfit+=Q,Q>0&&(l.economy_and_laws.balanceSheetHistory=[{day:l.environment.day,plot:`${g},${v}`,profits:Q,taxRate:l.economy_and_laws.tax_rate},...l.economy_and_laws.balanceSheetHistory],l.economy_and_laws.balanceSheetHistory.length>250&&(l.economy_and_laws.balanceSheetHistory=l.economy_and_laws.balanceSheetHistory.slice(0,250))),S.enables_tourism==!0&&(l.townInfo.gold_from_tourism+=S.tourism_revenue_per_week*l.economy_and_laws.tax_rate*l.townInfo.population_count)}}function M(){l.townInfo.happiness*=l.modifiers.happiness,l.townInfo.health*=l.modifiers.health}function q(){for(let g=0;g<l.plots.length;g++)for(let v=0;v<l.plots[g].length;v++)if(l.plots[g][v].active==!0&&l.plots[g][v].type>-1){let S=ie[l.plots[g][v].type];S.knowledge_points_per_month!=null&&(l.townInfo.knowledge_points+=S.knowledge_points_per_month)}}function A(g){let v=a;v.townLog="Day "+a.environment.day+" - "+g+`
`+v.townLog,V.set(v),localStorage.setItem(xe,JSON.stringify(v))}function I(g){let v=a,S=v.townInfo.happiness/100;S>1.25?S=1.25:S<.75&&(S=.75);let Q=g*v.economy_and_laws.tax_rate*(v.townInfo.population_count/v.townInfo.population_max)*S;return Ze(Q,2)}return Tt(async()=>{for(;;)localStorage.reset=="true"&&(Po(),localStorage.setItem("reset","false")),r(),await new Promise(g=>setTimeout(g,n))}),[r,N,E,P]}class Xo extends De{constructor(e){super(),Me(this,e,Lo,null,Fe,{mainGameThreadLoop:0,_fixVariables:1,_bringModifiersBackToNormal:2,_bringStatsBackToNormal:3})}get mainGameThreadLoop(){return this.$$.ctx[0]}get _fixVariables(){return this.$$.ctx[1]}get _bringModifiersBackToNormal(){return this.$$.ctx[2]}get _bringStatsBackToNormal(){return this.$$.ctx[3]}}function Hn(o,e,t){const n=o.slice();return n[21]=e[t],n}function Tn(o){let e,t;return{c(){e=p("div"),t=_(o[0]),d(e,"class","message")},m(n,a){x(n,e,a),s(e,t)},p(n,a){a&1&&H(t,n[0])},d(n){n&&b(e)}}}function Gn(o){let e,t,n;return{c(){e=p("button"),e.textContent="\u{1F525}",d(e,"id","bulldoze"),d(e,"class","svelte-1ppqz9a")},m(a,i){x(a,e,i),t||(n=ee(e,"click",o[11]),t=!0)},p:J,d(a){a&&b(e),t=!1,n()}}}function Rn(o){let e,t,n,a;return{c(){e=p("span"),t=_("("),n=_(o[7]),a=_(")"),d(e,"class","text_s")},m(i,l){x(i,e,l),s(e,t),s(e,n),s(e,a)},p(i,l){l&128&&H(n,i[7])},d(i){i&&b(e)}}}function Un(o){let e;return{c(){e=p("span"),e.textContent="(0)",d(e,"class","text_s")},m(t,n){x(t,e,n)},d(t){t&&b(e)}}}function Vo(o){let e,t,n,a=o[21].title+"",i,l,r,m,c,u=o[21].subtitle+"",f,h,F,y,C,z=o[21].description+"",N,E,P,T,M,q,A,I,g,v,S,Q,$,G,R,Y,se,L,B,Z,te,ne,ge,ye,k,D,ke,gt,re=(o[21].revenue_per_week>0||o[21].tourism_revenue_per_week>0)&&jn(o),pe=o[21].requirements.gold!==0&&Vn(o),fe=o[21].requirements.employees!==0&&Wn(o),ue=o[21].requirements.knowledge!=null&&o[21].requirements.knowledge!==0&&Kn(o);function Je(U,ce){return U[21].effect_modifiers.happiness==1?tl:el}let Ve=Je(o),Ie=Ve(o);function He(U,ce){return U[21].effect_modifiers.health==1?ol:nl}let Xe=He(o),$e=Xe(o),oe=(o[21].immediate_variable_changes.happiness!==0||o[21].immediate_variable_changes.health!==0)&&Qn(o);return{c(){e=p("div"),t=p("div"),n=p("span"),i=_(a),l=w(),r=p("br"),m=w(),c=p("span"),f=_(u),h=w(),F=p("br"),y=w(),C=p("span"),N=_(z),E=w(),P=p("div"),re&&re.c(),T=w(),M=p("div"),q=p("div"),A=p("span"),A.textContent="Requirements",I=w(),g=p("br"),v=w(),pe&&pe.c(),S=w(),fe&&fe.c(),Q=w(),ue&&ue.c(),$=w(),G=p("div"),R=p("span"),R.textContent="Multiplier",Y=w(),se=p("br"),L=w(),Ie.c(),B=w(),Z=p("br"),te=w(),$e.c(),ne=w(),oe&&oe.c(),ge=w(),d(n,"class","heading_m"),d(c,"class","subheading_m"),d(C,"class","text_s"),d(A,"class","subheading_m"),d(q,"class","svelte-1ppqz9a"),d(R,"class","subheading_m"),d(G,"class","svelte-1ppqz9a"),d(M,"class","reqs_and_mods svelte-1ppqz9a"),d(P,"class","bottom svelte-1ppqz9a"),d(e,"class","plotOption background-lightgray svelte-1ppqz9a"),d(e,"data-active",ye=o[21].selected),d(e,"data-affordable",k=o[13](o[21])),d(e,"data-plotoptionid",D=o[21].id)},m(U,ce){x(U,e,ce),s(e,t),s(t,n),s(n,i),s(t,l),s(t,r),s(t,m),s(t,c),s(c,f),s(t,h),s(t,F),s(t,y),s(t,C),s(C,N),s(e,E),s(e,P),re&&re.m(P,null),s(P,T),s(P,M),s(M,q),s(q,A),s(q,I),s(q,g),s(q,v),pe&&pe.m(q,null),s(q,S),fe&&fe.m(q,null),s(q,Q),ue&&ue.m(q,null),s(M,$),s(M,G),s(G,R),s(G,Y),s(G,se),s(G,L),Ie.m(G,null),s(G,B),s(G,Z),s(G,te),$e.m(G,null),s(P,ne),oe&&oe.m(P,null),s(e,ge),ke||(gt=ee(e,"click",o[12]),ke=!0)},p(U,ce){ce&32&&a!==(a=U[21].title+"")&&H(i,a),ce&32&&u!==(u=U[21].subtitle+"")&&H(f,u),ce&32&&z!==(z=U[21].description+"")&&H(N,z),U[21].revenue_per_week>0||U[21].tourism_revenue_per_week>0?re?re.p(U,ce):(re=jn(U),re.c(),re.m(P,T)):re&&(re.d(1),re=null),U[21].requirements.gold!==0?pe?pe.p(U,ce):(pe=Vn(U),pe.c(),pe.m(q,S)):pe&&(pe.d(1),pe=null),U[21].requirements.employees!==0?fe?fe.p(U,ce):(fe=Wn(U),fe.c(),fe.m(q,Q)):fe&&(fe.d(1),fe=null),U[21].requirements.knowledge!=null&&U[21].requirements.knowledge!==0?ue?ue.p(U,ce):(ue=Kn(U),ue.c(),ue.m(q,null)):ue&&(ue.d(1),ue=null),Ve===(Ve=Je(U))&&Ie?Ie.p(U,ce):(Ie.d(1),Ie=Ve(U),Ie&&(Ie.c(),Ie.m(G,B))),Xe===(Xe=He(U))&&$e?$e.p(U,ce):($e.d(1),$e=Xe(U),$e&&($e.c(),$e.m(G,null))),U[21].immediate_variable_changes.happiness!==0||U[21].immediate_variable_changes.health!==0?oe?oe.p(U,ce):(oe=Qn(U),oe.c(),oe.m(P,null)):oe&&(oe.d(1),oe=null),ce&32&&ye!==(ye=U[21].selected)&&d(e,"data-active",ye),ce&32&&k!==(k=U[13](U[21]))&&d(e,"data-affordable",k),ce&32&&D!==(D=U[21].id)&&d(e,"data-plotoptionid",D)},d(U){U&&b(e),re&&re.d(),pe&&pe.d(),fe&&fe.d(),ue&&ue.d(),Ie.d(),$e.d(),oe&&oe.d(),ke=!1,gt()}}}function jn(o){let e,t,n,a,i,l,r=o[21].revenue_per_week>0&&An(o),m=o[21].tourism_revenue_per_week>0&&Ln(o);return{c(){e=p("div"),t=p("span"),t.textContent="Profits",n=w(),a=p("br"),i=w(),r&&r.c(),l=w(),m&&m.c(),d(t,"class","subheading_m"),d(e,"class","profits svelte-1ppqz9a")},m(c,u){x(c,e,u),s(e,t),s(e,n),s(e,a),s(e,i),r&&r.m(e,null),s(e,l),m&&m.m(e,null)},p(c,u){c[21].revenue_per_week>0?r?r.p(c,u):(r=An(c),r.c(),r.m(e,l)):r&&(r.d(1),r=null),c[21].tourism_revenue_per_week>0?m?m.p(c,u):(m=Ln(c),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},d(c){c&&b(e),r&&r.d(),m&&m.d()}}}function An(o){let e,t,n=o[21].revenue_per_week+"",a,i,l=je(o[8].economy_and_laws.tax_rate*o[21].revenue_per_week,2)+"",r,m,c,u;return{c(){e=p("span"),t=p("span"),a=_(n),i=w(),r=_(l),m=_(" gold (with tax rate)"),c=w(),u=p("br"),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(f,h){x(f,e,h),s(e,t),s(t,a),s(e,i),s(e,r),s(e,m),x(f,c,h),x(f,u,h)},p(f,h){h&32&&n!==(n=f[21].revenue_per_week+"")&&H(a,n),h&288&&l!==(l=je(f[8].economy_and_laws.tax_rate*f[21].revenue_per_week,2)+"")&&H(r,l)},d(f){f&&b(e),f&&b(c),f&&b(u)}}}function Ln(o){let e,t,n=o[21].tourism_revenue_per_week+"",a,i,l=je(o[8].economy_and_laws.tax_rate*o[21].tourism_revenue_per_week*o[8].townInfo.population_count,2)+"",r,m,c,u=o[8].hasABank!==!0&&Xn();return{c(){e=p("span"),t=p("span"),a=_(n),i=w(),r=_(l),m=_(` tourism gold (
												`),u&&u.c(),c=_(`

												)`),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(f,h){x(f,e,h),s(e,t),s(t,a),s(e,i),s(e,r),s(e,m),u&&u.m(e,null),s(e,c)},p(f,h){h&32&&n!==(n=f[21].tourism_revenue_per_week+"")&&H(a,n),h&288&&l!==(l=je(f[8].economy_and_laws.tax_rate*f[21].tourism_revenue_per_week*f[8].townInfo.population_count,2)+"")&&H(r,l),f[8].hasABank!==!0?u||(u=Xn(),u.c(),u.m(e,c)):u&&(u.d(1),u=null)},d(f){f&&b(e),u&&u.d()}}}function Xn(o){let e;return{c(){e=_("get a bank to cash out")},m(t,n){x(t,e,n)},d(t){t&&b(e)}}}function Vn(o){let e,t;function n(l,r){return l[8].townInfo.gold<l[21].requirements.gold?Ko:Wo}let a=n(o),i=a(o);return{c(){i.c(),e=w(),t=p("br")},m(l,r){i.m(l,r),x(l,e,r),x(l,t,r)},p(l,r){a===(a=n(l))&&i?i.p(l,r):(i.d(1),i=a(l),i&&(i.c(),i.m(e.parentNode,e)))},d(l){i.d(l),l&&b(e),l&&b(t)}}}function Wo(o){let e,t=o[21].requirements.gold+"",n,a;return{c(){e=p("span"),n=_(t),a=_(" gold"),d(e,"class","text_s cost_label svelte-1ppqz9a")},m(i,l){x(i,e,l),s(e,n),s(e,a)},p(i,l){l&32&&t!==(t=i[21].requirements.gold+"")&&H(n,t)},d(i){i&&b(e)}}}function Ko(o){let e,t=o[21].requirements.gold+"",n,a;return{c(){e=p("span"),n=_(t),a=_(" gold"),d(e,"class","red text_s cost_label svelte-1ppqz9a")},m(i,l){x(i,e,l),s(e,n),s(e,a)},p(i,l){l&32&&t!==(t=i[21].requirements.gold+"")&&H(n,t)},d(i){i&&b(e)}}}function Wn(o){let e,t;function n(l,r){return l[8].townInfo.population_count-l[8].townInfo.employees<l[21].requirements.employees?Zo:Qo}let a=n(o),i=a(o);return{c(){i.c(),e=w(),t=p("br")},m(l,r){i.m(l,r),x(l,e,r),x(l,t,r)},p(l,r){a===(a=n(l))&&i?i.p(l,r):(i.d(1),i=a(l),i&&(i.c(),i.m(e.parentNode,e)))},d(l){i.d(l),l&&b(e),l&&b(t)}}}function Qo(o){let e,t=o[21].requirements.employees+"",n,a;return{c(){e=p("span"),n=_(t),a=_(" employees"),d(e,"class","text_s cost_label svelte-1ppqz9a")},m(i,l){x(i,e,l),s(e,n),s(e,a)},p(i,l){l&32&&t!==(t=i[21].requirements.employees+"")&&H(n,t)},d(i){i&&b(e)}}}function Zo(o){let e,t=o[21].requirements.employees+"",n,a;return{c(){e=p("span"),n=_(t),a=_(" employees"),d(e,"class","text_s cost_label red svelte-1ppqz9a")},m(i,l){x(i,e,l),s(e,n),s(e,a)},p(i,l){l&32&&t!==(t=i[21].requirements.employees+"")&&H(n,t)},d(i){i&&b(e)}}}function Kn(o){let e,t;function n(l,r){return l[8].townInfo.knowledge_points<l[21].requirements.knowledge?Yo:Jo}let a=n(o),i=a(o);return{c(){i.c(),e=w(),t=p("br")},m(l,r){i.m(l,r),x(l,e,r),x(l,t,r)},p(l,r){a===(a=n(l))&&i?i.p(l,r):(i.d(1),i=a(l),i&&(i.c(),i.m(e.parentNode,e)))},d(l){i.d(l),l&&b(e),l&&b(t)}}}function Jo(o){let e,t=o[21].requirements.knowledge+"",n,a;return{c(){e=p("span"),n=_(t),a=_(" knowledge"),d(e,"class","text_s cost_label svelte-1ppqz9a")},m(i,l){x(i,e,l),s(e,n),s(e,a)},p(i,l){l&32&&t!==(t=i[21].requirements.knowledge+"")&&H(n,t)},d(i){i&&b(e)}}}function Yo(o){let e,t=o[21].requirements.knowledge+"",n,a;return{c(){e=p("span"),n=_(t),a=_(" knowledge"),d(e,"class","text_s cost_label red svelte-1ppqz9a")},m(i,l){x(i,e,l),s(e,n),s(e,a)},p(i,l){l&32&&t!==(t=i[21].requirements.knowledge+"")&&H(n,t)},d(i){i&&b(e)}}}function el(o){let e,t,n=Gt(o[21].effect_modifiers.happiness)+"",a,i;return{c(){e=p("span"),t=_("\u{1F601} "),a=_(n),d(e,"class","text_s svelte-1ppqz9a"),d(e,"data-positive",i=o[21].effect_modifiers.happiness>=1)},m(l,r){x(l,e,r),s(e,t),s(e,a)},p(l,r){r&32&&n!==(n=Gt(l[21].effect_modifiers.happiness)+"")&&H(a,n),r&32&&i!==(i=l[21].effect_modifiers.happiness>=1)&&d(e,"data-positive",i)},d(l){l&&b(e)}}}function tl(o){let e;return{c(){e=p("span"),e.textContent="\u{1F601} No effect",d(e,"class","text_s svelte-1ppqz9a"),d(e,"data-positive","true")},m(t,n){x(t,e,n)},p:J,d(t){t&&b(e)}}}function nl(o){let e,t,n=Gt(o[21].effect_modifiers.health)+"",a,i;return{c(){e=p("span"),t=_("\u{1F3E5} "),a=_(n),d(e,"class","text_s svelte-1ppqz9a"),d(e,"data-positive",i=o[21].effect_modifiers.health>=1)},m(l,r){x(l,e,r),s(e,t),s(e,a)},p(l,r){r&32&&n!==(n=Gt(l[21].effect_modifiers.health)+"")&&H(a,n),r&32&&i!==(i=l[21].effect_modifiers.health>=1)&&d(e,"data-positive",i)},d(l){l&&b(e)}}}function ol(o){let e;return{c(){e=p("span"),e.textContent="\u{1F3E5} No effect",d(e,"class","text_s svelte-1ppqz9a"),d(e,"data-positive","true")},m(t,n){x(t,e,n)},p:J,d(t){t&&b(e)}}}function Qn(o){let e,t,n,a,i,l=o[21].immediate_variable_changes.happiness!==0&&Zn(o),r=o[21].immediate_variable_changes.happiness!==0&&o[21].immediate_variable_changes.health!==0&&Jn(),m=o[21].immediate_variable_changes.health!==0&&Yn(o);return{c(){e=p("div"),t=p("span"),n=_(`Instant changes:
											`),l&&l.c(),a=w(),r&&r.c(),i=w(),m&&m.c(),d(t,"class","subheading_m"),d(e,"class","immediate_changes svelte-1ppqz9a")},m(c,u){x(c,e,u),s(e,t),s(t,n),l&&l.m(t,null),s(t,a),r&&r.m(t,null),s(t,i),m&&m.m(t,null)},p(c,u){c[21].immediate_variable_changes.happiness!==0?l?l.p(c,u):(l=Zn(c),l.c(),l.m(t,a)):l&&(l.d(1),l=null),c[21].immediate_variable_changes.happiness!==0&&c[21].immediate_variable_changes.health!==0?r||(r=Jn(),r.c(),r.m(t,i)):r&&(r.d(1),r=null),c[21].immediate_variable_changes.health!==0?m?m.p(c,u):(m=Yn(c),m.c(),m.m(t,null)):m&&(m.d(1),m=null)},d(c){c&&b(e),l&&l.d(),r&&r.d(),m&&m.d()}}}function Zn(o){let e,t,n=o[21].immediate_variable_changes.happiness+"",a;return{c(){e=_(`\u{1F601}
												`),t=p("span"),a=_(n),d(t,"class","green")},m(i,l){x(i,e,l),x(i,t,l),s(t,a)},p(i,l){l&32&&n!==(n=i[21].immediate_variable_changes.happiness+"")&&H(a,n)},d(i){i&&b(e),i&&b(t)}}}function Jn(o){let e;return{c(){e=_(",")},m(t,n){x(t,e,n)},d(t){t&&b(e)}}}function Yn(o){let e,t,n=o[21].immediate_variable_changes.health+"",a;return{c(){e=_(`\u{1F3E5}
												`),t=p("span"),a=_(n),d(t,"class","green")},m(i,l){x(i,e,l),x(i,t,l),s(t,a)},p(i,l){l&32&&n!==(n=i[21].immediate_variable_changes.health+"")&&H(a,n)},d(i){i&&b(e),i&&b(t)}}}function eo(o,e){let t,n,a=Vo(e);return{key:o,first:null,c(){t=Le(),a&&a.c(),n=Le(),this.first=t},m(i,l){x(i,t,l),a&&a.m(i,l),x(i,n,l)},p(i,l){e=i,a.p(e,l)},d(i){i&&b(t),a&&a.d(i),i&&b(n)}}}function ll(o){let e,t,n,a,i,l,r=o[2]+1+"",m,c,u=o[1]+1+"",f,h,F,y,C,z,N=o[8].plots[o[1]][o[2]].type!==-1&&o[3](o[2],o[1]),E,P,T,M,q,A,I,g,v,S,Q,$,G,R=[],Y=new Map,se,L,B=o[0]!==""&&Tn(o),Z=N&&Gn(o),te=o[7]>0&&Rn(o),ne=o[5].length==0&&Un(),ge=o[5];const ye=k=>k[21];for(let k=0;k<ge.length;k+=1){let D=Hn(o,ge,k),ke=ye(D);Y.set(ke,R[k]=eo(ke,D))}return{c(){e=p("div"),t=p("div"),n=p("div"),a=p("div"),i=p("span"),l=_("Modify Plot: "),m=_(r),c=_("-"),f=_(u),h=w(),B&&B.c(),F=w(),y=p("input"),C=w(),z=p("div"),Z&&Z.c(),E=w(),P=p("button"),P.textContent="Close",T=w(),M=p("div"),q=p("label"),A=_(`options
				`),te&&te.c(),I=w(),ne&&ne.c(),g=w(),v=p("br"),S=w(),Q=p("br"),$=w(),G=p("div");for(let k=0;k<R.length;k+=1)R[k].c();d(i,"class","heading_l"),d(a,"class","svelte-1ppqz9a"),d(y,"type","text"),d(y,"id","search-bar"),d(y,"placeholder","Search Plot Options..."),y.value=o[4],d(y,"class","svelte-1ppqz9a"),d(P,"id","close"),d(P,"class","svelte-1ppqz9a"),d(z,"class","svelte-1ppqz9a"),d(n,"class","header svelte-1ppqz9a"),d(q,"for","plotType"),d(G,"class","plotOptions svelte-1ppqz9a"),d(M,"class","scrollable-y svelte-1ppqz9a"),d(t,"class","dialog-content svelte-1ppqz9a"),d(e,"class","dialog svelte-1ppqz9a")},m(k,D){x(k,e,D),s(e,t),s(t,n),s(n,a),s(a,i),s(i,l),s(i,m),s(i,c),s(i,f),s(a,h),B&&B.m(a,null),s(n,F),s(n,y),o[17](y),s(n,C),s(n,z),Z&&Z.m(z,null),s(z,E),s(z,P),s(t,T),s(t,M),s(M,q),s(q,A),te&&te.m(q,null),s(q,I),ne&&ne.m(q,null),s(M,g),s(M,v),s(M,S),s(M,Q),s(M,$),s(M,G);for(let ke=0;ke<R.length;ke+=1)R[ke].m(G,null);se||(L=[ee(y,"input",o[9]),ee(P,"click",o[10])],se=!0)},p(k,[D]){D&4&&r!==(r=k[2]+1+"")&&H(m,r),D&2&&u!==(u=k[1]+1+"")&&H(f,u),k[0]!==""?B?B.p(k,D):(B=Tn(k),B.c(),B.m(a,null)):B&&(B.d(1),B=null),D&16&&y.value!==k[4]&&(y.value=k[4]),D&262&&(N=k[8].plots[k[1]][k[2]].type!==-1&&k[3](k[2],k[1])),N?Z?Z.p(k,D):(Z=Gn(k),Z.c(),Z.m(z,E)):Z&&(Z.d(1),Z=null),k[7]>0?te?te.p(k,D):(te=Rn(k),te.c(),te.m(q,I)):te&&(te.d(1),te=null),k[5].length==0?ne||(ne=Un(),ne.c(),ne.m(q,null)):ne&&(ne.d(1),ne=null),D&12576&&(ge=k[5],R=Ho(R,D,ye,1,k,ge,Y,G,Do,eo,null,Hn))},i:J,o:J,d(k){k&&b(e),B&&B.d(),o[17](null),Z&&Z.d(),te&&te.d(),ne&&ne.d();for(let D=0;D<R.length;D+=1)R[D].d();se=!1,ot(L)}}}function je(o,e){e===void 0&&(e=0);var t=Math.pow(10,e);o=parseFloat((o*t).toFixed(11));var n=Math.round(o)/t;return+n.toFixed(e)}function Gt(o){return o.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}function al(o,e,t){let n,a;le(o,V,I=>t(8,n=I)),le(o,ae,I=>t(18,a=I));var i=this&&this.__awaiter||function(I,g,v,S){function Q($){return $ instanceof v?$:new v(function(G){G($)})}return new(v||(v=Promise))(function($,G){function R(L){try{se(S.next(L))}catch(B){G(B)}}function Y(L){try{se(S.throw(L))}catch(B){G(B)}}function se(L){L.done?$(L.value):Q(L.value).then(R,Y)}se((S=S.apply(I,g||[])).next())})};let{x:l=0}=e,{y:r=0}=e,m="",c=ie,{tooltip:u=""}=e,f=c,h,F;Tt(()=>i(void 0,void 0,void 0,function*(){yield Bo(),h&&h.focus()}));function y(I){t(4,m=I.target.value),I.stopPropagation()}Tt(()=>{const I=document.querySelectorAll(".plotOption");n.plots[l][r].type!==-1&&n.plots[l][r].type>-1&&(I[n.plots[l][r].type].classList.add("active"),I[n.plots[l][r].type].scrollIntoView({behavior:"smooth",block:"center"}))});function C(I,g){let v={x:I,y:g};return v.x===0&&v.y===0?!0:[{x:v.x-1,y:v.y},{x:v.x+1,y:v.y},{x:v.x,y:v.y-1},{x:v.x,y:v.y+1}].some(S=>(console.log(n.plots.length),S.x<0||S.x>n.plots.length-1||S.y<0||S.y>n.plots.length-1?!1:n.plots[S.x][S.y].active))}function z(){W(ae,a.visible=!1,a)}function N(){document.querySelectorAll(".plotOption").forEach(I=>{I.classList.remove("active")}),M(l,r)}function E(I){if(I.currentTarget.classList.contains("plotOption")){document.querySelectorAll(".plotOption").forEach(v=>{v.classList.remove("active")}),I.currentTarget.classList.add("active");const g=I.currentTarget.dataset.plotoptionid;T(l,r,g)}}function P(I,g){let v=0;return I>0&&n.plots[I-1][g].type!==-1&&v++,I<n.plots.length-1&&n.plots[I+1][g].type!==-1&&v++,g>0&&n.plots[I][g-1].type!==-1&&v++,g<n.plots[0].length-1&&n.plots[I][g+1].type!==-1&&v++,console.log(v),v<=4}function T(I,g,v){let S=n;const Q=ie.findIndex(R=>R.id===v);let $=ie[Q],G=!0;if(($.requirements.gold>S.townInfo.gold||$.requirements.employees>S.townInfo.population_count-S.townInfo.employees)&&(G=!1),$.requirements.size!=null&&G){let R=$.requirements.size,Y=[],se=c[Q].title.toLowerCase().indexOf("school")!=-1;for(let L=0;L<4;L++){let B=[[I,g]];L===0?(B.push([I-(R-1),g-(R-1)]),B.push([I-(R-1),g]),B.push([I,g-(R-1)])):L===1?(B.push([I,g-(R-1)]),B.push([I+(R-1),g-(R-1)]),B.push([I+(R-1),g])):L===2?(B.push([I-(R-1),g]),B.push([I-(R-1),g+(R-1)]),B.push([I,g+(R-1)])):L===3&&(B.push([I,g+(R-1)]),B.push([I+(R-1),g+(R-1)]),B.push([I+(R-1),g])),Y.push(B)}Y=Y.filter(L=>(console.log(S.plots.length),L.every(B=>B[0]>=0&&B[0]<=S.plots.length-1&&B[1]>=0&&B[1]<=S.plots.length-1&&!S.plots[B[0]][B[1]].active&&C(B[0],B[1])==!0))),Y.length===0?G=!1:Y.length>0&&Y[0].forEach(L=>{S.plots[L[0]][L[1]].active=!0,S.plots[L[0]][L[1]].type=se?-3:-2,S.plots[L[0]][L[1]].referencePlot=[I,g]})}if(G===!0){switch(S.plots[I][g].type!==-1&&M(I,g),t(0,u=""),S.plots[I][g].type=Q,S.plots[I][g].active=!0,S.plots[I][g].referencePlot=[],S.townInfo.gold-=$.requirements.gold,S.townInfo.gold=je(S.townInfo.gold,2),S.townInfo.population_count+=$.immediate_variable_changes.population,S.townInfo.population_max+=$.immediate_variable_changes.population,S.townInfo.happiness+=$.immediate_variable_changes.happiness,S.townInfo.health+=$.immediate_variable_changes.health,S.modifiers.happiness=je(S.modifiers.happiness*$.effect_modifiers.happiness,2),S.modifiers.health=je(S.modifiers.health*$.effect_modifiers.health,2),S.townInfo.employees+=$.requirements.employees,(S.plotCounts[Q]===void 0||S.plotCounts[Q]===null)&&(S.plotCounts[Q]=0),S.plotCounts[Q]++,S.lastChangeDay=S.environment.day,S.economy_and_laws.balanceSheetHistory=[{day:S.environment.day,plot:`${I},${g}`,profits:$.requirements.gold*-1,balance:je(S.townInfo.gold,2)},...S.economy_and_laws.balanceSheetHistory],$.id){case"city-hall":S.hasCityHall=!0;break;case"bank":S.hasBank=!0;break}V.set(S),localStorage.setItem(xe,JSON.stringify(S)),W(ae,a.visible=!1,a)}else t(0,u="You do not have enough resources to purchase this plot."),document.querySelectorAll(".plotOption").forEach(R=>{R.classList.remove("active")})}function M(I,g){let v=n,S=v.plots[I][g].type;v.plots[I][g].type=-1,v.plots[I][g].active=!1,S>-1&&(v.townInfo.population_count-=ie[S].immediate_variable_changes.population,v.townInfo.population_max-=ie[S].immediate_variable_changes.population,v.townInfo.happiness-=ie[S].immediate_variable_changes.happiness,v.townInfo.health-=ie[S].immediate_variable_changes.health,v.modifiers.happiness=je(v.modifiers.happiness/ie[S].effect_modifiers.happiness,2),v.modifiers.health=je(v.modifiers.health/ie[S].effect_modifiers.health,2),v.townInfo.employees-=ie[S].requirements.employees,(v.plotCounts[S]===void 0||v.plotCounts[S]===null)&&(v.plotCounts[S]=0),v.plotCounts[S]--),v.lastChangeDay=v.environment.day,V.set(v),localStorage.setItem(xe,JSON.stringify(v))}function q(I){let g=n,v=!0;I.requirements.gold>g.townInfo.gold&&(v=!1);let S=g.townInfo.population_count-g.townInfo.employees;return I.requirements.employees!==void 0&&I.requirements.employees>0&&I.requirements.employees>S&&(v=!1),I.requirements.knowledge!==void 0&&I.requirements.knowledge>g.townInfo.knowledge_points&&(v=!1),v}function A(I){Qt[I?"unshift":"push"](()=>{h=I,t(6,h)})}return o.$$set=I=>{"x"in I&&t(1,l=I.x),"y"in I&&t(2,r=I.y),"tooltip"in I&&t(0,u=I.tooltip)},o.$$.update=()=>{o.$$.dirty&16&&t(5,f=m?c.filter(I=>I.title.toLowerCase().includes(m.toLowerCase())):c),o.$$.dirty&32&&t(7,F=f.filter(I=>q(I)).length)},[u,l,r,P,m,f,h,F,n,y,z,N,E,q,C,T,M,A]}class il extends De{constructor(e){super(),Me(this,e,al,ll,Fe,{x:1,y:2,tooltip:0,checkIfPlotCanBeUpgraded:14,canBulldoze:3,purchasePlot:15,reverseClear:16})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[14]}get canBulldoze(){return this.$$.ctx[3]}get purchasePlot(){return this.$$.ctx[15]}get reverseClear(){return this.$$.ctx[16]}}function to(o,e,t){const n=o.slice();return n[6]=e[t],n}function no(o,e,t){const n=o.slice();return n[9]=e[t],n}function oo(o){let e,t,n=o[3],a,i,l=o[2].plots,r=[];for(let u=0;u<l.length;u+=1)r[u]=ao(to(o,l,u));const m=u=>K(r[u],1,1,()=>{r[u]=null});let c=so(o);return{c(){e=p("div");for(let u=0;u<r.length;u+=1)r[u].c();t=w(),c.c(),a=Le(),d(e,"class","grid svelte-3cpxwu")},m(u,f){x(u,e,f);for(let h=0;h<r.length;h+=1)r[h].m(e,null);x(u,t,f),c.m(u,f),x(u,a,f),i=!0},p(u,f){if(f&7){l=u[2].plots;let h;for(h=0;h<l.length;h+=1){const F=to(u,l,h);r[h]?(r[h].p(F,f),j(r[h],1)):(r[h]=ao(F),r[h].c(),j(r[h],1),r[h].m(e,null))}for(Oe(),h=l.length;h<r.length;h+=1)m(h);Be()}f&8&&Fe(n,n=u[3])?(Oe(),K(c,1,1,J),Be(),c=so(u),c.c(),j(c,1),c.m(a.parentNode,a)):c.p(u,f)},i(u){if(!i){for(let f=0;f<l.length;f+=1)j(r[f]);j(c),i=!0}},o(u){r=r.filter(Boolean);for(let f=0;f<r.length;f+=1)K(r[f]);K(c),i=!1},d(u){u&&b(e),en(r,u),u&&b(t),u&&b(a),c.d(u)}}}function lo(o){let e,t;return e=new Ao({props:{data:o[9],canBeUpgraded:o[0](o[9].x,o[9].y)}}),{c(){qe(e.$$.fragment)},m(n,a){Ee(e,n,a),t=!0},p(n,a){const i={};a&4&&(i.data=n[9]),a&4&&(i.canBeUpgraded=n[0](n[9].x,n[9].y)),e.$set(i)},i(n){t||(j(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){ze(e,n)}}}function ao(o){let e,t,n,a,i,l=o[6],r=[];for(let c=0;c<l.length;c+=1)r[c]=lo(no(o,l,c));const m=c=>K(r[c],1,1,()=>{r[c]=null});return{c(){e=p("div");for(let c=0;c<r.length;c+=1)r[c].c();t=w(),d(e,"class","row svelte-3cpxwu")},m(c,u){x(c,e,u);for(let f=0;f<r.length;f+=1)r[f].m(e,null);s(e,t),n=!0,a||(i=ee(e,"click",o[1]),a=!0)},p(c,u){if(u&5){l=c[6];let f;for(f=0;f<l.length;f+=1){const h=no(c,l,f);r[f]?(r[f].p(h,u),j(r[f],1)):(r[f]=lo(h),r[f].c(),j(r[f],1),r[f].m(e,t))}for(Oe(),f=l.length;f<r.length;f+=1)m(f);Be()}},i(c){if(!n){for(let u=0;u<l.length;u+=1)j(r[u]);n=!0}},o(c){r=r.filter(Boolean);for(let u=0;u<r.length;u+=1)K(r[u]);n=!1},d(c){c&&b(e),en(r,c),a=!1,i()}}}function io(o){let e,t;return e=new il({props:{x:o[4].x,y:o[4].y}}),{c(){qe(e.$$.fragment)},m(n,a){Ee(e,n,a),t=!0},p(n,a){const i={};a&16&&(i.x=n[4].x),a&16&&(i.y=n[4].y),e.$set(i)},i(n){t||(j(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){ze(e,n)}}}function so(o){let e,t,n=o[4].visible&&io(o);return{c(){n&&n.c(),e=Le()},m(a,i){n&&n.m(a,i),x(a,e,i),t=!0},p(a,i){a[4].visible?n?(n.p(a,i),i&16&&j(n,1)):(n=io(a),n.c(),j(n,1),n.m(e.parentNode,e)):n&&(Oe(),K(n,1,1,()=>{n=null}),Be())},i(a){t||(j(n),t=!0)},o(a){K(n),t=!1},d(a){n&&n.d(a),a&&b(e)}}}function sl(o){let e,t,n=o[2]!=null&&oo(o);return{c(){n&&n.c(),e=Le()},m(a,i){n&&n.m(a,i),x(a,e,i),t=!0},p(a,[i]){a[2]!=null?n?(n.p(a,i),i&4&&j(n,1)):(n=oo(a),n.c(),j(n,1),n.m(e.parentNode,e)):n&&(Oe(),K(n,1,1,()=>{n=null}),Be())},i(a){t||(j(n),t=!0)},o(a){K(n),t=!1},d(a){n&&n.d(a),a&&b(e)}}}function rl(o,e,t){let n,a,i;le(o,V,c=>t(2,n=c)),le(o,ht,c=>t(3,a=c)),le(o,ae,c=>t(4,i=c));function l(c,u){let f={x:c,y:u};return f.x===0&&f.y===0?!0:[{x:f.x-1,y:f.y},{x:f.x+1,y:f.y},{x:f.x,y:f.y-1},{x:f.x,y:f.y+1}].some(h=>h.x<0||h.x>=n.plots.length||h.y<0||h.y>=n.plots[h.x].length?!1:n.plots[h.x][h.y].active)}function r(){let c=[];for(let u=0;u<n.plots.length;u++)for(let f=0;f<n.plots.length;f++)l(u,f)&&n.plots[u][f].active==!1&&c.push(n.plots[u][f])}function m(){W(ht,a={},a)}return window.location.search.includes("dev=true")&&(W(V,n.townInfo.name="DevTown",n),W(V,n.townInfo.gold=1e8,n),W(V,n.townInfo.population=0,n),W(V,n.townInfo.happiness=1e5,n),W(V,n.townInfo.health=1e5,n),W(V,n.modifiers.happiness=1e5,n),W(V,n.modifiers.health=1e5,n),W(V,n.townInfo.knowledge_points=1e4,n)),o.$$.update=()=>{o.$$.dirty&4&&n&&r()},[l,m,n,a,i]}class cl extends De{constructor(e){super(),Me(this,e,rl,sl,Fe,{checkIfPlotCanBeUpgraded:0,restartModifyPlotMenu:1})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[0]}get restartModifyPlotMenu(){return this.$$.ctx[1]}}function ro(o,e,t){const n=o.slice();return n[4]=e[t],n}function pl(o){let e,t,n,a,i=o[0].economy_and_laws.balanceSheetHistory,l=[];for(let r=0;r<i.length;r+=1)l[r]=co(ro(o,i,r));return{c(){e=p("table"),t=p("thead"),t.innerHTML=`<tr class="svelte-1m5x2x2"><th>Day</th> 
						<th>Plot</th> 
						<th>Profits</th> 
						<th>Tax rate</th></tr>`,n=w(),a=p("tbody");for(let r=0;r<l.length;r+=1)l[r].c();d(e,"class","svelte-1m5x2x2")},m(r,m){x(r,e,m),s(e,t),s(e,n),s(e,a);for(let c=0;c<l.length;c+=1)l[c].m(a,null)},p(r,m){if(m&3){i=r[0].economy_and_laws.balanceSheetHistory;let c;for(c=0;c<i.length;c+=1){const u=ro(r,i,c);l[c]?l[c].p(u,m):(l[c]=co(u),l[c].c(),l[c].m(a,null))}for(;c<l.length;c+=1)l[c].d(1);l.length=i.length}},d(r){r&&b(e),en(l,r)}}}function ul(o){let e;return{c(){e=p("div"),e.textContent=`No data to display yet. Build some buildings and make sure that the tax
				rate is above 0%.`,d(e,"class","text-center padding-sides")},m(t,n){x(t,e,n)},p:J,d(t){t&&b(e)}}}function co(o){let e,t,n=o[4].day+"",a,i,l,r=o[4].plot+"",m,c,u,f=o[4].profits+"",h,F,y,C=o[4].taxRate+"",z,N,E,P;function T(){return o[2](o[4])}return{c(){e=p("tr"),t=p("td"),a=_(n),i=w(),l=p("th"),m=_(r),c=w(),u=p("td"),h=_(f),F=w(),y=p("td"),z=_(C),N=w(),d(t,"class","svelte-1m5x2x2"),d(l,"class","plot_link svelte-1m5x2x2"),d(u,"class","svelte-1m5x2x2"),d(y,"class","svelte-1m5x2x2"),d(e,"class","svelte-1m5x2x2")},m(M,q){x(M,e,q),s(e,t),s(t,a),s(e,i),s(e,l),s(l,m),s(e,c),s(e,u),s(u,h),s(e,F),s(e,y),s(y,z),s(e,N),E||(P=ee(l,"click",T),E=!0)},p(M,q){o=M,q&1&&n!==(n=o[4].day+"")&&H(a,n),q&1&&r!==(r=o[4].plot+"")&&H(m,r),q&1&&f!==(f=o[4].profits+"")&&H(h,f),q&1&&C!==(C=o[4].taxRate+"")&&H(z,C)},d(M){M&&b(e),E=!1,P()}}}function dl(o){let e,t,n,a,i,l;function r(u,f){return u[0].economy_and_laws.balanceSheetHistory.length==0?ul:pl}let m=r(o),c=m(o);return{c(){e=p("div"),t=p("div"),n=p("div"),n.textContent="Balance Sheet",a=w(),i=p("br"),l=w(),c.c(),d(n,"class","heading_m svelte-1m5x2x2"),d(t,"class","dialog-content svelte-1m5x2x2"),d(e,"class","dialog svelte-1m5x2x2")},m(u,f){x(u,e,f),s(e,t),s(t,n),s(t,a),s(t,i),s(t,l),c.m(t,null)},p(u,[f]){m===(m=r(u))&&c?c.p(u,f):(c.d(1),c=m(u),c&&(c.c(),c.m(t,null)))},i:J,o:J,d(u){u&&b(e),c.d()}}}function fl(o,e,t){let n,a;le(o,ae,l=>t(3,n=l)),le(o,V,l=>t(0,a=l));function i(l){let r=parseInt(l.split(",")[0]),m=parseInt(l.split(",")[1]);W(ae,n.x=r,n),W(ae,n.y=m,n),W(ae,n.visible=!0,n)}return[a,i,l=>{i(l.plot)}]}class Fo extends De{constructor(e){super(),Me(this,e,fl,dl,Fe,{})}}const po={0:"Easy",1:"Normal",2:"Hard"};function uo(o){let e,t,n,a=_e[o[0].endGoal].short_title+"",i,l,r,m,c,u,f,h,F,y,C,z,N,E=o[0].endGoal=="land"&&fo(o);return{c(){e=p("div"),t=p("div"),n=_("HOW TO PLAY ("),i=_(a),l=_(`)
			`),r=p("br"),m=w(),c=p("hr"),u=w(),E&&E.c(),f=w(),h=p("br"),F=w(),y=p("hr"),C=w(),z=p("br"),N=_(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(P,T){x(P,e,T),s(e,t),s(t,n),s(t,i),s(t,l),s(t,r),s(t,m),s(t,c),s(t,u),E&&E.m(t,null),s(t,f),s(t,h),s(t,F),s(t,y),s(t,C),s(t,z),s(t,N)},p(P,T){T&1&&a!==(a=_e[P[0].endGoal].short_title+"")&&H(i,a),P[0].endGoal=="land"?E?E.p(P,T):(E=fo(P),E.c(),E.m(t,f)):E&&(E.d(1),E=null)},d(P){P&&b(e),E&&E.d()}}}function fo(o){let e=_e[o[0].endGoal].description_title+"",t,n,a,i,l,r,m=po[o[0].difficulty]+"",c,u,f,h,F,y,C,z,N=JSON.stringify(_e.land.requirements[o[0].difficulty].population_count)+"",E,P,T,M,q,A,I=JSON.stringify(_e.land.requirements[o[0].difficulty].happiness)+"",g,v,S,Q,$,G,R=JSON.stringify(_e.land.requirements[o[0].difficulty].health)+"",Y,se,L,B,Z,te,ne=JSON.stringify(_e.land.requirements[o[0].difficulty].employment*100)+"",ge,ye;return{c(){t=_(e),n=w(),a=p("br"),i=w(),l=p("br"),r=_(`
				With your difficulty (`),c=_(m),u=_(`), you must
				also have:
				`),f=p("br"),h=w(),F=p("br"),y=w(),C=p("li"),z=_("Population: "),E=_(N),P=w(),T=p("br"),M=w(),q=p("li"),A=_("Happiness: "),g=_(I),v=w(),S=p("br"),Q=w(),$=p("li"),G=_("Health: "),Y=_(R),se=w(),L=p("br"),B=w(),Z=p("li"),te=_("Employment at "),ge=_(ne),ye=_("%")},m(k,D){x(k,t,D),x(k,n,D),x(k,a,D),x(k,i,D),x(k,l,D),x(k,r,D),x(k,c,D),x(k,u,D),x(k,f,D),x(k,h,D),x(k,F,D),x(k,y,D),x(k,C,D),s(C,z),s(C,E),x(k,P,D),x(k,T,D),x(k,M,D),x(k,q,D),s(q,A),s(q,g),x(k,v,D),x(k,S,D),x(k,Q,D),x(k,$,D),s($,G),s($,Y),x(k,se,D),x(k,L,D),x(k,B,D),x(k,Z,D),s(Z,te),s(Z,ge),s(Z,ye)},p(k,D){D&1&&e!==(e=_e[k[0].endGoal].description_title+"")&&H(t,e),D&1&&m!==(m=po[k[0].difficulty]+"")&&H(c,m),D&1&&N!==(N=JSON.stringify(_e.land.requirements[k[0].difficulty].population_count)+"")&&H(E,N),D&1&&I!==(I=JSON.stringify(_e.land.requirements[k[0].difficulty].happiness)+"")&&H(g,I),D&1&&R!==(R=JSON.stringify(_e.land.requirements[k[0].difficulty].health)+"")&&H(Y,R),D&1&&ne!==(ne=JSON.stringify(_e.land.requirements[k[0].difficulty].employment*100)+"")&&H(ge,ne)},d(k){k&&b(t),k&&b(n),k&&b(a),k&&b(i),k&&b(l),k&&b(r),k&&b(c),k&&b(u),k&&b(f),k&&b(h),k&&b(F),k&&b(y),k&&b(C),k&&b(P),k&&b(T),k&&b(M),k&&b(q),k&&b(v),k&&b(S),k&&b(Q),k&&b($),k&&b(se),k&&b(L),k&&b(B),k&&b(Z)}}}function ml(o){let e,t=o[2]&&o[0]!=null&&o[1]&&uo(o);return{c(){t&&t.c(),e=Le()},m(n,a){t&&t.m(n,a),x(n,e,a)},p(n,[a]){n[2]&&n[0]!=null&&n[1]?t?t.p(n,a):(t=uo(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:J,o:J,d(n){t&&t.d(n),n&&b(e)}}}function hl(o,e,t){let n;le(o,V,l=>t(0,n=l));let a=!0,i=!1;return o.$$.update=()=>{o.$$.dirty&1&&(n?t(2,i=!0):t(2,i=!1))},[n,a,i]}class gl extends De{constructor(e){super(),Me(this,e,hl,ml,Fe,{})}}function mo(o){let e,t=o[1].townLog+"",n,a,i;return{c(){e=p("div"),n=_(t),d(e,"class","townLog message")},m(l,r){x(l,e,r),s(e,n),a||(i=ee(e,"click",o[12]),a=!0)},p(l,r){r&2&&t!==(t=l[1].townLog+"")&&H(n,t)},d(l){l&&b(e),a=!1,i()}}}function ho(o){let e,t,n=o[1].townInfo.population_count-o[1].townInfo.employees+"",a,i;return{c(){e=p("span"),t=_("("),a=_(n),i=_(" unemployed)"),d(e,"class","text_ss gray")},m(l,r){x(l,e,r),s(e,t),s(e,a),s(e,i)},p(l,r){r&2&&n!==(n=l[1].townInfo.population_count-l[1].townInfo.employees+"")&&H(a,n)},d(l){l&&b(e)}}}function _l(o){let e,t,n=o[1].economy_and_laws.lastMonthProfit+"",a,i;return{c(){e=p("span"),t=_("("),a=_(n),i=_(")"),d(e,"class","text_s red")},m(l,r){x(l,e,r),s(e,t),s(e,a),s(e,i)},p(l,r){r&2&&n!==(n=l[1].economy_and_laws.lastMonthProfit+"")&&H(a,n)},d(l){l&&b(e)}}}function yl(o){let e,t,n=o[1].economy_and_laws.lastMonthProfit+"",a,i;return{c(){e=p("span"),t=_("(+"),a=_(n),i=_(")"),d(e,"class","text_s green")},m(l,r){x(l,e,r),s(e,t),s(e,a),s(e,i)},p(l,r){r&2&&n!==(n=l[1].economy_and_laws.lastMonthProfit+"")&&H(a,n)},d(l){l&&b(e)}}}function wl(o){let e,t=o[1].townInfo.happiness+"",n;return{c(){e=p("span"),n=_(t),d(e,"class","red")},m(a,i){x(a,e,i),s(e,n)},p(a,i){i&2&&t!==(t=a[1].townInfo.happiness+"")&&H(n,t)},d(a){a&&b(e)}}}function vl(o){let e,t=o[1].townInfo.happiness+"",n;return{c(){e=p("span"),n=_(t),d(e,"class","green")},m(a,i){x(a,e,i),s(e,n)},p(a,i){i&2&&t!==(t=a[1].townInfo.happiness+"")&&H(n,t)},d(a){a&&b(e)}}}function bl(o){let e;return{c(){e=p("span"),e.textContent="\u{1F44E}"},m(t,n){x(t,e,n)},d(t){t&&b(e)}}}function xl(o){let e;return{c(){e=p("span"),e.textContent="\u{1F44D}"},m(t,n){x(t,e,n)},d(t){t&&b(e)}}}function kl(o){let e;return{c(){e=p("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,n){x(t,e,n)},d(t){t&&b(e)}}}function Il(o){let e,t=o[1].townInfo.health+"",n;return{c(){e=p("span"),n=_(t),d(e,"class","red")},m(a,i){x(a,e,i),s(e,n)},p(a,i){i&2&&t!==(t=a[1].townInfo.health+"")&&H(n,t)},d(a){a&&b(e)}}}function $l(o){let e,t=o[1].townInfo.health+"",n;return{c(){e=p("span"),n=_(t),d(e,"class","green")},m(a,i){x(a,e,i),s(e,n)},p(a,i){i&2&&t!==(t=a[1].townInfo.health+"")&&H(n,t)},d(a){a&&b(e)}}}function go(o){let e;return{c(){e=p("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,n){x(t,e,n)},d(t){t&&b(e)}}}function Sl(o){let e;return{c(){e=_("How to play")},m(t,n){x(t,e,n)},d(t){t&&b(e)}}}function Pl(o){let e;return{c(){e=_("Close")},m(t,n){x(t,e,n)},d(t){t&&b(e)}}}function _o(o){let e,t;return e=new gl({}),{c(){qe(e.$$.fragment)},m(n,a){Ee(e,n,a),t=!0},i(n){t||(j(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){ze(e,n)}}}function yo(o){let e,t;return e=new Fo({}),{c(){qe(e.$$.fragment)},m(n,a){Ee(e,n,a),t=!0},i(n){t||(j(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){ze(e,n)}}}function Fl(o){let e,t,n,a=o[1].townInfo.name+"",i,l,r,m,c,u,f,h,F,y,C,z,N,E,P,T,M,q,A,I,g,v=o[1].townInfo.population_count+"",S,Q,$=o[1].townInfo.population_max+"",G,R,Y,se,L,B,Z=o[1].townInfo.employees+"",te,ne,ge=o[1].townInfo.population_count+"",ye,k,D,ke,gt,re,pe,fe,ue,Je=o[1].townInfo.knowledge_points+"",Ve,Ie,He,Xe,$e,oe,U=o[1].townInfo.gold+"",ce,tn,nn,on,ln,Ye,It,an,_t,sn,$t=o[1].townInfo.gold_from_tourism+"",Rt,rn,at,St,cn,Te,Ut,it,pn,Pt=Ae(o[1].modifiers.happiness,2)+"",jt,un,dn,fn,st,Ft,mn,Ge,At,rt,hn,Ct=Ae(o[1].modifiers.health,2)+"",Lt,gn,_n,yn,et,tt,wn,vn,bn,xn,We,Et,kn,Ne,In,Ke,ct,$n,pt,zt=(o[1].economy_and_laws.tax_rate*100).toFixed(0)+"",Xt,Sn,Pn,ut,Vt,yt,wt,de,Wt,Fn,we=o[1].townLog.length>0&&mo(o),ve=o[1].townInfo.population_count-o[1].townInfo.employees>0&&ho(o);function Cn(O,X){if(O[1].economy_and_laws.lastMonthProfit>=0)return yl;if(O[1].economy_and_laws.lastMonthProfit<0)return _l}let dt=Cn(o),be=dt&&dt(o);function En(O,X){return O[1].townInfo.happiness>=50?vl:wl}let Nt=En(o),Re=Nt(o);function zn(O,X){if(O[1].townInfo.happiness>=300)return kl;if(O[1].townInfo.happiness>=150)return xl;if(O[1].townInfo.happiness<150)return bl}let ft=zn(o),Ce=ft&&ft(o);function Nn(O,X){return O[1].townInfo.health>=50?$l:Il}let qt=Nn(o),Ue=qt(o),Se=o[1].townInfo.health>=300&&go();function qn(O,X){return O[5]?Pl:Sl}let Ot=qn(o),Qe=Ot(o),me=o[5]&&_o(),he=o[6]&&yo();return{c(){e=p("div"),t=p("div"),n=p("div"),i=_(a),l=w(),r=p("div"),r.textContent="double click to change name",m=w(),c=p("div"),u=p("span"),u.textContent="\u23EA",f=w(),h=p("span"),h.textContent="\u23E9",F=w(),y=_(o[0]),C=_("x - year "),z=_(o[2]),N=_(" day "),E=_(o[3]),P=w(),we&&we.c(),T=w(),M=p("div"),q=p("div"),A=p("div"),A.textContent="\u{1F46A} Population",I=w(),g=p("div"),S=_(v),Q=_("/"),G=_($),R=w(),Y=p("div"),se=p("div"),se.textContent="\u{1F9D1}\u200D\u{1F33E} Employees",L=w(),B=p("div"),te=_(Z),ne=_("/"),ye=_(ge),k=w(),D=p("br"),ke=w(),ve&&ve.c(),gt=w(),re=p("div"),pe=p("div"),pe.textContent="\u{1F9E0} Knowledge",fe=w(),ue=p("div"),Ve=_(Je),Ie=w(),He=p("div"),Xe=p("div"),Xe.textContent="\u{1F4B0} Gold",$e=w(),oe=p("div"),ce=_(U),tn=w(),nn=p("br"),on=w(),be&&be.c(),ln=w(),Ye=p("div"),It=p("div"),It.textContent="\u{1F4B0} Tourism Gold",an=w(),_t=p("div"),sn=_("$"),Rt=_($t),rn=w(),at=p("div"),St=p("div"),St.textContent="\u{1F601} Happiness",cn=w(),Te=p("div"),Re.c(),Ut=w(),it=p("span"),pn=_("("),jt=_(Pt),un=_(")"),dn=w(),Ce&&Ce.c(),fn=w(),st=p("div"),Ft=p("div"),Ft.textContent="\u{1F3E5} Health",mn=w(),Ge=p("div"),Ue.c(),At=w(),rt=p("span"),hn=_("("),Lt=_(Ct),gn=_(")"),_n=w(),Se&&Se.c(),yn=w(),et=p("div"),tt=p("div"),wn=_("\u{1F3C6} "),Qe.c(),vn=w(),bn=p("br"),xn=w(),We=p("div"),Et=p("div"),Et.textContent="Tax rate (more tax = less happiness)",kn=w(),Ne=p("input"),In=w(),Ke=p("div"),ct=p("button"),ct.textContent="-",$n=w(),pt=p("div"),Xt=_(zt),Sn=_("%"),Pn=w(),ut=p("button"),ut.textContent="+",Vt=w(),me&&me.c(),yt=w(),he&&he.c(),wt=Le(),d(n,"class","heading_l"),d(r,"class","subheading_m svelte-vu26gz"),d(t,"class","header__left svelte-vu26gz"),d(A,"class","subheading_m svelte-vu26gz"),d(g,"class","text_m svelte-vu26gz"),d(q,"class","svelte-vu26gz"),d(se,"class","subheading_m svelte-vu26gz"),d(B,"class","text_m svelte-vu26gz"),d(Y,"class","svelte-vu26gz"),d(pe,"class","subheading_m svelte-vu26gz"),d(ue,"class","text_m svelte-vu26gz"),d(re,"class","svelte-vu26gz"),d(Xe,"class","subheading_m svelte-vu26gz"),d(oe,"class","text_m svelte-vu26gz"),d(He,"class","svelte-vu26gz"),d(It,"class","subheading_m svelte-vu26gz"),d(_t,"class","text_m svelte-vu26gz"),d(Ye,"class","svelte-vu26gz"),d(St,"class","subheading_m svelte-vu26gz"),d(it,"class","text_ss gray"),d(Te,"class","text_m svelte-vu26gz"),d(at,"class","svelte-vu26gz"),d(Ft,"class","subheading_m svelte-vu26gz"),d(rt,"class","text_ss gray"),d(Ge,"class","text_m svelte-vu26gz"),d(st,"class","svelte-vu26gz"),d(M,"class","header__right svelte-vu26gz"),d(tt,"class","text_m pointer"),d(Et,"class","subheading_m svelte-vu26gz"),d(Ne,"type","range"),d(Ne,"min","0"),d(Ne,"max","1"),d(Ne,"step","0.01"),d(pt,"class","text_m"),d(Ke,"class","incrementalButtons svelte-vu26gz"),d(We,"class","taxInfo svelte-vu26gz"),d(e,"class","header noselect svelte-vu26gz")},m(O,X){x(O,e,X),s(e,t),s(t,n),s(n,i),s(t,l),s(t,r),s(t,m),s(t,c),s(c,u),s(c,f),s(c,h),s(c,F),s(c,y),s(c,C),s(c,z),s(c,N),s(c,E),s(t,P),we&&we.m(t,null),s(e,T),s(e,M),s(M,q),s(q,A),s(q,I),s(q,g),s(g,S),s(g,Q),s(g,G),s(M,R),s(M,Y),s(Y,se),s(Y,L),s(Y,B),s(B,te),s(B,ne),s(B,ye),s(B,k),s(B,D),s(B,ke),ve&&ve.m(B,null),s(M,gt),s(M,re),s(re,pe),s(re,fe),s(re,ue),s(ue,Ve),s(M,Ie),s(M,He),s(He,Xe),s(He,$e),s(He,oe),s(oe,ce),s(oe,tn),s(oe,nn),s(oe,on),be&&be.m(oe,null),s(M,ln),s(M,Ye),s(Ye,It),s(Ye,an),s(Ye,_t),s(_t,sn),s(_t,Rt),s(M,rn),s(M,at),s(at,St),s(at,cn),s(at,Te),Re.m(Te,null),s(Te,Ut),s(Te,it),s(it,pn),s(it,jt),s(it,un),s(Te,dn),Ce&&Ce.m(Te,null),s(M,fn),s(M,st),s(st,Ft),s(st,mn),s(st,Ge),Ue.m(Ge,null),s(Ge,At),s(Ge,rt),s(rt,hn),s(rt,Lt),s(rt,gn),s(Ge,_n),Se&&Se.m(Ge,null),s(e,yn),s(e,et),s(et,tt),s(tt,wn),Qe.m(tt,null),s(et,vn),s(et,bn),s(et,xn),s(et,We),s(We,Et),s(We,kn),s(We,Ne),Bn(Ne,o[1].economy_and_laws.tax_rate),s(We,In),s(We,Ke),s(Ke,ct),s(Ke,$n),s(Ke,pt),s(pt,Xt),s(pt,Sn),s(Ke,Pn),s(Ke,ut),x(O,Vt,X),me&&me.m(O,X),x(O,yt,X),he&&he.m(O,X),x(O,wt,X),de=!0,Wt||(Fn=[ee(n,"dblclick",o[7]),ee(u,"click",o[8]),ee(h,"click",o[9]),ee(He,"click",o[13]),ee(Ye,"click",o[14]),ee(tt,"click",o[15]),ee(Ne,"change",o[16]),ee(Ne,"input",o[16]),ee(Ne,"change",o[10]),ee(ct,"mousedown",o[17]),ee(ct,"mouseup",o[18]),ee(ct,"click",o[19]),ee(pt,"dblclick",o[20]),ee(ut,"mousedown",o[21]),ee(ut,"mouseup",o[22]),ee(ut,"click",o[23])],Wt=!0)},p(O,[X]){(!de||X&2)&&a!==(a=O[1].townInfo.name+"")&&H(i,a),(!de||X&1)&&H(y,O[0]),(!de||X&4)&&H(z,O[2]),(!de||X&8)&&H(E,O[3]),O[1].townLog.length>0?we?we.p(O,X):(we=mo(O),we.c(),we.m(t,null)):we&&(we.d(1),we=null),(!de||X&2)&&v!==(v=O[1].townInfo.population_count+"")&&H(S,v),(!de||X&2)&&$!==($=O[1].townInfo.population_max+"")&&H(G,$),(!de||X&2)&&Z!==(Z=O[1].townInfo.employees+"")&&H(te,Z),(!de||X&2)&&ge!==(ge=O[1].townInfo.population_count+"")&&H(ye,ge),O[1].townInfo.population_count-O[1].townInfo.employees>0?ve?ve.p(O,X):(ve=ho(O),ve.c(),ve.m(B,null)):ve&&(ve.d(1),ve=null),(!de||X&2)&&Je!==(Je=O[1].townInfo.knowledge_points+"")&&H(Ve,Je),(!de||X&2)&&U!==(U=O[1].townInfo.gold+"")&&H(ce,U),dt===(dt=Cn(O))&&be?be.p(O,X):(be&&be.d(1),be=dt&&dt(O),be&&(be.c(),be.m(oe,null))),(!de||X&2)&&$t!==($t=O[1].townInfo.gold_from_tourism+"")&&H(Rt,$t),Nt===(Nt=En(O))&&Re?Re.p(O,X):(Re.d(1),Re=Nt(O),Re&&(Re.c(),Re.m(Te,Ut))),(!de||X&2)&&Pt!==(Pt=Ae(O[1].modifiers.happiness,2)+"")&&H(jt,Pt),ft!==(ft=zn(O))&&(Ce&&Ce.d(1),Ce=ft&&ft(O),Ce&&(Ce.c(),Ce.m(Te,null))),qt===(qt=Nn(O))&&Ue?Ue.p(O,X):(Ue.d(1),Ue=qt(O),Ue&&(Ue.c(),Ue.m(Ge,At))),(!de||X&2)&&Ct!==(Ct=Ae(O[1].modifiers.health,2)+"")&&H(Lt,Ct),O[1].townInfo.health>=300?Se||(Se=go(),Se.c(),Se.m(Ge,null)):Se&&(Se.d(1),Se=null),Ot!==(Ot=qn(O))&&(Qe.d(1),Qe=Ot(O),Qe&&(Qe.c(),Qe.m(tt,null))),X&2&&Bn(Ne,O[1].economy_and_laws.tax_rate),(!de||X&2)&&zt!==(zt=(O[1].economy_and_laws.tax_rate*100).toFixed(0)+"")&&H(Xt,zt),O[5]?me?X&32&&j(me,1):(me=_o(),me.c(),j(me,1),me.m(yt.parentNode,yt)):me&&(Oe(),K(me,1,1,()=>{me=null}),Be()),O[6]?he?X&64&&j(he,1):(he=yo(),he.c(),j(he,1),he.m(wt.parentNode,wt)):he&&(Oe(),K(he,1,1,()=>{he=null}),Be())},i(O){de||(j(me),j(he),de=!0)},o(O){K(me),K(he),de=!1},d(O){O&&b(e),we&&we.d(),ve&&ve.d(),be&&be.d(),Re.d(),Ce&&Ce.d(),Ue.d(),Se&&Se.d(),Qe.d(),O&&b(Vt),me&&me.d(O),O&&b(yt),he&&he.d(O),O&&b(wt),Wt=!1,ot(Fn)}}}function Ae(o,e){e===void 0&&(e=0);var t=Math.pow(10,e);o=parseFloat((o*t).toFixed(11));var n=Math.round(o)/t;return+n.toFixed(e)}function Cl(o,e,t){let n,a,i;le(o,V,$=>t(1,n=$)),le(o,Ht,$=>t(25,a=$)),le(o,Yt,$=>t(6,i=$));let l=Math.floor(n.environment.day/365)+1,r=n.environment.day%365;function m(){let $=prompt("Enter a new name for your town (under 200 chars)");if($&&$.length<200){let G=n;G.townInfo.name=$,V.set(G),localStorage.setItem(xe,JSON.stringify(G))}}let{speedMultiplier:c=1}=e;function u(){let $=a;$=$*2,$>=8e3&&($=8e3),W(Ht,a=$,a),t(0,c=2e3/a)}function f(){let $=a;$=$/2,$<=250&&($=250),W(Ht,a=$,a),t(0,c=2e3/a)}function h($){let G=n;G.economy_and_laws.tax_rate=Ae($.target.value,2),V.set(G),localStorage.setItem(xe,JSON.stringify(G))}function F(){n.hasCityHall}function y(){let $=n;$.hasABank===!0?($.townInfo.gold+=$.townInfo.gold_from_tourism,$.townInfo.gold_from_tourism=0,V.set($),localStorage.setItem(xe,JSON.stringify($))):alert("You need a bank to transfer funds from tourism activities.")}document.addEventListener("keydown",$=>{switch($.key.toLowerCase()){case"1":$.preventDefault(),u();break;case"2":$.preventDefault(),f();break}}),document.addEventListener("click",()=>{F()});let C;F();let z=!1;const N=()=>{W(V,n.townLog="",n)},E=()=>{let $=i;$=!$,Yt.set($)},P=()=>{y()},T=()=>t(5,z=!z);function M(){n.economy_and_laws.tax_rate=No(this.value),V.set(n)}const q=()=>{t(4,C=setInterval(()=>{let $=n;$.economy_and_laws.tax_rate=Ae($.economy_and_laws.tax_rate-.01,2),V.set($),localStorage.setItem(xe,JSON.stringify($))},100))},A=()=>{clearInterval(C)},I=()=>{let $=n;$.economy_and_laws.tax_rate=Ae($.economy_and_laws.tax_rate-.01,2)},g=()=>{let $=parseFloat(prompt("Set a new tax rate (0-1)"));if($&&$>=0&&$<=1){let G=n;G.economy_and_laws.tax_rate=Ae($,2),V.set(G),localStorage.setItem(xe,JSON.stringify(G))}},v=()=>{t(4,C=setInterval(()=>{let $=n;$.economy_and_laws.tax_rate=Ae($.economy_and_laws.tax_rate+.01,2),V.set($),localStorage.setItem(xe,JSON.stringify($))},100))},S=()=>{clearInterval(C)},Q=()=>{let $=n;$.economy_and_laws.tax_rate=Ae($.economy_and_laws.tax_rate+.01,2),V.set($),localStorage.setItem(xe,JSON.stringify($))};return o.$$set=$=>{"speedMultiplier"in $&&t(0,c=$.speedMultiplier)},o.$$.update=()=>{o.$$.dirty&2&&(t(2,l=Math.floor(n.environment.day/365)+1),t(3,r=n.environment.day%365))},[c,n,l,r,C,z,i,m,u,f,h,y,N,E,P,T,M,q,A,I,g,v,S,Q]}class El extends De{constructor(e){super(),Me(this,e,Cl,Fl,Fe,{speedMultiplier:0})}}function zl(o){let e;return{c(){e=p("div"),e.innerHTML=`<div class="dialog-content svelte-2ih7px">The game is paused.
		<br/>
		Unpause the game by pressing P
		<br/> 
		<br/>
		Reset the game by pressing SHIFT+ESC</div>`,d(e,"class","dialog svelte-2ih7px")},m(t,n){x(t,e,n)},p:J,i:J,o:J,d(t){t&&b(e)}}}class Nl extends De{constructor(e){super(),Me(this,e,null,zl,Fe,{})}}function wo(o){let e,t,n,a,i,l=o[0].endGameDetails.msg+"",r,m,c,u,f,h;return{c(){e=p("div"),t=p("div"),n=_(`GAME OVER
			`),a=p("br"),i=w(),r=_(l),m=w(),c=p("br"),u=w(),f=p("br"),h=_(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(F,y){x(F,e,y),s(e,t),s(t,n),s(t,a),s(t,i),s(t,r),s(t,m),s(t,c),s(t,u),s(t,f),s(t,h)},p(F,y){y&1&&l!==(l=F[0].endGameDetails.msg+"")&&H(r,l)},d(F){F&&b(e)}}}function ql(o){let e,t=o[0].endGameDetails!=null&&wo(o);return{c(){t&&t.c(),e=Le()},m(n,a){t&&t.m(n,a),x(n,e,a)},p(n,[a]){n[0].endGameDetails!=null?t?t.p(n,a):(t=wo(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:J,o:J,d(n){t&&t.d(n),n&&b(e)}}}function Ol(o,e,t){let n;return le(o,V,a=>t(0,n=a)),[n]}class Bl extends De{constructor(e){super(),Me(this,e,Ol,ql,Fe,{})}}function Ml(o){let e,t,n,a,i,l,r,m,c,u,f,h,F,y,C,z,N,E,P,T,M;return{c(){e=p("div"),t=p("div"),n=_(`Welcome to Plots!
		`),a=p("br"),i=_(`
		Select a difficulty
		`),l=p("select"),r=p("option"),r.textContent="Easy (quick game)",m=p("option"),m.textContent="Normal (longer game)",c=p("option"),c.textContent="Hard (longest game)",u=w(),f=p("br"),h=_(`
		Select a goal
		`),F=p("select"),y=p("option"),y.textContent="Fill up the grid",C=p("option"),C.textContent="Rule the world through politics",z=w(),N=p("br"),E=w(),P=p("button"),P.textContent="Start game",r.__value="0",r.value=r.__value,m.__value="1",m.value=m.__value,m.selected=!0,c.__value="2",c.value=c.__value,d(l,"id","difficulty"),y.__value="land",y.value=y.__value,y.selected=!0,C.__value="political",C.value=C.__value,d(F,"id","endGoal"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(q,A){x(q,e,A),s(e,t),s(t,n),s(t,a),s(t,i),s(t,l),s(l,r),s(l,m),s(l,c),s(t,u),s(t,f),s(t,h),s(t,F),s(F,y),s(F,C),s(t,z),s(t,N),s(t,E),s(t,P),T||(M=ee(P,"click",o[0]),T=!0)},p:J,i:J,o:J,d(q){q&&b(e),T=!1,M()}}}function Dl(o){function e(){const t=document.getElementById("difficulty").value,n=document.getElementById("endGoal").value;Ro(t,n)}return[e]}class Hl extends De{constructor(e){super(),Me(this,e,Dl,Ml,Fe,{})}}function vo(o){let e,t,n,a;const i=[Gl,Tl],l=[];function r(m,c){return m[0]==null?0:1}return e=r(o),t=l[e]=i[e](o),{c(){t.c(),n=Le()},m(m,c){l[e].m(m,c),x(m,n,c),a=!0},p(m,c){let u=e;e=r(m),e===u?l[e].p(m,c):(Oe(),K(l[u],1,1,()=>{l[u]=null}),Be(),t=l[e],t?t.p(m,c):(t=l[e]=i[e](m),t.c()),j(t,1),t.m(n.parentNode,n))},i(m){a||(j(t),a=!0)},o(m){K(t),a=!1},d(m){l[e].d(m),m&&b(n)}}}function Tl(o){let e,t,n,a,i,l,r,m,c,u,f,h,F,y,C,z,N=o[2]==!0&&bo(),E=o[3]==!0&&xo();return n=new El({}),i=new Xo({}),r=new Bl({}),u=new cl({}),{c(){N&&N.c(),e=w(),E&&E.c(),t=w(),qe(n.$$.fragment),a=w(),qe(i.$$.fragment),l=w(),qe(r.$$.fragment),m=w(),c=p("div"),qe(u.$$.fragment),f=w(),h=p("br"),F=_(`
			outside of city`),y=w(),C=p("style"),C.textContent=`.plot_grid {
				max-width: 300%;
				max-height: 300%;
				overflow-x: scroll;
				overflow-y: scroll;
				width: 300%;
				height: 300vh;
				margin-top: 175px;
			}
			.plot_grid[data-marginRight='true'] {
				/* This is for when the balanceSheet is being shown. */
				margin-right: 224px;
			}`,d(c,"class","plot_grid"),d(c,"data-marginright",o[3])},m(P,T){N&&N.m(P,T),x(P,e,T),E&&E.m(P,T),x(P,t,T),Ee(n,P,T),x(P,a,T),Ee(i,P,T),x(P,l,T),Ee(r,P,T),x(P,m,T),x(P,c,T),Ee(u,c,null),s(c,f),s(c,h),s(c,F),x(P,y,T),x(P,C,T),z=!0},p(P,T){P[2]==!0?N?T&4&&j(N,1):(N=bo(),N.c(),j(N,1),N.m(e.parentNode,e)):N&&(Oe(),K(N,1,1,()=>{N=null}),Be()),P[3]==!0?E?T&8&&j(E,1):(E=xo(),E.c(),j(E,1),E.m(t.parentNode,t)):E&&(Oe(),K(E,1,1,()=>{E=null}),Be()),(!z||T&8)&&d(c,"data-marginright",P[3])},i(P){z||(j(N),j(E),j(n.$$.fragment,P),j(i.$$.fragment,P),j(r.$$.fragment,P),j(u.$$.fragment,P),z=!0)},o(P){K(N),K(E),K(n.$$.fragment,P),K(i.$$.fragment,P),K(r.$$.fragment,P),K(u.$$.fragment,P),z=!1},d(P){N&&N.d(P),P&&b(e),E&&E.d(P),P&&b(t),ze(n,P),P&&b(a),ze(i,P),P&&b(l),ze(r,P),P&&b(m),P&&b(c),ze(u),P&&b(y),P&&b(C)}}}function Gl(o){let e,t;return e=new Hl({}),{c(){qe(e.$$.fragment)},m(n,a){Ee(e,n,a),t=!0},p:J,i(n){t||(j(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){ze(e,n)}}}function bo(o){let e,t;return e=new Nl({}),{c(){qe(e.$$.fragment)},m(n,a){Ee(e,n,a),t=!0},i(n){t||(j(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){ze(e,n)}}}function xo(o){let e,t;return e=new Fo({}),{c(){qe(e.$$.fragment)},m(n,a){Ee(e,n,a),t=!0},i(n){t||(j(e.$$.fragment,n),t=!0)},o(n){K(e.$$.fragment,n),t=!1},d(n){ze(e,n)}}}function Rl(o){let e,t,n=(o[1]||o[0]==null)&&vo(o);return{c(){n&&n.c(),e=Le()},m(a,i){n&&n.m(a,i),x(a,e,i),t=!0},p(a,[i]){a[1]||a[0]==null?n?(n.p(a,i),i&3&&j(n,1)):(n=vo(a),n.c(),j(n,1),n.m(e.parentNode,e)):n&&(Oe(),K(n,1,1,()=>{n=null}),Be())},i(a){t||(j(n),t=!0)},o(a){K(n),t=!1},d(a){n&&n.d(a),a&&b(e)}}}function Ul(o,e,t){let n,a,i,l,r;le(o,ht,h=>t(6,n=h)),le(o,ae,h=>t(7,a=h)),le(o,xt,h=>t(2,i=h)),le(o,V,h=>t(0,l=h)),le(o,Yt,h=>t(3,r=h));let m=!1,c=!1;document.addEventListener("keydown",h=>{if(!((document.activeElement.nodeName==="INPUT"||document.activeElement.nodeName=="TEXTAREA")&&h.key!=="Escape"))switch(h.key.toLowerCase()){case"p":i==!0?xt.set(!1):(xt.set(!0),W(ae,a.visible=!1,a));break;case"escape":h.shiftKey?(localStorage.setItem("reset","true"),location.reload(),Po()):a.visible==!0&&W(ae,a.visible=!1,a);break;case"arrowleft":case"a":h.preventDefault(),u(0,-1,"up");break;case"arrowright":case"d":h.preventDefault(),u(0,1,"down");break;case"arrowup":case"w":h.preventDefault(),u(-1,0,"left");break;case"arrowdown":case"s":h.preventDefault(),u(1,0,"right");break}});function u(h,F,y){if(a.visible===!1&&a.x===0&&a.y===0)f(0,0,y);else{let C=a.x,z=a.y;C+h<0?C=0:C+h>l.plots.length?C=l.plots.length:C+=h,z+F<0?z=0:z+F>l.plots.length?z=l.plots.length:z+=F,f(C,z,y)}}function f(h,F,y){if(c==!0)switch(y){case"up":F-=2;break;case"down":F+=1;break;case"left":h-=2;break;case"right":h+=1;break}h<0?h=0:h>l.plots.length&&(h=l.plots.length),F<0?F=0:F>l.plots.length&&(F=l.plots.length);let C=document.querySelectorAll(".plot_container"),z;if(C.forEach(N=>{N.dataset.x==h&&N.dataset.y==F&&(z=N)}),i==!1){if(z.dataset.canBeUpgraded==="true"?W(ae,a.visible=!0,a):W(ae,a.visible=!1,a),z.dataset.refPlotX!==void 0&&z.dataset.refPlotY!=""?(c=!0,C.forEach(N=>{N.dataset.x==z.dataset.refPlotX&&N.dataset.y==z.dataset.refPlotY&&(z=N,h=parseInt(z.dataset.x),F=parseInt(z.dataset.y))})):c=!1,z.dataset.size!=="1"&&z.dataset.size!==void 0&&(c=!0),W(ae,a.x=h,a),W(ae,a.y=F,a),C.forEach(N=>{N.classList.remove("selected"),N.style.border="none",N.style.fontWeight=""}),z.classList.add("selected"),c){let N="4px solid #00800045";z.classList.remove("selected"),z.style.borderTop=N,z.style.borderLeft=N,z.style.fontWeight="600",C.forEach(E=>{E.dataset.x==h+1&&E.dataset.y==F&&(E.style.borderLeft=N,E.style.borderBottom=N),E.dataset.x==h&&E.dataset.y==F+1&&(E.style.borderTop=N,E.style.borderRight=N),E.dataset.x==h+1&&E.dataset.y==F+1&&(E.style.borderBottom=N,E.style.borderRight=N)})}z.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),W(ht,n={},n)}}return o.$$.update=()=>{o.$$.dirty&1&&(l?t(1,m=!0):t(1,m=!1))},[l,m,i,r,f]}class jl extends De{constructor(e){super(),Me(this,e,Ul,Rl,Fe,{openPlotMenu:4})}get openPlotMenu(){return this.$$.ctx[4]}}new jl({target:document.getElementById("app")});
