var El=Object.defineProperty;var Tl=(n,e,t)=>e in n?El(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Zt=(n,e,t)=>(Tl(n,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}})();function Q(){}function $l(n){return n()}function Dn(){return Object.create(null)}function Ve(n){n.forEach($l)}function Pl(n){return typeof n=="function"}function Ae(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function Bl(n){return Object.keys(n).length===0}function Gl(n,...e){if(n==null){for(const l of e)l(void 0);return Q}const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function ne(n,e,t){n.$$.on_destroy.push(Gl(e,t))}function Y(n,e,t){return n.set(t),e}function i(n,e){n.appendChild(e)}function k(n,e,t){n.insertBefore(e,t||null)}function w(n){n.parentNode&&n.parentNode.removeChild(n)}function sn(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function p(n){return document.createElement(n)}function b(n){return document.createTextNode(n)}function y(){return b(" ")}function xe(){return b("")}function Z(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function d(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Fl(n){return n===""?null:+n}function Rl(n){return Array.from(n.childNodes)}function G(n,e){e=""+e,n.data!==e&&(n.data=e)}function ot(n,e){n.value=e??""}let At;function qt(n){At=n}function Dl(){if(!At)throw new Error("Function called outside component initialization");return At}function Ut(n){Dl().$$.on_mount.push(n)}const vt=[],zt=[];let wt=[];const Un=[],Ol=Promise.resolve();let en=!1;function Cl(){en||(en=!0,Ol.then(Ml))}function Ul(){return Cl(),Ol}function tn(n){wt.push(n)}const xt=new Set;let ht=0;function Ml(){if(ht!==0)return;const n=At;do{try{for(;ht<vt.length;){const e=vt[ht];ht++,qt(e),Jl(e.$$)}}catch(e){throw vt.length=0,ht=0,e}for(qt(null),vt.length=0,ht=0;zt.length;)zt.pop()();for(let e=0;e<wt.length;e+=1){const t=wt[e];xt.has(t)||(xt.add(t),t())}wt.length=0}while(vt.length);for(;Un.length;)Un.pop()();en=!1,xt.clear(),qt(n)}function Jl(n){if(n.fragment!==null){n.update(),Ve(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(tn)}}function Hl(n){const e=[],t=[];wt.forEach(l=>n.indexOf(l)===-1?e.push(l):t.push(l)),t.forEach(l=>l()),wt=e}const Rt=new Set;let it;function Ne(){it={r:0,c:[],p:it}}function Ee(){it.r||Ve(it.c),it=it.p}function R(n,e){n&&n.i&&(Rt.delete(n),n.i(e))}function W(n,e,t,l){if(n&&n.o){if(Rt.has(n))return;Rt.add(n),it.c.push(()=>{Rt.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function Ze(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function jl(n,e){n.d(1),e.delete(n.key)}function Vl(n,e,t,l,o,a,s,f,h,u,c,m){let g=n.length,I=a.length,v=g;const C={};for(;v--;)C[n[v].key]=v;const O=[],M=new Map,P=new Map,$=[];for(v=I;v--;){const _=m(o,a,v),L=t(_);let q=s.get(L);q?l&&$.push(()=>q.p(_,e)):(q=u(L,_),q.c()),M.set(L,O[v]=q),L in C&&P.set(L,Math.abs(v-C[L]))}const E=new Set,T=new Set;function r(_){R(_,1),_.m(f,c),s.set(_.key,_),c=_.first,I--}for(;g&&I;){const _=O[I-1],L=n[g-1],q=_.key,A=L.key;_===L?(c=_.first,g--,I--):M.has(A)?!s.has(q)||E.has(q)?r(_):T.has(A)?g--:P.get(q)>P.get(A)?(T.add(q),r(_)):(E.add(A),g--):(h(L,s),g--)}for(;g--;){const _=n[g];M.has(_.key)||h(_,s)}for(;I;)r(O[I-1]);return Ve($),O}function Me(n){n&&n.c()}function Pe(n,e,t){const{fragment:l,after_update:o}=n.$$;l&&l.m(e,t),tn(()=>{const a=n.$$.on_mount.map($l).filter(Pl);n.$$.on_destroy?n.$$.on_destroy.push(...a):Ve(a),n.$$.on_mount=[]}),o.forEach(tn)}function Oe(n,e){const t=n.$$;t.fragment!==null&&(Hl(t.after_update),Ve(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Yl(n,e){n.$$.dirty[0]===-1&&(vt.push(n),Cl(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Te(n,e,t,l,o,a,s=null,f=[-1]){const h=At;qt(n);const u=n.$$={fragment:null,ctx:[],props:a,update:Q,not_equal:o,bound:Dn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(h?h.$$.context:[])),callbacks:Dn(),dirty:f,skip_bound:!1,root:e.target||h.$$.root};s&&s(u.root);let c=!1;if(u.ctx=t?t(n,e.props||{},(m,g,...I)=>{const v=I.length?I[0]:g;return u.ctx&&o(u.ctx[m],u.ctx[m]=v)&&(!u.skip_bound&&u.bound[m]&&u.bound[m](v),c&&Yl(n,m)),g}):[],u.update(),c=!0,Ve(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const m=Rl(e.target);u.fragment&&u.fragment.l(m),m.forEach(w)}else u.fragment&&u.fragment.c();e.intro&&R(n.$$.fragment),Pe(n,e.target,e.anchor),Ml()}qt(h)}class Be{constructor(){Zt(this,"$$");Zt(this,"$$set")}$destroy(){Oe(this,1),this.$destroy=Q}$on(e,t){if(!Pl(t))return Q;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const o=l.indexOf(t);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!Bl(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Wl="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Wl);const gt=[];function st(n,e=Q){let t;const l=new Set;function o(f){if(Ae(n,f)&&(n=f,t)){const h=!gt.length;for(const u of l)u[1](),gt.push(u,n);if(h){for(let u=0;u<gt.length;u+=2)gt[u][0](gt[u+1]);gt.length=0}}}function a(f){o(f(n))}function s(f,h=Q){const u=[f,h];return l.add(u),l.size===1&&(t=e(o,a)||Q),f(n),()=>{l.delete(u),l.size===0&&t&&(t(),t=null)}}return{set:o,update:a,subscribe:s}}const Kl={plots:[],lastChangeDay:0,townLog:"",townInfo:{name:"Your town",gold:1e3,gold_from_tourism:0,population_count:0,population_max:0,employees:0,happiness:100,health:100,knowledge_points:0},hasCityHall:!1,hasBank:!1,modifiers:{happiness:1,health:1},economyAndLaws:{tax_rate:0,max_tax_rate:1,balance_sheet_history:[],last_month_profit:0},plotCounts:[],environment:{day:0,year:1,climate:-1},difficulty:0,endGoal:"land",endGameDetails:null,tick:0},Ie="plots_active_game_db";let j=st(JSON.parse(localStorage.getItem(Ie)||"null"));function Xl(n,e){let t={...Kl};t.economyAndLaws.max_tax_rate=Math.random()*(.5-.2)+.2,t.endGoal=e;let l=[];const o=n=="0"?6:n=="1"?Math.floor(Math.random()*4)+7:n=="2"?Math.floor(Math.random()*9)+12:35;for(let a=0;a<o;a++){l.push([]);for(let s=0;s<o;s++)l[a][s]={id:Math.random().toString(36).substring(2,9),active:!1,x:a,y:s,type:-1}}t.plots=l,localStorage.reset=!1,localStorage.setItem(Ie,JSON.stringify(t)),j.set(t),location.reload()}function an(n=null){localStorage.removeItem(Ie),j.set(null),n&&(localStorage.setItem(Ie,JSON.stringify(n)),j.set(n)),location.reload()}let ie=st({visible:!1,x:0,y:0}),kt=st({}),yt=st(!1),nn=st(!1),Dt=st(2e3);st(localStorage.getItem("showUnaffordablePlotOptions")==="true");const ae=[{id:"res_small",title:"ðŸ  Residential (small)",subtitle:"for living",type:"residential",description:"A few basic homes that can hold 16 people.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:16},styling:"background-color: #e15f00"},{id:"res_medium",title:"ðŸ˜ï¸ Residential (medium)",subtitle:"for living",type:"residential",description:"A few high-density buildings that can hold 64 people.",revenue_per_week:0,requirements:{gold:500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:64},styling:"background-color: #e15f00"},{id:"res_large",title:"ðŸ¢ Residential (large)",subtitle:"for living",type:"residential",description:"Many high-density buildings that can hold 256 people.",revenue_per_week:0,requirements:{gold:1500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:256},styling:"background-color: #e15f00"},{id:"cafe",title:"â˜•ï¸ Small cafÃ©",subtitle:"for recreation & food",type:"food",description:"Great for eating & relaxing, not great for long-term health.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:16,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:.95},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #d24646;"},{id:"carrot_farm",title:"ðŸ¥• Carrot farm",subtitle:"for farming",type:"farm",description:"Farm for making carrots, makes money by selling them.",revenue_per_week:6,requirements:{gold:25,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"apple_orchard",title:"ðŸŽ Apple orchard",subtitle:"for farming",type:"farm",description:"A bunch of trees that make apples, makes money by selling them and by selling apple-related products.",revenue_per_week:8,requirements:{gold:50,plots:[],employees:4,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"bakery",title:"ðŸ¥– Bakery",subtitle:"for baking",type:"farm",description:"Makes money by selling bread.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:3,climate:null,knowledge:0},effect_modifiers:{happiness:1.11,health:.92},immediate_variable_changes:{happiness:25,health:0,population:0},styling:"background-color: #008000;"},{id:"grocery",title:"ðŸª Grocery store",subtitle:"for living",type:"food",description:"People get hungry. This is where they go to get food.",revenue_per_week:40,requirements:{gold:320,plots:[],employees:24,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"fishery",title:"ðŸ  Fishery",subtitle:"for fishing",type:"food",description:"Carve out some land, pour some water, and fish for fun & food.",revenue_per_week:25,requirements:{gold:400,plots:[],employees:9,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"library",title:"ðŸ“• Library",subtitle:"for reading",type:"recreation",description:"Reading makes people very happy, but doesn't make money.",revenue_per_week:0,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:1},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #4169e1;"},{id:"pub",title:"ðŸ» Pub",subtitle:"for hanging",type:"recreation",description:"Makes money, and somehow generates communal knowledge.",revenue_per_week:50,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:.7},immediate_variable_changes:{happiness:10,health:-25,population:0},styling:"background-color: #4169e1;"},{id:"church",title:"â›ªï¸ Church",subtitle:"for worship & community",type:"recreation",description:"This can make some people happy, but doesn't make money.",revenue_per_week:0,requirements:{gold:100,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"stables",title:"ðŸ´ Stables",subtitle:"for friends",type:"recreation",description:"People love horses. This makes them happy, and can generate some money through lessons.",revenue_per_week:10,requirements:{gold:220,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"blacksmith",title:"âš”ï¸ Blacksmith",subtitle:"for making shiny things",type:"shop",description:"Sometimes problems can only be dealt with by a hunk of metal. Makes money by selling weapons, tools, & armor.",revenue_per_week:50,requirements:{gold:1300,plots:[],employees:13,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1.5},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"inn",title:"ðŸ›Œ Village Inn",subtitle:"for a night out",type:"tourism",description:"Generates tourism gold that can be used if you have a bank.",revenue_per_week:0,enables_tourism:!0,tourism_revenue_per_week:15,requirements:{gold:1500,plots:[],employees:14,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"park_small",title:"ðŸŒ² Small park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"A few benches and a small grassy area.",revenue_per_week:0,requirements:{gold:80,plots:[],employees:1,climate:null,knowledge:0},effect_modifiers:{happiness:1.01,health:1.07},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_medium",title:"ðŸ› Medium park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Benches, grass, and a couple of swing-sets.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.02,health:1.15},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_large",title:"ðŸŽª Large park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Same as the medium park, with a nice fountain in the middle and occasional events run by the employees.",revenue_per_week:0,requirements:{gold:300,plots:[],employees:4,climate:null,size:2,knowledge:0},effect_modifiers:{happiness:1.09,health:1.25},immediate_variable_changes:{happiness:30,health:0,population:0},styling:"background-color: #ffff00;"},{id:"school_small",title:"ðŸ“š Small school",subtitle:"for learning",type:"education",description:"A place where children can learn and grow, and where adults can learn new skills. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:2,requirements:{gold:850,plots:[],employees:20,climate:null,size:1,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:15,health:3,population:0},styling:"background-color: #4caf50;"},{id:"school_large",title:"ðŸšŒ Large school",subtitle:"for learning",type:"education",description:"A larger school. Produces knowledge",revenue_per_week:0,knowledge_points_per_month:8,requirements:{gold:1300,plots:[],employees:40,climate:null,size:2,knowledge:10},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:5,health:3,population:0},styling:"background-color: #4caf50;"},{id:"university",title:"ðŸ« University",subtitle:"for learning",type:"education",description:"The supreme learning institution. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:25,requirements:{gold:3500,plots:[],employees:64,climate:null,size:2,knowledge:100},effect_modifiers:{happiness:1.25,health:1},immediate_variable_changes:{happiness:25,health:25,population:0},styling:"background-color: #4caf50;"},{id:"small_hospital",title:"ðŸš‘ Small hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from minor injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:800,plots:[],employees:8,climate:null,size:1,knowledge:50},effect_modifiers:{happiness:1.25,health:1.5},immediate_variable_changes:{happiness:5,health:50,population:0},styling:"background-color: #ff0000;"},{id:"large_hospital",title:"ðŸ¥ Large hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from all injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:4e3,plots:[],employees:64,climate:null,size:1,knowledge:200},effect_modifiers:{happiness:1.25,health:2.5},immediate_variable_changes:{happiness:5,health:75,population:0},styling:"background-color: #ff0000;"},{id:"bank",title:"ðŸ¦ Bank",subtitle:"for storing and accessing funds",type:"bank",description:"Rich get richer.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:64,climate:null,size:1,knowledge:300},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"},{id:"city-hall",title:"ðŸ—³ï¸ City Hall",subtitle:"for bureaucracy",type:"federal",description:"For running the government.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:24,climate:null,size:1,knowledge:500},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"}];function Jn(n,e,t){const l=n.slice();return l[21]=e[t],l}function Hn(n){let e,t;return{c(){e=p("div"),t=b(n[0]),d(e,"class","message")},m(l,o){k(l,e,o),i(e,t)},p(l,o){o&1&&G(t,l[0])},d(l){l&&w(e)}}}function jn(n){let e,t,l;return{c(){e=p("button"),e.textContent="ðŸ”¥",d(e,"id","bulldoze"),d(e,"class","svelte-140pktt")},m(o,a){k(o,e,a),t||(l=Z(e,"click",n[11]),t=!0)},p:Q,d(o){o&&w(e),t=!1,l()}}}function Vn(n){let e,t,l,o;return{c(){e=p("span"),t=b("("),l=b(n[8]),o=b(")"),d(e,"class","text_s")},m(a,s){k(a,e,s),i(e,t),i(e,l),i(e,o)},p(a,s){s&256&&G(l,a[8])},d(a){a&&w(e)}}}function Yn(n){let e;return{c(){e=p("span"),e.textContent="(0)",d(e,"class","text_s")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Wn(n){let e,t,l,o,a,s,f=n[21].revenue_per_week>0&&Kn(n),h=n[21].tourism_revenue_per_week>0&&Xn(n);return{c(){e=p("div"),t=p("span"),t.textContent="Profits",l=y(),o=p("br"),a=y(),f&&f.c(),s=y(),h&&h.c(),d(t,"class","subheading_m"),d(e,"class","profits svelte-140pktt")},m(u,c){k(u,e,c),i(e,t),i(e,l),i(e,o),i(e,a),f&&f.m(e,null),i(e,s),h&&h.m(e,null)},p(u,c){u[21].revenue_per_week>0?f?f.p(u,c):(f=Kn(u),f.c(),f.m(e,s)):f&&(f.d(1),f=null),u[21].tourism_revenue_per_week>0?h?h.p(u,c):(h=Xn(u),h.c(),h.m(e,null)):h&&(h.d(1),h=null)},d(u){u&&w(e),f&&f.d(),h&&h.d()}}}function Kn(n){let e,t,l=n[21].revenue_per_week+"",o,a,s=Je(n[6].economyAndLaws.tax_rate*n[21].revenue_per_week,2)+"",f,h,u,c;return{c(){e=p("span"),t=p("span"),o=b(l),a=y(),f=b(s),h=b(" gold (with tax rate)"),u=y(),c=p("br"),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(m,g){k(m,e,g),i(e,t),i(t,o),i(e,a),i(e,f),i(e,h),k(m,u,g),k(m,c,g)},p(m,g){g&32&&l!==(l=m[21].revenue_per_week+"")&&G(o,l),g&96&&s!==(s=Je(m[6].economyAndLaws.tax_rate*m[21].revenue_per_week,2)+"")&&G(f,s)},d(m){m&&(w(e),w(u),w(c))}}}function Xn(n){let e,t,l=n[21].tourism_revenue_per_week+"",o,a,s=Je(n[6].economyAndLaws.tax_rate*n[21].tourism_revenue_per_week*n[6].townInfo.population_count,2)+"",f,h,u,c=n[6].hasABank!==!0&&Qn();return{c(){e=p("span"),t=p("span"),o=b(l),a=y(),f=b(s),h=b(` tourism gold (
											`),c&&c.c(),u=b(`

											)`),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(m,g){k(m,e,g),i(e,t),i(t,o),i(e,a),i(e,f),i(e,h),c&&c.m(e,null),i(e,u)},p(m,g){g&32&&l!==(l=m[21].tourism_revenue_per_week+"")&&G(o,l),g&96&&s!==(s=Je(m[6].economyAndLaws.tax_rate*m[21].tourism_revenue_per_week*m[6].townInfo.population_count,2)+"")&&G(f,s),m[6].hasABank!==!0?c||(c=Qn(),c.c(),c.m(e,u)):c&&(c.d(1),c=null)},d(m){m&&w(e),c&&c.d()}}}function Qn(n){let e;return{c(){e=b("get a bank to cash out")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Zn(n){let e,t;function l(s,f){return s[6].townInfo.gold<s[21].requirements.gold?Zl:Ql}let o=l(n),a=o(n);return{c(){a.c(),e=y(),t=p("br")},m(s,f){a.m(s,f),k(s,e,f),k(s,t,f)},p(s,f){o===(o=l(s))&&a?a.p(s,f):(a.d(1),a=o(s),a&&(a.c(),a.m(e.parentNode,e)))},d(s){s&&(w(e),w(t)),a.d(s)}}}function Ql(n){let e,t=n[21].requirements.gold+"",l,o;return{c(){e=p("span"),l=b(t),o=b(" gold"),d(e,"class","text_s cost_label svelte-140pktt")},m(a,s){k(a,e,s),i(e,l),i(e,o)},p(a,s){s&32&&t!==(t=a[21].requirements.gold+"")&&G(l,t)},d(a){a&&w(e)}}}function Zl(n){let e,t=n[21].requirements.gold+"",l,o;return{c(){e=p("span"),l=b(t),o=b(" gold"),d(e,"class","red text_s cost_label svelte-140pktt")},m(a,s){k(a,e,s),i(e,l),i(e,o)},p(a,s){s&32&&t!==(t=a[21].requirements.gold+"")&&G(l,t)},d(a){a&&w(e)}}}function xn(n){let e,t;function l(s,f){return s[6].townInfo.population_count-s[6].townInfo.employees<s[21].requirements.employees?zl:xl}let o=l(n),a=o(n);return{c(){a.c(),e=y(),t=p("br")},m(s,f){a.m(s,f),k(s,e,f),k(s,t,f)},p(s,f){o===(o=l(s))&&a?a.p(s,f):(a.d(1),a=o(s),a&&(a.c(),a.m(e.parentNode,e)))},d(s){s&&(w(e),w(t)),a.d(s)}}}function xl(n){let e,t=n[21].requirements.employees+"",l,o;return{c(){e=p("span"),l=b(t),o=b(" employees"),d(e,"class","text_s cost_label svelte-140pktt")},m(a,s){k(a,e,s),i(e,l),i(e,o)},p(a,s){s&32&&t!==(t=a[21].requirements.employees+"")&&G(l,t)},d(a){a&&w(e)}}}function zl(n){let e,t=n[21].requirements.employees+"",l,o;return{c(){e=p("span"),l=b(t),o=b(" employees"),d(e,"class","text_s cost_label red svelte-140pktt")},m(a,s){k(a,e,s),i(e,l),i(e,o)},p(a,s){s&32&&t!==(t=a[21].requirements.employees+"")&&G(l,t)},d(a){a&&w(e)}}}function zn(n){let e,t;function l(s,f){return s[6].townInfo.knowledge_points<s[21].requirements.knowledge?to:eo}let o=l(n),a=o(n);return{c(){a.c(),e=y(),t=p("br")},m(s,f){a.m(s,f),k(s,e,f),k(s,t,f)},p(s,f){o===(o=l(s))&&a?a.p(s,f):(a.d(1),a=o(s),a&&(a.c(),a.m(e.parentNode,e)))},d(s){s&&(w(e),w(t)),a.d(s)}}}function eo(n){let e,t=n[21].requirements.knowledge+"",l,o;return{c(){e=p("span"),l=b(t),o=b(" knowledge"),d(e,"class","text_s cost_label svelte-140pktt")},m(a,s){k(a,e,s),i(e,l),i(e,o)},p(a,s){s&32&&t!==(t=a[21].requirements.knowledge+"")&&G(l,t)},d(a){a&&w(e)}}}function to(n){let e,t=n[21].requirements.knowledge+"",l,o;return{c(){e=p("span"),l=b(t),o=b(" knowledge"),d(e,"class","text_s cost_label red svelte-140pktt")},m(a,s){k(a,e,s),i(e,l),i(e,o)},p(a,s){s&32&&t!==(t=a[21].requirements.knowledge+"")&&G(l,t)},d(a){a&&w(e)}}}function no(n){let e,t,l=Jt(n[21].effect_modifiers.happiness)+"",o,a;return{c(){e=p("span"),t=b("ðŸ˜ "),o=b(l),d(e,"class","text_s svelte-140pktt"),d(e,"data-positive",a=n[21].effect_modifiers.happiness>=1)},m(s,f){k(s,e,f),i(e,t),i(e,o)},p(s,f){f&32&&l!==(l=Jt(s[21].effect_modifiers.happiness)+"")&&G(o,l),f&32&&a!==(a=s[21].effect_modifiers.happiness>=1)&&d(e,"data-positive",a)},d(s){s&&w(e)}}}function lo(n){let e;return{c(){e=p("span"),e.textContent="ðŸ˜ No effect",d(e,"class","text_s svelte-140pktt"),d(e,"data-positive","true")},m(t,l){k(t,e,l)},p:Q,d(t){t&&w(e)}}}function oo(n){let e,t,l=Jt(n[21].effect_modifiers.health)+"",o,a;return{c(){e=p("span"),t=b("ðŸ¥ "),o=b(l),d(e,"class","text_s svelte-140pktt"),d(e,"data-positive",a=n[21].effect_modifiers.health>=1)},m(s,f){k(s,e,f),i(e,t),i(e,o)},p(s,f){f&32&&l!==(l=Jt(s[21].effect_modifiers.health)+"")&&G(o,l),f&32&&a!==(a=s[21].effect_modifiers.health>=1)&&d(e,"data-positive",a)},d(s){s&&w(e)}}}function io(n){let e;return{c(){e=p("span"),e.textContent="ðŸ¥ No effect",d(e,"class","text_s svelte-140pktt"),d(e,"data-positive","true")},m(t,l){k(t,e,l)},p:Q,d(t){t&&w(e)}}}function el(n){let e,t,l,o,a,s=n[21].immediate_variable_changes.happiness!==0&&tl(n),f=n[21].immediate_variable_changes.happiness!==0&&n[21].immediate_variable_changes.health!==0&&nl(),h=n[21].immediate_variable_changes.health!==0&&ll(n);return{c(){e=p("div"),t=p("span"),l=b(`Instant changes:
										`),s&&s.c(),o=y(),f&&f.c(),a=y(),h&&h.c(),d(t,"class","subheading_m"),d(e,"class","immediate_changes svelte-140pktt")},m(u,c){k(u,e,c),i(e,t),i(t,l),s&&s.m(t,null),i(t,o),f&&f.m(t,null),i(t,a),h&&h.m(t,null)},p(u,c){u[21].immediate_variable_changes.happiness!==0?s?s.p(u,c):(s=tl(u),s.c(),s.m(t,o)):s&&(s.d(1),s=null),u[21].immediate_variable_changes.happiness!==0&&u[21].immediate_variable_changes.health!==0?f||(f=nl(),f.c(),f.m(t,a)):f&&(f.d(1),f=null),u[21].immediate_variable_changes.health!==0?h?h.p(u,c):(h=ll(u),h.c(),h.m(t,null)):h&&(h.d(1),h=null)},d(u){u&&w(e),s&&s.d(),f&&f.d(),h&&h.d()}}}function tl(n){let e,t,l=n[21].immediate_variable_changes.happiness+"",o;return{c(){e=b(`ðŸ˜
											`),t=p("span"),o=b(l),d(t,"class","green")},m(a,s){k(a,e,s),k(a,t,s),i(t,o)},p(a,s){s&32&&l!==(l=a[21].immediate_variable_changes.happiness+"")&&G(o,l)},d(a){a&&(w(e),w(t))}}}function nl(n){let e;return{c(){e=b(",")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function ll(n){let e,t,l=n[21].immediate_variable_changes.health+"",o;return{c(){e=b(`ðŸ¥
											`),t=p("span"),o=b(l),d(t,"class","green")},m(a,s){k(a,e,s),k(a,t,s),i(t,o)},p(a,s){s&32&&l!==(l=a[21].immediate_variable_changes.health+"")&&G(o,l)},d(a){a&&(w(e),w(t))}}}function ol(n,e){let t,l,o,a=e[21].title+"",s,f,h,u,c,m=e[21].subtitle+"",g,I,v,C,O,M=e[21].description+"",P,$,E,T,r,_,L,q,A,X,S,K,J,U,fe,te,D,H,x,z,oe,he,F,N,ee,ge,ze,re=(e[21].revenue_per_week>0||e[21].tourism_revenue_per_week>0)&&Wn(e),ue=e[21].requirements.gold!==0&&Zn(e),de=e[21].requirements.employees!==0&&xn(e),pe=e[21].requirements.knowledge!=null&&e[21].requirements.knowledge!==0&&zn(e);function et(ve,se){return ve[21].effect_modifiers.happiness==1?lo:no}let Ye=et(e),Se=Ye(e);function Ge(ve,se){return ve[21].effect_modifiers.health==1?io:oo}let je=Ge(e),Le=je(e),le=(e[21].immediate_variable_changes.happiness!==0||e[21].immediate_variable_changes.health!==0)&&el(e);return{key:n,first:null,c(){t=p("div"),l=p("div"),o=p("span"),s=b(a),f=y(),h=p("br"),u=y(),c=p("span"),g=b(m),I=y(),v=p("br"),C=y(),O=p("span"),P=b(M),$=y(),E=p("div"),re&&re.c(),T=y(),r=p("div"),_=p("div"),L=p("span"),L.textContent="Requirements",q=y(),A=p("br"),X=y(),ue&&ue.c(),S=y(),de&&de.c(),K=y(),pe&&pe.c(),J=y(),U=p("div"),fe=p("span"),fe.textContent="Multiplier",te=y(),D=p("br"),H=y(),Se.c(),x=y(),z=p("br"),oe=y(),Le.c(),he=y(),le&&le.c(),F=y(),d(o,"class","heading_m"),d(c,"class","subheading_m"),d(O,"class","text_s"),d(L,"class","subheading_m"),d(_,"class","svelte-140pktt"),d(fe,"class","subheading_m"),d(U,"class","svelte-140pktt"),d(r,"class","reqs_and_mods svelte-140pktt"),d(E,"class","bottom svelte-140pktt"),d(t,"class",N="plotOption background-lightgray "+(e[21].affordable?"":"unaffordable")+" svelte-140pktt"),d(t,"data-active",ee=e[21].selected),d(t,"data-affordable",ge=e[21].affordable),d(t,"data-plotoptionid",ze=e[21].id),this.first=t},m(ve,se){k(ve,t,se),i(t,l),i(l,o),i(o,s),i(l,f),i(l,h),i(l,u),i(l,c),i(c,g),i(l,I),i(l,v),i(l,C),i(l,O),i(O,P),i(t,$),i(t,E),re&&re.m(E,null),i(E,T),i(E,r),i(r,_),i(_,L),i(_,q),i(_,A),i(_,X),ue&&ue.m(_,null),i(_,S),de&&de.m(_,null),i(_,K),pe&&pe.m(_,null),i(r,J),i(r,U),i(U,fe),i(U,te),i(U,D),i(U,H),Se.m(U,null),i(U,x),i(U,z),i(U,oe),Le.m(U,null),i(E,he),le&&le.m(E,null),i(t,F)},p(ve,se){e=ve,se&32&&a!==(a=e[21].title+"")&&G(s,a),se&32&&m!==(m=e[21].subtitle+"")&&G(g,m),se&32&&M!==(M=e[21].description+"")&&G(P,M),e[21].revenue_per_week>0||e[21].tourism_revenue_per_week>0?re?re.p(e,se):(re=Wn(e),re.c(),re.m(E,T)):re&&(re.d(1),re=null),e[21].requirements.gold!==0?ue?ue.p(e,se):(ue=Zn(e),ue.c(),ue.m(_,S)):ue&&(ue.d(1),ue=null),e[21].requirements.employees!==0?de?de.p(e,se):(de=xn(e),de.c(),de.m(_,K)):de&&(de.d(1),de=null),e[21].requirements.knowledge!=null&&e[21].requirements.knowledge!==0?pe?pe.p(e,se):(pe=zn(e),pe.c(),pe.m(_,null)):pe&&(pe.d(1),pe=null),Ye===(Ye=et(e))&&Se?Se.p(e,se):(Se.d(1),Se=Ye(e),Se&&(Se.c(),Se.m(U,x))),je===(je=Ge(e))&&Le?Le.p(e,se):(Le.d(1),Le=je(e),Le&&(Le.c(),Le.m(U,null))),e[21].immediate_variable_changes.happiness!==0||e[21].immediate_variable_changes.health!==0?le?le.p(e,se):(le=el(e),le.c(),le.m(E,null)):le&&(le.d(1),le=null),se&32&&N!==(N="plotOption background-lightgray "+(e[21].affordable?"":"unaffordable")+" svelte-140pktt")&&d(t,"class",N),se&32&&ee!==(ee=e[21].selected)&&d(t,"data-active",ee),se&32&&ge!==(ge=e[21].affordable)&&d(t,"data-affordable",ge),se&32&&ze!==(ze=e[21].id)&&d(t,"data-plotoptionid",ze)},d(ve){ve&&w(t),re&&re.d(),ue&&ue.d(),de&&de.d(),pe&&pe.d(),Se.d(),Le.d(),le&&le.d()}}}function so(n){let e,t,l,o,a,s,f=n[2]+1+"",h,u,c=n[1]+1+"",m,g,I,v,C,O,M=n[6].plots[n[1]][n[2]].type!==-1&&n[3](n[2],n[1]),P,$,E,T,r,_,L,q,A,X,S,K,J,U=[],fe=new Map,te,D,H=n[0]!==""&&Hn(n),x=M&&jn(n),z=n[8]>0&&Vn(n),oe=n[5].length==0&&Yn(),he=Ze(n[5]);const F=N=>N[21].id;for(let N=0;N<he.length;N+=1){let ee=Jn(n,he,N),ge=F(ee);fe.set(ge,U[N]=ol(ge,ee))}return{c(){e=p("div"),t=p("div"),l=p("div"),o=p("div"),a=p("span"),s=b("Modify Plot: "),h=b(f),u=b("-"),m=b(c),g=y(),H&&H.c(),I=y(),v=p("input"),C=y(),O=p("div"),x&&x.c(),P=y(),$=p("button"),$.textContent="Close",E=y(),T=p("div"),r=p("label"),_=b(`options
				`),z&&z.c(),L=y(),oe&&oe.c(),q=y(),A=p("br"),X=y(),S=p("br"),K=y(),J=p("div");for(let N=0;N<U.length;N+=1)U[N].c();d(a,"class","heading_l"),d(o,"class","svelte-140pktt"),d(v,"type","text"),d(v,"id","search-bar"),d(v,"placeholder","Search Plot Options..."),v.value=n[4],d(v,"class","svelte-140pktt"),d($,"id","close"),d($,"class","svelte-140pktt"),d(O,"class","svelte-140pktt"),d(l,"class","header svelte-140pktt"),d(r,"for","plotType"),d(J,"class","plotOptions svelte-140pktt"),d(T,"class","scrollable-y svelte-140pktt"),d(t,"class","dialog-content svelte-140pktt"),d(e,"class","dialog svelte-140pktt")},m(N,ee){k(N,e,ee),i(e,t),i(t,l),i(l,o),i(o,a),i(a,s),i(a,h),i(a,u),i(a,m),i(o,g),H&&H.m(o,null),i(l,I),i(l,v),n[16](v),i(l,C),i(l,O),x&&x.m(O,null),i(O,P),i(O,$),i(t,E),i(t,T),i(T,r),i(r,_),z&&z.m(r,null),i(r,L),oe&&oe.m(r,null),i(T,q),i(T,A),i(T,X),i(T,S),i(T,K),i(T,J);for(let ge=0;ge<U.length;ge+=1)U[ge]&&U[ge].m(J,null);te||(D=[Z(v,"input",n[9]),Z($,"click",n[10]),Z(J,"click",n[12])],te=!0)},p(N,[ee]){ee&4&&f!==(f=N[2]+1+"")&&G(h,f),ee&2&&c!==(c=N[1]+1+"")&&G(m,c),N[0]!==""?H?H.p(N,ee):(H=Hn(N),H.c(),H.m(o,null)):H&&(H.d(1),H=null),ee&16&&v.value!==N[4]&&(v.value=N[4]),ee&70&&(M=N[6].plots[N[1]][N[2]].type!==-1&&N[3](N[2],N[1])),M?x?x.p(N,ee):(x=jn(N),x.c(),x.m(O,P)):x&&(x.d(1),x=null),N[8]>0?z?z.p(N,ee):(z=Vn(N),z.c(),z.m(r,L)):z&&(z.d(1),z=null),N[5].length==0?oe||(oe=Yn(),oe.c(),oe.m(r,null)):oe&&(oe.d(1),oe=null),ee&96&&(he=Ze(N[5]),U=Vl(U,ee,F,1,N,he,fe,J,jl,ol,null,Jn))},i:Q,o:Q,d(N){N&&w(e),H&&H.d(),n[16](null),x&&x.d(),z&&z.d(),oe&&oe.d();for(let ee=0;ee<U.length;ee+=1)U[ee].d();te=!1,Ve(D)}}}function Je(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Jt(n){return n.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}function il(n,e){let t=!0;n.requirements.gold>e.townInfo.gold&&(t=!1);let l=e.townInfo.population_count-e.townInfo.employees;return n.requirements.employees!==void 0&&n.requirements.employees>0&&n.requirements.employees>l&&(t=!1),n.requirements.knowledge!==void 0&&n.requirements.knowledge>e.townInfo.knowledge_points&&(t=!1),t}function ao(n,e,t){let l,o;ne(n,j,_=>t(6,l=_)),ne(n,ie,_=>t(17,o=_));let{x:a=0}=e,{y:s=0}=e,f="",h=ae,{tooltip:u=""}=e,c,m;Ut(async()=>{await Ul(),c&&c.focus()});let g=h.map(_=>Object.assign(Object.assign({},_),{affordable:il(_,l)}));function I(_){console.log(_.target.value),t(4,f=_.target.value||"")}Ut(()=>{const _=document.querySelectorAll(".plotOption");l.plots[a][s].type!==-1&&l.plots[a][s].type>-1&&(_[l.plots[a][s].type].classList.add("active"),_[l.plots[a][s].type].scrollIntoView({behavior:"smooth",block:"center"}))});function v(_,L){let q={x:_,y:L};return q.x===0&&q.y===0?!0:[{x:q.x-1,y:q.y},{x:q.x+1,y:q.y},{x:q.x,y:q.y-1},{x:q.x,y:q.y+1}].some(X=>X.x<0||X.x>l.plots.length-1||X.y<0||X.y>l.plots.length-1?!1:l.plots[X.x][X.y].active)}function C(){Y(ie,o.visible=!1,o)}function O(){document.querySelectorAll(".plotOption").forEach(L=>{L.classList.remove("active")}),E(a,s)}function M(_){document.querySelectorAll(".plotOption").forEach(A=>{A.classList.remove("active")});const q=document.querySelector(`[data-plotoptionid="${_}"]`);q&&(q.classList.add("active"),$(a,s,_))}function P(_,L){let q=0;return _>0&&l.plots[_-1][L].type!==-1&&q++,_<l.plots.length-1&&l.plots[_+1][L].type!==-1&&q++,L>0&&l.plots[_][L-1].type!==-1&&q++,L<l.plots[0].length-1&&l.plots[_][L+1].type!==-1&&q++,q<=4}function $(_,L,q){let A=l;const X=ae.findIndex(J=>J.id===q);let S=ae[X],K=!0;if((S.requirements.gold>A.townInfo.gold||S.requirements.employees>A.townInfo.population_count-A.townInfo.employees)&&(K=!1),S.requirements.size!=null&&K){let J=S.requirements.size,U=[],fe=h[X].title.toLowerCase().indexOf("school")!=-1;for(let te=0;te<4;te++){let D=[[_,L]];te===0?(D.push([_-(J-1),L-(J-1)]),D.push([_-(J-1),L]),D.push([_,L-(J-1)])):te===1?(D.push([_,L-(J-1)]),D.push([_+(J-1),L-(J-1)]),D.push([_+(J-1),L])):te===2?(D.push([_-(J-1),L]),D.push([_-(J-1),L+(J-1)]),D.push([_,L+(J-1)])):te===3&&(D.push([_,L+(J-1)]),D.push([_+(J-1),L+(J-1)]),D.push([_+(J-1),L])),U.push(D)}U=U.filter(te=>te.every(D=>D[0]>=0&&D[0]<=A.plots.length-1&&D[1]>=0&&D[1]<=A.plots.length-1&&!A.plots[D[0]][D[1]].active&&v(D[0],D[1])==!0)),U.length===0?K=!1:U.length>0&&U[0].forEach(D=>{A.plots[D[0]][D[1]].active=!0,A.plots[D[0]][D[1]].type=fe?-3:-2,A.plots[D[0]][D[1]].referencePlot=[_,L]})}if(K===!0){switch(A.plots[_][L].type!==-1&&E(_,L),t(0,u=""),A.plots[_][L].type=X,A.plots[_][L].active=!0,A.plots[_][L].referencePlot=[],A.townInfo.gold-=S.requirements.gold,A.townInfo.gold=Je(A.townInfo.gold,2),A.townInfo.population_count+=S.immediate_variable_changes.population,A.townInfo.population_max+=S.immediate_variable_changes.population,A.townInfo.happiness+=S.immediate_variable_changes.happiness,A.townInfo.health+=S.immediate_variable_changes.health,A.modifiers.happiness=Je(A.modifiers.happiness*S.effect_modifiers.happiness,2),A.modifiers.health=Je(A.modifiers.health*S.effect_modifiers.health,2),A.townInfo.employees+=S.requirements.employees,(A.plotCounts[X]===void 0||A.plotCounts[X]===null)&&(A.plotCounts[X]=0),A.plotCounts[X]++,A.lastChangeDay=A.environment.day,A.economyAndLaws.balance_sheet_history=[{day:A.environment.day,plot:`${_},${L}`,profits:S.requirements.gold*-1,balance:Je(A.townInfo.gold,2)},...A.economyAndLaws.balance_sheet_history],S.id){case"city-hall":A.hasCityHall=!0;break;case"bank":A.hasBank=!0;break}j.set(A),localStorage.setItem(Ie,JSON.stringify(A)),Y(ie,o.visible=!1,o)}else t(0,u="You do not have enough resources to purchase this plot."),document.querySelectorAll(".plotOption").forEach(U=>{U.classList.remove("active")})}function E(_,L){let q=l,A=q.plots[_][L].type;q.plots[_][L].type=-1,q.plots[_][L].active=!1,A>-1&&(q.townInfo.population_count-=ae[A].immediate_variable_changes.population,q.townInfo.population_max-=ae[A].immediate_variable_changes.population,q.townInfo.happiness-=ae[A].immediate_variable_changes.happiness,q.townInfo.health-=ae[A].immediate_variable_changes.health,q.modifiers.happiness=Je(q.modifiers.happiness/ae[A].effect_modifiers.happiness,2),q.modifiers.health=Je(q.modifiers.health/ae[A].effect_modifiers.health,2),q.townInfo.employees-=ae[A].requirements.employees,(q.plotCounts[A]===void 0||q.plotCounts[A]===null)&&(q.plotCounts[A]=0),q.plotCounts[A]--),q.lastChangeDay=q.environment.day,j.set(q),localStorage.setItem(Ie,JSON.stringify(q))}function T(_){const L=_.target.closest(".plotOption");if(L){const q=L.dataset.plotoptionid;M(q)}}function r(_){zt[_?"unshift":"push"](()=>{c=_,t(7,c)})}return n.$$set=_=>{"x"in _&&t(1,a=_.x),"y"in _&&t(2,s=_.y),"tooltip"in _&&t(0,u=_.tooltip)},n.$$.update=()=>{n.$$.dirty&64&&l&&t(5,g=h.map(_=>Object.assign(Object.assign({},_),{affordable:il(_,l)}))),n.$$.dirty&48&&t(5,g=g.filter(_=>_.title.toLowerCase().includes(f.toLowerCase()))),n.$$.dirty&32&&t(8,m=g.filter(_=>_.affordable).length)},[u,a,s,P,f,g,l,c,m,I,C,O,T,v,$,E,r]}class ro extends Be{constructor(e){super(),Te(this,e,ao,so,Ae,{x:1,y:2,tooltip:0,checkIfPlotCanBeUpgraded:13,canBulldoze:3,purchasePlot:14,reverseClear:15})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[13]}get canBulldoze(){return this.$$.ctx[3]}get purchasePlot(){return this.$$.ctx[14]}get reverseClear(){return this.$$.ctx[15]}}function sl(n){let e,t,l=ae[n[0].type].title+"",o,a;return{c(){e=p("div"),t=p("span"),o=b(l),d(t,"data-size",a=ae[n[0].type].requirements.size),d(t,"class","svelte-18cb8zy"),d(e,"class","svelte-18cb8zy")},m(s,f){k(s,e,f),i(e,t),i(t,o)},p(s,f){f&1&&l!==(l=ae[s[0].type].title+"")&&G(o,l),f&1&&a!==(a=ae[s[0].type].requirements.size)&&d(t,"data-size",a)},d(s){s&&w(e)}}}function fo(n){let e,t,l,o,a,s,f,h,u,c,m,g,I=n[0].type>-1&&sl(n);return{c(){e=p("div"),I&&I.c(),d(e,"class","plot_container svelte-18cb8zy"),d(e,"data-active",t=n[0].active),d(e,"data-id",l=n[0].id),d(e,"data-x",o=n[0].x),d(e,"data-y",a=n[0].y),d(e,"data-optionindex",s=n[0].optionIndex),d(e,"data-canbeupgraded",n[1]),d(e,"style",n[2]),d(e,"data-type",f=n[0].type),d(e,"data-referenceplotx",h=n[0].referencePlot!==void 0?n[0].referencePlot[0]:null),d(e,"data-referenceploty",u=n[0].referencePlot!==void 0?n[0].referencePlot[1]:null),d(e,"data-size",c=n[0].type>-1?ae[n[0].type].requirements.size:null)},m(v,C){k(v,e,C),I&&I.m(e,null),m||(g=Z(e,"click",n[3]),m=!0)},p(v,[C]){v[0].type>-1?I?I.p(v,C):(I=sl(v),I.c(),I.m(e,null)):I&&(I.d(1),I=null),C&1&&t!==(t=v[0].active)&&d(e,"data-active",t),C&1&&l!==(l=v[0].id)&&d(e,"data-id",l),C&1&&o!==(o=v[0].x)&&d(e,"data-x",o),C&1&&a!==(a=v[0].y)&&d(e,"data-y",a),C&1&&s!==(s=v[0].optionIndex)&&d(e,"data-optionindex",s),C&2&&d(e,"data-canbeupgraded",v[1]),C&4&&d(e,"style",v[2]),C&1&&f!==(f=v[0].type)&&d(e,"data-type",f),C&1&&h!==(h=v[0].referencePlot!==void 0?v[0].referencePlot[0]:null)&&d(e,"data-referenceplotx",h),C&1&&u!==(u=v[0].referencePlot!==void 0?v[0].referencePlot[1]:null)&&d(e,"data-referenceploty",u),C&1&&c!==(c=v[0].type>-1?ae[v[0].type].requirements.size:null)&&d(e,"data-size",c)},i:Q,o:Q,d(v){v&&w(e),I&&I.d(),m=!1,g()}}}function uo(n,e,t){let l,o,a,s;ne(n,ie,v=>t(5,l=v)),ne(n,j,v=>t(6,o=v)),ne(n,yt,v=>t(7,a=v)),ne(n,kt,v=>t(8,s=v));let{data:f={id:0,active:!1,x:0,y:0,type:-1,styling:"",referencePlot:[]}}=e,{canBeUpgraded:h=!1}=e;function u(...v){m()}let c=f.styling;Ut(async()=>{f.type>=0&&ae[f.type].styling&&t(2,c=ae[f.type].styling)});function m(){f.type>=0&&ae[f.type].styling&&t(2,c=ae[f.type].styling),f.type<0&&t(2,c="")}function g(v,C,O){let M=document.querySelectorAll(".plot_container");if(a==!1){if(f.referencePlot!=null&&f.referencePlot[0]!==null&&C==null&&O==null&&f.referencePlot[1]!==void 0)return g(v,f.referencePlot[0],f.referencePlot[1]);!f.active&&!h?(Y(kt,s={},s),Y(ie,l.visible=!1,l),M.forEach(P=>{P.classList.remove("selected")})):(C!=null&&O!=null?(Y(ie,l.x=C,l),Y(ie,l.y=O,l)):(Y(ie,l.x=f.x,l),Y(ie,l.y=f.y,l)),Y(ie,l.visible=!0,l),M.forEach(P=>{P.classList.remove("selected")}),C!=null&&O!=null?document.querySelector(`.plot_container[data-x="${C}"][data-y="${O}"]`).classList.add("selected"):document.querySelector(`.plot_container[data-id="${f.id}"]`).classList.add("selected"))}}function I(v){a==!1&&(Y(j,o.plots[f.x][f.y].type=v,o),Y(ie,l.visible=!1,l))}return n.$$set=v=>{"data"in v&&t(0,f=v.data),"canBeUpgraded"in v&&t(1,h=v.canBeUpgraded)},n.$$.update=()=>{n.$$.dirty&1&&u(f)},[f,h,c,g,I]}class po extends Be{constructor(e){super(),Te(this,e,uo,fo,Ae,{data:0,canBeUpgraded:1,changePlotType:4})}get changePlotType(){return this.$$.ctx[4]}}function al(n,e,t){const l=n.slice();return l[6]=e[t],l}function rl(n,e,t){const l=n.slice();return l[9]=e[t],l}function fl(n){let e,t,l=n[3],o,a,s=Ze(n[2].plots),f=[];for(let c=0;c<s.length;c+=1)f[c]=pl(al(n,s,c));const h=c=>W(f[c],1,1,()=>{f[c]=null});let u=dl(n);return{c(){e=p("div");for(let c=0;c<f.length;c+=1)f[c].c();t=y(),u.c(),o=xe(),d(e,"class","grid svelte-3cpxwu")},m(c,m){k(c,e,m);for(let g=0;g<f.length;g+=1)f[g]&&f[g].m(e,null);k(c,t,m),u.m(c,m),k(c,o,m),a=!0},p(c,m){if(m&7){s=Ze(c[2].plots);let g;for(g=0;g<s.length;g+=1){const I=al(c,s,g);f[g]?(f[g].p(I,m),R(f[g],1)):(f[g]=pl(I),f[g].c(),R(f[g],1),f[g].m(e,null))}for(Ne(),g=s.length;g<f.length;g+=1)h(g);Ee()}m&8&&Ae(l,l=c[3])?(Ne(),W(u,1,1,Q),Ee(),u=dl(c),u.c(),R(u,1),u.m(o.parentNode,o)):u.p(c,m)},i(c){if(!a){for(let m=0;m<s.length;m+=1)R(f[m]);R(u),a=!0}},o(c){f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)W(f[m]);W(u),a=!1},d(c){c&&(w(e),w(t),w(o)),sn(f,c),u.d(c)}}}function ul(n){let e,t;return e=new po({props:{data:n[9],canBeUpgraded:n[0](n[9].x,n[9].y)}}),{c(){Me(e.$$.fragment)},m(l,o){Pe(e,l,o),t=!0},p(l,o){const a={};o&4&&(a.data=l[9]),o&4&&(a.canBeUpgraded=l[0](l[9].x,l[9].y)),e.$set(a)},i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function pl(n){let e,t,l,o,a,s=Ze(n[6]),f=[];for(let u=0;u<s.length;u+=1)f[u]=ul(rl(n,s,u));const h=u=>W(f[u],1,1,()=>{f[u]=null});return{c(){e=p("div");for(let u=0;u<f.length;u+=1)f[u].c();t=y(),d(e,"class","row svelte-3cpxwu")},m(u,c){k(u,e,c);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(e,null);i(e,t),l=!0,o||(a=Z(e,"click",n[1]),o=!0)},p(u,c){if(c&5){s=Ze(u[6]);let m;for(m=0;m<s.length;m+=1){const g=rl(u,s,m);f[m]?(f[m].p(g,c),R(f[m],1)):(f[m]=ul(g),f[m].c(),R(f[m],1),f[m].m(e,t))}for(Ne(),m=s.length;m<f.length;m+=1)h(m);Ee()}},i(u){if(!l){for(let c=0;c<s.length;c+=1)R(f[c]);l=!0}},o(u){f=f.filter(Boolean);for(let c=0;c<f.length;c+=1)W(f[c]);l=!1},d(u){u&&w(e),sn(f,u),o=!1,a()}}}function cl(n){let e,t;return e=new ro({props:{x:n[4].x,y:n[4].y}}),{c(){Me(e.$$.fragment)},m(l,o){Pe(e,l,o),t=!0},p(l,o){const a={};o&16&&(a.x=l[4].x),o&16&&(a.y=l[4].y),e.$set(a)},i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function dl(n){let e,t,l=n[4].visible&&cl(n);return{c(){l&&l.c(),e=xe()},m(o,a){l&&l.m(o,a),k(o,e,a),t=!0},p(o,a){o[4].visible?l?(l.p(o,a),a&16&&R(l,1)):(l=cl(o),l.c(),R(l,1),l.m(e.parentNode,e)):l&&(Ne(),W(l,1,1,()=>{l=null}),Ee())},i(o){t||(R(l),t=!0)},o(o){W(l),t=!1},d(o){o&&w(e),l&&l.d(o)}}}function co(n){let e,t,l=n[2]!=null&&fl(n);return{c(){l&&l.c(),e=xe()},m(o,a){l&&l.m(o,a),k(o,e,a),t=!0},p(o,[a]){o[2]!=null?l?(l.p(o,a),a&4&&R(l,1)):(l=fl(o),l.c(),R(l,1),l.m(e.parentNode,e)):l&&(Ne(),W(l,1,1,()=>{l=null}),Ee())},i(o){t||(R(l),t=!0)},o(o){W(l),t=!1},d(o){o&&w(e),l&&l.d(o)}}}function _o(n,e,t){let l,o,a;ne(n,j,u=>t(2,l=u)),ne(n,kt,u=>t(3,o=u)),ne(n,ie,u=>t(4,a=u));function s(u,c){let m={x:u,y:c};return m.x===0&&m.y===0?!0:[{x:m.x-1,y:m.y},{x:m.x+1,y:m.y},{x:m.x,y:m.y-1},{x:m.x,y:m.y+1}].some(I=>I.x<0||I.x>=l.plots.length||I.y<0||I.y>=l.plots[I.x].length?!1:l.plots[I.x][I.y].active)}function f(){let u=[];for(let c=0;c<l.plots.length;c++)for(let m=0;m<l.plots.length;m++)s(c,m)&&l.plots[c][m].active==!1&&u.push(l.plots[c][m])}function h(){Y(kt,o={},o)}return window.location.search.includes("dev=true")&&(Y(j,l.townInfo.name="DevTown",l),Y(j,l.townInfo.gold=1e8,l),Y(j,l.townInfo.population=0,l),Y(j,l.townInfo.happiness=1e5,l),Y(j,l.townInfo.health=1e5,l),Y(j,l.modifiers.happiness=1e5,l),Y(j,l.modifiers.health=1e5,l),Y(j,l.townInfo.knowledge_points=1e4,l)),n.$$.update=()=>{n.$$.dirty&4&&l&&f()},[s,h,l,o,a]}class mo extends Be{constructor(e){super(),Te(this,e,_o,co,Ae,{checkIfPlotCanBeUpgraded:0,restartModifyPlotMenu:1})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[0]}get restartModifyPlotMenu(){return this.$$.ctx[1]}}const ke={unemployment_num:" people can't find jobs.",bored:"People are bored. Try making some new buildings.",vairety:"People don't like going to the same places over and over again. Try making some new buildings.",nobody_home:"Nobody can live here. Build some residential buildings.",leave_town_num:" people left town because they were unhappy.",new_people_num:" new people moved to town.",people_want_to_move_in:"People want to move in. Build more homes.",high_tax_rate:"People are unhappy with the high tax rate.",very_high_tax_rate:"People are extremely unhappy with the high tax rate.",sickAndDying:"People are sick and dying.",sickAndLeaving:"People are sick and leaving town.",happiness_zero:"The town has fallen into chaos due to extreme unhappiness.",health_zero:"The town has fallen into chaos due to extreme sickness.",population_zero:"The town has been condemned due to lack of population.",win:{land:"You have filled the grid with buildings. You win!"}},bt={land:{short_title:"Fill the grid",description_title:"You win by filling up all possible plots in the grid, and by meeting some requirements.",win:"You have filled the grid with buildings. You win!",requirements:{0:{population_count:200,happiness:100,health:100,employment:1},1:{population_count:500,happiness:100,health:100,employment:1},2:{population_count:1e3,happiness:100,health:100,employment:1}}}},_l=30;function ho(n){return n.hasBank,n}function go(n){return n.hasCityHall,n}function ln(n){if(n.modifiers.happiness>1){let e=n.modifiers.happiness-1;n.modifiers.happiness-=e*.08,n.modifiers.happiness<1.05&&(n.modifiers.happiness=1)}if(n.modifiers.health>1){let e=n.modifiers.health-1;n.modifiers.health-=e*.08,n.modifiers.health<1.05&&(n.modifiers.health=1)}return n}function on(n){if(n.townInfo.happiness>150){let t=n.townInfo.happiness-150;n.townInfo.happiness-=t*.08,n.townInfo.happiness<150&&(n.townInfo.happiness=150)}if(n.townInfo.health>150){let t=n.townInfo.health-150;n.townInfo.health-=t*.08,n.townInfo.health<150&&(n.townInfo.health=150)}return n}function vo(n){return n.townInfo.happiness*=n.modifiers.happiness,n.townInfo.health*=n.modifiers.health,n}function bo(n,e){let t=e.townInfo.happiness/100;t>1.25?t=1.25:t<.75&&(t=.75);let l=n*e.economyAndLaws.tax_rate*(e.townInfo.population_count/e.townInfo.population_max)*t;return Qe(l,2)}function Qe(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function yo(n,e,t){let l,o,a;ne(n,Dt,r=>t(4,l=r)),ne(n,j,r=>t(5,o=r)),ne(n,yt,r=>t(6,a=r));function s(r){return r=I(r),r=M(r),r=$(r),r=vo(r),r=v(r),r=ln(r),r}function f(r){return r=E(r),r=O(r),r=ho(r),r=go(r),r}function h(r){return r=C(r),r=on(r),r}function u(r){return r=P(r),r=g(r),r=m(r),r}function c(){j.update(r=>{if(r.tick++,r.tick%_l!==0||a||!r||r.endGameDetails)return r;try{return r.environment.day+=1,r.environment.day%7===0&&(r=s(r)),r.environment.day%30===0&&(r=f(r)),r.environment.day%90===0&&(r=h(r)),r=u(r),r}catch(_){return console.error("Error in game loop:",_),r}})}j.subscribe(r=>{r&&localStorage.setItem(Ie,JSON.stringify(r))});function m(r){if(r.endGoal=="land"&&r.townInfo.population_max==r.townInfo.population_count&&r.townInfo.happiness>=bt.land.requirements[r.difficulty].happiness&&r.townInfo.health>=bt.land.requirements[r.difficulty].health&&r.townInfo.employees/r.townInfo.population_count>=bt.land.requirements[r.difficulty].employment&&r.townInfo.population_count>bt.land.requirements[r.difficulty].population){let L=!0;for(let q=0;q<r.plots.length;q++)for(let A=0;A<r.plots[q].length;A++)if(r.plots[q][A].active==!1){L=!1;break}L&&(r.endGameDetails={msg:bt.land.win,win:!0})}return r}function g(r){return r.townInfo.happiness<=0&&(r.townInfo.happiness=0,r.endGameDetails={msg:ke.happiness_zero,win:!1}),r.townInfo.health<=0&&(r.townInfo.health=0,r.endGameDetails={msg:ke.health_zero,win:!1}),r.townInfo.population_count<=0&&r.townInfo.population_max>0&&(r.townInfo.population_count=0,r.endGameDetails={msg:ke.population_zero,win:!1}),r}function I(r){let _=r.townInfo.population_count-r.townInfo.employees;return _>0&&(r.modifiers.happiness-=_*9e-4,r=T(_+ke.unemployment_num,r)),r}function v(r){let _=r.townInfo.health,L=0;return _>50||_<Math.random()*50&&(_<25?(r=T(ke.sickAndDying,r),r.townInfo.happiness-=10,L=Math.round(r.townInfo.population_count*.1)):(r=T(ke.sickAndLeaving,r),r.townInfo.happiness-=5,L=Math.round(r.townInfo.population_count*.05)),r.townInfo.population_count-=L,r.townInfo.employees-=L),r}function C(r){return r.lastChangeDay+(Math.random()*160+50)<r.environment.day&&(r.townInfo.population_count>0&&(r.townInfo.population_count-=1,r.townInfo.employees-=1,r.modifiers.happiness-=.01),r=T(ke.bored,r)),r}function O(r){if(r.townInfo.population_count<r.townInfo.population_max&&r.townInfo.happiness>50){let _=r.townInfo.population_max-r.townInfo.population_count,L=Math.round(r.townInfo.happiness/100*_);r.townInfo.population_count+=L,r.townInfo.population_count>r.townInfo.population_max&&(r.townInfo.population_count=r.townInfo.population_max),r.townInfo.employees+=L,r.townInfo.employees>r.townInfo.population_count&&(r.townInfo.employees=r.townInfo.population_count),r=T(L+ke.new_people_num,r)}if(r.townInfo.happiness<50&&r.townInfo.population_count>0){let _=Math.round((100-r.townInfo.happiness)/5);r.townInfo.population_count-=_,r.townInfo.employees>0&&(r.townInfo.employees-=_),r=T(_+ke.leave_town_num,r)}else r.townInfo.population_count==r.townInfo.population_max&&(r=T(ke.people_want_to_move_in,r));return r}function M(r){const _=Math.random();if(r.economyAndLaws.tax_rate>r.economyAndLaws.max_tax_rate){const L=r.difficulty==0?.7:r.difficulty==1?.4:.2;_<L&&r.economyAndLaws.tax_rate>r.economyAndLaws.max_tax_rate*2?(r.modifiers.happiness-=.03,r=T(ke.very_high_tax_rate+"  ("+r.economyAndLaws.tax_rate+"%)",r)):(r.modifiers.happiness-=.01,r=T(ke.high_tax_rate+"  ("+r.economyAndLaws.tax_rate*100+"%)",r))}return r}function P(r){return r.townInfo.happiness<0&&(r.townInfo.happiness=0),r.townInfo.health<0&&(r.townInfo.health=0),r.townInfo.gold<0&&(r.townInfo.gold=0),r.townInfo.employees<0&&(r.townInfo.employees=0),r.townInfo.knowledge_points<0&&(r.townInfo.knowledge_points=0),r.townInfo.population_count<0&&(r.townInfo.population_count=0),r.townInfo.population_max==0&&(r=T(ke.nobody_home,r)),r.economyAndLaws.last_month_profit=Qe(r.economyAndLaws.last_month_profit,2),r.townInfo.gold=Qe(r.townInfo.gold,2),r.townInfo.population_count=Qe(r.townInfo.population_count,0),r.townInfo.employees=Qe(r.townInfo.employees,0),r.townInfo.population_max=Qe(r.townInfo.population_max,0),r.townInfo.happiness=Qe(r.townInfo.happiness,2),r.townInfo.health=Qe(r.townInfo.health,2),r.townInfo.happiness>300&&(r.townInfo.happiness=300),r.townInfo.health>300&&(r.townInfo.health=300),r.modifiers.happiness<.5&&(r.modifiers.happiness=.5),r.modifiers.health<.5&&(r.modifiers.health=.5),r}function $(r){r.economyAndLaws.last_month_profit=0;for(let _=0;_<r.plots.length;_++)for(let L=0;L<r.plots[_].length;L++)if(r.plots[_][L].active==!0&&r.plots[_][L].type>-1){let q=ae[r.plots[_][L].type],A=bo(q.revenue_per_week,r);r.townInfo.gold+=A,r.economyAndLaws.last_month_profit+=A,A>0&&(r.economyAndLaws.balance_sheet_history=[{day:r.environment.day,plot:`${_},${L}`,profits:A,taxRate:r.economyAndLaws.tax_rate},...r.economyAndLaws.balance_sheet_history],r.economyAndLaws.balance_sheet_history.length>250&&(r.economyAndLaws.balance_sheet_history=r.economyAndLaws.balance_sheet_history.slice(0,250))),q.enables_tourism==!0&&(r.townInfo.gold_from_tourism+=q.tourism_revenue_per_week*r.economyAndLaws.tax_rate*r.townInfo.population_count)}return r}function E(r){for(let _=0;_<r.plots.length;_++)for(let L=0;L<r.plots[_].length;L++)if(r.plots[_][L].active==!0&&r.plots[_][L].type>-1){let q=ae[r.plots[_][L].type];q.knowledge_points_per_month!=null&&(r.townInfo.knowledge_points+=q.knowledge_points_per_month)}return r}function T(r,_){return _.townLog="Day "+o.environment.day+" - "+r+`
`+_.townLog,_}return Ut(async()=>{for(;;)localStorage.reset=="true"&&(an(),localStorage.setItem("reset","false")),c(),await new Promise(r=>setTimeout(r,l/_l))}),[c,P,ln,on]}class wo extends Be{constructor(e){super(),Te(this,e,yo,null,Ae,{mainGameThreadLoop:0,_fixVariables:1,_bringModifiersBackToNormal:2,_bringStatsBackToNormal:3})}get mainGameThreadLoop(){return this.$$.ctx[0]}get _fixVariables(){return this.$$.ctx[1]}get _bringModifiersBackToNormal(){return ln}get _bringStatsBackToNormal(){return on}}function ml(n,e,t){const l=n.slice();return l[4]=e[t],l}function ko(n){let e,t,l,o,a=Ze(n[0].economyAndLaws.balance_sheet_history),s=[];for(let f=0;f<a.length;f+=1)s[f]=hl(ml(n,a,f));return{c(){e=p("table"),t=p("thead"),t.innerHTML='<tr class="svelte-1m5x2x2"><th>Day</th> <th>Plot</th> <th>Profits</th> <th>Tax rate</th></tr>',l=y(),o=p("tbody");for(let f=0;f<s.length;f+=1)s[f].c();d(e,"class","svelte-1m5x2x2")},m(f,h){k(f,e,h),i(e,t),i(e,l),i(e,o);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(o,null)},p(f,h){if(h&3){a=Ze(f[0].economyAndLaws.balance_sheet_history);let u;for(u=0;u<a.length;u+=1){const c=ml(f,a,u);s[u]?s[u].p(c,h):(s[u]=hl(c),s[u].c(),s[u].m(o,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=a.length}},d(f){f&&w(e),sn(s,f)}}}function Io(n){let e;return{c(){e=p("div"),e.textContent=`No data to display yet. Build some buildings and make sure that the tax
				rate is above 0%.`,d(e,"class","text-center padding-sides")},m(t,l){k(t,e,l)},p:Q,d(t){t&&w(e)}}}function hl(n){let e,t,l=n[4].day+"",o,a,s,f=n[4].plot+"",h,u,c,m=n[4].profits+"",g,I,v,C=n[4].taxRate+"",O,M,P,$;function E(){return n[2](n[4])}return{c(){e=p("tr"),t=p("td"),o=b(l),a=y(),s=p("th"),h=b(f),u=y(),c=p("td"),g=b(m),I=y(),v=p("td"),O=b(C),M=y(),d(t,"class","svelte-1m5x2x2"),d(s,"class","plot_link svelte-1m5x2x2"),d(c,"class","svelte-1m5x2x2"),d(v,"class","svelte-1m5x2x2"),d(e,"class","svelte-1m5x2x2")},m(T,r){k(T,e,r),i(e,t),i(t,o),i(e,a),i(e,s),i(s,h),i(e,u),i(e,c),i(c,g),i(e,I),i(e,v),i(v,O),i(e,M),P||($=Z(s,"click",E),P=!0)},p(T,r){n=T,r&1&&l!==(l=n[4].day+"")&&G(o,l),r&1&&f!==(f=n[4].plot+"")&&G(h,f),r&1&&m!==(m=n[4].profits+"")&&G(g,m),r&1&&C!==(C=n[4].taxRate+"")&&G(O,C)},d(T){T&&w(e),P=!1,$()}}}function So(n){let e,t,l,o,a,s;function f(c,m){return c[0].economyAndLaws.balance_sheet_history.length==0?Io:ko}let h=f(n),u=h(n);return{c(){e=p("div"),t=p("div"),l=p("div"),l.textContent="Balance Sheet",o=y(),a=p("br"),s=y(),u.c(),d(l,"class","heading_m svelte-1m5x2x2"),d(t,"class","dialog-content svelte-1m5x2x2"),d(e,"class","dialog svelte-1m5x2x2")},m(c,m){k(c,e,m),i(e,t),i(t,l),i(t,o),i(t,a),i(t,s),u.m(t,null)},p(c,[m]){h===(h=f(c))&&u?u.p(c,m):(u.d(1),u=h(c),u&&(u.c(),u.m(t,null)))},i:Q,o:Q,d(c){c&&w(e),u.d()}}}function Lo(n,e,t){let l,o;ne(n,ie,f=>t(3,l=f)),ne(n,j,f=>t(0,o=f));function a(f){let h=parseInt(f.split(",")[0]),u=parseInt(f.split(",")[1]);Y(ie,l.x=h,l),Y(ie,l.y=u,l),Y(ie,l.visible=!0,l)}return[o,a,f=>{a(f.plot)}]}class Nl extends Be{constructor(e){super(),Te(this,e,Lo,So,Ae,{})}}const qo={0:"Easy",1:"Normal",2:"Hard"};function gl(n){let e,t,l,o=n[3].short_title+"",a,s,f,h,u,c,m,g,I,v,C,O,M,P=n[0].endGoal=="land"&&vl(n);return{c(){e=p("div"),t=p("div"),l=b("HOW TO PLAY ("),a=b(o),s=b(`)
			`),f=p("br"),h=y(),u=p("hr"),c=y(),P&&P.c(),m=y(),g=p("br"),I=y(),v=p("hr"),C=y(),O=p("br"),M=b(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m($,E){k($,e,E),i(e,t),i(t,l),i(t,a),i(t,s),i(t,f),i(t,h),i(t,u),i(t,c),P&&P.m(t,null),i(t,m),i(t,g),i(t,I),i(t,v),i(t,C),i(t,O),i(t,M)},p($,E){$[0].endGoal=="land"?P?P.p($,E):(P=vl($),P.c(),P.m(t,m)):P&&(P.d(1),P=null)},d($){$&&w(e),P&&P.d()}}}function vl(n){let e=n[3].description_title+"",t,l,o,a,s,f,h,u,c,m,g,I,v,C,O=JSON.stringify(n[3].requirements[n[0].difficulty].population_count)+"",M,P,$,E,T,r,_=JSON.stringify(n[3].requirements[n[0].difficulty].happiness)+"",L,q,A,X,S,K,J=JSON.stringify(n[3].requirements[n[0].difficulty].health)+"",U,fe,te,D,H,x,z=JSON.stringify(n[3].requirements[n[0].difficulty].employment*100)+"",oe,he;return{c(){t=b(e),l=y(),o=p("br"),a=y(),s=p("br"),f=b(`
				With your difficulty (`),h=b(n[4]),u=b(`), you must also have:
				`),c=p("br"),m=y(),g=p("br"),I=y(),v=p("li"),C=b("Population: "),M=b(O),P=y(),$=p("br"),E=y(),T=p("li"),r=b("Happiness: "),L=b(_),q=y(),A=p("br"),X=y(),S=p("li"),K=b("Health: "),U=b(J),fe=y(),te=p("br"),D=y(),H=p("li"),x=b("Employment at "),oe=b(z),he=b("%")},m(F,N){k(F,t,N),k(F,l,N),k(F,o,N),k(F,a,N),k(F,s,N),k(F,f,N),k(F,h,N),k(F,u,N),k(F,c,N),k(F,m,N),k(F,g,N),k(F,I,N),k(F,v,N),i(v,C),i(v,M),k(F,P,N),k(F,$,N),k(F,E,N),k(F,T,N),i(T,r),i(T,L),k(F,q,N),k(F,A,N),k(F,X,N),k(F,S,N),i(S,K),i(S,U),k(F,fe,N),k(F,te,N),k(F,D,N),k(F,H,N),i(H,x),i(H,oe),i(H,he)},p(F,N){N&1&&O!==(O=JSON.stringify(F[3].requirements[F[0].difficulty].population_count)+"")&&G(M,O),N&1&&_!==(_=JSON.stringify(F[3].requirements[F[0].difficulty].happiness)+"")&&G(L,_),N&1&&J!==(J=JSON.stringify(F[3].requirements[F[0].difficulty].health)+"")&&G(U,J),N&1&&z!==(z=JSON.stringify(F[3].requirements[F[0].difficulty].employment*100)+"")&&G(oe,z)},d(F){F&&(w(t),w(l),w(o),w(a),w(s),w(f),w(h),w(u),w(c),w(m),w(g),w(I),w(v),w(P),w($),w(E),w(T),w(q),w(A),w(X),w(S),w(fe),w(te),w(D),w(H))}}}function Ao(n){let e,t=n[2]&&n[0]!=null&&n[1]&&gl(n);return{c(){t&&t.c(),e=xe()},m(l,o){t&&t.m(l,o),k(l,e,o)},p(l,[o]){l[2]&&l[0]!=null&&l[1]?t?t.p(l,o):(t=gl(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Q,o:Q,d(l){l&&w(e),t&&t.d(l)}}}function $o(n,e,t){let l;ne(n,j,u=>t(0,l=u));let o=!0;const s=bt[l.endGoal],f=qo[l.difficulty]||0;let h=!1;return n.$$.update=()=>{n.$$.dirty&1&&(l?t(2,h=!0):t(2,h=!1))},[l,o,h,s,f]}class Po extends Be{constructor(e){super(),Te(this,e,$o,Ao,Ae,{})}}function bl(n){let e,t=n[1].townLog+"",l,o,a;return{c(){e=p("div"),l=b(t),d(e,"class","townLog message")},m(s,f){k(s,e,f),i(e,l),o||(a=Z(e,"click",n[12]),o=!0)},p(s,f){f&2&&t!==(t=s[1].townLog+"")&&G(l,t)},d(s){s&&w(e),o=!1,a()}}}function yl(n){let e,t,l=n[1].townInfo.population_count-n[1].townInfo.employees+"",o,a;return{c(){e=p("span"),t=b("("),o=b(l),a=b(" unemployed)"),d(e,"class","text_ss gray")},m(s,f){k(s,e,f),i(e,t),i(e,o),i(e,a)},p(s,f){f&2&&l!==(l=s[1].townInfo.population_count-s[1].townInfo.employees+"")&&G(o,l)},d(s){s&&w(e)}}}function Oo(n){let e,t,l=n[1].economyAndLaws.last_month_profit+"",o,a;return{c(){e=p("span"),t=b("("),o=b(l),a=b(")"),d(e,"class","text_s red")},m(s,f){k(s,e,f),i(e,t),i(e,o),i(e,a)},p(s,f){f&2&&l!==(l=s[1].economyAndLaws.last_month_profit+"")&&G(o,l)},d(s){s&&w(e)}}}function Co(n){let e,t,l=n[1].economyAndLaws.last_month_profit+"",o,a;return{c(){e=p("span"),t=b("(+"),o=b(l),a=b(")"),d(e,"class","text_s green")},m(s,f){k(s,e,f),i(e,t),i(e,o),i(e,a)},p(s,f){f&2&&l!==(l=s[1].economyAndLaws.last_month_profit+"")&&G(o,l)},d(s){s&&w(e)}}}function Mo(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=p("span"),l=b(t),d(e,"class","red")},m(o,a){k(o,e,a),i(e,l)},p(o,a){a&2&&t!==(t=o[1].townInfo.happiness+"")&&G(l,t)},d(o){o&&w(e)}}}function No(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=p("span"),l=b(t),d(e,"class","green")},m(o,a){k(o,e,a),i(e,l)},p(o,a){a&2&&t!==(t=o[1].townInfo.happiness+"")&&G(l,t)},d(o){o&&w(e)}}}function Eo(n){let e;return{c(){e=p("span"),e.textContent="ðŸ‘Ž"},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function To(n){let e;return{c(){e=p("span"),e.textContent="ðŸ‘"},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Bo(n){let e;return{c(){e=p("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Go(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=p("span"),l=b(t),d(e,"class","red")},m(o,a){k(o,e,a),i(e,l)},p(o,a){a&2&&t!==(t=o[1].townInfo.health+"")&&G(l,t)},d(o){o&&w(e)}}}function Fo(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=p("span"),l=b(t),d(e,"class","green")},m(o,a){k(o,e,a),i(e,l)},p(o,a){a&2&&t!==(t=o[1].townInfo.health+"")&&G(l,t)},d(o){o&&w(e)}}}function wl(n){let e;return{c(){e=p("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Ro(n){let e;return{c(){e=b("How to play")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Do(n){let e;return{c(){e=b("Close")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function kl(n){let e,t;return e=new Po({}),{c(){Me(e.$$.fragment)},m(l,o){Pe(e,l,o),t=!0},i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function Il(n){let e,t;return e=new Nl({}),{c(){Me(e.$$.fragment)},m(l,o){Pe(e,l,o),t=!0},i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function Uo(n){let e,t,l,o=n[1].townInfo.name+"",a,s,f,h,u,c,m,g,I,v,C,O,M,P,$,E,T,r,_,L,q,A=n[1].townInfo.population_count+"",X,S,K=n[1].townInfo.population_max+"",J,U,fe,te,D,H,x=n[1].townInfo.employees+"",z,oe,he=n[1].townInfo.population_count+"",F,N,ee,ge,ze,re,ue,de,pe,et=n[1].townInfo.knowledge_points+"",Ye,Se,Ge,je,Le,le,ve=n[1].townInfo.gold+"",se,rn,fn,un,pn,tt,$t,cn,It,dn,Pt=n[1].townInfo.gold_from_tourism+"",Ht,_n,at,Ot,mn,Fe,jt,rt,hn,Ct=He(n[1].modifiers.happiness,2)+"",Vt,gn,vn,bn,ft,Mt,yn,Re,Yt,ut,wn,Nt=He(n[1].modifiers.health,2)+"",Wt,kn,In,Sn,nt,lt,Ln,qn,An,$n,We,Et,Pn,Ce,On,Ke,pt,Cn,ct,Tt=(n[1].economyAndLaws.tax_rate*100).toFixed(0)+"",Kt,Mn,Nn,dt,Xt,St,Lt,ce,Qt,En,be=n[1].townLog.length>0&&bl(n),ye=n[1].townInfo.population_count-n[1].townInfo.employees>0&&yl(n);function Tn(B,V){if(B[1].economyAndLaws.last_month_profit>=0)return Co;if(B[1].economyAndLaws.last_month_profit<0)return Oo}let _t=Tn(n),we=_t&&_t(n);function Bn(B,V){return B[1].townInfo.happiness>=50?No:Mo}let Bt=Bn(n),De=Bt(n);function Gn(B,V){if(B[1].townInfo.happiness>=300)return Bo;if(B[1].townInfo.happiness>=150)return To;if(B[1].townInfo.happiness<150)return Eo}let mt=Gn(n),$e=mt&&mt(n);function Fn(B,V){return B[1].townInfo.health>=50?Fo:Go}let Gt=Fn(n),Ue=Gt(n),qe=n[1].townInfo.health>=300&&wl();function Rn(B,V){return B[5]?Do:Ro}let Ft=Rn(n),Xe=Ft(n),_e=n[5]&&kl(),me=n[6]&&Il();return{c(){e=p("div"),t=p("div"),l=p("div"),a=b(o),s=y(),f=p("div"),f.textContent="double click to change name",h=y(),u=p("div"),c=p("span"),c.textContent="âª",m=y(),g=p("span"),g.textContent="â©",I=y(),v=b(n[0]),C=b("x - year "),O=b(n[2]),M=b(" day "),P=b(n[3]),$=y(),be&&be.c(),E=y(),T=p("div"),r=p("div"),_=p("div"),_.textContent="ðŸ‘ª Population",L=y(),q=p("div"),X=b(A),S=b("/"),J=b(K),U=y(),fe=p("div"),te=p("div"),te.textContent="ðŸ§‘â€ðŸŒ¾ Employees",D=y(),H=p("div"),z=b(x),oe=b("/"),F=b(he),N=y(),ee=p("br"),ge=y(),ye&&ye.c(),ze=y(),re=p("div"),ue=p("div"),ue.textContent="ðŸ§  Knowledge",de=y(),pe=p("div"),Ye=b(et),Se=y(),Ge=p("div"),je=p("div"),je.textContent="ðŸ’° Gold",Le=y(),le=p("div"),se=b(ve),rn=y(),fn=p("br"),un=y(),we&&we.c(),pn=y(),tt=p("div"),$t=p("div"),$t.textContent="ðŸ’° Tourism Gold",cn=y(),It=p("div"),dn=b("$"),Ht=b(Pt),_n=y(),at=p("div"),Ot=p("div"),Ot.textContent="ðŸ˜ Happiness",mn=y(),Fe=p("div"),De.c(),jt=y(),rt=p("span"),hn=b("("),Vt=b(Ct),gn=b(")"),vn=y(),$e&&$e.c(),bn=y(),ft=p("div"),Mt=p("div"),Mt.textContent="ðŸ¥ Health",yn=y(),Re=p("div"),Ue.c(),Yt=y(),ut=p("span"),wn=b("("),Wt=b(Nt),kn=b(")"),In=y(),qe&&qe.c(),Sn=y(),nt=p("div"),lt=p("div"),Ln=b("ðŸ† "),Xe.c(),qn=y(),An=p("br"),$n=y(),We=p("div"),Et=p("div"),Et.textContent="Tax rate (more tax = less happiness)",Pn=y(),Ce=p("input"),On=y(),Ke=p("div"),pt=p("button"),pt.textContent="-",Cn=y(),ct=p("div"),Kt=b(Tt),Mn=b("%"),Nn=y(),dt=p("button"),dt.textContent="+",Xt=y(),_e&&_e.c(),St=y(),me&&me.c(),Lt=xe(),d(l,"class","heading_l"),d(f,"class","subheading_m svelte-vu26gz"),d(t,"class","header__left svelte-vu26gz"),d(_,"class","subheading_m svelte-vu26gz"),d(q,"class","text_m svelte-vu26gz"),d(r,"class","svelte-vu26gz"),d(te,"class","subheading_m svelte-vu26gz"),d(H,"class","text_m svelte-vu26gz"),d(fe,"class","svelte-vu26gz"),d(ue,"class","subheading_m svelte-vu26gz"),d(pe,"class","text_m svelte-vu26gz"),d(re,"class","svelte-vu26gz"),d(je,"class","subheading_m svelte-vu26gz"),d(le,"class","text_m svelte-vu26gz"),d(Ge,"class","svelte-vu26gz"),d($t,"class","subheading_m svelte-vu26gz"),d(It,"class","text_m svelte-vu26gz"),d(tt,"class","svelte-vu26gz"),d(Ot,"class","subheading_m svelte-vu26gz"),d(rt,"class","text_ss gray"),d(Fe,"class","text_m svelte-vu26gz"),d(at,"class","svelte-vu26gz"),d(Mt,"class","subheading_m svelte-vu26gz"),d(ut,"class","text_ss gray"),d(Re,"class","text_m svelte-vu26gz"),d(ft,"class","svelte-vu26gz"),d(T,"class","header__right svelte-vu26gz"),d(lt,"class","text_m pointer"),d(Et,"class","subheading_m svelte-vu26gz"),d(Ce,"type","range"),d(Ce,"min","0"),d(Ce,"max","1"),d(Ce,"step","0.01"),d(ct,"class","text_m"),d(Ke,"class","incrementalButtons svelte-vu26gz"),d(We,"class","taxInfo svelte-vu26gz"),d(e,"class","header noselect svelte-vu26gz")},m(B,V){k(B,e,V),i(e,t),i(t,l),i(l,a),i(t,s),i(t,f),i(t,h),i(t,u),i(u,c),i(u,m),i(u,g),i(u,I),i(u,v),i(u,C),i(u,O),i(u,M),i(u,P),i(t,$),be&&be.m(t,null),i(e,E),i(e,T),i(T,r),i(r,_),i(r,L),i(r,q),i(q,X),i(q,S),i(q,J),i(T,U),i(T,fe),i(fe,te),i(fe,D),i(fe,H),i(H,z),i(H,oe),i(H,F),i(H,N),i(H,ee),i(H,ge),ye&&ye.m(H,null),i(T,ze),i(T,re),i(re,ue),i(re,de),i(re,pe),i(pe,Ye),i(T,Se),i(T,Ge),i(Ge,je),i(Ge,Le),i(Ge,le),i(le,se),i(le,rn),i(le,fn),i(le,un),we&&we.m(le,null),i(T,pn),i(T,tt),i(tt,$t),i(tt,cn),i(tt,It),i(It,dn),i(It,Ht),i(T,_n),i(T,at),i(at,Ot),i(at,mn),i(at,Fe),De.m(Fe,null),i(Fe,jt),i(Fe,rt),i(rt,hn),i(rt,Vt),i(rt,gn),i(Fe,vn),$e&&$e.m(Fe,null),i(T,bn),i(T,ft),i(ft,Mt),i(ft,yn),i(ft,Re),Ue.m(Re,null),i(Re,Yt),i(Re,ut),i(ut,wn),i(ut,Wt),i(ut,kn),i(Re,In),qe&&qe.m(Re,null),i(e,Sn),i(e,nt),i(nt,lt),i(lt,Ln),Xe.m(lt,null),i(nt,qn),i(nt,An),i(nt,$n),i(nt,We),i(We,Et),i(We,Pn),i(We,Ce),ot(Ce,n[1].economyAndLaws.tax_rate),i(We,On),i(We,Ke),i(Ke,pt),i(Ke,Cn),i(Ke,ct),i(ct,Kt),i(ct,Mn),i(Ke,Nn),i(Ke,dt),k(B,Xt,V),_e&&_e.m(B,V),k(B,St,V),me&&me.m(B,V),k(B,Lt,V),ce=!0,Qt||(En=[Z(l,"dblclick",n[7]),Z(c,"click",n[8]),Z(g,"click",n[9]),Z(Ge,"click",n[13]),Z(tt,"click",n[14]),Z(lt,"click",n[15]),Z(Ce,"change",n[16]),Z(Ce,"input",n[16]),Z(Ce,"change",n[10]),Z(pt,"mousedown",n[17]),Z(pt,"mouseup",n[18]),Z(pt,"click",n[19]),Z(ct,"dblclick",n[20]),Z(dt,"mousedown",n[21]),Z(dt,"mouseup",n[22]),Z(dt,"click",n[23])],Qt=!0)},p(B,[V]){(!ce||V&2)&&o!==(o=B[1].townInfo.name+"")&&G(a,o),(!ce||V&1)&&G(v,B[0]),(!ce||V&4)&&G(O,B[2]),(!ce||V&8)&&G(P,B[3]),B[1].townLog.length>0?be?be.p(B,V):(be=bl(B),be.c(),be.m(t,null)):be&&(be.d(1),be=null),(!ce||V&2)&&A!==(A=B[1].townInfo.population_count+"")&&G(X,A),(!ce||V&2)&&K!==(K=B[1].townInfo.population_max+"")&&G(J,K),(!ce||V&2)&&x!==(x=B[1].townInfo.employees+"")&&G(z,x),(!ce||V&2)&&he!==(he=B[1].townInfo.population_count+"")&&G(F,he),B[1].townInfo.population_count-B[1].townInfo.employees>0?ye?ye.p(B,V):(ye=yl(B),ye.c(),ye.m(H,null)):ye&&(ye.d(1),ye=null),(!ce||V&2)&&et!==(et=B[1].townInfo.knowledge_points+"")&&G(Ye,et),(!ce||V&2)&&ve!==(ve=B[1].townInfo.gold+"")&&G(se,ve),_t===(_t=Tn(B))&&we?we.p(B,V):(we&&we.d(1),we=_t&&_t(B),we&&(we.c(),we.m(le,null))),(!ce||V&2)&&Pt!==(Pt=B[1].townInfo.gold_from_tourism+"")&&G(Ht,Pt),Bt===(Bt=Bn(B))&&De?De.p(B,V):(De.d(1),De=Bt(B),De&&(De.c(),De.m(Fe,jt))),(!ce||V&2)&&Ct!==(Ct=He(B[1].modifiers.happiness,2)+"")&&G(Vt,Ct),mt!==(mt=Gn(B))&&($e&&$e.d(1),$e=mt&&mt(B),$e&&($e.c(),$e.m(Fe,null))),Gt===(Gt=Fn(B))&&Ue?Ue.p(B,V):(Ue.d(1),Ue=Gt(B),Ue&&(Ue.c(),Ue.m(Re,Yt))),(!ce||V&2)&&Nt!==(Nt=He(B[1].modifiers.health,2)+"")&&G(Wt,Nt),B[1].townInfo.health>=300?qe||(qe=wl(),qe.c(),qe.m(Re,null)):qe&&(qe.d(1),qe=null),Ft!==(Ft=Rn(B))&&(Xe.d(1),Xe=Ft(B),Xe&&(Xe.c(),Xe.m(lt,null))),V&2&&ot(Ce,B[1].economyAndLaws.tax_rate),(!ce||V&2)&&Tt!==(Tt=(B[1].economyAndLaws.tax_rate*100).toFixed(0)+"")&&G(Kt,Tt),B[5]?_e?V&32&&R(_e,1):(_e=kl(),_e.c(),R(_e,1),_e.m(St.parentNode,St)):_e&&(Ne(),W(_e,1,1,()=>{_e=null}),Ee()),B[6]?me?V&64&&R(me,1):(me=Il(),me.c(),R(me,1),me.m(Lt.parentNode,Lt)):me&&(Ne(),W(me,1,1,()=>{me=null}),Ee())},i(B){ce||(R(_e),R(me),ce=!0)},o(B){W(_e),W(me),ce=!1},d(B){B&&(w(e),w(Xt),w(St),w(Lt)),be&&be.d(),ye&&ye.d(),we&&we.d(),De.d(),$e&&$e.d(),Ue.d(),qe&&qe.d(),Xe.d(),_e&&_e.d(B),me&&me.d(B),Qt=!1,Ve(En)}}}function He(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Jo(n,e,t){let l,o,a;ne(n,j,S=>t(1,l=S)),ne(n,Dt,S=>t(24,o=S)),ne(n,nn,S=>t(6,a=S));let s=Math.floor(l.environment.day/365)+1,f=l.environment.day%365;function h(){let S=prompt("Enter a new name for your town (under 200 chars)");if(S&&S.length<200){let K=l;K.townInfo.name=S,j.set(K),localStorage.setItem(Ie,JSON.stringify(K))}}let{speedMultiplier:u=1}=e;function c(){let S=o;S=S*2,S>=8e3&&(S=8e3),Y(Dt,o=S,o),t(0,u=2e3/o)}function m(){let S=o;S=S/2,S<=250&&(S=250),Y(Dt,o=S,o),t(0,u=2e3/o)}function g(S){let K=l;K.economyAndLaws.tax_rate=He(S.target.value,2),j.set(K),localStorage.setItem(Ie,JSON.stringify(K))}function I(){let S=l;S.hasABank===!0?(S.townInfo.gold+=S.townInfo.gold_from_tourism,S.townInfo.gold_from_tourism=0,j.set(S),localStorage.setItem(Ie,JSON.stringify(S))):alert("You need a bank to transfer funds from tourism activities.")}document.addEventListener("keydown",S=>{switch(S.key.toLowerCase()){case"1":S.preventDefault(),c();break;case"2":S.preventDefault(),m();break}});let v,C=!1;const O=()=>{Y(j,l.townLog="",l)},M=()=>{let S=a;S=!S,nn.set(S)},P=()=>{I()},$=()=>t(5,C=!C);function E(){l.economyAndLaws.tax_rate=Fl(this.value),j.set(l)}const T=()=>{t(4,v=setInterval(()=>{let S=l;S.economyAndLaws.tax_rate=He(S.economyAndLaws.tax_rate-.01,2),j.set(S),localStorage.setItem(Ie,JSON.stringify(S))},100))},r=()=>{clearInterval(v)},_=()=>{let S=l;S.economyAndLaws.tax_rate=He(S.economyAndLaws.tax_rate-.01,2)},L=()=>{let S=parseFloat(prompt("Set a new tax rate (0-1)"));if(S&&S>=0&&S<=1){let K=l;K.economyAndLaws.tax_rate=He(S,2),j.set(K),localStorage.setItem(Ie,JSON.stringify(K))}},q=()=>{t(4,v=setInterval(()=>{let S=l;S.economyAndLaws.tax_rate=He(S.economyAndLaws.tax_rate+.01,2),j.set(S),localStorage.setItem(Ie,JSON.stringify(S))},100))},A=()=>{clearInterval(v)},X=()=>{let S=l;S.economyAndLaws.tax_rate=He(S.economyAndLaws.tax_rate+.01,2),j.set(S),localStorage.setItem(Ie,JSON.stringify(S))};return n.$$set=S=>{"speedMultiplier"in S&&t(0,u=S.speedMultiplier)},n.$$.update=()=>{n.$$.dirty&2&&(t(2,s=Math.floor(l.environment.day/365)+1),t(3,f=l.environment.day%365))},[u,l,s,f,v,C,a,h,c,m,g,I,O,M,P,$,E,T,r,_,L,q,A,X]}class Ho extends Be{constructor(e){super(),Te(this,e,Jo,Uo,Ae,{speedMultiplier:0})}}function jo(n){let e,t,l,o,a,s,f,h,u,c,m,g,I,v,C,O,M,P,$;return{c(){e=p("div"),t=p("div"),l=b(`The game is paused!
		`),o=p("br"),a=b(`
		Load file:
		`),s=p("input"),f=y(),h=p("br"),u=b(`
		Backup save:
		`),c=p("button"),c.textContent="Save",m=y(),g=p("br"),I=b(`
		Unpause the game by pressing P
		`),v=p("br"),C=y(),O=p("br"),M=b(`
		Reset the game by pressing SHIFT+ESC`),d(s,"type","file"),d(s,"id","upload"),d(c,"id","save"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(E,T){k(E,e,T),i(e,t),i(t,l),i(t,o),i(t,a),i(t,s),i(t,f),i(t,h),i(t,u),i(t,c),i(t,m),i(t,g),i(t,I),i(t,v),i(t,C),i(t,O),i(t,M),P||($=[Z(s,"change",n[1]),Z(c,"click",n[0])],P=!0)},p:Q,i:Q,o:Q,d(E){E&&w(e),P=!1,Ve($)}}}function Vo(n){const e=JSON.parse(n);return e.townInfo!=null&&e.difficulty!=null}function Yo(n,e,t){let l;ne(n,j,s=>t(2,l=s));function o(){const s=JSON.stringify(l),f=new Blob([s],{type:"text/plain"}),h=URL.createObjectURL(f),u=document.createElement("a");u.href=h,u.download=`${new Date().toISOString()}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(h)}function a(){const f=document.getElementById("upload").files;if(f==null)return;const h=f[0],u=new FileReader;u.onload=function(c){if(c.target==null)return;const m=c.target.result;if(typeof m=="string"){if(!Vo(m)){alert("Invalid game file");return}an(JSON.parse(m))}else alert("Invalid game file: is not String.")},u.readAsText(h)}return[o,a]}class Wo extends Be{constructor(e){super(),Te(this,e,Yo,jo,Ae,{})}}function Sl(n){let e,t,l,o,a,s=n[0].endGameDetails.msg+"",f,h,u,c,m,g;return{c(){e=p("div"),t=p("div"),l=b(`GAME OVER
			`),o=p("br"),a=y(),f=b(s),h=y(),u=p("br"),c=y(),m=p("br"),g=b(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(I,v){k(I,e,v),i(e,t),i(t,l),i(t,o),i(t,a),i(t,f),i(t,h),i(t,u),i(t,c),i(t,m),i(t,g)},p(I,v){v&1&&s!==(s=I[0].endGameDetails.msg+"")&&G(f,s)},d(I){I&&w(e)}}}function Ko(n){let e,t=n[0].endGameDetails!=null&&Sl(n);return{c(){t&&t.c(),e=xe()},m(l,o){t&&t.m(l,o),k(l,e,o)},p(l,[o]){l[0].endGameDetails!=null?t?t.p(l,o):(t=Sl(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Q,o:Q,d(l){l&&w(e),t&&t.d(l)}}}function Xo(n,e,t){let l;return ne(n,j,o=>t(0,l=o)),[l]}class Qo extends Be{constructor(e){super(),Te(this,e,Xo,Ko,Ae,{})}}function Zo(n){let e,t,l,o,a,s,f,h,u,c,m,g,I,v,C,O,M,P,$,E,T;return{c(){e=p("div"),t=p("div"),l=b(`Welcome to Plots!
		`),o=p("br"),a=b(`
		Select a difficulty
		`),s=p("select"),f=p("option"),f.textContent="Easy (quick game)",h=p("option"),h.textContent="Normal (longer game)",u=p("option"),u.textContent="Hard (longest game)",c=y(),m=p("br"),g=b(`
		Select a goal
		`),I=p("select"),v=p("option"),v.textContent="Fill up the grid",C=p("option"),C.textContent="Rule the world through politics",O=y(),M=p("br"),P=y(),$=p("button"),$.textContent="Start game",f.__value="0",ot(f,f.__value),h.__value="1",ot(h,h.__value),h.selected=!0,u.__value="2",ot(u,u.__value),d(s,"id","difficulty"),v.__value="land",ot(v,v.__value),v.selected=!0,C.__value="political",ot(C,C.__value),d(I,"id","endGoal"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(r,_){k(r,e,_),i(e,t),i(t,l),i(t,o),i(t,a),i(t,s),i(s,f),i(s,h),i(s,u),i(t,c),i(t,m),i(t,g),i(t,I),i(I,v),i(I,C),i(t,O),i(t,M),i(t,P),i(t,$),E||(T=Z($,"click",n[0]),E=!0)},p:Q,i:Q,o:Q,d(r){r&&w(e),E=!1,T()}}}function xo(n){function e(){const t=document.getElementById("difficulty").value,l=document.getElementById("endGoal").value;Xl(t,l)}return[e]}class zo extends Be{constructor(e){super(),Te(this,e,xo,Zo,Ae,{})}}function Ll(n){let e,t,l,o;const a=[ti,ei],s=[];function f(h,u){return h[0]==null?0:1}return e=f(n),t=s[e]=a[e](n),{c(){t.c(),l=xe()},m(h,u){s[e].m(h,u),k(h,l,u),o=!0},p(h,u){let c=e;e=f(h),e===c?s[e].p(h,u):(Ne(),W(s[c],1,1,()=>{s[c]=null}),Ee(),t=s[e],t?t.p(h,u):(t=s[e]=a[e](h),t.c()),R(t,1),t.m(l.parentNode,l))},i(h){o||(R(t),o=!0)},o(h){W(t),o=!1},d(h){h&&w(l),s[e].d(h)}}}function ei(n){let e,t,l,o,a,s,f,h,u,c,m,g,I,v,C,O,M=n[2]==!0&&ql(),P=n[3]==!0&&Al();return l=new Ho({}),a=new wo({}),f=new Qo({}),c=new mo({}),{c(){M&&M.c(),e=y(),P&&P.c(),t=y(),Me(l.$$.fragment),o=y(),Me(a.$$.fragment),s=y(),Me(f.$$.fragment),h=y(),u=p("div"),Me(c.$$.fragment),m=y(),g=p("br"),I=b(`
			outside of city`),v=y(),C=p("style"),C.textContent=`.plot_grid {
				max-width: 300%;
				max-height: 300%;
				overflow-x: scroll;
				overflow-y: scroll;
				width: 300%;
				height: 300vh;
				margin-top: 175px;
			}
			.plot_grid[data-marginRight='true'] {
				/* This is for when the balanceSheet is being shown. */
				margin-right: 224px;
			}`,d(u,"class","plot_grid"),d(u,"data-marginright",n[3])},m($,E){M&&M.m($,E),k($,e,E),P&&P.m($,E),k($,t,E),Pe(l,$,E),k($,o,E),Pe(a,$,E),k($,s,E),Pe(f,$,E),k($,h,E),k($,u,E),Pe(c,u,null),i(u,m),i(u,g),i(u,I),k($,v,E),k($,C,E),O=!0},p($,E){$[2]==!0?M?E&4&&R(M,1):(M=ql(),M.c(),R(M,1),M.m(e.parentNode,e)):M&&(Ne(),W(M,1,1,()=>{M=null}),Ee()),$[3]==!0?P?E&8&&R(P,1):(P=Al(),P.c(),R(P,1),P.m(t.parentNode,t)):P&&(Ne(),W(P,1,1,()=>{P=null}),Ee()),(!O||E&8)&&d(u,"data-marginright",$[3])},i($){O||(R(M),R(P),R(l.$$.fragment,$),R(a.$$.fragment,$),R(f.$$.fragment,$),R(c.$$.fragment,$),O=!0)},o($){W(M),W(P),W(l.$$.fragment,$),W(a.$$.fragment,$),W(f.$$.fragment,$),W(c.$$.fragment,$),O=!1},d($){$&&(w(e),w(t),w(o),w(s),w(h),w(u),w(v),w(C)),M&&M.d($),P&&P.d($),Oe(l,$),Oe(a,$),Oe(f,$),Oe(c)}}}function ti(n){let e,t;return e=new zo({}),{c(){Me(e.$$.fragment)},m(l,o){Pe(e,l,o),t=!0},p:Q,i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function ql(n){let e,t;return e=new Wo({}),{c(){Me(e.$$.fragment)},m(l,o){Pe(e,l,o),t=!0},i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function Al(n){let e,t;return e=new Nl({}),{c(){Me(e.$$.fragment)},m(l,o){Pe(e,l,o),t=!0},i(l){t||(R(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function ni(n){let e,t,l=(n[1]||n[0]==null)&&Ll(n);return{c(){l&&l.c(),e=xe()},m(o,a){l&&l.m(o,a),k(o,e,a),t=!0},p(o,[a]){o[1]||o[0]==null?l?(l.p(o,a),a&3&&R(l,1)):(l=Ll(o),l.c(),R(l,1),l.m(e.parentNode,e)):l&&(Ne(),W(l,1,1,()=>{l=null}),Ee())},i(o){t||(R(l),t=!0)},o(o){W(l),t=!1},d(o){o&&w(e),l&&l.d(o)}}}function li(n,e,t){let l,o,a,s,f;ne(n,kt,g=>t(6,l=g)),ne(n,ie,g=>t(7,o=g)),ne(n,yt,g=>t(2,a=g)),ne(n,j,g=>t(0,s=g)),ne(n,nn,g=>t(3,f=g));let h=!1,u=!1;document.addEventListener("keydown",g=>{if((document.activeElement!=null&&document.activeElement.nodeName==="INPUT"||document.activeElement!=null&&document.activeElement.nodeName=="TEXTAREA")&&g.key!=="Escape")return;switch(g.key.toLowerCase()){case"p":a==!0?yt.set(!1):(yt.set(!0),Y(ie,o.visible=!1,o));break;case"escape":g.shiftKey?(Y(yt,a=!0,a),localStorage.setItem("reset","true"),location.reload(),an()):o.visible==!0&&Y(ie,o.visible=!1,o);break;case"arrowleft":case"a":g.preventDefault(),c(0,-1,"up");break;case"arrowright":case"d":g.preventDefault(),c(0,1,"down");break;case"arrowup":case"w":g.preventDefault(),c(-1,0,"left");break;case"arrowdown":case"s":g.preventDefault(),c(1,0,"right");break}});function c(g,I,v){if(o.visible===!1&&o.x===0&&o.y===0)m(0,0,v);else{let C=o.x,O=o.y;C+g<0?C=0:C+g>s.plots.length?C=s.plots.length:C+=g,O+I<0?O=0:O+I>s.plots.length?O=s.plots.length:O+=I,m(C,O,v)}}function m(g,I,v){if(u==!0)switch(v){case"up":I-=2;break;case"down":I+=1;break;case"left":g-=2;break;case"right":g+=1;break}g<0?g=0:g>s.plots.length&&(g=s.plots.length),I<0?I=0:I>s.plots.length&&(I=s.plots.length);let C=document.querySelectorAll(".plot_container"),O;if(C.forEach(M=>{M.dataset.x=="$x"&&M.dataset.y=="$y"&&(O=M)}),a==!1){if(O.dataset.canBeUpgraded==="true"?Y(ie,o.visible=!0,o):Y(ie,o.visible=!1,o),O.dataset.refPlotX!==void 0&&O.dataset.refPlotY!=""?(u=!0,C.forEach(M=>{M.dataset.x==O.dataset.refPlotX&&M.dataset.y==O.dataset.refPlotY&&(O=M,g=parseInt(O.dataset.x),I=parseInt(O.dataset.y))})):u=!1,O.dataset.size!=="1"&&O.dataset.size!==void 0&&(u=!0),Y(ie,o.x=g,o),Y(ie,o.y=I,o),C.forEach(M=>{M.classList.remove("selected"),M.style.border="none",M.style.fontWeight=""}),O.classList.add("selected"),u){let M="4px solid #00800045";O.classList.remove("selected"),O.style.borderTop=M,O.style.borderLeft=M,O.style.fontWeight="600",C.forEach(P=>{const $=parseInt(`${P.dataset.x}`),E=parseInt(`${P.dataset.y}`);$==g+1&&E==I&&(P.style.borderLeft=M,P.style.borderBottom=M),$==g&&E==I+1&&(P.style.borderTop=M,P.style.borderRight=M),$==g+1&&E==I+1&&(P.style.borderBottom=M,P.style.borderRight=M)})}O.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),Y(kt,l={},l)}}return n.$$.update=()=>{n.$$.dirty&1&&(s?t(1,h=!0):t(1,h=!1))},[s,h,a,f,m]}class oi extends Be{constructor(e){super(),Te(this,e,li,ni,Ae,{openPlotMenu:4})}get openPlotMenu(){return this.$$.ctx[4]}}new oi({target:document.getElementById("app")});
