(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();function Z(){}function Ln(n){return n()}function Bl(){return Object.create(null)}function Ze(n){n.forEach(Ln)}function Mn(n){return typeof n=="function"}function Pe(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function Cn(n){return Object.keys(n).length===0}function On(n,...e){if(n==null)return Z;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function ee(n,e,t){n.$$.on_destroy.push(On(e,t))}function V(n,e,t){return n.set(t),e}function a(n,e){n.appendChild(e)}function k(n,e,t){n.insertBefore(e,t||null)}function w(n){n.parentNode.removeChild(n)}function ll(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function c(n){return document.createElement(n)}function v(n){return document.createTextNode(n)}function y(){return v(" ")}function xe(){return v("")}function x(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function d(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Nn(n){return n===""?null:+n}function Tn(n){return Array.from(n.childNodes)}function D(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function Gl(n,e){n.value=e==null?"":e}let It;function kt(n){It=n}function En(){if(!It)throw new Error("Function called outside component initialization");return It}function Ft(n){En().$$.on_mount.push(n)}const wt=[],Qt=[],Bt=[],Dl=[],qn=Promise.resolve();let Zt=!1;function Pn(){Zt||(Zt=!0,qn.then(An))}function Bn(){return Pn(),qn}function xt(n){Bt.push(n)}const Xt=new Set;let Et=0;function An(){const n=It;do{for(;Et<wt.length;){const e=wt[Et];Et++,kt(e),Gn(e.$$)}for(kt(null),wt.length=0,Et=0;Qt.length;)Qt.pop()();for(let e=0;e<Bt.length;e+=1){const t=Bt[e];Xt.has(t)||(Xt.add(t),t())}Bt.length=0}while(wt.length);for(;Dl.length;)Dl.pop()();Zt=!1,Xt.clear(),kt(n)}function Gn(n){if(n.fragment!==null){n.update(),Ze(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(xt)}}const Gt=new Set;let ot;function Te(){ot={r:0,c:[],p:ot}}function Ee(){ot.r||Ze(ot.c),ot=ot.p}function F(n,e){n&&n.i&&(Gt.delete(n),n.i(e))}function K(n,e,t,l){if(n&&n.o){if(Gt.has(n))return;Gt.add(n),ot.c.push(()=>{Gt.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function Dn(n,e){n.d(1),e.delete(n.key)}function Fn(n,e,t,l,o,r,i,f,_,u,p,m){let g=n.length,S=r.length,b=g;const $={};for(;b--;)$[n[b].key]=b;const C=[],O=new Map,A=new Map;for(b=S;b--;){const s=m(o,r,b),h=t(s);let L=i.get(h);L?l&&L.p(s,e):(L=u(h,s),L.c()),O.set(h,C[b]=L),h in $&&A.set(h,Math.abs(b-$[h]))}const P=new Set,T=new Set;function B(s){F(s,1),s.m(f,p),i.set(s.key,s),p=s.first,S--}for(;g&&S;){const s=C[S-1],h=n[g-1],L=s.key,N=h.key;s===h?(p=s.first,g--,S--):O.has(N)?!i.has(L)||P.has(L)?B(s):T.has(N)?g--:A.get(L)>A.get(N)?(T.add(L),B(s)):(P.add(N),g--):(_(h,i),g--)}for(;g--;){const s=n[g];O.has(s.key)||_(s,i)}for(;S;)B(C[S-1]);return C}function Ne(n){n&&n.c()}function Me(n,e,t,l){const{fragment:o,on_mount:r,on_destroy:i,after_update:f}=n.$$;o&&o.m(e,t),l||xt(()=>{const _=r.map(Ln).filter(Mn);i?i.push(..._):Ze(_),n.$$.on_mount=[]}),f.forEach(xt)}function Ce(n,e){const t=n.$$;t.fragment!==null&&(Ze(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Rn(n,e){n.$$.dirty[0]===-1&&(wt.push(n),Pn(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Be(n,e,t,l,o,r,i,f=[-1]){const _=It;kt(n);const u=n.$$={fragment:null,ctx:null,props:r,update:Z,not_equal:o,bound:Bl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(_?_.$$.context:[])),callbacks:Bl(),dirty:f,skip_bound:!1,root:e.target||_.$$.root};i&&i(u.root);let p=!1;if(u.ctx=t?t(n,e.props||{},(m,g,...S)=>{const b=S.length?S[0]:g;return u.ctx&&o(u.ctx[m],u.ctx[m]=b)&&(!u.skip_bound&&u.bound[m]&&u.bound[m](b),p&&Rn(n,m)),g}):[],u.update(),p=!0,Ze(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const m=Tn(e.target);u.fragment&&u.fragment.l(m),m.forEach(w)}else u.fragment&&u.fragment.c();e.intro&&F(n.$$.fragment),Me(n,e.target,e.anchor,e.customElement),An()}kt(_)}class Ge{$destroy(){Ce(this,1),this.$destroy=Z}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const o=l.indexOf(t);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!Cn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const mt=[];function it(n,e=Z){let t;const l=new Set;function o(f){if(Pe(n,f)&&(n=f,t)){const _=!mt.length;for(const u of l)u[1](),mt.push(u,n);if(_){for(let u=0;u<mt.length;u+=2)mt[u][0](mt[u+1]);mt.length=0}}}function r(f){o(f(n))}function i(f,_=Z){const u=[f,_];return l.add(u),l.size===1&&(t=e(o)||Z),f(n),()=>{l.delete(u),l.size===0&&(t(),t=null)}}return{set:o,update:r,subscribe:i}}const Jn={plots:[],lastChangeDay:0,townLog:"",townInfo:{name:"Your town",gold:1e3,gold_from_tourism:0,population_count:0,population_max:0,employees:0,happiness:100,health:100,knowledge_points:0},hasCityHall:!1,hasBank:!1,modifiers:{happiness:1,health:1},economyAndLaws:{tax_rate:0,max_tax_rate:1,balance_sheet_history:[],last_month_profit:0},plotCounts:[],environment:{day:0,year:1,climate:-1},difficulty:0,endGoal:"land",endGameDetails:null},Ie="plots_active_game_db";let j=it(JSON.parse(localStorage.getItem(Ie)||"null"));function Un(n,e){let t={...Jn};t.economyAndLaws.max_tax_rate=Math.random()*(.5-.2)+.2,t.endGoal=e;let l=[];const o=n=="0"?6:n=="1"?Math.floor(Math.random()*4)+7:n=="2"?Math.floor(Math.random()*9)+12:35;for(let r=0;r<o;r++){l.push([]);for(let i=0;i<o;i++)l[r][i]={id:Math.random().toString(36).substring(2,9),active:!1,x:r,y:i,type:-1}}t.plots=l,localStorage.reset=!1,localStorage.setItem(Ie,JSON.stringify(t)),j.set(t),location.reload()}function nl(n=null){localStorage.removeItem(Ie),j.set(null),n&&(localStorage.setItem(Ie,JSON.stringify(n)),j.set(n)),location.reload()}let oe=it({visible:!1,x:0,y:0}),gt=it({}),ht=it(!1),zt=it(!1),Dt=it(2e3);it(localStorage.getItem("showUnaffordablePlotOptions")==="true");const se=[{id:"res_small",title:"\u{1F3E0} Residential (small)",subtitle:"for living",type:"residential",description:"A few basic homes that can hold 16 people.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:16},styling:"background-color: #e15f00"},{id:"res_medium",title:"\u{1F3D8}\uFE0F Residential (medium)",subtitle:"for living",type:"residential",description:"A few high-density buildings that can hold 64 people.",revenue_per_week:0,requirements:{gold:500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:64},styling:"background-color: #e15f00"},{id:"res_large",title:"\u{1F3E2} Residential (large)",subtitle:"for living",type:"residential",description:"Many high-density buildings that can hold 256 people.",revenue_per_week:0,requirements:{gold:1500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:256},styling:"background-color: #e15f00"},{id:"cafe",title:"\u2615\uFE0F Small caf\xE9",subtitle:"for recreation & food",type:"food",description:"Great for eating & relaxing, not great for long-term health.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:16,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:.95},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #d24646;"},{id:"carrot_farm",title:"\u{1F955} Carrot farm",subtitle:"for farming",type:"farm",description:"Farm for making carrots, makes money by selling them.",revenue_per_week:6,requirements:{gold:25,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"apple_orchard",title:"\u{1F34E} Apple orchard",subtitle:"for farming",type:"farm",description:"A bunch of trees that make apples, makes money by selling them and by selling apple-related products.",revenue_per_week:8,requirements:{gold:50,plots:[],employees:4,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"bakery",title:"\u{1F956} Bakery",subtitle:"for baking",type:"farm",description:"Makes money by selling bread.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:3,climate:null,knowledge:0},effect_modifiers:{happiness:1.11,health:.92},immediate_variable_changes:{happiness:25,health:0,population:0},styling:"background-color: #008000;"},{id:"grocery",title:"\u{1F3EA} Grocery store",subtitle:"for living",type:"food",description:"People get hungry. This is where they go to get food.",revenue_per_week:40,requirements:{gold:320,plots:[],employees:24,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"fishery",title:"\u{1F420} Fishery",subtitle:"for fishing",type:"food",description:"Carve out some land, pour some water, and fish for fun & food.",revenue_per_week:25,requirements:{gold:400,plots:[],employees:9,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"library",title:"\u{1F4D5} Library",subtitle:"for reading",type:"recreation",description:"Reading makes people very happy, but doesn't make money.",revenue_per_week:0,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:1},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #4169e1;"},{id:"pub",title:"\u{1F37B} Pub",subtitle:"for hanging",type:"recreation",description:"Makes money, and somehow generates communal knowledge.",revenue_per_week:50,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:.7},immediate_variable_changes:{happiness:10,health:-25,population:0},styling:"background-color: #4169e1;"},{id:"church",title:"\u26EA\uFE0F Church",subtitle:"for worship & community",type:"recreation",description:"This can make some people happy, but doesn't make money.",revenue_per_week:0,requirements:{gold:100,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"stables",title:"\u{1F434} Stables",subtitle:"for friends",type:"recreation",description:"People love horses. This makes them happy, and can generate some money through lessons.",revenue_per_week:10,requirements:{gold:220,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"blacksmith",title:"\u2694\uFE0F Blacksmith",subtitle:"for making shiny things",type:"shop",description:"Sometimes problems can only be dealt with by a hunk of metal. Makes money by selling weapons, tools, & armor.",revenue_per_week:50,requirements:{gold:1300,plots:[],employees:13,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1.5},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"inn",title:"\u{1F6CC} Village Inn",subtitle:"for a night out",type:"tourism",description:"Generates tourism gold that can be used if you have a bank.",revenue_per_week:0,enables_tourism:!0,tourism_revenue_per_week:15,requirements:{gold:1500,plots:[],employees:14,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"park_small",title:"\u{1F332} Small park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"A few benches and a small grassy area.",revenue_per_week:0,requirements:{gold:80,plots:[],employees:1,climate:null,knowledge:0},effect_modifiers:{happiness:1.01,health:1.07},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_medium",title:"\u{1F6DD} Medium park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Benches, grass, and a couple of swing-sets.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.02,health:1.15},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_large",title:"\u{1F3AA} Large park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Same as the medium park, with a nice fountain in the middle and occasional events run by the employees.",revenue_per_week:0,requirements:{gold:300,plots:[],employees:4,climate:null,size:2,knowledge:0},effect_modifiers:{happiness:1.09,health:1.25},immediate_variable_changes:{happiness:30,health:0,population:0},styling:"background-color: #ffff00;"},{id:"school_small",title:"\u{1F4DA} Small school",subtitle:"for learning",type:"education",description:"A place where children can learn and grow, and where adults can learn new skills. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:2,requirements:{gold:850,plots:[],employees:20,climate:null,size:1,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:15,health:3,population:0},styling:"background-color: #4caf50;"},{id:"school_large",title:"\u{1F68C} Large school",subtitle:"for learning",type:"education",description:"A larger school. Produces knowledge",revenue_per_week:0,knowledge_points_per_month:8,requirements:{gold:1300,plots:[],employees:40,climate:null,size:2,knowledge:10},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:5,health:3,population:0},styling:"background-color: #4caf50;"},{id:"university",title:"\u{1F3EB} University",subtitle:"for learning",type:"education",description:"The supreme learning institution. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:25,requirements:{gold:3500,plots:[],employees:64,climate:null,size:2,knowledge:100},effect_modifiers:{happiness:1.25,health:1},immediate_variable_changes:{happiness:25,health:25,population:0},styling:"background-color: #4caf50;"},{id:"small_hospital",title:"\u{1F691} Small hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from minor injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:800,plots:[],employees:8,climate:null,size:1,knowledge:50},effect_modifiers:{happiness:1.25,health:1.5},immediate_variable_changes:{happiness:5,health:50,population:0},styling:"background-color: #ff0000;"},{id:"large_hospital",title:"\u{1F3E5} Large hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from all injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:4e3,plots:[],employees:64,climate:null,size:1,knowledge:200},effect_modifiers:{happiness:1.25,health:2.5},immediate_variable_changes:{happiness:5,health:75,population:0},styling:"background-color: #ff0000;"},{id:"bank",title:"\u{1F3E6} Bank",subtitle:"for storing and accessing funds",type:"bank",description:"Rich get richer.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:64,climate:null,size:1,knowledge:300},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"},{id:"city-hall",title:"\u{1F5F3}\uFE0F City Hall",subtitle:"for bureaucracy",type:"federal",description:"For running the government.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:24,climate:null,size:1,knowledge:500},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"}],ke={unemployment_num:" people can't find jobs.",bored:"People are bored. Try making some new buildings.",vairety:"People don't like going to the same places over and over again. Try making some new buildings.",nobody_home:"Nobody can live here. Build some residential buildings.",leave_town_num:" people left town because they were unhappy.",new_people_num:" new people moved to town.",people_want_to_move_in:"People want to move in. Build more homes.",high_tax_rate:"People are unhappy with the high tax rate.",very_high_tax_rate:"People are extremely unhappy with the high tax rate.",sickAndDying:"People are sick and dying.",sickAndLeaving:"People are sick and leaving town.",happiness_zero:"The town has fallen into chaos due to extreme unhappiness.",health_zero:"The town has fallen into chaos due to extreme sickness.",population_zero:"The town has been condemned due to lack of population.",win:{land:"You have filled the grid with buildings. You win!"}};function Fl(n){let e,t,l=se[n[0].type].title+"",o,r;return{c(){e=c("div"),t=c("span"),o=v(l),d(t,"data-size",r=se[n[0].type].requirements.size),d(t,"class","svelte-18cb8zy"),d(e,"class","svelte-18cb8zy")},m(i,f){k(i,e,f),a(e,t),a(t,o)},p(i,f){f&1&&l!==(l=se[i[0].type].title+"")&&D(o,l),f&1&&r!==(r=se[i[0].type].requirements.size)&&d(t,"data-size",r)},d(i){i&&w(e)}}}function Hn(n){let e,t,l,o,r,i,f,_,u,p,m,g,S=n[0].type>-1&&Fl(n);return{c(){e=c("div"),S&&S.c(),d(e,"class","plot_container svelte-18cb8zy"),d(e,"data-active",t=n[0].active),d(e,"data-id",l=n[0].id),d(e,"data-x",o=n[0].x),d(e,"data-y",r=n[0].y),d(e,"data-optionindex",i=n[0].optionIndex),d(e,"data-canbeupgraded",n[1]),d(e,"style",n[2]),d(e,"data-type",f=n[0].type),d(e,"data-referenceplotx",_=n[0].referencePlot!==void 0?n[0].referencePlot[0]:null),d(e,"data-referenceploty",u=n[0].referencePlot!==void 0?n[0].referencePlot[1]:null),d(e,"data-size",p=n[0].type>-1?se[n[0].type].requirements.size:null)},m(b,$){k(b,e,$),S&&S.m(e,null),m||(g=x(e,"click",n[3]),m=!0)},p(b,[$]){b[0].type>-1?S?S.p(b,$):(S=Fl(b),S.c(),S.m(e,null)):S&&(S.d(1),S=null),$&1&&t!==(t=b[0].active)&&d(e,"data-active",t),$&1&&l!==(l=b[0].id)&&d(e,"data-id",l),$&1&&o!==(o=b[0].x)&&d(e,"data-x",o),$&1&&r!==(r=b[0].y)&&d(e,"data-y",r),$&1&&i!==(i=b[0].optionIndex)&&d(e,"data-optionindex",i),$&2&&d(e,"data-canbeupgraded",b[1]),$&4&&d(e,"style",b[2]),$&1&&f!==(f=b[0].type)&&d(e,"data-type",f),$&1&&_!==(_=b[0].referencePlot!==void 0?b[0].referencePlot[0]:null)&&d(e,"data-referenceplotx",_),$&1&&u!==(u=b[0].referencePlot!==void 0?b[0].referencePlot[1]:null)&&d(e,"data-referenceploty",u),$&1&&p!==(p=b[0].type>-1?se[b[0].type].requirements.size:null)&&d(e,"data-size",p)},i:Z,o:Z,d(b){b&&w(e),S&&S.d(),m=!1,g()}}}function jn(n,e,t){let l,o,r,i;ee(n,oe,b=>t(5,l=b)),ee(n,j,b=>t(6,o=b)),ee(n,ht,b=>t(7,r=b)),ee(n,gt,b=>t(8,i=b));let{data:f={id:0,active:!1,x:0,y:0,type:-1,styling:"",referencePlot:[]}}=e,{canBeUpgraded:_=!1}=e;function u(...b){m()}let p=f.styling;Ft(async()=>{f.type>=0&&se[f.type].styling&&t(2,p=se[f.type].styling)});function m(){f.type>=0&&se[f.type].styling&&t(2,p=se[f.type].styling),f.type<0&&t(2,p="")}function g(b,$,C){let O=document.querySelectorAll(".plot_container");if(r==!1){if(f.referencePlot!=null&&f.referencePlot[0]!==null&&$==null&&C==null&&f.referencePlot[1]!==void 0)return g(b,f.referencePlot[0],f.referencePlot[1]);!f.active&&!_?(V(gt,i={},i),V(oe,l.visible=!1,l),O.forEach(A=>{A.classList.remove("selected")})):($!=null&&C!=null?(V(oe,l.x=$,l),V(oe,l.y=C,l)):(V(oe,l.x=f.x,l),V(oe,l.y=f.y,l)),V(oe,l.visible=!0,l),O.forEach(A=>{A.classList.remove("selected")}),$!=null&&C!=null?document.querySelector(`.plot_container[data-x="${$}"][data-y="${C}"]`).classList.add("selected"):document.querySelector(`.plot_container[data-id="${f.id}"]`).classList.add("selected"))}}function S(b){r==!1&&(V(j,o.plots[f.x][f.y].type=b,o),V(oe,l.visible=!1,l))}return n.$$set=b=>{"data"in b&&t(0,f=b.data),"canBeUpgraded"in b&&t(1,_=b.canBeUpgraded)},n.$$.update=()=>{n.$$.dirty&1&&u(f)},[f,_,p,g,S]}class Yn extends Ge{constructor(e){super(),Be(this,e,jn,Hn,Pe,{data:0,canBeUpgraded:1,changePlotType:4})}get changePlotType(){return this.$$.ctx[4]}}const me={land:{short_title:"Fill the grid",description_title:"You win by filling up all possible plots in the grid, and by meeting some requirements.",win:"You have filled the grid with buildings. You win!",requirements:{0:{population_count:200,happiness:100,health:100,employment:1},1:{population_count:500,happiness:100,health:100,employment:1},2:{population_count:1e3,happiness:100,health:100,employment:1}}}};function Vn(n){return n.hasBank,n}function Wn(n){return n.hasCityHall,n}function el(n){if(n.modifiers.happiness>1){let e=n.modifiers.happiness-1;n.modifiers.happiness-=e*.08,n.modifiers.happiness<1.05&&(n.modifiers.happiness=1)}if(n.modifiers.health>1){let e=n.modifiers.health-1;n.modifiers.health-=e*.08,n.modifiers.health<1.05&&(n.modifiers.health=1)}return n}function tl(n){if(n.townInfo.happiness>150){let t=n.townInfo.happiness-150;n.townInfo.happiness-=t*.08,n.townInfo.happiness<150&&(n.townInfo.happiness=150)}if(n.townInfo.health>150){let t=n.townInfo.health-150;n.townInfo.health-=t*.08,n.townInfo.health<150&&(n.townInfo.health=150)}return n}function Kn(n){return n.townInfo.happiness*=n.modifiers.happiness,n.townInfo.health*=n.modifiers.health,n}function Xn(n,e){let t=e.townInfo.happiness/100;t>1.25?t=1.25:t<.75&&(t=.75);let l=n*e.economyAndLaws.tax_rate*(e.townInfo.population_count/e.townInfo.population_max)*t;return Qe(l,2)}function Qe(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Qn(n,e,t){let l,o,r;ee(n,Dt,s=>t(4,l=s)),ee(n,j,s=>t(5,o=s)),ee(n,ht,s=>t(6,r=s));function i(s){return s=S(s),s=O(s),s=P(s),s=Kn(s),s=b(s),s=el(s),s}function f(s){return s=T(s),s=C(s),s=Vn(s),s=Wn(s),s}function _(s){return s=$(s),s=tl(s),s}function u(s){return s=A(s),s=g(s),s=m(s),s}function p(){j.update(s=>{if(r||!s||s.endGameDetails)return s;try{return s.environment.day+=1,s.environment.day%7===0&&(s=i(s)),s.environment.day%30===0&&(s=f(s)),s.environment.day%90===0&&(s=_(s)),s=u(s),s}catch(h){return console.error("Error in game loop:",h),s}})}j.subscribe(s=>{s&&localStorage.setItem(Ie,JSON.stringify(s))});function m(s){if(s.endGoal=="land"&&s.townInfo.population_max==s.townInfo.population_count&&s.townInfo.happiness>=me.land.requirements[s.difficulty].happiness&&s.townInfo.health>=me.land.requirements[s.difficulty].health&&s.townInfo.employees/s.townInfo.population_count>=me.land.requirements[s.difficulty].employment&&s.townInfo.population_count>me.land.requirements[s.difficulty].population){let L=!0;for(let N=0;N<s.plots.length;N++)for(let M=0;M<s.plots[N].length;M++)if(s.plots[N][M].active==!1){L=!1;break}L&&(s.endGameDetails={msg:me.land.win,win:!0})}return s}function g(s){return s.townInfo.happiness<=0&&(s.townInfo.happiness=0,s.endGameDetails={msg:ke.happiness_zero,win:!1}),s.townInfo.health<=0&&(s.townInfo.health=0,s.endGameDetails={msg:ke.health_zero,win:!1}),s.townInfo.population_count<=0&&s.townInfo.population_max>0&&(s.townInfo.population_count=0,s.endGameDetails={msg:ke.population_zero,win:!1}),s}function S(s){let h=s.townInfo.population_count-s.townInfo.employees;return h>0&&(s.modifiers.happiness-=h*9e-4,s=B(h+ke.unemployment_num,s)),s}function b(s){let h=s.townInfo.health,L=0;return h>50||h<Math.random()*50&&(h<25?(s=B(ke.sickAndDying,s),s.townInfo.happiness-=10,L=Math.round(s.townInfo.population_count*.1)):(s=B(ke.sickAndLeaving,s),s.townInfo.happiness-=5,L=Math.round(s.townInfo.population_count*.05)),s.townInfo.population_count-=L,s.townInfo.employees-=L),s}function $(s){return s.lastChangeDay+(Math.random()*160+50)<s.environment.day&&(s.townInfo.population_count>0&&(s.townInfo.population_count-=1,s.townInfo.employees-=1,s.modifiers.happiness-=.01),s=B(ke.bored,s)),s}function C(s){if(s.townInfo.population_count<s.townInfo.population_max&&s.townInfo.happiness>50){let h=s.townInfo.population_max-s.townInfo.population_count,L=Math.round(s.townInfo.happiness/100*h);s.townInfo.population_count+=L,s.townInfo.population_count>s.townInfo.population_max&&(s.townInfo.population_count=s.townInfo.population_max),s.townInfo.employees+=L,s.townInfo.employees>s.townInfo.population_count&&(s.townInfo.employees=s.townInfo.population_count),s=B(L+ke.new_people_num,s)}if(s.townInfo.happiness<50&&s.townInfo.population_count>0){let h=Math.round((100-s.townInfo.happiness)/5);s.townInfo.population_count-=h,s.townInfo.employees>0&&(s.townInfo.employees-=h),s=B(h+ke.leave_town_num,s)}else s.townInfo.population_count==s.townInfo.population_max&&(s=B(ke.people_want_to_move_in,s));return s}function O(s){const h=Math.random();if(s.economyAndLaws.tax_rate>s.economyAndLaws.max_tax_rate){const L=s.difficulty==0?.7:s.difficulty==1?.4:.2;h<L&&s.economyAndLaws.tax_rate>s.economyAndLaws.max_tax_rate*2?(s.modifiers.happiness-=.03,s=B(ke.very_high_tax_rate+"  ("+s.economyAndLaws.tax_rate+"%)",s)):(s.modifiers.happiness-=.01,s=B(ke.high_tax_rate+"  ("+s.economyAndLaws.tax_rate*100+"%)",s))}return s}function A(s){return s.townInfo.happiness<0&&(s.townInfo.happiness=0),s.townInfo.health<0&&(s.townInfo.health=0),s.townInfo.gold<0&&(s.townInfo.gold=0),s.townInfo.employees<0&&(s.townInfo.employees=0),s.townInfo.knowledge_points<0&&(s.townInfo.knowledge_points=0),s.townInfo.population_count<0&&(s.townInfo.population_count=0),s.townInfo.population_max==0&&(s=B(ke.nobody_home,s)),s.economyAndLaws.last_month_profit=Qe(s.economyAndLaws.last_month_profit,2),s.townInfo.gold=Qe(s.townInfo.gold,2),s.townInfo.population_count=Qe(s.townInfo.population_count,0),s.townInfo.employees=Qe(s.townInfo.employees,0),s.townInfo.population_max=Qe(s.townInfo.population_max,0),s.townInfo.happiness=Qe(s.townInfo.happiness,2),s.townInfo.health=Qe(s.townInfo.health,2),s.townInfo.happiness>300&&(s.townInfo.happiness=300),s.townInfo.health>300&&(s.townInfo.health=300),s.modifiers.happiness<.5&&(s.modifiers.happiness=.5),s.modifiers.health<.5&&(s.modifiers.health=.5),s}function P(s){s.economyAndLaws.last_month_profit=0;for(let h=0;h<s.plots.length;h++)for(let L=0;L<s.plots[h].length;L++)if(s.plots[h][L].active==!0&&s.plots[h][L].type>-1){let N=se[s.plots[h][L].type],M=Xn(N.revenue_per_week,s);s.townInfo.gold+=M,s.economyAndLaws.last_month_profit+=M,M>0&&(s.economyAndLaws.balance_sheet_history=[{day:s.environment.day,plot:`${h},${L}`,profits:M,taxRate:s.economyAndLaws.tax_rate},...s.economyAndLaws.balance_sheet_history],s.economyAndLaws.balance_sheet_history.length>250&&(s.economyAndLaws.balance_sheet_history=s.economyAndLaws.balance_sheet_history.slice(0,250))),N.enables_tourism==!0&&(s.townInfo.gold_from_tourism+=N.tourism_revenue_per_week*s.economyAndLaws.tax_rate*s.townInfo.population_count)}return s}function T(s){for(let h=0;h<s.plots.length;h++)for(let L=0;L<s.plots[h].length;L++)if(s.plots[h][L].active==!0&&s.plots[h][L].type>-1){let N=se[s.plots[h][L].type];N.knowledge_points_per_month!=null&&(s.townInfo.knowledge_points+=N.knowledge_points_per_month)}return s}function B(s,h){return h.townLog="Day "+o.environment.day+" - "+s+`
`+h.townLog,h}return Ft(async()=>{for(;;)localStorage.reset=="true"&&(nl(),localStorage.setItem("reset","false")),p(),await new Promise(s=>setTimeout(s,l))}),[p,A,el,tl]}class Zn extends Ge{constructor(e){super(),Be(this,e,Qn,null,Pe,{mainGameThreadLoop:0,_fixVariables:1,_bringModifiersBackToNormal:2,_bringStatsBackToNormal:3})}get mainGameThreadLoop(){return this.$$.ctx[0]}get _fixVariables(){return this.$$.ctx[1]}get _bringModifiersBackToNormal(){return el}get _bringStatsBackToNormal(){return tl}}function Rl(n,e,t){const l=n.slice();return l[21]=e[t],l}function Jl(n){let e,t;return{c(){e=c("div"),t=v(n[0]),d(e,"class","message")},m(l,o){k(l,e,o),a(e,t)},p(l,o){o&1&&D(t,l[0])},d(l){l&&w(e)}}}function Ul(n){let e,t,l;return{c(){e=c("button"),e.textContent="\u{1F525}",d(e,"id","bulldoze"),d(e,"class","svelte-bdghnw")},m(o,r){k(o,e,r),t||(l=x(e,"click",n[11]),t=!0)},p:Z,d(o){o&&w(e),t=!1,l()}}}function Hl(n){let e,t,l,o;return{c(){e=c("span"),t=v("("),l=v(n[8]),o=v(")"),d(e,"class","text_s")},m(r,i){k(r,e,i),a(e,t),a(e,l),a(e,o)},p(r,i){i&256&&D(l,r[8])},d(r){r&&w(e)}}}function jl(n){let e;return{c(){e=c("span"),e.textContent="(0)",d(e,"class","text_s")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Yl(n){let e,t,l,o,r,i,f=n[21].revenue_per_week>0&&Vl(n),_=n[21].tourism_revenue_per_week>0&&Wl(n);return{c(){e=c("div"),t=c("span"),t.textContent="Profits",l=y(),o=c("br"),r=y(),f&&f.c(),i=y(),_&&_.c(),d(t,"class","subheading_m"),d(e,"class","profits svelte-bdghnw")},m(u,p){k(u,e,p),a(e,t),a(e,l),a(e,o),a(e,r),f&&f.m(e,null),a(e,i),_&&_.m(e,null)},p(u,p){u[21].revenue_per_week>0?f?f.p(u,p):(f=Vl(u),f.c(),f.m(e,i)):f&&(f.d(1),f=null),u[21].tourism_revenue_per_week>0?_?_.p(u,p):(_=Wl(u),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},d(u){u&&w(e),f&&f.d(),_&&_.d()}}}function Vl(n){let e,t,l=n[21].revenue_per_week+"",o,r,i=He(n[6].economyAndLaws.tax_rate*n[21].revenue_per_week,2)+"",f,_,u,p;return{c(){e=c("span"),t=c("span"),o=v(l),r=y(),f=v(i),_=v(" gold (with tax rate)"),u=y(),p=c("br"),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(m,g){k(m,e,g),a(e,t),a(t,o),a(e,r),a(e,f),a(e,_),k(m,u,g),k(m,p,g)},p(m,g){g&32&&l!==(l=m[21].revenue_per_week+"")&&D(o,l),g&96&&i!==(i=He(m[6].economyAndLaws.tax_rate*m[21].revenue_per_week,2)+"")&&D(f,i)},d(m){m&&w(e),m&&w(u),m&&w(p)}}}function Wl(n){let e,t,l=n[21].tourism_revenue_per_week+"",o,r,i=He(n[6].economyAndLaws.tax_rate*n[21].tourism_revenue_per_week*n[6].townInfo.population_count,2)+"",f,_,u,p=n[6].hasABank!==!0&&Kl();return{c(){e=c("span"),t=c("span"),o=v(l),r=y(),f=v(i),_=v(` tourism gold (
											`),p&&p.c(),u=v(`

											)`),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(m,g){k(m,e,g),a(e,t),a(t,o),a(e,r),a(e,f),a(e,_),p&&p.m(e,null),a(e,u)},p(m,g){g&32&&l!==(l=m[21].tourism_revenue_per_week+"")&&D(o,l),g&96&&i!==(i=He(m[6].economyAndLaws.tax_rate*m[21].tourism_revenue_per_week*m[6].townInfo.population_count,2)+"")&&D(f,i),m[6].hasABank!==!0?p||(p=Kl(),p.c(),p.m(e,u)):p&&(p.d(1),p=null)},d(m){m&&w(e),p&&p.d()}}}function Kl(n){let e;return{c(){e=v("get a bank to cash out")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Xl(n){let e,t;function l(i,f){return i[6].townInfo.gold<i[21].requirements.gold?zn:xn}let o=l(n),r=o(n);return{c(){r.c(),e=y(),t=c("br")},m(i,f){r.m(i,f),k(i,e,f),k(i,t,f)},p(i,f){o===(o=l(i))&&r?r.p(i,f):(r.d(1),r=o(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){r.d(i),i&&w(e),i&&w(t)}}}function xn(n){let e,t=n[21].requirements.gold+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" gold"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,i){k(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.gold+"")&&D(l,t)},d(r){r&&w(e)}}}function zn(n){let e,t=n[21].requirements.gold+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" gold"),d(e,"class","red text_s cost_label svelte-bdghnw")},m(r,i){k(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.gold+"")&&D(l,t)},d(r){r&&w(e)}}}function Ql(n){let e,t;function l(i,f){return i[6].townInfo.population_count-i[6].townInfo.employees<i[21].requirements.employees?to:eo}let o=l(n),r=o(n);return{c(){r.c(),e=y(),t=c("br")},m(i,f){r.m(i,f),k(i,e,f),k(i,t,f)},p(i,f){o===(o=l(i))&&r?r.p(i,f):(r.d(1),r=o(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){r.d(i),i&&w(e),i&&w(t)}}}function eo(n){let e,t=n[21].requirements.employees+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" employees"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,i){k(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.employees+"")&&D(l,t)},d(r){r&&w(e)}}}function to(n){let e,t=n[21].requirements.employees+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" employees"),d(e,"class","text_s cost_label red svelte-bdghnw")},m(r,i){k(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.employees+"")&&D(l,t)},d(r){r&&w(e)}}}function Zl(n){let e,t;function l(i,f){return i[6].townInfo.knowledge_points<i[21].requirements.knowledge?no:lo}let o=l(n),r=o(n);return{c(){r.c(),e=y(),t=c("br")},m(i,f){r.m(i,f),k(i,e,f),k(i,t,f)},p(i,f){o===(o=l(i))&&r?r.p(i,f):(r.d(1),r=o(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){r.d(i),i&&w(e),i&&w(t)}}}function lo(n){let e,t=n[21].requirements.knowledge+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" knowledge"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,i){k(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.knowledge+"")&&D(l,t)},d(r){r&&w(e)}}}function no(n){let e,t=n[21].requirements.knowledge+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" knowledge"),d(e,"class","text_s cost_label red svelte-bdghnw")},m(r,i){k(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.knowledge+"")&&D(l,t)},d(r){r&&w(e)}}}function oo(n){let e,t,l=Rt(n[21].effect_modifiers.happiness)+"",o,r;return{c(){e=c("span"),t=v("\u{1F601} "),o=v(l),d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive",r=n[21].effect_modifiers.happiness>=1)},m(i,f){k(i,e,f),a(e,t),a(e,o)},p(i,f){f&32&&l!==(l=Rt(i[21].effect_modifiers.happiness)+"")&&D(o,l),f&32&&r!==(r=i[21].effect_modifiers.happiness>=1)&&d(e,"data-positive",r)},d(i){i&&w(e)}}}function io(n){let e;return{c(){e=c("span"),e.textContent="\u{1F601} No effect",d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive","true")},m(t,l){k(t,e,l)},p:Z,d(t){t&&w(e)}}}function so(n){let e,t,l=Rt(n[21].effect_modifiers.health)+"",o,r;return{c(){e=c("span"),t=v("\u{1F3E5} "),o=v(l),d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive",r=n[21].effect_modifiers.health>=1)},m(i,f){k(i,e,f),a(e,t),a(e,o)},p(i,f){f&32&&l!==(l=Rt(i[21].effect_modifiers.health)+"")&&D(o,l),f&32&&r!==(r=i[21].effect_modifiers.health>=1)&&d(e,"data-positive",r)},d(i){i&&w(e)}}}function ao(n){let e;return{c(){e=c("span"),e.textContent="\u{1F3E5} No effect",d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive","true")},m(t,l){k(t,e,l)},p:Z,d(t){t&&w(e)}}}function xl(n){let e,t,l,o,r,i=n[21].immediate_variable_changes.happiness!==0&&zl(n),f=n[21].immediate_variable_changes.happiness!==0&&n[21].immediate_variable_changes.health!==0&&en(),_=n[21].immediate_variable_changes.health!==0&&tn(n);return{c(){e=c("div"),t=c("span"),l=v(`Instant changes:
										`),i&&i.c(),o=y(),f&&f.c(),r=y(),_&&_.c(),d(t,"class","subheading_m"),d(e,"class","immediate_changes svelte-bdghnw")},m(u,p){k(u,e,p),a(e,t),a(t,l),i&&i.m(t,null),a(t,o),f&&f.m(t,null),a(t,r),_&&_.m(t,null)},p(u,p){u[21].immediate_variable_changes.happiness!==0?i?i.p(u,p):(i=zl(u),i.c(),i.m(t,o)):i&&(i.d(1),i=null),u[21].immediate_variable_changes.happiness!==0&&u[21].immediate_variable_changes.health!==0?f||(f=en(),f.c(),f.m(t,r)):f&&(f.d(1),f=null),u[21].immediate_variable_changes.health!==0?_?_.p(u,p):(_=tn(u),_.c(),_.m(t,null)):_&&(_.d(1),_=null)},d(u){u&&w(e),i&&i.d(),f&&f.d(),_&&_.d()}}}function zl(n){let e,t,l=n[21].immediate_variable_changes.happiness+"",o;return{c(){e=v(`\u{1F601}
											`),t=c("span"),o=v(l),d(t,"class","green")},m(r,i){k(r,e,i),k(r,t,i),a(t,o)},p(r,i){i&32&&l!==(l=r[21].immediate_variable_changes.happiness+"")&&D(o,l)},d(r){r&&w(e),r&&w(t)}}}function en(n){let e;return{c(){e=v(",")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function tn(n){let e,t,l=n[21].immediate_variable_changes.health+"",o;return{c(){e=v(`\u{1F3E5}
											`),t=c("span"),o=v(l),d(t,"class","green")},m(r,i){k(r,e,i),k(r,t,i),a(t,o)},p(r,i){i&32&&l!==(l=r[21].immediate_variable_changes.health+"")&&D(o,l)},d(r){r&&w(e),r&&w(t)}}}function ln(n,e){let t,l,o,r=e[21].title+"",i,f,_,u,p,m=e[21].subtitle+"",g,S,b,$,C,O=e[21].description+"",A,P,T,B,s,h,L,N,M,X,q,H,U,J,re,z,R,W,Q,te,le,he,Ae,I,G,ge,ze,ae=(e[21].revenue_per_week>0||e[21].tourism_revenue_per_week>0)&&Yl(e),fe=e[21].requirements.gold!==0&&Xl(e),ce=e[21].requirements.employees!==0&&Ql(e),ue=e[21].requirements.knowledge!=null&&e[21].requirements.knowledge!==0&&Zl(e);function et(ve,ie){return ve[21].effect_modifiers.happiness==1?io:oo}let Ve=et(e),Se=Ve(e);function De(ve,ie){return ve[21].effect_modifiers.health==1?ao:so}let Ye=De(e),Le=Ye(e),ne=(e[21].immediate_variable_changes.happiness!==0||e[21].immediate_variable_changes.health!==0)&&xl(e);return{key:n,first:null,c(){t=c("div"),l=c("div"),o=c("span"),i=v(r),f=y(),_=c("br"),u=y(),p=c("span"),g=v(m),S=y(),b=c("br"),$=y(),C=c("span"),A=v(O),P=y(),T=c("div"),ae&&ae.c(),B=y(),s=c("div"),h=c("div"),L=c("span"),L.textContent="Requirements",N=y(),M=c("br"),X=y(),fe&&fe.c(),q=y(),ce&&ce.c(),H=y(),ue&&ue.c(),U=y(),J=c("div"),re=c("span"),re.textContent="Multiplier",z=y(),R=c("br"),W=y(),Se.c(),Q=y(),te=c("br"),le=y(),Le.c(),he=y(),ne&&ne.c(),Ae=y(),d(o,"class","heading_m"),d(p,"class","subheading_m"),d(C,"class","text_s"),d(L,"class","subheading_m"),d(h,"class","svelte-bdghnw"),d(re,"class","subheading_m"),d(J,"class","svelte-bdghnw"),d(s,"class","reqs_and_mods svelte-bdghnw"),d(T,"class","bottom svelte-bdghnw"),d(t,"class",I="plotOption background-lightgray "+(e[21].affordable?"":"unaffordable")+" svelte-bdghnw"),d(t,"data-active",G=e[21].selected),d(t,"data-affordable",ge=e[21].affordable),d(t,"data-plotoptionid",ze=e[21].id),this.first=t},m(ve,ie){k(ve,t,ie),a(t,l),a(l,o),a(o,i),a(l,f),a(l,_),a(l,u),a(l,p),a(p,g),a(l,S),a(l,b),a(l,$),a(l,C),a(C,A),a(t,P),a(t,T),ae&&ae.m(T,null),a(T,B),a(T,s),a(s,h),a(h,L),a(h,N),a(h,M),a(h,X),fe&&fe.m(h,null),a(h,q),ce&&ce.m(h,null),a(h,H),ue&&ue.m(h,null),a(s,U),a(s,J),a(J,re),a(J,z),a(J,R),a(J,W),Se.m(J,null),a(J,Q),a(J,te),a(J,le),Le.m(J,null),a(T,he),ne&&ne.m(T,null),a(t,Ae)},p(ve,ie){e=ve,ie&32&&r!==(r=e[21].title+"")&&D(i,r),ie&32&&m!==(m=e[21].subtitle+"")&&D(g,m),ie&32&&O!==(O=e[21].description+"")&&D(A,O),e[21].revenue_per_week>0||e[21].tourism_revenue_per_week>0?ae?ae.p(e,ie):(ae=Yl(e),ae.c(),ae.m(T,B)):ae&&(ae.d(1),ae=null),e[21].requirements.gold!==0?fe?fe.p(e,ie):(fe=Xl(e),fe.c(),fe.m(h,q)):fe&&(fe.d(1),fe=null),e[21].requirements.employees!==0?ce?ce.p(e,ie):(ce=Ql(e),ce.c(),ce.m(h,H)):ce&&(ce.d(1),ce=null),e[21].requirements.knowledge!=null&&e[21].requirements.knowledge!==0?ue?ue.p(e,ie):(ue=Zl(e),ue.c(),ue.m(h,null)):ue&&(ue.d(1),ue=null),Ve===(Ve=et(e))&&Se?Se.p(e,ie):(Se.d(1),Se=Ve(e),Se&&(Se.c(),Se.m(J,Q))),Ye===(Ye=De(e))&&Le?Le.p(e,ie):(Le.d(1),Le=Ye(e),Le&&(Le.c(),Le.m(J,null))),e[21].immediate_variable_changes.happiness!==0||e[21].immediate_variable_changes.health!==0?ne?ne.p(e,ie):(ne=xl(e),ne.c(),ne.m(T,null)):ne&&(ne.d(1),ne=null),ie&32&&I!==(I="plotOption background-lightgray "+(e[21].affordable?"":"unaffordable")+" svelte-bdghnw")&&d(t,"class",I),ie&32&&G!==(G=e[21].selected)&&d(t,"data-active",G),ie&32&&ge!==(ge=e[21].affordable)&&d(t,"data-affordable",ge),ie&32&&ze!==(ze=e[21].id)&&d(t,"data-plotoptionid",ze)},d(ve){ve&&w(t),ae&&ae.d(),fe&&fe.d(),ce&&ce.d(),ue&&ue.d(),Se.d(),Le.d(),ne&&ne.d()}}}function ro(n){let e,t,l,o,r,i,f=n[2]+1+"",_,u,p=n[1]+1+"",m,g,S,b,$,C,O=n[6].plots[n[1]][n[2]].type!==-1&&n[3](n[2],n[1]),A,P,T,B,s,h,L,N,M,X,q,H,U,J=[],re=new Map,z,R,W=n[0]!==""&&Jl(n),Q=O&&Ul(n),te=n[8]>0&&Hl(n),le=n[5].length==0&&jl(),he=n[5];const Ae=I=>I[21].id;for(let I=0;I<he.length;I+=1){let G=Rl(n,he,I),ge=Ae(G);re.set(ge,J[I]=ln(ge,G))}return{c(){e=c("div"),t=c("div"),l=c("div"),o=c("div"),r=c("span"),i=v("Modify Plot: "),_=v(f),u=v("-"),m=v(p),g=y(),W&&W.c(),S=y(),b=c("input"),$=y(),C=c("div"),Q&&Q.c(),A=y(),P=c("button"),P.textContent="Close",T=y(),B=c("div"),s=c("label"),h=v(`options
				`),te&&te.c(),L=y(),le&&le.c(),N=y(),M=c("br"),X=y(),q=c("br"),H=y(),U=c("div");for(let I=0;I<J.length;I+=1)J[I].c();d(r,"class","heading_l"),d(o,"class","svelte-bdghnw"),d(b,"type","text"),d(b,"id","search-bar"),d(b,"placeholder","Search Plot Options..."),b.value=n[4],d(b,"class","svelte-bdghnw"),d(P,"id","close"),d(P,"class","svelte-bdghnw"),d(C,"class","svelte-bdghnw"),d(l,"class","header svelte-bdghnw"),d(s,"for","plotType"),d(U,"class","plotOptions svelte-bdghnw"),d(B,"class","scrollable-y svelte-bdghnw"),d(t,"class","dialog-content svelte-bdghnw"),d(e,"class","dialog svelte-bdghnw")},m(I,G){k(I,e,G),a(e,t),a(t,l),a(l,o),a(o,r),a(r,i),a(r,_),a(r,u),a(r,m),a(o,g),W&&W.m(o,null),a(l,S),a(l,b),n[16](b),a(l,$),a(l,C),Q&&Q.m(C,null),a(C,A),a(C,P),a(t,T),a(t,B),a(B,s),a(s,h),te&&te.m(s,null),a(s,L),le&&le.m(s,null),a(B,N),a(B,M),a(B,X),a(B,q),a(B,H),a(B,U);for(let ge=0;ge<J.length;ge+=1)J[ge].m(U,null);z||(R=[x(b,"input",n[9]),x(P,"click",n[10]),x(U,"click",n[12])],z=!0)},p(I,[G]){G&4&&f!==(f=I[2]+1+"")&&D(_,f),G&2&&p!==(p=I[1]+1+"")&&D(m,p),I[0]!==""?W?W.p(I,G):(W=Jl(I),W.c(),W.m(o,null)):W&&(W.d(1),W=null),G&16&&b.value!==I[4]&&(b.value=I[4]),G&70&&(O=I[6].plots[I[1]][I[2]].type!==-1&&I[3](I[2],I[1])),O?Q?Q.p(I,G):(Q=Ul(I),Q.c(),Q.m(C,A)):Q&&(Q.d(1),Q=null),I[8]>0?te?te.p(I,G):(te=Hl(I),te.c(),te.m(s,L)):te&&(te.d(1),te=null),I[5].length==0?le||(le=jl(),le.c(),le.m(s,null)):le&&(le.d(1),le=null),G&96&&(he=I[5],J=Fn(J,G,Ae,1,I,he,re,U,Dn,ln,null,Rl))},i:Z,o:Z,d(I){I&&w(e),W&&W.d(),n[16](null),Q&&Q.d(),te&&te.d(),le&&le.d();for(let G=0;G<J.length;G+=1)J[G].d();z=!1,Ze(R)}}}function He(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Rt(n){return n.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}function fo(n,e){let t=!0;n.requirements.gold>e.townInfo.gold&&(t=!1);let l=e.townInfo.population_count-e.townInfo.employees;return n.requirements.employees!==void 0&&n.requirements.employees>0&&n.requirements.employees>l&&(t=!1),n.requirements.knowledge!==void 0&&n.requirements.knowledge>e.townInfo.knowledge_points&&(t=!1),t}function uo(n,e,t){let l,o;ee(n,j,h=>t(6,l=h)),ee(n,oe,h=>t(17,o=h));let{x:r=0}=e,{y:i=0}=e,f="",_=se,{tooltip:u=""}=e,p,m;Ft(async()=>{await Bn(),p&&p.focus()});let g=[];function S(h){t(4,f=h.target.value),h.stopPropagation()}Ft(()=>{const h=document.querySelectorAll(".plotOption");l.plots[r][i].type!==-1&&l.plots[r][i].type>-1&&(h[l.plots[r][i].type].classList.add("active"),h[l.plots[r][i].type].scrollIntoView({behavior:"smooth",block:"center"}))});function b(h,L){let N={x:h,y:L};return N.x===0&&N.y===0?!0:[{x:N.x-1,y:N.y},{x:N.x+1,y:N.y},{x:N.x,y:N.y-1},{x:N.x,y:N.y+1}].some(X=>X.x<0||X.x>l.plots.length-1||X.y<0||X.y>l.plots.length-1?!1:l.plots[X.x][X.y].active)}function $(){V(oe,o.visible=!1,o)}function C(){document.querySelectorAll(".plotOption").forEach(L=>{L.classList.remove("active")}),T(r,i)}function O(h){document.querySelectorAll(".plotOption").forEach(M=>{M.classList.remove("active")}),document.querySelector(`[data-plotoptionid="${h}"]`).classList.add("active"),P(r,i,h)}function A(h,L){let N=0;return h>0&&l.plots[h-1][L].type!==-1&&N++,h<l.plots.length-1&&l.plots[h+1][L].type!==-1&&N++,L>0&&l.plots[h][L-1].type!==-1&&N++,L<l.plots[0].length-1&&l.plots[h][L+1].type!==-1&&N++,N<=4}function P(h,L,N){let M=l;const X=se.findIndex(U=>U.id===N);let q=se[X],H=!0;if((q.requirements.gold>M.townInfo.gold||q.requirements.employees>M.townInfo.population_count-M.townInfo.employees)&&(H=!1),q.requirements.size!=null&&H){let U=q.requirements.size,J=[],re=_[X].title.toLowerCase().indexOf("school")!=-1;for(let z=0;z<4;z++){let R=[[h,L]];z===0?(R.push([h-(U-1),L-(U-1)]),R.push([h-(U-1),L]),R.push([h,L-(U-1)])):z===1?(R.push([h,L-(U-1)]),R.push([h+(U-1),L-(U-1)]),R.push([h+(U-1),L])):z===2?(R.push([h-(U-1),L]),R.push([h-(U-1),L+(U-1)]),R.push([h,L+(U-1)])):z===3&&(R.push([h,L+(U-1)]),R.push([h+(U-1),L+(U-1)]),R.push([h+(U-1),L])),J.push(R)}J=J.filter(z=>z.every(R=>R[0]>=0&&R[0]<=M.plots.length-1&&R[1]>=0&&R[1]<=M.plots.length-1&&!M.plots[R[0]][R[1]].active&&b(R[0],R[1])==!0)),J.length===0?H=!1:J.length>0&&J[0].forEach(R=>{M.plots[R[0]][R[1]].active=!0,M.plots[R[0]][R[1]].type=re?-3:-2,M.plots[R[0]][R[1]].referencePlot=[h,L]})}if(H===!0){switch(M.plots[h][L].type!==-1&&T(h,L),t(0,u=""),M.plots[h][L].type=X,M.plots[h][L].active=!0,M.plots[h][L].referencePlot=[],M.townInfo.gold-=q.requirements.gold,M.townInfo.gold=He(M.townInfo.gold,2),M.townInfo.population_count+=q.immediate_variable_changes.population,M.townInfo.population_max+=q.immediate_variable_changes.population,M.townInfo.happiness+=q.immediate_variable_changes.happiness,M.townInfo.health+=q.immediate_variable_changes.health,M.modifiers.happiness=He(M.modifiers.happiness*q.effect_modifiers.happiness,2),M.modifiers.health=He(M.modifiers.health*q.effect_modifiers.health,2),M.townInfo.employees+=q.requirements.employees,(M.plotCounts[X]===void 0||M.plotCounts[X]===null)&&(M.plotCounts[X]=0),M.plotCounts[X]++,M.lastChangeDay=M.environment.day,M.economyAndLaws.balance_sheet_history=[{day:M.environment.day,plot:`${h},${L}`,profits:q.requirements.gold*-1,balance:He(M.townInfo.gold,2)},...M.economyAndLaws.balance_sheet_history],q.id){case"city-hall":M.hasCityHall=!0;break;case"bank":M.hasBank=!0;break}j.set(M),localStorage.setItem(Ie,JSON.stringify(M)),V(oe,o.visible=!1,o)}else t(0,u="You do not have enough resources to purchase this plot."),document.querySelectorAll(".plotOption").forEach(J=>{J.classList.remove("active")})}function T(h,L){let N=l,M=N.plots[h][L].type;N.plots[h][L].type=-1,N.plots[h][L].active=!1,M>-1&&(N.townInfo.population_count-=se[M].immediate_variable_changes.population,N.townInfo.population_max-=se[M].immediate_variable_changes.population,N.townInfo.happiness-=se[M].immediate_variable_changes.happiness,N.townInfo.health-=se[M].immediate_variable_changes.health,N.modifiers.happiness=He(N.modifiers.happiness/se[M].effect_modifiers.happiness,2),N.modifiers.health=He(N.modifiers.health/se[M].effect_modifiers.health,2),N.townInfo.employees-=se[M].requirements.employees,(N.plotCounts[M]===void 0||N.plotCounts[M]===null)&&(N.plotCounts[M]=0),N.plotCounts[M]--),N.lastChangeDay=N.environment.day,j.set(N),localStorage.setItem(Ie,JSON.stringify(N))}function B(h){const L=h.target.closest(".plotOption");if(L){const N=L.dataset.plotoptionid;O(N)}}function s(h){Qt[h?"unshift":"push"](()=>{p=h,t(7,p)})}return n.$$set=h=>{"x"in h&&t(1,r=h.x),"y"in h&&t(2,i=h.y),"tooltip"in h&&t(0,u=h.tooltip)},n.$$.update=()=>{n.$$.dirty&64&&l&&t(5,g=_.map(h=>({...h,affordable:fo(h,l)}))),n.$$.dirty&48&&t(5,g=f?g.filter(h=>h.title.toLowerCase().includes(f.toLowerCase())):g),n.$$.dirty&32&&t(8,m=g.filter(h=>h.affordable==!0).length)},[u,r,i,A,f,g,l,p,m,S,$,C,B,b,P,T,s]}class po extends Ge{constructor(e){super(),Be(this,e,uo,ro,Pe,{x:1,y:2,tooltip:0,checkIfPlotCanBeUpgraded:13,canBulldoze:3,purchasePlot:14,reverseClear:15})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[13]}get canBulldoze(){return this.$$.ctx[3]}get purchasePlot(){return this.$$.ctx[14]}get reverseClear(){return this.$$.ctx[15]}}function nn(n,e,t){const l=n.slice();return l[6]=e[t],l}function on(n,e,t){const l=n.slice();return l[9]=e[t],l}function sn(n){let e,t,l=n[3],o,r,i=n[2].plots,f=[];for(let p=0;p<i.length;p+=1)f[p]=rn(nn(n,i,p));const _=p=>K(f[p],1,1,()=>{f[p]=null});let u=un(n);return{c(){e=c("div");for(let p=0;p<f.length;p+=1)f[p].c();t=y(),u.c(),o=xe(),d(e,"class","grid svelte-3cpxwu")},m(p,m){k(p,e,m);for(let g=0;g<f.length;g+=1)f[g].m(e,null);k(p,t,m),u.m(p,m),k(p,o,m),r=!0},p(p,m){if(m&7){i=p[2].plots;let g;for(g=0;g<i.length;g+=1){const S=nn(p,i,g);f[g]?(f[g].p(S,m),F(f[g],1)):(f[g]=rn(S),f[g].c(),F(f[g],1),f[g].m(e,null))}for(Te(),g=i.length;g<f.length;g+=1)_(g);Ee()}m&8&&Pe(l,l=p[3])?(Te(),K(u,1,1,Z),Ee(),u=un(p),u.c(),F(u,1),u.m(o.parentNode,o)):u.p(p,m)},i(p){if(!r){for(let m=0;m<i.length;m+=1)F(f[m]);F(u),r=!0}},o(p){f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)K(f[m]);K(u),r=!1},d(p){p&&w(e),ll(f,p),p&&w(t),p&&w(o),u.d(p)}}}function an(n){let e,t;return e=new Yn({props:{data:n[9],canBeUpgraded:n[0](n[9].x,n[9].y)}}),{c(){Ne(e.$$.fragment)},m(l,o){Me(e,l,o),t=!0},p(l,o){const r={};o&4&&(r.data=l[9]),o&4&&(r.canBeUpgraded=l[0](l[9].x,l[9].y)),e.$set(r)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function rn(n){let e,t,l,o,r,i=n[6],f=[];for(let u=0;u<i.length;u+=1)f[u]=an(on(n,i,u));const _=u=>K(f[u],1,1,()=>{f[u]=null});return{c(){e=c("div");for(let u=0;u<f.length;u+=1)f[u].c();t=y(),d(e,"class","row svelte-3cpxwu")},m(u,p){k(u,e,p);for(let m=0;m<f.length;m+=1)f[m].m(e,null);a(e,t),l=!0,o||(r=x(e,"click",n[1]),o=!0)},p(u,p){if(p&5){i=u[6];let m;for(m=0;m<i.length;m+=1){const g=on(u,i,m);f[m]?(f[m].p(g,p),F(f[m],1)):(f[m]=an(g),f[m].c(),F(f[m],1),f[m].m(e,t))}for(Te(),m=i.length;m<f.length;m+=1)_(m);Ee()}},i(u){if(!l){for(let p=0;p<i.length;p+=1)F(f[p]);l=!0}},o(u){f=f.filter(Boolean);for(let p=0;p<f.length;p+=1)K(f[p]);l=!1},d(u){u&&w(e),ll(f,u),o=!1,r()}}}function fn(n){let e,t;return e=new po({props:{x:n[4].x,y:n[4].y}}),{c(){Ne(e.$$.fragment)},m(l,o){Me(e,l,o),t=!0},p(l,o){const r={};o&16&&(r.x=l[4].x),o&16&&(r.y=l[4].y),e.$set(r)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function un(n){let e,t,l=n[4].visible&&fn(n);return{c(){l&&l.c(),e=xe()},m(o,r){l&&l.m(o,r),k(o,e,r),t=!0},p(o,r){o[4].visible?l?(l.p(o,r),r&16&&F(l,1)):(l=fn(o),l.c(),F(l,1),l.m(e.parentNode,e)):l&&(Te(),K(l,1,1,()=>{l=null}),Ee())},i(o){t||(F(l),t=!0)},o(o){K(l),t=!1},d(o){l&&l.d(o),o&&w(e)}}}function co(n){let e,t,l=n[2]!=null&&sn(n);return{c(){l&&l.c(),e=xe()},m(o,r){l&&l.m(o,r),k(o,e,r),t=!0},p(o,[r]){o[2]!=null?l?(l.p(o,r),r&4&&F(l,1)):(l=sn(o),l.c(),F(l,1),l.m(e.parentNode,e)):l&&(Te(),K(l,1,1,()=>{l=null}),Ee())},i(o){t||(F(l),t=!0)},o(o){K(l),t=!1},d(o){l&&l.d(o),o&&w(e)}}}function _o(n,e,t){let l,o,r;ee(n,j,u=>t(2,l=u)),ee(n,gt,u=>t(3,o=u)),ee(n,oe,u=>t(4,r=u));function i(u,p){let m={x:u,y:p};return m.x===0&&m.y===0?!0:[{x:m.x-1,y:m.y},{x:m.x+1,y:m.y},{x:m.x,y:m.y-1},{x:m.x,y:m.y+1}].some(S=>S.x<0||S.x>=l.plots.length||S.y<0||S.y>=l.plots[S.x].length?!1:l.plots[S.x][S.y].active)}function f(){let u=[];for(let p=0;p<l.plots.length;p++)for(let m=0;m<l.plots.length;m++)i(p,m)&&l.plots[p][m].active==!1&&u.push(l.plots[p][m])}function _(){V(gt,o={},o)}return window.location.search.includes("dev=true")&&(V(j,l.townInfo.name="DevTown",l),V(j,l.townInfo.gold=1e8,l),V(j,l.townInfo.population=0,l),V(j,l.townInfo.happiness=1e5,l),V(j,l.townInfo.health=1e5,l),V(j,l.modifiers.happiness=1e5,l),V(j,l.modifiers.health=1e5,l),V(j,l.townInfo.knowledge_points=1e4,l)),n.$$.update=()=>{n.$$.dirty&4&&l&&f()},[i,_,l,o,r]}class mo extends Ge{constructor(e){super(),Be(this,e,_o,co,Pe,{checkIfPlotCanBeUpgraded:0,restartModifyPlotMenu:1})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[0]}get restartModifyPlotMenu(){return this.$$.ctx[1]}}function pn(n,e,t){const l=n.slice();return l[4]=e[t],l}function ho(n){let e,t,l,o,r=n[0].economyAndLaws.balance_sheet_history,i=[];for(let f=0;f<r.length;f+=1)i[f]=cn(pn(n,r,f));return{c(){e=c("table"),t=c("thead"),t.innerHTML=`<tr class="svelte-1m5x2x2"><th>Day</th> 
						<th>Plot</th> 
						<th>Profits</th> 
						<th>Tax rate</th></tr>`,l=y(),o=c("tbody");for(let f=0;f<i.length;f+=1)i[f].c();d(e,"class","svelte-1m5x2x2")},m(f,_){k(f,e,_),a(e,t),a(e,l),a(e,o);for(let u=0;u<i.length;u+=1)i[u].m(o,null)},p(f,_){if(_&3){r=f[0].economyAndLaws.balance_sheet_history;let u;for(u=0;u<r.length;u+=1){const p=pn(f,r,u);i[u]?i[u].p(p,_):(i[u]=cn(p),i[u].c(),i[u].m(o,null))}for(;u<i.length;u+=1)i[u].d(1);i.length=r.length}},d(f){f&&w(e),ll(i,f)}}}function go(n){let e;return{c(){e=c("div"),e.textContent=`No data to display yet. Build some buildings and make sure that the tax
				rate is above 0%.`,d(e,"class","text-center padding-sides")},m(t,l){k(t,e,l)},p:Z,d(t){t&&w(e)}}}function cn(n){let e,t,l=n[4].day+"",o,r,i,f=n[4].plot+"",_,u,p,m=n[4].profits+"",g,S,b,$=n[4].taxRate+"",C,O,A,P;function T(){return n[2](n[4])}return{c(){e=c("tr"),t=c("td"),o=v(l),r=y(),i=c("th"),_=v(f),u=y(),p=c("td"),g=v(m),S=y(),b=c("td"),C=v($),O=y(),d(t,"class","svelte-1m5x2x2"),d(i,"class","plot_link svelte-1m5x2x2"),d(p,"class","svelte-1m5x2x2"),d(b,"class","svelte-1m5x2x2"),d(e,"class","svelte-1m5x2x2")},m(B,s){k(B,e,s),a(e,t),a(t,o),a(e,r),a(e,i),a(i,_),a(e,u),a(e,p),a(p,g),a(e,S),a(e,b),a(b,C),a(e,O),A||(P=x(i,"click",T),A=!0)},p(B,s){n=B,s&1&&l!==(l=n[4].day+"")&&D(o,l),s&1&&f!==(f=n[4].plot+"")&&D(_,f),s&1&&m!==(m=n[4].profits+"")&&D(g,m),s&1&&$!==($=n[4].taxRate+"")&&D(C,$)},d(B){B&&w(e),A=!1,P()}}}function vo(n){let e,t,l,o,r,i;function f(p,m){return p[0].economyAndLaws.balance_sheet_history.length==0?go:ho}let _=f(n),u=_(n);return{c(){e=c("div"),t=c("div"),l=c("div"),l.textContent="Balance Sheet",o=y(),r=c("br"),i=y(),u.c(),d(l,"class","heading_m svelte-1m5x2x2"),d(t,"class","dialog-content svelte-1m5x2x2"),d(e,"class","dialog svelte-1m5x2x2")},m(p,m){k(p,e,m),a(e,t),a(t,l),a(t,o),a(t,r),a(t,i),u.m(t,null)},p(p,[m]){_===(_=f(p))&&u?u.p(p,m):(u.d(1),u=_(p),u&&(u.c(),u.m(t,null)))},i:Z,o:Z,d(p){p&&w(e),u.d()}}}function bo(n,e,t){let l,o;ee(n,oe,f=>t(3,l=f)),ee(n,j,f=>t(0,o=f));function r(f){let _=parseInt(f.split(",")[0]),u=parseInt(f.split(",")[1]);V(oe,l.x=_,l),V(oe,l.y=u,l),V(oe,l.visible=!0,l)}return[o,r,f=>{r(f.plot)}]}class $n extends Ge{constructor(e){super(),Be(this,e,bo,vo,Pe,{})}}const dn={0:"Easy",1:"Normal",2:"Hard"};function _n(n){let e,t,l,o=me[n[0].endGoal].short_title+"",r,i,f,_,u,p,m,g,S,b,$,C,O,A=n[0].endGoal=="land"&&mn(n);return{c(){e=c("div"),t=c("div"),l=v("HOW TO PLAY ("),r=v(o),i=v(`)
			`),f=c("br"),_=y(),u=c("hr"),p=y(),A&&A.c(),m=y(),g=c("br"),S=y(),b=c("hr"),$=y(),C=c("br"),O=v(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(P,T){k(P,e,T),a(e,t),a(t,l),a(t,r),a(t,i),a(t,f),a(t,_),a(t,u),a(t,p),A&&A.m(t,null),a(t,m),a(t,g),a(t,S),a(t,b),a(t,$),a(t,C),a(t,O)},p(P,T){T&1&&o!==(o=me[P[0].endGoal].short_title+"")&&D(r,o),P[0].endGoal=="land"?A?A.p(P,T):(A=mn(P),A.c(),A.m(t,m)):A&&(A.d(1),A=null)},d(P){P&&w(e),A&&A.d()}}}function mn(n){let e=me[n[0].endGoal].description_title+"",t,l,o,r,i,f,_=dn[n[0].difficulty]+"",u,p,m,g,S,b,$,C,O=JSON.stringify(me.land.requirements[n[0].difficulty].population_count)+"",A,P,T,B,s,h,L=JSON.stringify(me.land.requirements[n[0].difficulty].happiness)+"",N,M,X,q,H,U,J=JSON.stringify(me.land.requirements[n[0].difficulty].health)+"",re,z,R,W,Q,te,le=JSON.stringify(me.land.requirements[n[0].difficulty].employment*100)+"",he,Ae;return{c(){t=v(e),l=y(),o=c("br"),r=y(),i=c("br"),f=v(`
				With your difficulty (`),u=v(_),p=v(`), you must
				also have:
				`),m=c("br"),g=y(),S=c("br"),b=y(),$=c("li"),C=v("Population: "),A=v(O),P=y(),T=c("br"),B=y(),s=c("li"),h=v("Happiness: "),N=v(L),M=y(),X=c("br"),q=y(),H=c("li"),U=v("Health: "),re=v(J),z=y(),R=c("br"),W=y(),Q=c("li"),te=v("Employment at "),he=v(le),Ae=v("%")},m(I,G){k(I,t,G),k(I,l,G),k(I,o,G),k(I,r,G),k(I,i,G),k(I,f,G),k(I,u,G),k(I,p,G),k(I,m,G),k(I,g,G),k(I,S,G),k(I,b,G),k(I,$,G),a($,C),a($,A),k(I,P,G),k(I,T,G),k(I,B,G),k(I,s,G),a(s,h),a(s,N),k(I,M,G),k(I,X,G),k(I,q,G),k(I,H,G),a(H,U),a(H,re),k(I,z,G),k(I,R,G),k(I,W,G),k(I,Q,G),a(Q,te),a(Q,he),a(Q,Ae)},p(I,G){G&1&&e!==(e=me[I[0].endGoal].description_title+"")&&D(t,e),G&1&&_!==(_=dn[I[0].difficulty]+"")&&D(u,_),G&1&&O!==(O=JSON.stringify(me.land.requirements[I[0].difficulty].population_count)+"")&&D(A,O),G&1&&L!==(L=JSON.stringify(me.land.requirements[I[0].difficulty].happiness)+"")&&D(N,L),G&1&&J!==(J=JSON.stringify(me.land.requirements[I[0].difficulty].health)+"")&&D(re,J),G&1&&le!==(le=JSON.stringify(me.land.requirements[I[0].difficulty].employment*100)+"")&&D(he,le)},d(I){I&&w(t),I&&w(l),I&&w(o),I&&w(r),I&&w(i),I&&w(f),I&&w(u),I&&w(p),I&&w(m),I&&w(g),I&&w(S),I&&w(b),I&&w($),I&&w(P),I&&w(T),I&&w(B),I&&w(s),I&&w(M),I&&w(X),I&&w(q),I&&w(H),I&&w(z),I&&w(R),I&&w(W),I&&w(Q)}}}function yo(n){let e,t=n[2]&&n[0]!=null&&n[1]&&_n(n);return{c(){t&&t.c(),e=xe()},m(l,o){t&&t.m(l,o),k(l,e,o)},p(l,[o]){l[2]&&l[0]!=null&&l[1]?t?t.p(l,o):(t=_n(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Z,o:Z,d(l){t&&t.d(l),l&&w(e)}}}function wo(n,e,t){let l;ee(n,j,i=>t(0,l=i));let o=!0,r=!1;return n.$$.update=()=>{n.$$.dirty&1&&(l?t(2,r=!0):t(2,r=!1))},[l,o,r]}class ko extends Ge{constructor(e){super(),Be(this,e,wo,yo,Pe,{})}}function hn(n){let e,t=n[1].townLog+"",l,o,r;return{c(){e=c("div"),l=v(t),d(e,"class","townLog message")},m(i,f){k(i,e,f),a(e,l),o||(r=x(e,"click",n[12]),o=!0)},p(i,f){f&2&&t!==(t=i[1].townLog+"")&&D(l,t)},d(i){i&&w(e),o=!1,r()}}}function gn(n){let e,t,l=n[1].townInfo.population_count-n[1].townInfo.employees+"",o,r;return{c(){e=c("span"),t=v("("),o=v(l),r=v(" unemployed)"),d(e,"class","text_ss gray")},m(i,f){k(i,e,f),a(e,t),a(e,o),a(e,r)},p(i,f){f&2&&l!==(l=i[1].townInfo.population_count-i[1].townInfo.employees+"")&&D(o,l)},d(i){i&&w(e)}}}function Io(n){let e,t,l=n[1].economyAndLaws.last_month_profit+"",o,r;return{c(){e=c("span"),t=v("("),o=v(l),r=v(")"),d(e,"class","text_s red")},m(i,f){k(i,e,f),a(e,t),a(e,o),a(e,r)},p(i,f){f&2&&l!==(l=i[1].economyAndLaws.last_month_profit+"")&&D(o,l)},d(i){i&&w(e)}}}function So(n){let e,t,l=n[1].economyAndLaws.last_month_profit+"",o,r;return{c(){e=c("span"),t=v("(+"),o=v(l),r=v(")"),d(e,"class","text_s green")},m(i,f){k(i,e,f),a(e,t),a(e,o),a(e,r)},p(i,f){f&2&&l!==(l=i[1].economyAndLaws.last_month_profit+"")&&D(o,l)},d(i){i&&w(e)}}}function Lo(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=c("span"),l=v(t),d(e,"class","red")},m(o,r){k(o,e,r),a(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.happiness+"")&&D(l,t)},d(o){o&&w(e)}}}function qo(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=c("span"),l=v(t),d(e,"class","green")},m(o,r){k(o,e,r),a(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.happiness+"")&&D(l,t)},d(o){o&&w(e)}}}function Po(n){let e;return{c(){e=c("span"),e.textContent="\u{1F44E}"},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Ao(n){let e;return{c(){e=c("span"),e.textContent="\u{1F44D}"},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function $o(n){let e;return{c(){e=c("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Mo(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=c("span"),l=v(t),d(e,"class","red")},m(o,r){k(o,e,r),a(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.health+"")&&D(l,t)},d(o){o&&w(e)}}}function Co(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=c("span"),l=v(t),d(e,"class","green")},m(o,r){k(o,e,r),a(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.health+"")&&D(l,t)},d(o){o&&w(e)}}}function vn(n){let e;return{c(){e=c("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Oo(n){let e;return{c(){e=v("How to play")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function No(n){let e;return{c(){e=v("Close")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function bn(n){let e,t;return e=new ko({}),{c(){Ne(e.$$.fragment)},m(l,o){Me(e,l,o),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function yn(n){let e,t;return e=new $n({}),{c(){Ne(e.$$.fragment)},m(l,o){Me(e,l,o),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function To(n){let e,t,l,o=n[1].townInfo.name+"",r,i,f,_,u,p,m,g,S,b,$,C,O,A,P,T,B,s,h,L,N,M=n[1].townInfo.population_count+"",X,q,H=n[1].townInfo.population_max+"",U,J,re,z,R,W,Q=n[1].townInfo.employees+"",te,le,he=n[1].townInfo.population_count+"",Ae,I,G,ge,ze,ae,fe,ce,ue,et=n[1].townInfo.knowledge_points+"",Ve,Se,De,Ye,Le,ne,ve=n[1].townInfo.gold+"",ie,ol,il,sl,al,tt,St,rl,vt,fl,Lt=n[1].townInfo.gold_from_tourism+"",Jt,ul,st,qt,pl,Fe,Ut,at,cl,Pt=je(n[1].modifiers.happiness,2)+"",Ht,dl,_l,ml,rt,At,hl,Re,jt,ft,gl,$t=je(n[1].modifiers.health,2)+"",Yt,vl,bl,yl,lt,nt,wl,kl,Il,Sl,We,Mt,Ll,Oe,ql,Ke,ut,Pl,pt,Ct=(n[1].economyAndLaws.tax_rate*100).toFixed(0)+"",Vt,Al,$l,ct,Wt,bt,yt,pe,Kt,Ml,be=n[1].townLog.length>0&&hn(n),ye=n[1].townInfo.population_count-n[1].townInfo.employees>0&&gn(n);function Cl(E,Y){if(E[1].economyAndLaws.last_month_profit>=0)return So;if(E[1].economyAndLaws.last_month_profit<0)return Io}let dt=Cl(n),we=dt&&dt(n);function Ol(E,Y){return E[1].townInfo.happiness>=50?qo:Lo}let Ot=Ol(n),Je=Ot(n);function Nl(E,Y){if(E[1].townInfo.happiness>=300)return $o;if(E[1].townInfo.happiness>=150)return Ao;if(E[1].townInfo.happiness<150)return Po}let _t=Nl(n),$e=_t&&_t(n);function Tl(E,Y){return E[1].townInfo.health>=50?Co:Mo}let Nt=Tl(n),Ue=Nt(n),qe=n[1].townInfo.health>=300&&vn();function El(E,Y){return E[5]?No:Oo}let Tt=El(n),Xe=Tt(n),de=n[5]&&bn(),_e=n[6]&&yn();return{c(){e=c("div"),t=c("div"),l=c("div"),r=v(o),i=y(),f=c("div"),f.textContent="double click to change name",_=y(),u=c("div"),p=c("span"),p.textContent="\u23EA",m=y(),g=c("span"),g.textContent="\u23E9",S=y(),b=v(n[0]),$=v("x - year "),C=v(n[2]),O=v(" day "),A=v(n[3]),P=y(),be&&be.c(),T=y(),B=c("div"),s=c("div"),h=c("div"),h.textContent="\u{1F46A} Population",L=y(),N=c("div"),X=v(M),q=v("/"),U=v(H),J=y(),re=c("div"),z=c("div"),z.textContent="\u{1F9D1}\u200D\u{1F33E} Employees",R=y(),W=c("div"),te=v(Q),le=v("/"),Ae=v(he),I=y(),G=c("br"),ge=y(),ye&&ye.c(),ze=y(),ae=c("div"),fe=c("div"),fe.textContent="\u{1F9E0} Knowledge",ce=y(),ue=c("div"),Ve=v(et),Se=y(),De=c("div"),Ye=c("div"),Ye.textContent="\u{1F4B0} Gold",Le=y(),ne=c("div"),ie=v(ve),ol=y(),il=c("br"),sl=y(),we&&we.c(),al=y(),tt=c("div"),St=c("div"),St.textContent="\u{1F4B0} Tourism Gold",rl=y(),vt=c("div"),fl=v("$"),Jt=v(Lt),ul=y(),st=c("div"),qt=c("div"),qt.textContent="\u{1F601} Happiness",pl=y(),Fe=c("div"),Je.c(),Ut=y(),at=c("span"),cl=v("("),Ht=v(Pt),dl=v(")"),_l=y(),$e&&$e.c(),ml=y(),rt=c("div"),At=c("div"),At.textContent="\u{1F3E5} Health",hl=y(),Re=c("div"),Ue.c(),jt=y(),ft=c("span"),gl=v("("),Yt=v($t),vl=v(")"),bl=y(),qe&&qe.c(),yl=y(),lt=c("div"),nt=c("div"),wl=v("\u{1F3C6} "),Xe.c(),kl=y(),Il=c("br"),Sl=y(),We=c("div"),Mt=c("div"),Mt.textContent="Tax rate (more tax = less happiness)",Ll=y(),Oe=c("input"),ql=y(),Ke=c("div"),ut=c("button"),ut.textContent="-",Pl=y(),pt=c("div"),Vt=v(Ct),Al=v("%"),$l=y(),ct=c("button"),ct.textContent="+",Wt=y(),de&&de.c(),bt=y(),_e&&_e.c(),yt=xe(),d(l,"class","heading_l"),d(f,"class","subheading_m svelte-vu26gz"),d(t,"class","header__left svelte-vu26gz"),d(h,"class","subheading_m svelte-vu26gz"),d(N,"class","text_m svelte-vu26gz"),d(s,"class","svelte-vu26gz"),d(z,"class","subheading_m svelte-vu26gz"),d(W,"class","text_m svelte-vu26gz"),d(re,"class","svelte-vu26gz"),d(fe,"class","subheading_m svelte-vu26gz"),d(ue,"class","text_m svelte-vu26gz"),d(ae,"class","svelte-vu26gz"),d(Ye,"class","subheading_m svelte-vu26gz"),d(ne,"class","text_m svelte-vu26gz"),d(De,"class","svelte-vu26gz"),d(St,"class","subheading_m svelte-vu26gz"),d(vt,"class","text_m svelte-vu26gz"),d(tt,"class","svelte-vu26gz"),d(qt,"class","subheading_m svelte-vu26gz"),d(at,"class","text_ss gray"),d(Fe,"class","text_m svelte-vu26gz"),d(st,"class","svelte-vu26gz"),d(At,"class","subheading_m svelte-vu26gz"),d(ft,"class","text_ss gray"),d(Re,"class","text_m svelte-vu26gz"),d(rt,"class","svelte-vu26gz"),d(B,"class","header__right svelte-vu26gz"),d(nt,"class","text_m pointer"),d(Mt,"class","subheading_m svelte-vu26gz"),d(Oe,"type","range"),d(Oe,"min","0"),d(Oe,"max","1"),d(Oe,"step","0.01"),d(pt,"class","text_m"),d(Ke,"class","incrementalButtons svelte-vu26gz"),d(We,"class","taxInfo svelte-vu26gz"),d(e,"class","header noselect svelte-vu26gz")},m(E,Y){k(E,e,Y),a(e,t),a(t,l),a(l,r),a(t,i),a(t,f),a(t,_),a(t,u),a(u,p),a(u,m),a(u,g),a(u,S),a(u,b),a(u,$),a(u,C),a(u,O),a(u,A),a(t,P),be&&be.m(t,null),a(e,T),a(e,B),a(B,s),a(s,h),a(s,L),a(s,N),a(N,X),a(N,q),a(N,U),a(B,J),a(B,re),a(re,z),a(re,R),a(re,W),a(W,te),a(W,le),a(W,Ae),a(W,I),a(W,G),a(W,ge),ye&&ye.m(W,null),a(B,ze),a(B,ae),a(ae,fe),a(ae,ce),a(ae,ue),a(ue,Ve),a(B,Se),a(B,De),a(De,Ye),a(De,Le),a(De,ne),a(ne,ie),a(ne,ol),a(ne,il),a(ne,sl),we&&we.m(ne,null),a(B,al),a(B,tt),a(tt,St),a(tt,rl),a(tt,vt),a(vt,fl),a(vt,Jt),a(B,ul),a(B,st),a(st,qt),a(st,pl),a(st,Fe),Je.m(Fe,null),a(Fe,Ut),a(Fe,at),a(at,cl),a(at,Ht),a(at,dl),a(Fe,_l),$e&&$e.m(Fe,null),a(B,ml),a(B,rt),a(rt,At),a(rt,hl),a(rt,Re),Ue.m(Re,null),a(Re,jt),a(Re,ft),a(ft,gl),a(ft,Yt),a(ft,vl),a(Re,bl),qe&&qe.m(Re,null),a(e,yl),a(e,lt),a(lt,nt),a(nt,wl),Xe.m(nt,null),a(lt,kl),a(lt,Il),a(lt,Sl),a(lt,We),a(We,Mt),a(We,Ll),a(We,Oe),Gl(Oe,n[1].economyAndLaws.tax_rate),a(We,ql),a(We,Ke),a(Ke,ut),a(Ke,Pl),a(Ke,pt),a(pt,Vt),a(pt,Al),a(Ke,$l),a(Ke,ct),k(E,Wt,Y),de&&de.m(E,Y),k(E,bt,Y),_e&&_e.m(E,Y),k(E,yt,Y),pe=!0,Kt||(Ml=[x(l,"dblclick",n[7]),x(p,"click",n[8]),x(g,"click",n[9]),x(De,"click",n[13]),x(tt,"click",n[14]),x(nt,"click",n[15]),x(Oe,"change",n[16]),x(Oe,"input",n[16]),x(Oe,"change",n[10]),x(ut,"mousedown",n[17]),x(ut,"mouseup",n[18]),x(ut,"click",n[19]),x(pt,"dblclick",n[20]),x(ct,"mousedown",n[21]),x(ct,"mouseup",n[22]),x(ct,"click",n[23])],Kt=!0)},p(E,[Y]){(!pe||Y&2)&&o!==(o=E[1].townInfo.name+"")&&D(r,o),(!pe||Y&1)&&D(b,E[0]),(!pe||Y&4)&&D(C,E[2]),(!pe||Y&8)&&D(A,E[3]),E[1].townLog.length>0?be?be.p(E,Y):(be=hn(E),be.c(),be.m(t,null)):be&&(be.d(1),be=null),(!pe||Y&2)&&M!==(M=E[1].townInfo.population_count+"")&&D(X,M),(!pe||Y&2)&&H!==(H=E[1].townInfo.population_max+"")&&D(U,H),(!pe||Y&2)&&Q!==(Q=E[1].townInfo.employees+"")&&D(te,Q),(!pe||Y&2)&&he!==(he=E[1].townInfo.population_count+"")&&D(Ae,he),E[1].townInfo.population_count-E[1].townInfo.employees>0?ye?ye.p(E,Y):(ye=gn(E),ye.c(),ye.m(W,null)):ye&&(ye.d(1),ye=null),(!pe||Y&2)&&et!==(et=E[1].townInfo.knowledge_points+"")&&D(Ve,et),(!pe||Y&2)&&ve!==(ve=E[1].townInfo.gold+"")&&D(ie,ve),dt===(dt=Cl(E))&&we?we.p(E,Y):(we&&we.d(1),we=dt&&dt(E),we&&(we.c(),we.m(ne,null))),(!pe||Y&2)&&Lt!==(Lt=E[1].townInfo.gold_from_tourism+"")&&D(Jt,Lt),Ot===(Ot=Ol(E))&&Je?Je.p(E,Y):(Je.d(1),Je=Ot(E),Je&&(Je.c(),Je.m(Fe,Ut))),(!pe||Y&2)&&Pt!==(Pt=je(E[1].modifiers.happiness,2)+"")&&D(Ht,Pt),_t!==(_t=Nl(E))&&($e&&$e.d(1),$e=_t&&_t(E),$e&&($e.c(),$e.m(Fe,null))),Nt===(Nt=Tl(E))&&Ue?Ue.p(E,Y):(Ue.d(1),Ue=Nt(E),Ue&&(Ue.c(),Ue.m(Re,jt))),(!pe||Y&2)&&$t!==($t=je(E[1].modifiers.health,2)+"")&&D(Yt,$t),E[1].townInfo.health>=300?qe||(qe=vn(),qe.c(),qe.m(Re,null)):qe&&(qe.d(1),qe=null),Tt!==(Tt=El(E))&&(Xe.d(1),Xe=Tt(E),Xe&&(Xe.c(),Xe.m(nt,null))),Y&2&&Gl(Oe,E[1].economyAndLaws.tax_rate),(!pe||Y&2)&&Ct!==(Ct=(E[1].economyAndLaws.tax_rate*100).toFixed(0)+"")&&D(Vt,Ct),E[5]?de?Y&32&&F(de,1):(de=bn(),de.c(),F(de,1),de.m(bt.parentNode,bt)):de&&(Te(),K(de,1,1,()=>{de=null}),Ee()),E[6]?_e?Y&64&&F(_e,1):(_e=yn(),_e.c(),F(_e,1),_e.m(yt.parentNode,yt)):_e&&(Te(),K(_e,1,1,()=>{_e=null}),Ee())},i(E){pe||(F(de),F(_e),pe=!0)},o(E){K(de),K(_e),pe=!1},d(E){E&&w(e),be&&be.d(),ye&&ye.d(),we&&we.d(),Je.d(),$e&&$e.d(),Ue.d(),qe&&qe.d(),Xe.d(),E&&w(Wt),de&&de.d(E),E&&w(bt),_e&&_e.d(E),E&&w(yt),Kt=!1,Ze(Ml)}}}function je(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Eo(n,e,t){let l,o,r;ee(n,j,q=>t(1,l=q)),ee(n,Dt,q=>t(24,o=q)),ee(n,zt,q=>t(6,r=q));let i=Math.floor(l.environment.day/365)+1,f=l.environment.day%365;function _(){let q=prompt("Enter a new name for your town (under 200 chars)");if(q&&q.length<200){let H=l;H.townInfo.name=q,j.set(H),localStorage.setItem(Ie,JSON.stringify(H))}}let{speedMultiplier:u=1}=e;function p(){let q=o;q=q*2,q>=8e3&&(q=8e3),V(Dt,o=q,o),t(0,u=2e3/o)}function m(){let q=o;q=q/2,q<=250&&(q=250),V(Dt,o=q,o),t(0,u=2e3/o)}function g(q){let H=l;H.economyAndLaws.tax_rate=je(q.target.value,2),j.set(H),localStorage.setItem(Ie,JSON.stringify(H))}function S(){let q=l;q.hasABank===!0?(q.townInfo.gold+=q.townInfo.gold_from_tourism,q.townInfo.gold_from_tourism=0,j.set(q),localStorage.setItem(Ie,JSON.stringify(q))):alert("You need a bank to transfer funds from tourism activities.")}document.addEventListener("keydown",q=>{switch(q.key.toLowerCase()){case"1":q.preventDefault(),p();break;case"2":q.preventDefault(),m();break}});let b,$=!1;const C=()=>{V(j,l.townLog="",l)},O=()=>{let q=r;q=!q,zt.set(q)},A=()=>{S()},P=()=>t(5,$=!$);function T(){l.economyAndLaws.tax_rate=Nn(this.value),j.set(l)}const B=()=>{t(4,b=setInterval(()=>{let q=l;q.economyAndLaws.tax_rate=je(q.economyAndLaws.tax_rate-.01,2),j.set(q),localStorage.setItem(Ie,JSON.stringify(q))},100))},s=()=>{clearInterval(b)},h=()=>{let q=l;q.economyAndLaws.tax_rate=je(q.economyAndLaws.tax_rate-.01,2)},L=()=>{let q=parseFloat(prompt("Set a new tax rate (0-1)"));if(q&&q>=0&&q<=1){let H=l;H.economyAndLaws.tax_rate=je(q,2),j.set(H),localStorage.setItem(Ie,JSON.stringify(H))}},N=()=>{t(4,b=setInterval(()=>{let q=l;q.economyAndLaws.tax_rate=je(q.economyAndLaws.tax_rate+.01,2),j.set(q),localStorage.setItem(Ie,JSON.stringify(q))},100))},M=()=>{clearInterval(b)},X=()=>{let q=l;q.economyAndLaws.tax_rate=je(q.economyAndLaws.tax_rate+.01,2),j.set(q),localStorage.setItem(Ie,JSON.stringify(q))};return n.$$set=q=>{"speedMultiplier"in q&&t(0,u=q.speedMultiplier)},n.$$.update=()=>{n.$$.dirty&2&&(t(2,i=Math.floor(l.environment.day/365)+1),t(3,f=l.environment.day%365))},[u,l,i,f,b,$,r,_,p,m,g,S,C,O,A,P,T,B,s,h,L,N,M,X]}class Bo extends Ge{constructor(e){super(),Be(this,e,Eo,To,Pe,{speedMultiplier:0})}}function Go(n){let e,t,l,o,r,i,f,_,u,p,m,g,S,b,$,C,O,A,P;return{c(){e=c("div"),t=c("div"),l=v(`The game is paused!
		`),o=c("br"),r=v(`
		Load file:
		`),i=c("input"),f=y(),_=c("br"),u=v(`
		Backup save:
		`),p=c("button"),p.textContent="Save",m=y(),g=c("br"),S=v(`
		Unpause the game by pressing P
		`),b=c("br"),$=y(),C=c("br"),O=v(`
		Reset the game by pressing SHIFT+ESC`),d(i,"type","file"),d(i,"id","upload"),d(p,"id","save"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(T,B){k(T,e,B),a(e,t),a(t,l),a(t,o),a(t,r),a(t,i),a(t,f),a(t,_),a(t,u),a(t,p),a(t,m),a(t,g),a(t,S),a(t,b),a(t,$),a(t,C),a(t,O),A||(P=[x(i,"change",n[1]),x(p,"click",n[0])],A=!0)},p:Z,i:Z,o:Z,d(T){T&&w(e),A=!1,Ze(P)}}}function Do(n){const e=JSON.parse(n);return e.townInfo!=null&&e.difficulty!=null}function Fo(n,e,t){let l;ee(n,j,i=>t(2,l=i));function o(){const i=JSON.stringify(l),f=new Blob([i],{type:"text/plain"}),_=URL.createObjectURL(f),u=document.createElement("a");u.href=_,u.download=`${new Date().toISOString()}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(_)}function r(){const f=document.getElementById("upload").files[0],_=new FileReader;_.onload=function(u){const p=u.target.result;if(typeof p=="string"){if(!Do(p)){alert("Invalid game file");return}nl(JSON.parse(p))}else alert("Invalid game file: is not String.")},_.readAsText(f)}return[o,r]}class Ro extends Ge{constructor(e){super(),Be(this,e,Fo,Go,Pe,{})}}function wn(n){let e,t,l,o,r,i=n[0].endGameDetails.msg+"",f,_,u,p,m,g;return{c(){e=c("div"),t=c("div"),l=v(`GAME OVER
			`),o=c("br"),r=y(),f=v(i),_=y(),u=c("br"),p=y(),m=c("br"),g=v(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(S,b){k(S,e,b),a(e,t),a(t,l),a(t,o),a(t,r),a(t,f),a(t,_),a(t,u),a(t,p),a(t,m),a(t,g)},p(S,b){b&1&&i!==(i=S[0].endGameDetails.msg+"")&&D(f,i)},d(S){S&&w(e)}}}function Jo(n){let e,t=n[0].endGameDetails!=null&&wn(n);return{c(){t&&t.c(),e=xe()},m(l,o){t&&t.m(l,o),k(l,e,o)},p(l,[o]){l[0].endGameDetails!=null?t?t.p(l,o):(t=wn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Z,o:Z,d(l){t&&t.d(l),l&&w(e)}}}function Uo(n,e,t){let l;return ee(n,j,o=>t(0,l=o)),[l]}class Ho extends Ge{constructor(e){super(),Be(this,e,Uo,Jo,Pe,{})}}function jo(n){let e,t,l,o,r,i,f,_,u,p,m,g,S,b,$,C,O,A,P,T,B;return{c(){e=c("div"),t=c("div"),l=v(`Welcome to Plots!
		`),o=c("br"),r=v(`
		Select a difficulty
		`),i=c("select"),f=c("option"),f.textContent="Easy (quick game)",_=c("option"),_.textContent="Normal (longer game)",u=c("option"),u.textContent="Hard (longest game)",p=y(),m=c("br"),g=v(`
		Select a goal
		`),S=c("select"),b=c("option"),b.textContent="Fill up the grid",$=c("option"),$.textContent="Rule the world through politics",C=y(),O=c("br"),A=y(),P=c("button"),P.textContent="Start game",f.__value="0",f.value=f.__value,_.__value="1",_.value=_.__value,_.selected=!0,u.__value="2",u.value=u.__value,d(i,"id","difficulty"),b.__value="land",b.value=b.__value,b.selected=!0,$.__value="political",$.value=$.__value,d(S,"id","endGoal"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(s,h){k(s,e,h),a(e,t),a(t,l),a(t,o),a(t,r),a(t,i),a(i,f),a(i,_),a(i,u),a(t,p),a(t,m),a(t,g),a(t,S),a(S,b),a(S,$),a(t,C),a(t,O),a(t,A),a(t,P),T||(B=x(P,"click",n[0]),T=!0)},p:Z,i:Z,o:Z,d(s){s&&w(e),T=!1,B()}}}function Yo(n){function e(){const t=document.getElementById("difficulty").value,l=document.getElementById("endGoal").value;Un(t,l)}return[e]}class Vo extends Ge{constructor(e){super(),Be(this,e,Yo,jo,Pe,{})}}function kn(n){let e,t,l,o;const r=[Ko,Wo],i=[];function f(_,u){return _[0]==null?0:1}return e=f(n),t=i[e]=r[e](n),{c(){t.c(),l=xe()},m(_,u){i[e].m(_,u),k(_,l,u),o=!0},p(_,u){let p=e;e=f(_),e===p?i[e].p(_,u):(Te(),K(i[p],1,1,()=>{i[p]=null}),Ee(),t=i[e],t?t.p(_,u):(t=i[e]=r[e](_),t.c()),F(t,1),t.m(l.parentNode,l))},i(_){o||(F(t),o=!0)},o(_){K(t),o=!1},d(_){i[e].d(_),_&&w(l)}}}function Wo(n){let e,t,l,o,r,i,f,_,u,p,m,g,S,b,$,C,O=n[2]==!0&&In(),A=n[3]==!0&&Sn();return l=new Bo({}),r=new Zn({}),f=new Ho({}),p=new mo({}),{c(){O&&O.c(),e=y(),A&&A.c(),t=y(),Ne(l.$$.fragment),o=y(),Ne(r.$$.fragment),i=y(),Ne(f.$$.fragment),_=y(),u=c("div"),Ne(p.$$.fragment),m=y(),g=c("br"),S=v(`
			outside of city`),b=y(),$=c("style"),$.textContent=`.plot_grid {
				max-width: 300%;
				max-height: 300%;
				overflow-x: scroll;
				overflow-y: scroll;
				width: 300%;
				height: 300vh;
				margin-top: 175px;
			}
			.plot_grid[data-marginRight='true'] {
				/* This is for when the balanceSheet is being shown. */
				margin-right: 224px;
			}`,d(u,"class","plot_grid"),d(u,"data-marginright",n[3])},m(P,T){O&&O.m(P,T),k(P,e,T),A&&A.m(P,T),k(P,t,T),Me(l,P,T),k(P,o,T),Me(r,P,T),k(P,i,T),Me(f,P,T),k(P,_,T),k(P,u,T),Me(p,u,null),a(u,m),a(u,g),a(u,S),k(P,b,T),k(P,$,T),C=!0},p(P,T){P[2]==!0?O?T&4&&F(O,1):(O=In(),O.c(),F(O,1),O.m(e.parentNode,e)):O&&(Te(),K(O,1,1,()=>{O=null}),Ee()),P[3]==!0?A?T&8&&F(A,1):(A=Sn(),A.c(),F(A,1),A.m(t.parentNode,t)):A&&(Te(),K(A,1,1,()=>{A=null}),Ee()),(!C||T&8)&&d(u,"data-marginright",P[3])},i(P){C||(F(O),F(A),F(l.$$.fragment,P),F(r.$$.fragment,P),F(f.$$.fragment,P),F(p.$$.fragment,P),C=!0)},o(P){K(O),K(A),K(l.$$.fragment,P),K(r.$$.fragment,P),K(f.$$.fragment,P),K(p.$$.fragment,P),C=!1},d(P){O&&O.d(P),P&&w(e),A&&A.d(P),P&&w(t),Ce(l,P),P&&w(o),Ce(r,P),P&&w(i),Ce(f,P),P&&w(_),P&&w(u),Ce(p),P&&w(b),P&&w($)}}}function Ko(n){let e,t;return e=new Vo({}),{c(){Ne(e.$$.fragment)},m(l,o){Me(e,l,o),t=!0},p:Z,i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function In(n){let e,t;return e=new Ro({}),{c(){Ne(e.$$.fragment)},m(l,o){Me(e,l,o),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function Sn(n){let e,t;return e=new $n({}),{c(){Ne(e.$$.fragment)},m(l,o){Me(e,l,o),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Ce(e,l)}}}function Xo(n){let e,t,l=(n[1]||n[0]==null)&&kn(n);return{c(){l&&l.c(),e=xe()},m(o,r){l&&l.m(o,r),k(o,e,r),t=!0},p(o,[r]){o[1]||o[0]==null?l?(l.p(o,r),r&3&&F(l,1)):(l=kn(o),l.c(),F(l,1),l.m(e.parentNode,e)):l&&(Te(),K(l,1,1,()=>{l=null}),Ee())},i(o){t||(F(l),t=!0)},o(o){K(l),t=!1},d(o){l&&l.d(o),o&&w(e)}}}function Qo(n,e,t){let l,o,r,i,f;ee(n,gt,g=>t(6,l=g)),ee(n,oe,g=>t(7,o=g)),ee(n,ht,g=>t(2,r=g)),ee(n,j,g=>t(0,i=g)),ee(n,zt,g=>t(3,f=g));let _=!1,u=!1;document.addEventListener("keydown",g=>{if((document.activeElement!=null&&document.activeElement.nodeName==="INPUT"||document.activeElement!=null&&document.activeElement.nodeName=="TEXTAREA")&&g.key!=="Escape")return;switch(g.key.toLowerCase()){case"p":r==!0?ht.set(!1):(ht.set(!0),V(oe,o.visible=!1,o));break;case"escape":g.shiftKey?(V(ht,r=!0,r),localStorage.setItem("reset","true"),location.reload(),nl()):o.visible==!0&&V(oe,o.visible=!1,o);break;case"arrowleft":case"a":g.preventDefault(),p(0,-1,"up");break;case"arrowright":case"d":g.preventDefault(),p(0,1,"down");break;case"arrowup":case"w":g.preventDefault(),p(-1,0,"left");break;case"arrowdown":case"s":g.preventDefault(),p(1,0,"right");break}});function p(g,S,b){if(o.visible===!1&&o.x===0&&o.y===0)m(0,0,b);else{let $=o.x,C=o.y;$+g<0?$=0:$+g>i.plots.length?$=i.plots.length:$+=g,C+S<0?C=0:C+S>i.plots.length?C=i.plots.length:C+=S,m($,C,b)}}function m(g,S,b){if(u==!0)switch(b){case"up":S-=2;break;case"down":S+=1;break;case"left":g-=2;break;case"right":g+=1;break}g<0?g=0:g>i.plots.length&&(g=i.plots.length),S<0?S=0:S>i.plots.length&&(S=i.plots.length);let $=document.querySelectorAll(".plot_container"),C;if($.forEach(O=>{O.dataset.x=="$x"&&O.dataset.y=="$y"&&(C=O)}),r==!1){if(C.dataset.canBeUpgraded==="true"?V(oe,o.visible=!0,o):V(oe,o.visible=!1,o),C.dataset.refPlotX!==void 0&&C.dataset.refPlotY!=""?(u=!0,$.forEach(O=>{O.dataset.x==C.dataset.refPlotX&&O.dataset.y==C.dataset.refPlotY&&(C=O,g=parseInt(C.dataset.x),S=parseInt(C.dataset.y))})):u=!1,C.dataset.size!=="1"&&C.dataset.size!==void 0&&(u=!0),V(oe,o.x=g,o),V(oe,o.y=S,o),$.forEach(O=>{O.classList.remove("selected"),O.style.border="none",O.style.fontWeight=""}),C.classList.add("selected"),u){let O="4px solid #00800045";C.classList.remove("selected"),C.style.borderTop=O,C.style.borderLeft=O,C.style.fontWeight="600",$.forEach(A=>{const P=parseInt(`${A.dataset.x}`),T=parseInt(`${A.dataset.y}`);P==g+1&&T==S&&(A.style.borderLeft=O,A.style.borderBottom=O),P==g&&T==S+1&&(A.style.borderTop=O,A.style.borderRight=O),P==g+1&&T==S+1&&(A.style.borderBottom=O,A.style.borderRight=O)})}C.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),V(gt,l={},l)}}return n.$$.update=()=>{n.$$.dirty&1&&(i?t(1,_=!0):t(1,_=!1))},[i,_,r,f,m]}class Zo extends Ge{constructor(e){super(),Be(this,e,Qo,Xo,Pe,{openPlotMenu:4})}get openPlotMenu(){return this.$$.ctx[4]}}new Zo({target:document.getElementById("app")});
