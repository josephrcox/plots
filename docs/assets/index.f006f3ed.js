(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&l(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(i){if(i.ep)return;i.ep=!0;const r=t(i);fetch(i.href,r)}})();function K(){}function Ln(n){return n()}function Bl(){return Object.create(null)}function Qe(n){n.forEach(Ln)}function Mn(n){return typeof n=="function"}function qe(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function Cn(n){return Object.keys(n).length===0}function On(n,...e){if(n==null)return K;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function z(n,e,t){n.$$.on_destroy.push(On(e,t))}function V(n,e,t){return n.set(t),e}function a(n,e){n.appendChild(e)}function S(n,e,t){n.insertBefore(e,t||null)}function I(n){n.parentNode.removeChild(n)}function ll(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function p(n){return document.createElement(n)}function b(n){return document.createTextNode(n)}function w(){return b(" ")}function Ze(){return b("")}function X(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function d(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Nn(n){return n===""?null:+n}function Tn(n){return Array.from(n.childNodes)}function B(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function Gl(n,e){n.value=e==null?"":e}let It;function kt(n){It=n}function En(){if(!It)throw new Error("Function called outside component initialization");return It}function Ft(n){En().$$.on_mount.push(n)}const wt=[],Qt=[],Bt=[],Dl=[],qn=Promise.resolve();let Zt=!1;function Pn(){Zt||(Zt=!0,qn.then(An))}function Bn(){return Pn(),qn}function xt(n){Bt.push(n)}const Xt=new Set;let Et=0;function An(){const n=It;do{for(;Et<wt.length;){const e=wt[Et];Et++,kt(e),Gn(e.$$)}for(kt(null),wt.length=0,Et=0;Qt.length;)Qt.pop()();for(let e=0;e<Bt.length;e+=1){const t=Bt[e];Xt.has(t)||(Xt.add(t),t())}Bt.length=0}while(wt.length);for(;Dl.length;)Dl.pop()();Zt=!1,Xt.clear(),kt(n)}function Gn(n){if(n.fragment!==null){n.update(),Qe(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(xt)}}const Gt=new Set;let nt;function Ne(){nt={r:0,c:[],p:nt}}function Te(){nt.r||Qe(nt.c),nt=nt.p}function F(n,e){n&&n.i&&(Gt.delete(n),n.i(e))}function W(n,e,t,l){if(n&&n.o){if(Gt.has(n))return;Gt.add(n),nt.c.push(()=>{Gt.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function Dn(n,e){n.d(1),e.delete(n.key)}function Fn(n,e,t,l,i,r,s,f,m,u,c,_){let h=n.length,q=r.length,y=h;const C={};for(;y--;)C[n[y].key]=y;const $=[],M=new Map,A=new Map;for(y=q;y--;){const o=_(i,r,y),v=t(o);let k=s.get(v);k?l&&k.p(o,e):(k=u(v,o),k.c()),M.set(v,$[y]=k),v in C&&A.set(v,Math.abs(y-C[v]))}const P=new Set,E=new Set;function g(o){F(o,1),o.m(f,c),s.set(o.key,o),c=o.first,q--}for(;h&&q;){const o=$[q-1],v=n[h-1],k=o.key,G=v.key;o===v?(c=o.first,h--,q--):M.has(G)?!s.has(k)||P.has(k)?g(o):E.has(G)?h--:A.get(k)>A.get(G)?(E.add(k),g(o)):(P.add(G),h--):(m(v,s),h--)}for(;h--;){const o=n[h];M.has(o.key)||m(o,s)}for(;q;)g($[q-1]);return $}function Oe(n){n&&n.c()}function $e(n,e,t,l){const{fragment:i,on_mount:r,on_destroy:s,after_update:f}=n.$$;i&&i.m(e,t),l||xt(()=>{const m=r.map(Ln).filter(Mn);s?s.push(...m):Qe(m),n.$$.on_mount=[]}),f.forEach(xt)}function Me(n,e){const t=n.$$;t.fragment!==null&&(Qe(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Rn(n,e){n.$$.dirty[0]===-1&&(wt.push(n),Pn(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Ee(n,e,t,l,i,r,s,f=[-1]){const m=It;kt(n);const u=n.$$={fragment:null,ctx:null,props:r,update:K,not_equal:i,bound:Bl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(m?m.$$.context:[])),callbacks:Bl(),dirty:f,skip_bound:!1,root:e.target||m.$$.root};s&&s(u.root);let c=!1;if(u.ctx=t?t(n,e.props||{},(_,h,...q)=>{const y=q.length?q[0]:h;return u.ctx&&i(u.ctx[_],u.ctx[_]=y)&&(!u.skip_bound&&u.bound[_]&&u.bound[_](y),c&&Rn(n,_)),h}):[],u.update(),c=!0,Qe(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const _=Tn(e.target);u.fragment&&u.fragment.l(_),_.forEach(I)}else u.fragment&&u.fragment.c();e.intro&&F(n.$$.fragment),$e(n,e.target,e.anchor,e.customElement),An()}kt(m)}class Be{$destroy(){Me(this,1),this.$destroy=K}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const i=l.indexOf(t);i!==-1&&l.splice(i,1)}}$set(e){this.$$set&&!Cn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const _t=[];function ot(n,e=K){let t;const l=new Set;function i(f){if(qe(n,f)&&(n=f,t)){const m=!_t.length;for(const u of l)u[1](),_t.push(u,n);if(m){for(let u=0;u<_t.length;u+=2)_t[u][0](_t[u+1]);_t.length=0}}}function r(f){i(f(n))}function s(f,m=K){const u=[f,m];return l.add(u),l.size===1&&(t=e(i)||K),f(n),()=>{l.delete(u),l.size===0&&(t(),t=null)}}return{set:i,update:r,subscribe:s}}const Jn={plots:[],lastChangeDay:0,townLog:"",townInfo:{name:"Your town",gold:1e3,gold_from_tourism:0,population_count:0,population_max:0,employees:0,happiness:100,health:100,knowledge_points:0},hasCityHall:!1,hasBank:!1,modifiers:{happiness:1,health:1},economyAndLaws:{tax_rate:0,max_tax_rate:1,balance_sheet_history:[],last_month_profit:0},plotCounts:[],environment:{day:0,year:1,climate:-1},difficulty:0,endGoal:"land",endGameDetails:null},ke="plots_active_game_db";let j=ot(JSON.parse(localStorage.getItem(ke)||"null"));function Un(n,e){let t={...Jn};t.economyAndLaws.max_tax_rate=Math.random()*(.5-.2)+.2,t.endGoal=e;let l=[];const i=n=="0"?6:n=="1"?Math.floor(Math.random()*4)+7:n=="2"?Math.floor(Math.random()*9)+12:35;for(let r=0;r<i;r++){l.push([]);for(let s=0;s<i;s++)l[r][s]={id:Math.random().toString(36).substring(2,9),active:!1,x:r,y:s,type:-1}}t.plots=l,localStorage.reset=!1,localStorage.setItem(ke,JSON.stringify(t)),j.set(t),location.reload()}function nl(n=null){localStorage.removeItem(ke),j.set(null),n&&(localStorage.setItem(ke,JSON.stringify(n)),j.set(n)),location.reload()}let le=ot({visible:!1,x:0,y:0}),gt=ot({}),ht=ot(!1),zt=ot(!1),Dt=ot(2e3);ot(localStorage.getItem("showUnaffordablePlotOptions")==="true");const oe=[{id:"res_small",title:"\u{1F3E0} Residential (small)",subtitle:"for living",type:"residential",description:"A few basic homes that can hold 16 people.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:16},styling:"background-color: #e15f00"},{id:"res_medium",title:"\u{1F3D8}\uFE0F Residential (medium)",subtitle:"for living",type:"residential",description:"A few high-density buildings that can hold 64 people.",revenue_per_week:0,requirements:{gold:500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:64},styling:"background-color: #e15f00"},{id:"res_large",title:"\u{1F3E2} Residential (large)",subtitle:"for living",type:"residential",description:"Many high-density buildings that can hold 256 people.",revenue_per_week:0,requirements:{gold:1500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:256},styling:"background-color: #e15f00"},{id:"cafe",title:"\u2615\uFE0F Small caf\xE9",subtitle:"for recreation & food",type:"food",description:"Great for eating & relaxing, not great for long-term health.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:16,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:.95},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #d24646;"},{id:"carrot_farm",title:"\u{1F955} Carrot farm",subtitle:"for farming",type:"farm",description:"Farm for making carrots, makes money by selling them.",revenue_per_week:6,requirements:{gold:25,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"apple_orchard",title:"\u{1F34E} Apple orchard",subtitle:"for farming",type:"farm",description:"A bunch of trees that make apples, makes money by selling them and by selling apple-related products.",revenue_per_week:8,requirements:{gold:50,plots:[],employees:4,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"bakery",title:"\u{1F956} Bakery",subtitle:"for baking",type:"farm",description:"Makes money by selling bread.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:3,climate:null,knowledge:0},effect_modifiers:{happiness:1.11,health:.92},immediate_variable_changes:{happiness:25,health:0,population:0},styling:"background-color: #008000;"},{id:"grocery",title:"\u{1F3EA} Grocery store",subtitle:"for living",type:"food",description:"People get hungry. This is where they go to get food.",revenue_per_week:40,requirements:{gold:320,plots:[],employees:24,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"fishery",title:"\u{1F420} Fishery",subtitle:"for fishing",type:"food",description:"Carve out some land, pour some water, and fish for fun & food.",revenue_per_week:25,requirements:{gold:400,plots:[],employees:9,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"library",title:"\u{1F4D5} Library",subtitle:"for reading",type:"recreation",description:"Reading makes people very happy, but doesn't make money.",revenue_per_week:0,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:1},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #4169e1;"},{id:"pub",title:"\u{1F37B} Pub",subtitle:"for hanging",type:"recreation",description:"Makes money, and somehow generates communal knowledge.",revenue_per_week:50,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:.7},immediate_variable_changes:{happiness:10,health:-25,population:0},styling:"background-color: #4169e1;"},{id:"church",title:"\u26EA\uFE0F Church",subtitle:"for worship & community",type:"recreation",description:"This can make some people happy, but doesn't make money.",revenue_per_week:0,requirements:{gold:100,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"stables",title:"\u{1F434} Stables",subtitle:"for friends",type:"recreation",description:"People love horses. This makes them happy, and can generate some money through lessons.",revenue_per_week:10,requirements:{gold:220,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"blacksmith",title:"\u2694\uFE0F Blacksmith",subtitle:"for making shiny things",type:"shop",description:"Sometimes problems can only be dealt with by a hunk of metal. Makes money by selling weapons, tools, & armor.",revenue_per_week:50,requirements:{gold:1300,plots:[],employees:13,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1.5},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"inn",title:"\u{1F6CC} Village Inn",subtitle:"for a night out",type:"tourism",description:"Generates tourism gold that can be used if you have a bank.",revenue_per_week:0,enables_tourism:!0,tourism_revenue_per_week:15,requirements:{gold:1500,plots:[],employees:14,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"park_small",title:"\u{1F332} Small park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"A few benches and a small grassy area.",revenue_per_week:0,requirements:{gold:80,plots:[],employees:1,climate:null,knowledge:0},effect_modifiers:{happiness:1.01,health:1.07},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_medium",title:"\u{1F6DD} Medium park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Benches, grass, and a couple of swing-sets.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.02,health:1.15},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_large",title:"\u{1F3AA} Large park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Same as the medium park, with a nice fountain in the middle and occasional events run by the employees.",revenue_per_week:0,requirements:{gold:300,plots:[],employees:4,climate:null,size:2,knowledge:0},effect_modifiers:{happiness:1.09,health:1.25},immediate_variable_changes:{happiness:30,health:0,population:0},styling:"background-color: #ffff00;"},{id:"school_small",title:"\u{1F4DA} Small school",subtitle:"for learning",type:"education",description:"A place where children can learn and grow, and where adults can learn new skills. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:2,requirements:{gold:850,plots:[],employees:20,climate:null,size:1,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:15,health:3,population:0},styling:"background-color: #4caf50;"},{id:"school_large",title:"\u{1F68C} Large school",subtitle:"for learning",type:"education",description:"A larger school. Produces knowledge",revenue_per_week:0,knowledge_points_per_month:8,requirements:{gold:1300,plots:[],employees:40,climate:null,size:2,knowledge:10},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:5,health:3,population:0},styling:"background-color: #4caf50;"},{id:"university",title:"\u{1F3EB} University",subtitle:"for learning",type:"education",description:"The supreme learning institution. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:25,requirements:{gold:3500,plots:[],employees:64,climate:null,size:2,knowledge:100},effect_modifiers:{happiness:1.25,health:1},immediate_variable_changes:{happiness:25,health:25,population:0},styling:"background-color: #4caf50;"},{id:"small_hospital",title:"\u{1F691} Small hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from minor injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:800,plots:[],employees:8,climate:null,size:1,knowledge:50},effect_modifiers:{happiness:1.25,health:1.5},immediate_variable_changes:{happiness:5,health:50,population:0},styling:"background-color: #ff0000;"},{id:"large_hospital",title:"\u{1F3E5} Large hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from all injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:4e3,plots:[],employees:64,climate:null,size:1,knowledge:200},effect_modifiers:{happiness:1.25,health:2.5},immediate_variable_changes:{happiness:5,health:75,population:0},styling:"background-color: #ff0000;"},{id:"bank",title:"\u{1F3E6} Bank",subtitle:"for storing and accessing funds",type:"bank",description:"Rich get richer.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:64,climate:null,size:1,knowledge:300},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"},{id:"city-hall",title:"\u{1F5F3}\uFE0F City Hall",subtitle:"for bureaucracy",type:"federal",description:"For running the government.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:24,climate:null,size:1,knowledge:500},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"}],we={unemployment_num:" people can't find jobs.",bored:"People are bored. Try making some new buildings.",vairety:"People don't like going to the same places over and over again. Try making some new buildings.",nobody_home:"Nobody can live here. Build some residential buildings.",leave_town_num:" people left town because they were unhappy.",new_people_num:" new people moved to town.",people_want_to_move_in:"People want to move in. Build more homes.",high_tax_rate:"People are unhappy with the high tax rate.",very_high_tax_rate:"People are extremely unhappy with the high tax rate.",sickAndDying:"People are sick and dying.",sickAndLeaving:"People are sick and leaving town.",happiness_zero:"The town has fallen into chaos due to extreme unhappiness.",health_zero:"The town has fallen into chaos due to extreme sickness.",population_zero:"The town has been condemned due to lack of population.",win:{land:"You have filled the grid with buildings. You win!"}};function Fl(n){let e,t,l=oe[n[0].type].title+"",i,r;return{c(){e=p("div"),t=p("span"),i=b(l),d(t,"data-size",r=oe[n[0].type].requirements.size),d(t,"class","svelte-18cb8zy"),d(e,"class","svelte-18cb8zy")},m(s,f){S(s,e,f),a(e,t),a(t,i)},p(s,f){f&1&&l!==(l=oe[s[0].type].title+"")&&B(i,l),f&1&&r!==(r=oe[s[0].type].requirements.size)&&d(t,"data-size",r)},d(s){s&&I(e)}}}function Hn(n){let e,t,l,i,r,s,f,m,u,c,_,h,q=n[0].type>-1&&Fl(n);return{c(){e=p("div"),q&&q.c(),d(e,"class","plot_container svelte-18cb8zy"),d(e,"data-active",t=n[0].active),d(e,"data-id",l=n[0].id),d(e,"data-x",i=n[0].x),d(e,"data-y",r=n[0].y),d(e,"data-optionindex",s=n[0].optionIndex),d(e,"data-canbeupgraded",n[1]),d(e,"style",n[2]),d(e,"data-type",f=n[0].type),d(e,"data-referenceplotx",m=n[0].referencePlot!==void 0?n[0].referencePlot[0]:null),d(e,"data-referenceploty",u=n[0].referencePlot!==void 0?n[0].referencePlot[1]:null),d(e,"data-size",c=n[0].type>-1?oe[n[0].type].requirements.size:null)},m(y,C){S(y,e,C),q&&q.m(e,null),_||(h=X(e,"click",n[3]),_=!0)},p(y,[C]){y[0].type>-1?q?q.p(y,C):(q=Fl(y),q.c(),q.m(e,null)):q&&(q.d(1),q=null),C&1&&t!==(t=y[0].active)&&d(e,"data-active",t),C&1&&l!==(l=y[0].id)&&d(e,"data-id",l),C&1&&i!==(i=y[0].x)&&d(e,"data-x",i),C&1&&r!==(r=y[0].y)&&d(e,"data-y",r),C&1&&s!==(s=y[0].optionIndex)&&d(e,"data-optionindex",s),C&2&&d(e,"data-canbeupgraded",y[1]),C&4&&d(e,"style",y[2]),C&1&&f!==(f=y[0].type)&&d(e,"data-type",f),C&1&&m!==(m=y[0].referencePlot!==void 0?y[0].referencePlot[0]:null)&&d(e,"data-referenceplotx",m),C&1&&u!==(u=y[0].referencePlot!==void 0?y[0].referencePlot[1]:null)&&d(e,"data-referenceploty",u),C&1&&c!==(c=y[0].type>-1?oe[y[0].type].requirements.size:null)&&d(e,"data-size",c)},i:K,o:K,d(y){y&&I(e),q&&q.d(),_=!1,h()}}}function jn(n,e,t){let l,i,r,s;z(n,le,y=>t(5,l=y)),z(n,j,y=>t(6,i=y)),z(n,ht,y=>t(7,r=y)),z(n,gt,y=>t(8,s=y));let{data:f={id:0,active:!1,x:0,y:0,type:-1,styling:"",referencePlot:[]}}=e,{canBeUpgraded:m=!1}=e;function u(...y){_()}let c=f.styling;Ft(async()=>{f.type>=0&&oe[f.type].styling&&t(2,c=oe[f.type].styling)});function _(){f.type>=0&&oe[f.type].styling&&t(2,c=oe[f.type].styling),f.type<0&&t(2,c="")}function h(y,C,$){let M=document.querySelectorAll(".plot_container");if(r==!1){if(f.referencePlot!=null&&f.referencePlot[0]!==null&&C==null&&$==null&&f.referencePlot[1]!==void 0)return h(y,f.referencePlot[0],f.referencePlot[1]);!f.active&&!m?(V(gt,s={},s),V(le,l.visible=!1,l),M.forEach(A=>{A.classList.remove("selected")})):(C!=null&&$!=null?(V(le,l.x=C,l),V(le,l.y=$,l)):(V(le,l.x=f.x,l),V(le,l.y=f.y,l)),V(le,l.visible=!0,l),M.forEach(A=>{A.classList.remove("selected")}),C!=null&&$!=null?document.querySelector(`.plot_container[data-x="${C}"][data-y="${$}"]`).classList.add("selected"):document.querySelector(`.plot_container[data-id="${f.id}"]`).classList.add("selected"))}}function q(y){r==!1&&(V(j,i.plots[f.x][f.y].type=y,i),V(le,l.visible=!1,l))}return n.$$set=y=>{"data"in y&&t(0,f=y.data),"canBeUpgraded"in y&&t(1,m=y.canBeUpgraded)},n.$$.update=()=>{n.$$.dirty&1&&u(f)},[f,m,c,h,q]}class Yn extends Be{constructor(e){super(),Ee(this,e,jn,Hn,qe,{data:0,canBeUpgraded:1,changePlotType:4})}get changePlotType(){return this.$$.ctx[4]}}const mt={land:{short_title:"Fill the grid",description_title:"You win by filling up all possible plots in the grid, and by meeting some requirements.",win:"You have filled the grid with buildings. You win!",requirements:{0:{population_count:200,happiness:100,health:100,employment:1},1:{population_count:500,happiness:100,health:100,employment:1},2:{population_count:1e3,happiness:100,health:100,employment:1}}}};function Vn(n){return n.hasBank,n}function Wn(n){return n.hasCityHall,n}function el(n){if(n.modifiers.happiness>1){let e=n.modifiers.happiness-1;n.modifiers.happiness-=e*.08,n.modifiers.happiness<1.05&&(n.modifiers.happiness=1)}if(n.modifiers.health>1){let e=n.modifiers.health-1;n.modifiers.health-=e*.08,n.modifiers.health<1.05&&(n.modifiers.health=1)}return n}function tl(n){if(n.townInfo.happiness>150){let t=n.townInfo.happiness-150;n.townInfo.happiness-=t*.08,n.townInfo.happiness<150&&(n.townInfo.happiness=150)}if(n.townInfo.health>150){let t=n.townInfo.health-150;n.townInfo.health-=t*.08,n.townInfo.health<150&&(n.townInfo.health=150)}return n}function Kn(n){return n.townInfo.happiness*=n.modifiers.happiness,n.townInfo.health*=n.modifiers.health,n}function Xn(n,e){let t=e.townInfo.happiness/100;t>1.25?t=1.25:t<.75&&(t=.75);let l=n*e.economyAndLaws.tax_rate*(e.townInfo.population_count/e.townInfo.population_max)*t;return Xe(l,2)}function Xe(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Qn(n,e,t){let l,i,r;z(n,Dt,o=>t(4,l=o)),z(n,j,o=>t(5,i=o)),z(n,ht,o=>t(6,r=o));function s(o){return o=q(o),o=M(o),o=P(o),o=Kn(o),o=y(o),o=el(o),o}function f(o){return o=E(o),o=$(o),o=Vn(o),o=Wn(o),o}function m(o){return o=C(o),o=tl(o),o}function u(o){return o=A(o),o=h(o),o=_(o),o}function c(){j.update(o=>{if(r||!o||o.endGameDetails)return o;try{return o.environment.day+=1,o.environment.day%7===0&&(o=s(o)),o.environment.day%30===0&&(o=f(o)),o.environment.day%90===0&&(o=m(o)),o=u(o),o}catch(v){return console.error("Error in game loop:",v),o}})}j.subscribe(o=>{o&&localStorage.setItem(ke,JSON.stringify(o))});function _(o){if(o.endGoal=="land"&&o.townInfo.population_max==o.townInfo.population_count&&o.townInfo.happiness>=mt.land.requirements[o.difficulty].happiness&&o.townInfo.health>=mt.land.requirements[o.difficulty].health&&o.townInfo.employees/o.townInfo.population_count>=mt.land.requirements[o.difficulty].employment&&o.townInfo.population_count>mt.land.requirements[o.difficulty].population){let k=!0;for(let G=0;G<o.plots.length;G++)for(let R=0;R<o.plots[G].length;R++)if(o.plots[G][R].active==!1){k=!1;break}k&&(o.endGameDetails={msg:mt.land.win,win:!0})}return o}function h(o){return o.townInfo.happiness<=0&&(o.townInfo.happiness=0,o.endGameDetails={msg:we.happiness_zero,win:!1}),o.townInfo.health<=0&&(o.townInfo.health=0,o.endGameDetails={msg:we.health_zero,win:!1}),o.townInfo.population_count<=0&&o.townInfo.population_max>0&&(o.townInfo.population_count=0,o.endGameDetails={msg:we.population_zero,win:!1}),o}function q(o){let v=o.townInfo.population_count-o.townInfo.employees;return v>0&&(o.modifiers.happiness-=v*9e-4,o=g(v+we.unemployment_num,o)),o}function y(o){let v=o.townInfo.health,k=0;return v>50||v<Math.random()*50&&(v<25?(o=g(we.sickAndDying,o),o.townInfo.happiness-=10,k=Math.round(o.townInfo.population_count*.1)):(o=g(we.sickAndLeaving,o),o.townInfo.happiness-=5,k=Math.round(o.townInfo.population_count*.05)),o.townInfo.population_count-=k,o.townInfo.employees-=k),o}function C(o){return o.lastChangeDay+(Math.random()*160+50)<o.environment.day&&(o.townInfo.population_count>0&&(o.townInfo.population_count-=1,o.townInfo.employees-=1,o.modifiers.happiness-=.01),o=g(we.bored,o)),o}function $(o){if(o.townInfo.population_count<o.townInfo.population_max&&o.townInfo.happiness>50){let v=o.townInfo.population_max-o.townInfo.population_count,k=Math.round(o.townInfo.happiness/100*v);o.townInfo.population_count+=k,o.townInfo.population_count>o.townInfo.population_max&&(o.townInfo.population_count=o.townInfo.population_max),o.townInfo.employees+=k,o.townInfo.employees>o.townInfo.population_count&&(o.townInfo.employees=o.townInfo.population_count),o=g(k+we.new_people_num,o)}if(o.townInfo.happiness<50&&o.townInfo.population_count>0){let v=Math.round((100-o.townInfo.happiness)/5);o.townInfo.population_count-=v,o.townInfo.employees>0&&(o.townInfo.employees-=v),o=g(v+we.leave_town_num,o)}else o.townInfo.population_count==o.townInfo.population_max&&(o=g(we.people_want_to_move_in,o));return o}function M(o){const v=Math.random();if(o.economyAndLaws.tax_rate>o.economyAndLaws.max_tax_rate){const k=o.difficulty==0?.7:o.difficulty==1?.4:.2;v<k&&o.economyAndLaws.tax_rate>o.economyAndLaws.max_tax_rate*2?(o.modifiers.happiness-=.03,o=g(we.very_high_tax_rate+"  ("+o.economyAndLaws.tax_rate+"%)",o)):(o.modifiers.happiness-=.01,o=g(we.high_tax_rate+"  ("+o.economyAndLaws.tax_rate*100+"%)",o))}return o}function A(o){return o.townInfo.happiness<0&&(o.townInfo.happiness=0),o.townInfo.health<0&&(o.townInfo.health=0),o.townInfo.gold<0&&(o.townInfo.gold=0),o.townInfo.employees<0&&(o.townInfo.employees=0),o.townInfo.knowledge_points<0&&(o.townInfo.knowledge_points=0),o.townInfo.population_count<0&&(o.townInfo.population_count=0),o.townInfo.population_max==0&&(o=g(we.nobody_home,o)),o.economyAndLaws.last_month_profit=Xe(o.economyAndLaws.last_month_profit,2),o.townInfo.gold=Xe(o.townInfo.gold,2),o.townInfo.population_count=Xe(o.townInfo.population_count,0),o.townInfo.employees=Xe(o.townInfo.employees,0),o.townInfo.population_max=Xe(o.townInfo.population_max,0),o.townInfo.happiness=Xe(o.townInfo.happiness,2),o.townInfo.health=Xe(o.townInfo.health,2),o.townInfo.happiness>300&&(o.townInfo.happiness=300),o.townInfo.health>300&&(o.townInfo.health=300),o.modifiers.happiness<.5&&(o.modifiers.happiness=.5),o.modifiers.health<.5&&(o.modifiers.health=.5),o}function P(o){o.economyAndLaws.last_month_profit=0;for(let v=0;v<o.plots.length;v++)for(let k=0;k<o.plots[v].length;k++)if(o.plots[v][k].active==!0&&o.plots[v][k].type>-1){let G=oe[o.plots[v][k].type],R=Xn(G.revenue_per_week,o);o.townInfo.gold+=R,o.economyAndLaws.last_month_profit+=R,R>0&&(o.economyAndLaws.balance_sheet_history=[{day:o.environment.day,plot:`${v},${k}`,profits:R,taxRate:o.economyAndLaws.tax_rate},...o.economyAndLaws.balance_sheet_history],o.economyAndLaws.balance_sheet_history.length>250&&(o.economyAndLaws.balance_sheet_history=o.economyAndLaws.balance_sheet_history.slice(0,250))),G.enables_tourism==!0&&(o.townInfo.gold_from_tourism+=G.tourism_revenue_per_week*o.economyAndLaws.tax_rate*o.townInfo.population_count)}return o}function E(o){for(let v=0;v<o.plots.length;v++)for(let k=0;k<o.plots[v].length;k++)if(o.plots[v][k].active==!0&&o.plots[v][k].type>-1){let G=oe[o.plots[v][k].type];G.knowledge_points_per_month!=null&&(o.townInfo.knowledge_points+=G.knowledge_points_per_month)}return o}function g(o,v){return v.townLog="Day "+i.environment.day+" - "+o+`
`+v.townLog,v}return Ft(async()=>{for(;;)localStorage.reset=="true"&&(nl(),localStorage.setItem("reset","false")),c(),await new Promise(o=>setTimeout(o,l))}),[c,A,el,tl]}class Zn extends Be{constructor(e){super(),Ee(this,e,Qn,null,qe,{mainGameThreadLoop:0,_fixVariables:1,_bringModifiersBackToNormal:2,_bringStatsBackToNormal:3})}get mainGameThreadLoop(){return this.$$.ctx[0]}get _fixVariables(){return this.$$.ctx[1]}get _bringModifiersBackToNormal(){return el}get _bringStatsBackToNormal(){return tl}}function Rl(n,e,t){const l=n.slice();return l[19]=e[t],l}function Jl(n){let e,t;return{c(){e=p("div"),t=b(n[0]),d(e,"class","message")},m(l,i){S(l,e,i),a(e,t)},p(l,i){i&1&&B(t,l[0])},d(l){l&&I(e)}}}function Ul(n){let e,t,l;return{c(){e=p("button"),e.textContent="\u{1F525}",d(e,"id","bulldoze"),d(e,"class","svelte-bdghnw")},m(i,r){S(i,e,r),t||(l=X(e,"click",n[9]),t=!0)},p:K,d(i){i&&I(e),t=!1,l()}}}function Hl(n){let e,t,l,i;return{c(){e=p("span"),t=b("("),l=b(n[7]),i=b(")"),d(e,"class","text_s")},m(r,s){S(r,e,s),a(e,t),a(e,l),a(e,i)},p(r,s){s&128&&B(l,r[7])},d(r){r&&I(e)}}}function jl(n){let e;return{c(){e=p("span"),e.textContent="(0)",d(e,"class","text_s")},m(t,l){S(t,e,l)},d(t){t&&I(e)}}}function Yl(n){let e,t,l,i,r,s,f=n[19].revenue_per_week>0&&Vl(n),m=n[19].tourism_revenue_per_week>0&&Wl(n);return{c(){e=p("div"),t=p("span"),t.textContent="Profits",l=w(),i=p("br"),r=w(),f&&f.c(),s=w(),m&&m.c(),d(t,"class","subheading_m"),d(e,"class","profits svelte-bdghnw")},m(u,c){S(u,e,c),a(e,t),a(e,l),a(e,i),a(e,r),f&&f.m(e,null),a(e,s),m&&m.m(e,null)},p(u,c){u[19].revenue_per_week>0?f?f.p(u,c):(f=Vl(u),f.c(),f.m(e,s)):f&&(f.d(1),f=null),u[19].tourism_revenue_per_week>0?m?m.p(u,c):(m=Wl(u),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},d(u){u&&I(e),f&&f.d(),m&&m.d()}}}function Vl(n){let e,t,l=n[19].revenue_per_week+"",i,r,s=Ue(n[5].economyAndLaws.tax_rate*n[19].revenue_per_week,2)+"",f,m,u,c;return{c(){e=p("span"),t=p("span"),i=b(l),r=w(),f=b(s),m=b(" gold (with tax rate)"),u=w(),c=p("br"),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(_,h){S(_,e,h),a(e,t),a(t,i),a(e,r),a(e,f),a(e,m),S(_,u,h),S(_,c,h)},p(_,h){h&16&&l!==(l=_[19].revenue_per_week+"")&&B(i,l),h&48&&s!==(s=Ue(_[5].economyAndLaws.tax_rate*_[19].revenue_per_week,2)+"")&&B(f,s)},d(_){_&&I(e),_&&I(u),_&&I(c)}}}function Wl(n){let e,t,l=n[19].tourism_revenue_per_week+"",i,r,s=Ue(n[5].economyAndLaws.tax_rate*n[19].tourism_revenue_per_week*n[5].townInfo.population_count,2)+"",f,m,u,c=n[5].hasABank!==!0&&Kl();return{c(){e=p("span"),t=p("span"),i=b(l),r=w(),f=b(s),m=b(` tourism gold (
											`),c&&c.c(),u=b(`

											)`),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(_,h){S(_,e,h),a(e,t),a(t,i),a(e,r),a(e,f),a(e,m),c&&c.m(e,null),a(e,u)},p(_,h){h&16&&l!==(l=_[19].tourism_revenue_per_week+"")&&B(i,l),h&48&&s!==(s=Ue(_[5].economyAndLaws.tax_rate*_[19].tourism_revenue_per_week*_[5].townInfo.population_count,2)+"")&&B(f,s),_[5].hasABank!==!0?c||(c=Kl(),c.c(),c.m(e,u)):c&&(c.d(1),c=null)},d(_){_&&I(e),c&&c.d()}}}function Kl(n){let e;return{c(){e=b("get a bank to cash out")},m(t,l){S(t,e,l)},d(t){t&&I(e)}}}function Xl(n){let e,t;function l(s,f){return s[5].townInfo.gold<s[19].requirements.gold?zn:xn}let i=l(n),r=i(n);return{c(){r.c(),e=w(),t=p("br")},m(s,f){r.m(s,f),S(s,e,f),S(s,t,f)},p(s,f){i===(i=l(s))&&r?r.p(s,f):(r.d(1),r=i(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&I(e),s&&I(t)}}}function xn(n){let e,t=n[19].requirements.gold+"",l,i;return{c(){e=p("span"),l=b(t),i=b(" gold"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,s){S(r,e,s),a(e,l),a(e,i)},p(r,s){s&16&&t!==(t=r[19].requirements.gold+"")&&B(l,t)},d(r){r&&I(e)}}}function zn(n){let e,t=n[19].requirements.gold+"",l,i;return{c(){e=p("span"),l=b(t),i=b(" gold"),d(e,"class","red text_s cost_label svelte-bdghnw")},m(r,s){S(r,e,s),a(e,l),a(e,i)},p(r,s){s&16&&t!==(t=r[19].requirements.gold+"")&&B(l,t)},d(r){r&&I(e)}}}function Ql(n){let e,t;function l(s,f){return s[5].townInfo.population_count-s[5].townInfo.employees<s[19].requirements.employees?to:eo}let i=l(n),r=i(n);return{c(){r.c(),e=w(),t=p("br")},m(s,f){r.m(s,f),S(s,e,f),S(s,t,f)},p(s,f){i===(i=l(s))&&r?r.p(s,f):(r.d(1),r=i(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&I(e),s&&I(t)}}}function eo(n){let e,t=n[19].requirements.employees+"",l,i;return{c(){e=p("span"),l=b(t),i=b(" employees"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,s){S(r,e,s),a(e,l),a(e,i)},p(r,s){s&16&&t!==(t=r[19].requirements.employees+"")&&B(l,t)},d(r){r&&I(e)}}}function to(n){let e,t=n[19].requirements.employees+"",l,i;return{c(){e=p("span"),l=b(t),i=b(" employees"),d(e,"class","text_s cost_label red svelte-bdghnw")},m(r,s){S(r,e,s),a(e,l),a(e,i)},p(r,s){s&16&&t!==(t=r[19].requirements.employees+"")&&B(l,t)},d(r){r&&I(e)}}}function Zl(n){let e,t;function l(s,f){return s[5].townInfo.knowledge_points<s[19].requirements.knowledge?no:lo}let i=l(n),r=i(n);return{c(){r.c(),e=w(),t=p("br")},m(s,f){r.m(s,f),S(s,e,f),S(s,t,f)},p(s,f){i===(i=l(s))&&r?r.p(s,f):(r.d(1),r=i(s),r&&(r.c(),r.m(e.parentNode,e)))},d(s){r.d(s),s&&I(e),s&&I(t)}}}function lo(n){let e,t=n[19].requirements.knowledge+"",l,i;return{c(){e=p("span"),l=b(t),i=b(" knowledge"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,s){S(r,e,s),a(e,l),a(e,i)},p(r,s){s&16&&t!==(t=r[19].requirements.knowledge+"")&&B(l,t)},d(r){r&&I(e)}}}function no(n){let e,t=n[19].requirements.knowledge+"",l,i;return{c(){e=p("span"),l=b(t),i=b(" knowledge"),d(e,"class","text_s cost_label red svelte-bdghnw")},m(r,s){S(r,e,s),a(e,l),a(e,i)},p(r,s){s&16&&t!==(t=r[19].requirements.knowledge+"")&&B(l,t)},d(r){r&&I(e)}}}function oo(n){let e,t,l=Rt(n[19].effect_modifiers.happiness)+"",i,r;return{c(){e=p("span"),t=b("\u{1F601} "),i=b(l),d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive",r=n[19].effect_modifiers.happiness>=1)},m(s,f){S(s,e,f),a(e,t),a(e,i)},p(s,f){f&16&&l!==(l=Rt(s[19].effect_modifiers.happiness)+"")&&B(i,l),f&16&&r!==(r=s[19].effect_modifiers.happiness>=1)&&d(e,"data-positive",r)},d(s){s&&I(e)}}}function io(n){let e;return{c(){e=p("span"),e.textContent="\u{1F601} No effect",d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive","true")},m(t,l){S(t,e,l)},p:K,d(t){t&&I(e)}}}function so(n){let e,t,l=Rt(n[19].effect_modifiers.health)+"",i,r;return{c(){e=p("span"),t=b("\u{1F3E5} "),i=b(l),d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive",r=n[19].effect_modifiers.health>=1)},m(s,f){S(s,e,f),a(e,t),a(e,i)},p(s,f){f&16&&l!==(l=Rt(s[19].effect_modifiers.health)+"")&&B(i,l),f&16&&r!==(r=s[19].effect_modifiers.health>=1)&&d(e,"data-positive",r)},d(s){s&&I(e)}}}function ao(n){let e;return{c(){e=p("span"),e.textContent="\u{1F3E5} No effect",d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive","true")},m(t,l){S(t,e,l)},p:K,d(t){t&&I(e)}}}function xl(n){let e,t,l,i,r,s=n[19].immediate_variable_changes.happiness!==0&&zl(n),f=n[19].immediate_variable_changes.happiness!==0&&n[19].immediate_variable_changes.health!==0&&en(),m=n[19].immediate_variable_changes.health!==0&&tn(n);return{c(){e=p("div"),t=p("span"),l=b(`Instant changes:
										`),s&&s.c(),i=w(),f&&f.c(),r=w(),m&&m.c(),d(t,"class","subheading_m"),d(e,"class","immediate_changes svelte-bdghnw")},m(u,c){S(u,e,c),a(e,t),a(t,l),s&&s.m(t,null),a(t,i),f&&f.m(t,null),a(t,r),m&&m.m(t,null)},p(u,c){u[19].immediate_variable_changes.happiness!==0?s?s.p(u,c):(s=zl(u),s.c(),s.m(t,i)):s&&(s.d(1),s=null),u[19].immediate_variable_changes.happiness!==0&&u[19].immediate_variable_changes.health!==0?f||(f=en(),f.c(),f.m(t,r)):f&&(f.d(1),f=null),u[19].immediate_variable_changes.health!==0?m?m.p(u,c):(m=tn(u),m.c(),m.m(t,null)):m&&(m.d(1),m=null)},d(u){u&&I(e),s&&s.d(),f&&f.d(),m&&m.d()}}}function zl(n){let e,t,l=n[19].immediate_variable_changes.happiness+"",i;return{c(){e=b(`\u{1F601}
											`),t=p("span"),i=b(l),d(t,"class","green")},m(r,s){S(r,e,s),S(r,t,s),a(t,i)},p(r,s){s&16&&l!==(l=r[19].immediate_variable_changes.happiness+"")&&B(i,l)},d(r){r&&I(e),r&&I(t)}}}function en(n){let e;return{c(){e=b(",")},m(t,l){S(t,e,l)},d(t){t&&I(e)}}}function tn(n){let e,t,l=n[19].immediate_variable_changes.health+"",i;return{c(){e=b(`\u{1F3E5}
											`),t=p("span"),i=b(l),d(t,"class","green")},m(r,s){S(r,e,s),S(r,t,s),a(t,i)},p(r,s){s&16&&l!==(l=r[19].immediate_variable_changes.health+"")&&B(i,l)},d(r){r&&I(e),r&&I(t)}}}function ln(n,e){let t,l,i,r=e[19].title+"",s,f,m,u,c,_=e[19].subtitle+"",h,q,y,C,$,M=e[19].description+"",A,P,E,g,o,v,k,G,R,se,L,U,ae,J,D,_e,Pe,H,Q,Z,te,me,N,O,x,he,xe,ie=(e[19].revenue_per_week>0||e[19].tourism_revenue_per_week>0)&&Yl(e),re=e[19].requirements.gold!==0&&Xl(e),pe=e[19].requirements.employees!==0&&Ql(e),fe=e[19].requirements.knowledge!=null&&e[19].requirements.knowledge!==0&&Zl(e);function ze(ge,ne){return ge[19].effect_modifiers.happiness==1?io:oo}let Ye=ze(e),Ie=Ye(e);function Ge(ge,ne){return ge[19].effect_modifiers.health==1?ao:so}let je=Ge(e),Se=je(e),ee=(e[19].immediate_variable_changes.happiness!==0||e[19].immediate_variable_changes.health!==0)&&xl(e);return{key:n,first:null,c(){t=p("div"),l=p("div"),i=p("span"),s=b(r),f=w(),m=p("br"),u=w(),c=p("span"),h=b(_),q=w(),y=p("br"),C=w(),$=p("span"),A=b(M),P=w(),E=p("div"),ie&&ie.c(),g=w(),o=p("div"),v=p("div"),k=p("span"),k.textContent="Requirements",G=w(),R=p("br"),se=w(),re&&re.c(),L=w(),pe&&pe.c(),U=w(),fe&&fe.c(),ae=w(),J=p("div"),D=p("span"),D.textContent="Multiplier",_e=w(),Pe=p("br"),H=w(),Ie.c(),Q=w(),Z=p("br"),te=w(),Se.c(),me=w(),ee&&ee.c(),N=w(),d(i,"class","heading_m"),d(c,"class","subheading_m"),d($,"class","text_s"),d(k,"class","subheading_m"),d(v,"class","svelte-bdghnw"),d(D,"class","subheading_m"),d(J,"class","svelte-bdghnw"),d(o,"class","reqs_and_mods svelte-bdghnw"),d(E,"class","bottom svelte-bdghnw"),d(t,"class",O="plotOption background-lightgray "+(e[19].affordable?"":"unaffordable")+" svelte-bdghnw"),d(t,"data-active",x=e[19].selected),d(t,"data-affordable",he=e[19].affordable),d(t,"data-plotoptionid",xe=e[19].id),this.first=t},m(ge,ne){S(ge,t,ne),a(t,l),a(l,i),a(i,s),a(l,f),a(l,m),a(l,u),a(l,c),a(c,h),a(l,q),a(l,y),a(l,C),a(l,$),a($,A),a(t,P),a(t,E),ie&&ie.m(E,null),a(E,g),a(E,o),a(o,v),a(v,k),a(v,G),a(v,R),a(v,se),re&&re.m(v,null),a(v,L),pe&&pe.m(v,null),a(v,U),fe&&fe.m(v,null),a(o,ae),a(o,J),a(J,D),a(J,_e),a(J,Pe),a(J,H),Ie.m(J,null),a(J,Q),a(J,Z),a(J,te),Se.m(J,null),a(E,me),ee&&ee.m(E,null),a(t,N)},p(ge,ne){e=ge,ne&16&&r!==(r=e[19].title+"")&&B(s,r),ne&16&&_!==(_=e[19].subtitle+"")&&B(h,_),ne&16&&M!==(M=e[19].description+"")&&B(A,M),e[19].revenue_per_week>0||e[19].tourism_revenue_per_week>0?ie?ie.p(e,ne):(ie=Yl(e),ie.c(),ie.m(E,g)):ie&&(ie.d(1),ie=null),e[19].requirements.gold!==0?re?re.p(e,ne):(re=Xl(e),re.c(),re.m(v,L)):re&&(re.d(1),re=null),e[19].requirements.employees!==0?pe?pe.p(e,ne):(pe=Ql(e),pe.c(),pe.m(v,U)):pe&&(pe.d(1),pe=null),e[19].requirements.knowledge!=null&&e[19].requirements.knowledge!==0?fe?fe.p(e,ne):(fe=Zl(e),fe.c(),fe.m(v,null)):fe&&(fe.d(1),fe=null),Ye===(Ye=ze(e))&&Ie?Ie.p(e,ne):(Ie.d(1),Ie=Ye(e),Ie&&(Ie.c(),Ie.m(J,Q))),je===(je=Ge(e))&&Se?Se.p(e,ne):(Se.d(1),Se=je(e),Se&&(Se.c(),Se.m(J,null))),e[19].immediate_variable_changes.happiness!==0||e[19].immediate_variable_changes.health!==0?ee?ee.p(e,ne):(ee=xl(e),ee.c(),ee.m(E,null)):ee&&(ee.d(1),ee=null),ne&16&&O!==(O="plotOption background-lightgray "+(e[19].affordable?"":"unaffordable")+" svelte-bdghnw")&&d(t,"class",O),ne&16&&x!==(x=e[19].selected)&&d(t,"data-active",x),ne&16&&he!==(he=e[19].affordable)&&d(t,"data-affordable",he),ne&16&&xe!==(xe=e[19].id)&&d(t,"data-plotoptionid",xe)},d(ge){ge&&I(t),ie&&ie.d(),re&&re.d(),pe&&pe.d(),fe&&fe.d(),Ie.d(),Se.d(),ee&&ee.d()}}}function ro(n){let e,t,l,i,r,s,f=n[2]+1+"",m,u,c=n[1]+1+"",_,h,q,y,C,$,M=n[5].plots[n[1]][n[2]].type!==-1&&n[3](n[2],n[1]),A,P,E,g,o,v,k,G,R,se,L,U,ae,J=[],D=new Map,_e,Pe,H=n[0]!==""&&Jl(n),Q=M&&Ul(n),Z=n[7]>0&&Hl(n),te=n[4].length==0&&jl(),me=n[4];const N=O=>O[19].id;for(let O=0;O<me.length;O+=1){let x=Rl(n,me,O),he=N(x);D.set(he,J[O]=ln(he,x))}return{c(){e=p("div"),t=p("div"),l=p("div"),i=p("div"),r=p("span"),s=b("Modify Plot: "),m=b(f),u=b("-"),_=b(c),h=w(),H&&H.c(),q=w(),y=p("input"),C=w(),$=p("div"),Q&&Q.c(),A=w(),P=p("button"),P.textContent="Close",E=w(),g=p("div"),o=p("label"),v=b(`options
				`),Z&&Z.c(),k=w(),te&&te.c(),G=w(),R=p("br"),se=w(),L=p("br"),U=w(),ae=p("div");for(let O=0;O<J.length;O+=1)J[O].c();d(r,"class","heading_l"),d(i,"class","svelte-bdghnw"),d(y,"type","text"),d(y,"id","search-bar"),d(y,"placeholder","Search Plot Options..."),y.value=fo,d(y,"class","svelte-bdghnw"),d(P,"id","close"),d(P,"class","svelte-bdghnw"),d($,"class","svelte-bdghnw"),d(l,"class","header svelte-bdghnw"),d(o,"for","plotType"),d(ae,"class","plotOptions svelte-bdghnw"),d(g,"class","scrollable-y svelte-bdghnw"),d(t,"class","dialog-content svelte-bdghnw"),d(e,"class","dialog svelte-bdghnw")},m(O,x){S(O,e,x),a(e,t),a(t,l),a(l,i),a(i,r),a(r,s),a(r,m),a(r,u),a(r,_),a(i,h),H&&H.m(i,null),a(l,q),a(l,y),n[14](y),a(l,C),a(l,$),Q&&Q.m($,null),a($,A),a($,P),a(t,E),a(t,g),a(g,o),a(o,v),Z&&Z.m(o,null),a(o,k),te&&te.m(o,null),a(g,G),a(g,R),a(g,se),a(g,L),a(g,U),a(g,ae);for(let he=0;he<J.length;he+=1)J[he].m(ae,null);_e||(Pe=[X(y,"input",uo),X(P,"click",n[8]),X(ae,"click",n[10])],_e=!0)},p(O,[x]){x&4&&f!==(f=O[2]+1+"")&&B(m,f),x&2&&c!==(c=O[1]+1+"")&&B(_,c),O[0]!==""?H?H.p(O,x):(H=Jl(O),H.c(),H.m(i,null)):H&&(H.d(1),H=null),x&38&&(M=O[5].plots[O[1]][O[2]].type!==-1&&O[3](O[2],O[1])),M?Q?Q.p(O,x):(Q=Ul(O),Q.c(),Q.m($,A)):Q&&(Q.d(1),Q=null),O[7]>0?Z?Z.p(O,x):(Z=Hl(O),Z.c(),Z.m(o,k)):Z&&(Z.d(1),Z=null),O[4].length==0?te||(te=jl(),te.c(),te.m(o,null)):te&&(te.d(1),te=null),x&48&&(me=O[4],J=Fn(J,x,N,1,O,me,D,ae,Dn,ln,null,Rl))},i:K,o:K,d(O){O&&I(e),H&&H.d(),n[14](null),Q&&Q.d(),Z&&Z.d(),te&&te.d();for(let x=0;x<J.length;x+=1)J[x].d();_e=!1,Qe(Pe)}}}let fo="";function uo(n){console.log(typeof n),console.log(typeof n.target),n.stopPropagation()}function Ue(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Rt(n){return n.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}function nn(n,e){let t=!0;n.requirements.gold>e.townInfo.gold&&(t=!1);let l=e.townInfo.population_count-e.townInfo.employees;return n.requirements.employees!==void 0&&n.requirements.employees>0&&n.requirements.employees>l&&(t=!1),n.requirements.knowledge!==void 0&&n.requirements.knowledge>e.townInfo.knowledge_points&&(t=!1),t}function po(n,e,t){let l,i;z(n,j,g=>t(5,l=g)),z(n,le,g=>t(15,i=g));let{x:r=0}=e,{y:s=0}=e,f=oe,{tooltip:m=""}=e,u,c;Ft(async()=>{await Bn(),u&&u.focus()});let _=f.map(g=>Object.assign(Object.assign({},g),{affordable:nn(g,l)}));Ft(()=>{const g=document.querySelectorAll(".plotOption");l.plots[r][s].type!==-1&&l.plots[r][s].type>-1&&(g[l.plots[r][s].type].classList.add("active"),g[l.plots[r][s].type].scrollIntoView({behavior:"smooth",block:"center"}))});function h(g,o){let v={x:g,y:o};return v.x===0&&v.y===0?!0:[{x:v.x-1,y:v.y},{x:v.x+1,y:v.y},{x:v.x,y:v.y-1},{x:v.x,y:v.y+1}].some(G=>G.x<0||G.x>l.plots.length-1||G.y<0||G.y>l.plots.length-1?!1:l.plots[G.x][G.y].active)}function q(){V(le,i.visible=!1,i)}function y(){document.querySelectorAll(".plotOption").forEach(o=>{o.classList.remove("active")}),A(r,s)}function C(g){document.querySelectorAll(".plotOption").forEach(k=>{k.classList.remove("active")});const v=document.querySelector(`[data-plotoptionid="${g}"]`);v&&(v.classList.add("active"),M(r,s,g))}function $(g,o){let v=0;return g>0&&l.plots[g-1][o].type!==-1&&v++,g<l.plots.length-1&&l.plots[g+1][o].type!==-1&&v++,o>0&&l.plots[g][o-1].type!==-1&&v++,o<l.plots[0].length-1&&l.plots[g][o+1].type!==-1&&v++,v<=4}function M(g,o,v){let k=l;const G=oe.findIndex(L=>L.id===v);let R=oe[G],se=!0;if((R.requirements.gold>k.townInfo.gold||R.requirements.employees>k.townInfo.population_count-k.townInfo.employees)&&(se=!1),R.requirements.size!=null&&se){let L=R.requirements.size,U=[],ae=f[G].title.toLowerCase().indexOf("school")!=-1;for(let J=0;J<4;J++){let D=[[g,o]];J===0?(D.push([g-(L-1),o-(L-1)]),D.push([g-(L-1),o]),D.push([g,o-(L-1)])):J===1?(D.push([g,o-(L-1)]),D.push([g+(L-1),o-(L-1)]),D.push([g+(L-1),o])):J===2?(D.push([g-(L-1),o]),D.push([g-(L-1),o+(L-1)]),D.push([g,o+(L-1)])):J===3&&(D.push([g,o+(L-1)]),D.push([g+(L-1),o+(L-1)]),D.push([g+(L-1),o])),U.push(D)}U=U.filter(J=>J.every(D=>D[0]>=0&&D[0]<=k.plots.length-1&&D[1]>=0&&D[1]<=k.plots.length-1&&!k.plots[D[0]][D[1]].active&&h(D[0],D[1])==!0)),U.length===0?se=!1:U.length>0&&U[0].forEach(D=>{k.plots[D[0]][D[1]].active=!0,k.plots[D[0]][D[1]].type=ae?-3:-2,k.plots[D[0]][D[1]].referencePlot=[g,o]})}if(se===!0){switch(k.plots[g][o].type!==-1&&A(g,o),t(0,m=""),k.plots[g][o].type=G,k.plots[g][o].active=!0,k.plots[g][o].referencePlot=[],k.townInfo.gold-=R.requirements.gold,k.townInfo.gold=Ue(k.townInfo.gold,2),k.townInfo.population_count+=R.immediate_variable_changes.population,k.townInfo.population_max+=R.immediate_variable_changes.population,k.townInfo.happiness+=R.immediate_variable_changes.happiness,k.townInfo.health+=R.immediate_variable_changes.health,k.modifiers.happiness=Ue(k.modifiers.happiness*R.effect_modifiers.happiness,2),k.modifiers.health=Ue(k.modifiers.health*R.effect_modifiers.health,2),k.townInfo.employees+=R.requirements.employees,(k.plotCounts[G]===void 0||k.plotCounts[G]===null)&&(k.plotCounts[G]=0),k.plotCounts[G]++,k.lastChangeDay=k.environment.day,k.economyAndLaws.balance_sheet_history=[{day:k.environment.day,plot:`${g},${o}`,profits:R.requirements.gold*-1,balance:Ue(k.townInfo.gold,2)},...k.economyAndLaws.balance_sheet_history],R.id){case"city-hall":k.hasCityHall=!0;break;case"bank":k.hasBank=!0;break}j.set(k),localStorage.setItem(ke,JSON.stringify(k)),V(le,i.visible=!1,i)}else t(0,m="You do not have enough resources to purchase this plot."),document.querySelectorAll(".plotOption").forEach(U=>{U.classList.remove("active")})}function A(g,o){let v=l,k=v.plots[g][o].type;v.plots[g][o].type=-1,v.plots[g][o].active=!1,k>-1&&(v.townInfo.population_count-=oe[k].immediate_variable_changes.population,v.townInfo.population_max-=oe[k].immediate_variable_changes.population,v.townInfo.happiness-=oe[k].immediate_variable_changes.happiness,v.townInfo.health-=oe[k].immediate_variable_changes.health,v.modifiers.happiness=Ue(v.modifiers.happiness/oe[k].effect_modifiers.happiness,2),v.modifiers.health=Ue(v.modifiers.health/oe[k].effect_modifiers.health,2),v.townInfo.employees-=oe[k].requirements.employees,(v.plotCounts[k]===void 0||v.plotCounts[k]===null)&&(v.plotCounts[k]=0),v.plotCounts[k]--),v.lastChangeDay=v.environment.day,j.set(v),localStorage.setItem(ke,JSON.stringify(v))}function P(g){const o=g.target.closest(".plotOption");if(o){const v=o.dataset.plotoptionid;C(v)}}function E(g){Qt[g?"unshift":"push"](()=>{u=g,t(6,u)})}return n.$$set=g=>{"x"in g&&t(1,r=g.x),"y"in g&&t(2,s=g.y),"tooltip"in g&&t(0,m=g.tooltip)},n.$$.update=()=>{n.$$.dirty&32&&l&&t(4,_=f.map(g=>Object.assign(Object.assign({},g),{affordable:nn(g,l)}))),n.$$.dirty&16&&t(4,_=_),n.$$.dirty&16&&t(7,c=_.filter(g=>g.affordable).length)},[m,r,s,$,_,l,u,c,q,y,P,h,M,A,E]}class co extends Be{constructor(e){super(),Ee(this,e,po,ro,qe,{x:1,y:2,tooltip:0,checkIfPlotCanBeUpgraded:11,canBulldoze:3,purchasePlot:12,reverseClear:13})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[11]}get canBulldoze(){return this.$$.ctx[3]}get purchasePlot(){return this.$$.ctx[12]}get reverseClear(){return this.$$.ctx[13]}}function on(n,e,t){const l=n.slice();return l[6]=e[t],l}function sn(n,e,t){const l=n.slice();return l[9]=e[t],l}function an(n){let e,t,l=n[3],i,r,s=n[2].plots,f=[];for(let c=0;c<s.length;c+=1)f[c]=fn(on(n,s,c));const m=c=>W(f[c],1,1,()=>{f[c]=null});let u=pn(n);return{c(){e=p("div");for(let c=0;c<f.length;c+=1)f[c].c();t=w(),u.c(),i=Ze(),d(e,"class","grid svelte-3cpxwu")},m(c,_){S(c,e,_);for(let h=0;h<f.length;h+=1)f[h].m(e,null);S(c,t,_),u.m(c,_),S(c,i,_),r=!0},p(c,_){if(_&7){s=c[2].plots;let h;for(h=0;h<s.length;h+=1){const q=on(c,s,h);f[h]?(f[h].p(q,_),F(f[h],1)):(f[h]=fn(q),f[h].c(),F(f[h],1),f[h].m(e,null))}for(Ne(),h=s.length;h<f.length;h+=1)m(h);Te()}_&8&&qe(l,l=c[3])?(Ne(),W(u,1,1,K),Te(),u=pn(c),u.c(),F(u,1),u.m(i.parentNode,i)):u.p(c,_)},i(c){if(!r){for(let _=0;_<s.length;_+=1)F(f[_]);F(u),r=!0}},o(c){f=f.filter(Boolean);for(let _=0;_<f.length;_+=1)W(f[_]);W(u),r=!1},d(c){c&&I(e),ll(f,c),c&&I(t),c&&I(i),u.d(c)}}}function rn(n){let e,t;return e=new Yn({props:{data:n[9],canBeUpgraded:n[0](n[9].x,n[9].y)}}),{c(){Oe(e.$$.fragment)},m(l,i){$e(e,l,i),t=!0},p(l,i){const r={};i&4&&(r.data=l[9]),i&4&&(r.canBeUpgraded=l[0](l[9].x,l[9].y)),e.$set(r)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function fn(n){let e,t,l,i,r,s=n[6],f=[];for(let u=0;u<s.length;u+=1)f[u]=rn(sn(n,s,u));const m=u=>W(f[u],1,1,()=>{f[u]=null});return{c(){e=p("div");for(let u=0;u<f.length;u+=1)f[u].c();t=w(),d(e,"class","row svelte-3cpxwu")},m(u,c){S(u,e,c);for(let _=0;_<f.length;_+=1)f[_].m(e,null);a(e,t),l=!0,i||(r=X(e,"click",n[1]),i=!0)},p(u,c){if(c&5){s=u[6];let _;for(_=0;_<s.length;_+=1){const h=sn(u,s,_);f[_]?(f[_].p(h,c),F(f[_],1)):(f[_]=rn(h),f[_].c(),F(f[_],1),f[_].m(e,t))}for(Ne(),_=s.length;_<f.length;_+=1)m(_);Te()}},i(u){if(!l){for(let c=0;c<s.length;c+=1)F(f[c]);l=!0}},o(u){f=f.filter(Boolean);for(let c=0;c<f.length;c+=1)W(f[c]);l=!1},d(u){u&&I(e),ll(f,u),i=!1,r()}}}function un(n){let e,t;return e=new co({props:{x:n[4].x,y:n[4].y}}),{c(){Oe(e.$$.fragment)},m(l,i){$e(e,l,i),t=!0},p(l,i){const r={};i&16&&(r.x=l[4].x),i&16&&(r.y=l[4].y),e.$set(r)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function pn(n){let e,t,l=n[4].visible&&un(n);return{c(){l&&l.c(),e=Ze()},m(i,r){l&&l.m(i,r),S(i,e,r),t=!0},p(i,r){i[4].visible?l?(l.p(i,r),r&16&&F(l,1)):(l=un(i),l.c(),F(l,1),l.m(e.parentNode,e)):l&&(Ne(),W(l,1,1,()=>{l=null}),Te())},i(i){t||(F(l),t=!0)},o(i){W(l),t=!1},d(i){l&&l.d(i),i&&I(e)}}}function _o(n){let e,t,l=n[2]!=null&&an(n);return{c(){l&&l.c(),e=Ze()},m(i,r){l&&l.m(i,r),S(i,e,r),t=!0},p(i,[r]){i[2]!=null?l?(l.p(i,r),r&4&&F(l,1)):(l=an(i),l.c(),F(l,1),l.m(e.parentNode,e)):l&&(Ne(),W(l,1,1,()=>{l=null}),Te())},i(i){t||(F(l),t=!0)},o(i){W(l),t=!1},d(i){l&&l.d(i),i&&I(e)}}}function mo(n,e,t){let l,i,r;z(n,j,u=>t(2,l=u)),z(n,gt,u=>t(3,i=u)),z(n,le,u=>t(4,r=u));function s(u,c){let _={x:u,y:c};return _.x===0&&_.y===0?!0:[{x:_.x-1,y:_.y},{x:_.x+1,y:_.y},{x:_.x,y:_.y-1},{x:_.x,y:_.y+1}].some(q=>q.x<0||q.x>=l.plots.length||q.y<0||q.y>=l.plots[q.x].length?!1:l.plots[q.x][q.y].active)}function f(){let u=[];for(let c=0;c<l.plots.length;c++)for(let _=0;_<l.plots.length;_++)s(c,_)&&l.plots[c][_].active==!1&&u.push(l.plots[c][_])}function m(){V(gt,i={},i)}return window.location.search.includes("dev=true")&&(V(j,l.townInfo.name="DevTown",l),V(j,l.townInfo.gold=1e8,l),V(j,l.townInfo.population=0,l),V(j,l.townInfo.happiness=1e5,l),V(j,l.townInfo.health=1e5,l),V(j,l.modifiers.happiness=1e5,l),V(j,l.modifiers.health=1e5,l),V(j,l.townInfo.knowledge_points=1e4,l)),n.$$.update=()=>{n.$$.dirty&4&&l&&f()},[s,m,l,i,r]}class ho extends Be{constructor(e){super(),Ee(this,e,mo,_o,qe,{checkIfPlotCanBeUpgraded:0,restartModifyPlotMenu:1})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[0]}get restartModifyPlotMenu(){return this.$$.ctx[1]}}function cn(n,e,t){const l=n.slice();return l[4]=e[t],l}function go(n){let e,t,l,i,r=n[0].economyAndLaws.balance_sheet_history,s=[];for(let f=0;f<r.length;f+=1)s[f]=dn(cn(n,r,f));return{c(){e=p("table"),t=p("thead"),t.innerHTML=`<tr class="svelte-1m5x2x2"><th>Day</th> 
						<th>Plot</th> 
						<th>Profits</th> 
						<th>Tax rate</th></tr>`,l=w(),i=p("tbody");for(let f=0;f<s.length;f+=1)s[f].c();d(e,"class","svelte-1m5x2x2")},m(f,m){S(f,e,m),a(e,t),a(e,l),a(e,i);for(let u=0;u<s.length;u+=1)s[u].m(i,null)},p(f,m){if(m&3){r=f[0].economyAndLaws.balance_sheet_history;let u;for(u=0;u<r.length;u+=1){const c=cn(f,r,u);s[u]?s[u].p(c,m):(s[u]=dn(c),s[u].c(),s[u].m(i,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=r.length}},d(f){f&&I(e),ll(s,f)}}}function vo(n){let e;return{c(){e=p("div"),e.textContent=`No data to display yet. Build some buildings and make sure that the tax
				rate is above 0%.`,d(e,"class","text-center padding-sides")},m(t,l){S(t,e,l)},p:K,d(t){t&&I(e)}}}function dn(n){let e,t,l=n[4].day+"",i,r,s,f=n[4].plot+"",m,u,c,_=n[4].profits+"",h,q,y,C=n[4].taxRate+"",$,M,A,P;function E(){return n[2](n[4])}return{c(){e=p("tr"),t=p("td"),i=b(l),r=w(),s=p("th"),m=b(f),u=w(),c=p("td"),h=b(_),q=w(),y=p("td"),$=b(C),M=w(),d(t,"class","svelte-1m5x2x2"),d(s,"class","plot_link svelte-1m5x2x2"),d(c,"class","svelte-1m5x2x2"),d(y,"class","svelte-1m5x2x2"),d(e,"class","svelte-1m5x2x2")},m(g,o){S(g,e,o),a(e,t),a(t,i),a(e,r),a(e,s),a(s,m),a(e,u),a(e,c),a(c,h),a(e,q),a(e,y),a(y,$),a(e,M),A||(P=X(s,"click",E),A=!0)},p(g,o){n=g,o&1&&l!==(l=n[4].day+"")&&B(i,l),o&1&&f!==(f=n[4].plot+"")&&B(m,f),o&1&&_!==(_=n[4].profits+"")&&B(h,_),o&1&&C!==(C=n[4].taxRate+"")&&B($,C)},d(g){g&&I(e),A=!1,P()}}}function bo(n){let e,t,l,i,r,s;function f(c,_){return c[0].economyAndLaws.balance_sheet_history.length==0?vo:go}let m=f(n),u=m(n);return{c(){e=p("div"),t=p("div"),l=p("div"),l.textContent="Balance Sheet",i=w(),r=p("br"),s=w(),u.c(),d(l,"class","heading_m svelte-1m5x2x2"),d(t,"class","dialog-content svelte-1m5x2x2"),d(e,"class","dialog svelte-1m5x2x2")},m(c,_){S(c,e,_),a(e,t),a(t,l),a(t,i),a(t,r),a(t,s),u.m(t,null)},p(c,[_]){m===(m=f(c))&&u?u.p(c,_):(u.d(1),u=m(c),u&&(u.c(),u.m(t,null)))},i:K,o:K,d(c){c&&I(e),u.d()}}}function yo(n,e,t){let l,i;z(n,le,f=>t(3,l=f)),z(n,j,f=>t(0,i=f));function r(f){let m=parseInt(f.split(",")[0]),u=parseInt(f.split(",")[1]);V(le,l.x=m,l),V(le,l.y=u,l),V(le,l.visible=!0,l)}return[i,r,f=>{r(f.plot)}]}class $n extends Be{constructor(e){super(),Ee(this,e,yo,bo,qe,{})}}const wo={0:"Easy",1:"Normal",2:"Hard"};function _n(n){let e,t,l,i=n[3].short_title+"",r,s,f,m,u,c,_,h,q,y,C,$,M,A=n[0].endGoal=="land"&&mn(n);return{c(){e=p("div"),t=p("div"),l=b("HOW TO PLAY ("),r=b(i),s=b(`)
			`),f=p("br"),m=w(),u=p("hr"),c=w(),A&&A.c(),_=w(),h=p("br"),q=w(),y=p("hr"),C=w(),$=p("br"),M=b(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(P,E){S(P,e,E),a(e,t),a(t,l),a(t,r),a(t,s),a(t,f),a(t,m),a(t,u),a(t,c),A&&A.m(t,null),a(t,_),a(t,h),a(t,q),a(t,y),a(t,C),a(t,$),a(t,M)},p(P,E){P[0].endGoal=="land"?A?A.p(P,E):(A=mn(P),A.c(),A.m(t,_)):A&&(A.d(1),A=null)},d(P){P&&I(e),A&&A.d()}}}function mn(n){let e=n[3].description_title+"",t,l,i,r,s,f,m,u,c,_,h,q,y,C,$=JSON.stringify(n[3].requirements[n[0].difficulty].population_count)+"",M,A,P,E,g,o,v=JSON.stringify(n[3].requirements[n[0].difficulty].happiness)+"",k,G,R,se,L,U,ae=JSON.stringify(n[3].requirements[n[0].difficulty].health)+"",J,D,_e,Pe,H,Q,Z=JSON.stringify(n[3].requirements[n[0].difficulty].employment*100)+"",te,me;return{c(){t=b(e),l=w(),i=p("br"),r=w(),s=p("br"),f=b(`
				With your difficulty (`),m=b(n[4]),u=b(`), you must also have:
				`),c=p("br"),_=w(),h=p("br"),q=w(),y=p("li"),C=b("Population: "),M=b($),A=w(),P=p("br"),E=w(),g=p("li"),o=b("Happiness: "),k=b(v),G=w(),R=p("br"),se=w(),L=p("li"),U=b("Health: "),J=b(ae),D=w(),_e=p("br"),Pe=w(),H=p("li"),Q=b("Employment at "),te=b(Z),me=b("%")},m(N,O){S(N,t,O),S(N,l,O),S(N,i,O),S(N,r,O),S(N,s,O),S(N,f,O),S(N,m,O),S(N,u,O),S(N,c,O),S(N,_,O),S(N,h,O),S(N,q,O),S(N,y,O),a(y,C),a(y,M),S(N,A,O),S(N,P,O),S(N,E,O),S(N,g,O),a(g,o),a(g,k),S(N,G,O),S(N,R,O),S(N,se,O),S(N,L,O),a(L,U),a(L,J),S(N,D,O),S(N,_e,O),S(N,Pe,O),S(N,H,O),a(H,Q),a(H,te),a(H,me)},p(N,O){O&1&&$!==($=JSON.stringify(N[3].requirements[N[0].difficulty].population_count)+"")&&B(M,$),O&1&&v!==(v=JSON.stringify(N[3].requirements[N[0].difficulty].happiness)+"")&&B(k,v),O&1&&ae!==(ae=JSON.stringify(N[3].requirements[N[0].difficulty].health)+"")&&B(J,ae),O&1&&Z!==(Z=JSON.stringify(N[3].requirements[N[0].difficulty].employment*100)+"")&&B(te,Z)},d(N){N&&I(t),N&&I(l),N&&I(i),N&&I(r),N&&I(s),N&&I(f),N&&I(m),N&&I(u),N&&I(c),N&&I(_),N&&I(h),N&&I(q),N&&I(y),N&&I(A),N&&I(P),N&&I(E),N&&I(g),N&&I(G),N&&I(R),N&&I(se),N&&I(L),N&&I(D),N&&I(_e),N&&I(Pe),N&&I(H)}}}function ko(n){let e,t=n[2]&&n[0]!=null&&n[1]&&_n(n);return{c(){t&&t.c(),e=Ze()},m(l,i){t&&t.m(l,i),S(l,e,i)},p(l,[i]){l[2]&&l[0]!=null&&l[1]?t?t.p(l,i):(t=_n(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:K,o:K,d(l){t&&t.d(l),l&&I(e)}}}function Io(n,e,t){let l;z(n,j,u=>t(0,l=u));let i=!0;const s=mt[l.endGoal],f=wo[l.difficulty]||0;let m=!1;return n.$$.update=()=>{n.$$.dirty&1&&(l?t(2,m=!0):t(2,m=!1))},[l,i,m,s,f]}class So extends Be{constructor(e){super(),Ee(this,e,Io,ko,qe,{})}}function hn(n){let e,t=n[1].townLog+"",l,i,r;return{c(){e=p("div"),l=b(t),d(e,"class","townLog message")},m(s,f){S(s,e,f),a(e,l),i||(r=X(e,"click",n[12]),i=!0)},p(s,f){f&2&&t!==(t=s[1].townLog+"")&&B(l,t)},d(s){s&&I(e),i=!1,r()}}}function gn(n){let e,t,l=n[1].townInfo.population_count-n[1].townInfo.employees+"",i,r;return{c(){e=p("span"),t=b("("),i=b(l),r=b(" unemployed)"),d(e,"class","text_ss gray")},m(s,f){S(s,e,f),a(e,t),a(e,i),a(e,r)},p(s,f){f&2&&l!==(l=s[1].townInfo.population_count-s[1].townInfo.employees+"")&&B(i,l)},d(s){s&&I(e)}}}function Lo(n){let e,t,l=n[1].economyAndLaws.last_month_profit+"",i,r;return{c(){e=p("span"),t=b("("),i=b(l),r=b(")"),d(e,"class","text_s red")},m(s,f){S(s,e,f),a(e,t),a(e,i),a(e,r)},p(s,f){f&2&&l!==(l=s[1].economyAndLaws.last_month_profit+"")&&B(i,l)},d(s){s&&I(e)}}}function qo(n){let e,t,l=n[1].economyAndLaws.last_month_profit+"",i,r;return{c(){e=p("span"),t=b("(+"),i=b(l),r=b(")"),d(e,"class","text_s green")},m(s,f){S(s,e,f),a(e,t),a(e,i),a(e,r)},p(s,f){f&2&&l!==(l=s[1].economyAndLaws.last_month_profit+"")&&B(i,l)},d(s){s&&I(e)}}}function Po(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=p("span"),l=b(t),d(e,"class","red")},m(i,r){S(i,e,r),a(e,l)},p(i,r){r&2&&t!==(t=i[1].townInfo.happiness+"")&&B(l,t)},d(i){i&&I(e)}}}function Ao(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=p("span"),l=b(t),d(e,"class","green")},m(i,r){S(i,e,r),a(e,l)},p(i,r){r&2&&t!==(t=i[1].townInfo.happiness+"")&&B(l,t)},d(i){i&&I(e)}}}function $o(n){let e;return{c(){e=p("span"),e.textContent="\u{1F44E}"},m(t,l){S(t,e,l)},d(t){t&&I(e)}}}function Mo(n){let e;return{c(){e=p("span"),e.textContent="\u{1F44D}"},m(t,l){S(t,e,l)},d(t){t&&I(e)}}}function Co(n){let e;return{c(){e=p("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,l){S(t,e,l)},d(t){t&&I(e)}}}function Oo(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=p("span"),l=b(t),d(e,"class","red")},m(i,r){S(i,e,r),a(e,l)},p(i,r){r&2&&t!==(t=i[1].townInfo.health+"")&&B(l,t)},d(i){i&&I(e)}}}function No(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=p("span"),l=b(t),d(e,"class","green")},m(i,r){S(i,e,r),a(e,l)},p(i,r){r&2&&t!==(t=i[1].townInfo.health+"")&&B(l,t)},d(i){i&&I(e)}}}function vn(n){let e;return{c(){e=p("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,l){S(t,e,l)},d(t){t&&I(e)}}}function To(n){let e;return{c(){e=b("How to play")},m(t,l){S(t,e,l)},d(t){t&&I(e)}}}function Eo(n){let e;return{c(){e=b("Close")},m(t,l){S(t,e,l)},d(t){t&&I(e)}}}function bn(n){let e,t;return e=new So({}),{c(){Oe(e.$$.fragment)},m(l,i){$e(e,l,i),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function yn(n){let e,t;return e=new $n({}),{c(){Oe(e.$$.fragment)},m(l,i){$e(e,l,i),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function Bo(n){let e,t,l,i=n[1].townInfo.name+"",r,s,f,m,u,c,_,h,q,y,C,$,M,A,P,E,g,o,v,k,G,R=n[1].townInfo.population_count+"",se,L,U=n[1].townInfo.population_max+"",ae,J,D,_e,Pe,H,Q=n[1].townInfo.employees+"",Z,te,me=n[1].townInfo.population_count+"",N,O,x,he,xe,ie,re,pe,fe,ze=n[1].townInfo.knowledge_points+"",Ye,Ie,Ge,je,Se,ee,ge=n[1].townInfo.gold+"",ne,ol,il,sl,al,et,St,rl,vt,fl,Lt=n[1].townInfo.gold_from_tourism+"",Jt,ul,it,qt,pl,De,Ut,st,cl,Pt=He(n[1].modifiers.happiness,2)+"",Ht,dl,_l,ml,at,At,hl,Fe,jt,rt,gl,$t=He(n[1].modifiers.health,2)+"",Yt,vl,bl,yl,tt,lt,wl,kl,Il,Sl,Ve,Mt,Ll,Ce,ql,We,ft,Pl,ut,Ct=(n[1].economyAndLaws.tax_rate*100).toFixed(0)+"",Vt,Al,$l,pt,Wt,bt,yt,ue,Kt,Ml,ve=n[1].townLog.length>0&&hn(n),be=n[1].townInfo.population_count-n[1].townInfo.employees>0&&gn(n);function Cl(T,Y){if(T[1].economyAndLaws.last_month_profit>=0)return qo;if(T[1].economyAndLaws.last_month_profit<0)return Lo}let ct=Cl(n),ye=ct&&ct(n);function Ol(T,Y){return T[1].townInfo.happiness>=50?Ao:Po}let Ot=Ol(n),Re=Ot(n);function Nl(T,Y){if(T[1].townInfo.happiness>=300)return Co;if(T[1].townInfo.happiness>=150)return Mo;if(T[1].townInfo.happiness<150)return $o}let dt=Nl(n),Ae=dt&&dt(n);function Tl(T,Y){return T[1].townInfo.health>=50?No:Oo}let Nt=Tl(n),Je=Nt(n),Le=n[1].townInfo.health>=300&&vn();function El(T,Y){return T[5]?Eo:To}let Tt=El(n),Ke=Tt(n),ce=n[5]&&bn(),de=n[6]&&yn();return{c(){e=p("div"),t=p("div"),l=p("div"),r=b(i),s=w(),f=p("div"),f.textContent="double click to change name",m=w(),u=p("div"),c=p("span"),c.textContent="\u23EA",_=w(),h=p("span"),h.textContent="\u23E9",q=w(),y=b(n[0]),C=b("x - year "),$=b(n[2]),M=b(" day "),A=b(n[3]),P=w(),ve&&ve.c(),E=w(),g=p("div"),o=p("div"),v=p("div"),v.textContent="\u{1F46A} Population",k=w(),G=p("div"),se=b(R),L=b("/"),ae=b(U),J=w(),D=p("div"),_e=p("div"),_e.textContent="\u{1F9D1}\u200D\u{1F33E} Employees",Pe=w(),H=p("div"),Z=b(Q),te=b("/"),N=b(me),O=w(),x=p("br"),he=w(),be&&be.c(),xe=w(),ie=p("div"),re=p("div"),re.textContent="\u{1F9E0} Knowledge",pe=w(),fe=p("div"),Ye=b(ze),Ie=w(),Ge=p("div"),je=p("div"),je.textContent="\u{1F4B0} Gold",Se=w(),ee=p("div"),ne=b(ge),ol=w(),il=p("br"),sl=w(),ye&&ye.c(),al=w(),et=p("div"),St=p("div"),St.textContent="\u{1F4B0} Tourism Gold",rl=w(),vt=p("div"),fl=b("$"),Jt=b(Lt),ul=w(),it=p("div"),qt=p("div"),qt.textContent="\u{1F601} Happiness",pl=w(),De=p("div"),Re.c(),Ut=w(),st=p("span"),cl=b("("),Ht=b(Pt),dl=b(")"),_l=w(),Ae&&Ae.c(),ml=w(),at=p("div"),At=p("div"),At.textContent="\u{1F3E5} Health",hl=w(),Fe=p("div"),Je.c(),jt=w(),rt=p("span"),gl=b("("),Yt=b($t),vl=b(")"),bl=w(),Le&&Le.c(),yl=w(),tt=p("div"),lt=p("div"),wl=b("\u{1F3C6} "),Ke.c(),kl=w(),Il=p("br"),Sl=w(),Ve=p("div"),Mt=p("div"),Mt.textContent="Tax rate (more tax = less happiness)",Ll=w(),Ce=p("input"),ql=w(),We=p("div"),ft=p("button"),ft.textContent="-",Pl=w(),ut=p("div"),Vt=b(Ct),Al=b("%"),$l=w(),pt=p("button"),pt.textContent="+",Wt=w(),ce&&ce.c(),bt=w(),de&&de.c(),yt=Ze(),d(l,"class","heading_l"),d(f,"class","subheading_m svelte-vu26gz"),d(t,"class","header__left svelte-vu26gz"),d(v,"class","subheading_m svelte-vu26gz"),d(G,"class","text_m svelte-vu26gz"),d(o,"class","svelte-vu26gz"),d(_e,"class","subheading_m svelte-vu26gz"),d(H,"class","text_m svelte-vu26gz"),d(D,"class","svelte-vu26gz"),d(re,"class","subheading_m svelte-vu26gz"),d(fe,"class","text_m svelte-vu26gz"),d(ie,"class","svelte-vu26gz"),d(je,"class","subheading_m svelte-vu26gz"),d(ee,"class","text_m svelte-vu26gz"),d(Ge,"class","svelte-vu26gz"),d(St,"class","subheading_m svelte-vu26gz"),d(vt,"class","text_m svelte-vu26gz"),d(et,"class","svelte-vu26gz"),d(qt,"class","subheading_m svelte-vu26gz"),d(st,"class","text_ss gray"),d(De,"class","text_m svelte-vu26gz"),d(it,"class","svelte-vu26gz"),d(At,"class","subheading_m svelte-vu26gz"),d(rt,"class","text_ss gray"),d(Fe,"class","text_m svelte-vu26gz"),d(at,"class","svelte-vu26gz"),d(g,"class","header__right svelte-vu26gz"),d(lt,"class","text_m pointer"),d(Mt,"class","subheading_m svelte-vu26gz"),d(Ce,"type","range"),d(Ce,"min","0"),d(Ce,"max","1"),d(Ce,"step","0.01"),d(ut,"class","text_m"),d(We,"class","incrementalButtons svelte-vu26gz"),d(Ve,"class","taxInfo svelte-vu26gz"),d(e,"class","header noselect svelte-vu26gz")},m(T,Y){S(T,e,Y),a(e,t),a(t,l),a(l,r),a(t,s),a(t,f),a(t,m),a(t,u),a(u,c),a(u,_),a(u,h),a(u,q),a(u,y),a(u,C),a(u,$),a(u,M),a(u,A),a(t,P),ve&&ve.m(t,null),a(e,E),a(e,g),a(g,o),a(o,v),a(o,k),a(o,G),a(G,se),a(G,L),a(G,ae),a(g,J),a(g,D),a(D,_e),a(D,Pe),a(D,H),a(H,Z),a(H,te),a(H,N),a(H,O),a(H,x),a(H,he),be&&be.m(H,null),a(g,xe),a(g,ie),a(ie,re),a(ie,pe),a(ie,fe),a(fe,Ye),a(g,Ie),a(g,Ge),a(Ge,je),a(Ge,Se),a(Ge,ee),a(ee,ne),a(ee,ol),a(ee,il),a(ee,sl),ye&&ye.m(ee,null),a(g,al),a(g,et),a(et,St),a(et,rl),a(et,vt),a(vt,fl),a(vt,Jt),a(g,ul),a(g,it),a(it,qt),a(it,pl),a(it,De),Re.m(De,null),a(De,Ut),a(De,st),a(st,cl),a(st,Ht),a(st,dl),a(De,_l),Ae&&Ae.m(De,null),a(g,ml),a(g,at),a(at,At),a(at,hl),a(at,Fe),Je.m(Fe,null),a(Fe,jt),a(Fe,rt),a(rt,gl),a(rt,Yt),a(rt,vl),a(Fe,bl),Le&&Le.m(Fe,null),a(e,yl),a(e,tt),a(tt,lt),a(lt,wl),Ke.m(lt,null),a(tt,kl),a(tt,Il),a(tt,Sl),a(tt,Ve),a(Ve,Mt),a(Ve,Ll),a(Ve,Ce),Gl(Ce,n[1].economyAndLaws.tax_rate),a(Ve,ql),a(Ve,We),a(We,ft),a(We,Pl),a(We,ut),a(ut,Vt),a(ut,Al),a(We,$l),a(We,pt),S(T,Wt,Y),ce&&ce.m(T,Y),S(T,bt,Y),de&&de.m(T,Y),S(T,yt,Y),ue=!0,Kt||(Ml=[X(l,"dblclick",n[7]),X(c,"click",n[8]),X(h,"click",n[9]),X(Ge,"click",n[13]),X(et,"click",n[14]),X(lt,"click",n[15]),X(Ce,"change",n[16]),X(Ce,"input",n[16]),X(Ce,"change",n[10]),X(ft,"mousedown",n[17]),X(ft,"mouseup",n[18]),X(ft,"click",n[19]),X(ut,"dblclick",n[20]),X(pt,"mousedown",n[21]),X(pt,"mouseup",n[22]),X(pt,"click",n[23])],Kt=!0)},p(T,[Y]){(!ue||Y&2)&&i!==(i=T[1].townInfo.name+"")&&B(r,i),(!ue||Y&1)&&B(y,T[0]),(!ue||Y&4)&&B($,T[2]),(!ue||Y&8)&&B(A,T[3]),T[1].townLog.length>0?ve?ve.p(T,Y):(ve=hn(T),ve.c(),ve.m(t,null)):ve&&(ve.d(1),ve=null),(!ue||Y&2)&&R!==(R=T[1].townInfo.population_count+"")&&B(se,R),(!ue||Y&2)&&U!==(U=T[1].townInfo.population_max+"")&&B(ae,U),(!ue||Y&2)&&Q!==(Q=T[1].townInfo.employees+"")&&B(Z,Q),(!ue||Y&2)&&me!==(me=T[1].townInfo.population_count+"")&&B(N,me),T[1].townInfo.population_count-T[1].townInfo.employees>0?be?be.p(T,Y):(be=gn(T),be.c(),be.m(H,null)):be&&(be.d(1),be=null),(!ue||Y&2)&&ze!==(ze=T[1].townInfo.knowledge_points+"")&&B(Ye,ze),(!ue||Y&2)&&ge!==(ge=T[1].townInfo.gold+"")&&B(ne,ge),ct===(ct=Cl(T))&&ye?ye.p(T,Y):(ye&&ye.d(1),ye=ct&&ct(T),ye&&(ye.c(),ye.m(ee,null))),(!ue||Y&2)&&Lt!==(Lt=T[1].townInfo.gold_from_tourism+"")&&B(Jt,Lt),Ot===(Ot=Ol(T))&&Re?Re.p(T,Y):(Re.d(1),Re=Ot(T),Re&&(Re.c(),Re.m(De,Ut))),(!ue||Y&2)&&Pt!==(Pt=He(T[1].modifiers.happiness,2)+"")&&B(Ht,Pt),dt!==(dt=Nl(T))&&(Ae&&Ae.d(1),Ae=dt&&dt(T),Ae&&(Ae.c(),Ae.m(De,null))),Nt===(Nt=Tl(T))&&Je?Je.p(T,Y):(Je.d(1),Je=Nt(T),Je&&(Je.c(),Je.m(Fe,jt))),(!ue||Y&2)&&$t!==($t=He(T[1].modifiers.health,2)+"")&&B(Yt,$t),T[1].townInfo.health>=300?Le||(Le=vn(),Le.c(),Le.m(Fe,null)):Le&&(Le.d(1),Le=null),Tt!==(Tt=El(T))&&(Ke.d(1),Ke=Tt(T),Ke&&(Ke.c(),Ke.m(lt,null))),Y&2&&Gl(Ce,T[1].economyAndLaws.tax_rate),(!ue||Y&2)&&Ct!==(Ct=(T[1].economyAndLaws.tax_rate*100).toFixed(0)+"")&&B(Vt,Ct),T[5]?ce?Y&32&&F(ce,1):(ce=bn(),ce.c(),F(ce,1),ce.m(bt.parentNode,bt)):ce&&(Ne(),W(ce,1,1,()=>{ce=null}),Te()),T[6]?de?Y&64&&F(de,1):(de=yn(),de.c(),F(de,1),de.m(yt.parentNode,yt)):de&&(Ne(),W(de,1,1,()=>{de=null}),Te())},i(T){ue||(F(ce),F(de),ue=!0)},o(T){W(ce),W(de),ue=!1},d(T){T&&I(e),ve&&ve.d(),be&&be.d(),ye&&ye.d(),Re.d(),Ae&&Ae.d(),Je.d(),Le&&Le.d(),Ke.d(),T&&I(Wt),ce&&ce.d(T),T&&I(bt),de&&de.d(T),T&&I(yt),Kt=!1,Qe(Ml)}}}function He(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Go(n,e,t){let l,i,r;z(n,j,L=>t(1,l=L)),z(n,Dt,L=>t(24,i=L)),z(n,zt,L=>t(6,r=L));let s=Math.floor(l.environment.day/365)+1,f=l.environment.day%365;function m(){let L=prompt("Enter a new name for your town (under 200 chars)");if(L&&L.length<200){let U=l;U.townInfo.name=L,j.set(U),localStorage.setItem(ke,JSON.stringify(U))}}let{speedMultiplier:u=1}=e;function c(){let L=i;L=L*2,L>=8e3&&(L=8e3),V(Dt,i=L,i),t(0,u=2e3/i)}function _(){let L=i;L=L/2,L<=250&&(L=250),V(Dt,i=L,i),t(0,u=2e3/i)}function h(L){let U=l;U.economyAndLaws.tax_rate=He(L.target.value,2),j.set(U),localStorage.setItem(ke,JSON.stringify(U))}function q(){let L=l;L.hasABank===!0?(L.townInfo.gold+=L.townInfo.gold_from_tourism,L.townInfo.gold_from_tourism=0,j.set(L),localStorage.setItem(ke,JSON.stringify(L))):alert("You need a bank to transfer funds from tourism activities.")}document.addEventListener("keydown",L=>{switch(L.key.toLowerCase()){case"1":L.preventDefault(),c();break;case"2":L.preventDefault(),_();break}});let y,C=!1;const $=()=>{V(j,l.townLog="",l)},M=()=>{let L=r;L=!L,zt.set(L)},A=()=>{q()},P=()=>t(5,C=!C);function E(){l.economyAndLaws.tax_rate=Nn(this.value),j.set(l)}const g=()=>{t(4,y=setInterval(()=>{let L=l;L.economyAndLaws.tax_rate=He(L.economyAndLaws.tax_rate-.01,2),j.set(L),localStorage.setItem(ke,JSON.stringify(L))},100))},o=()=>{clearInterval(y)},v=()=>{let L=l;L.economyAndLaws.tax_rate=He(L.economyAndLaws.tax_rate-.01,2)},k=()=>{let L=parseFloat(prompt("Set a new tax rate (0-1)"));if(L&&L>=0&&L<=1){let U=l;U.economyAndLaws.tax_rate=He(L,2),j.set(U),localStorage.setItem(ke,JSON.stringify(U))}},G=()=>{t(4,y=setInterval(()=>{let L=l;L.economyAndLaws.tax_rate=He(L.economyAndLaws.tax_rate+.01,2),j.set(L),localStorage.setItem(ke,JSON.stringify(L))},100))},R=()=>{clearInterval(y)},se=()=>{let L=l;L.economyAndLaws.tax_rate=He(L.economyAndLaws.tax_rate+.01,2),j.set(L),localStorage.setItem(ke,JSON.stringify(L))};return n.$$set=L=>{"speedMultiplier"in L&&t(0,u=L.speedMultiplier)},n.$$.update=()=>{n.$$.dirty&2&&(t(2,s=Math.floor(l.environment.day/365)+1),t(3,f=l.environment.day%365))},[u,l,s,f,y,C,r,m,c,_,h,q,$,M,A,P,E,g,o,v,k,G,R,se]}class Do extends Be{constructor(e){super(),Ee(this,e,Go,Bo,qe,{speedMultiplier:0})}}function Fo(n){let e,t,l,i,r,s,f,m,u,c,_,h,q,y,C,$,M,A,P;return{c(){e=p("div"),t=p("div"),l=b(`The game is paused!
		`),i=p("br"),r=b(`
		Load file:
		`),s=p("input"),f=w(),m=p("br"),u=b(`
		Backup save:
		`),c=p("button"),c.textContent="Save",_=w(),h=p("br"),q=b(`
		Unpause the game by pressing P
		`),y=p("br"),C=w(),$=p("br"),M=b(`
		Reset the game by pressing SHIFT+ESC`),d(s,"type","file"),d(s,"id","upload"),d(c,"id","save"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(E,g){S(E,e,g),a(e,t),a(t,l),a(t,i),a(t,r),a(t,s),a(t,f),a(t,m),a(t,u),a(t,c),a(t,_),a(t,h),a(t,q),a(t,y),a(t,C),a(t,$),a(t,M),A||(P=[X(s,"change",n[1]),X(c,"click",n[0])],A=!0)},p:K,i:K,o:K,d(E){E&&I(e),A=!1,Qe(P)}}}function Ro(n){const e=JSON.parse(n);return e.townInfo!=null&&e.difficulty!=null}function Jo(n,e,t){let l;z(n,j,s=>t(2,l=s));function i(){const s=JSON.stringify(l),f=new Blob([s],{type:"text/plain"}),m=URL.createObjectURL(f),u=document.createElement("a");u.href=m,u.download=`${new Date().toISOString()}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(m)}function r(){const f=document.getElementById("upload").files;if(f==null)return;const m=f[0],u=new FileReader;u.onload=function(c){if(c.target==null)return;const _=c.target.result;if(typeof _=="string"){if(!Ro(_)){alert("Invalid game file");return}nl(JSON.parse(_))}else alert("Invalid game file: is not String.")},u.readAsText(m)}return[i,r]}class Uo extends Be{constructor(e){super(),Ee(this,e,Jo,Fo,qe,{})}}function wn(n){let e,t,l,i,r,s=n[0].endGameDetails.msg+"",f,m,u,c,_,h;return{c(){e=p("div"),t=p("div"),l=b(`GAME OVER
			`),i=p("br"),r=w(),f=b(s),m=w(),u=p("br"),c=w(),_=p("br"),h=b(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(q,y){S(q,e,y),a(e,t),a(t,l),a(t,i),a(t,r),a(t,f),a(t,m),a(t,u),a(t,c),a(t,_),a(t,h)},p(q,y){y&1&&s!==(s=q[0].endGameDetails.msg+"")&&B(f,s)},d(q){q&&I(e)}}}function Ho(n){let e,t=n[0].endGameDetails!=null&&wn(n);return{c(){t&&t.c(),e=Ze()},m(l,i){t&&t.m(l,i),S(l,e,i)},p(l,[i]){l[0].endGameDetails!=null?t?t.p(l,i):(t=wn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:K,o:K,d(l){t&&t.d(l),l&&I(e)}}}function jo(n,e,t){let l;return z(n,j,i=>t(0,l=i)),[l]}class Yo extends Be{constructor(e){super(),Ee(this,e,jo,Ho,qe,{})}}function Vo(n){let e,t,l,i,r,s,f,m,u,c,_,h,q,y,C,$,M,A,P,E,g;return{c(){e=p("div"),t=p("div"),l=b(`Welcome to Plots!
		`),i=p("br"),r=b(`
		Select a difficulty
		`),s=p("select"),f=p("option"),f.textContent="Easy (quick game)",m=p("option"),m.textContent="Normal (longer game)",u=p("option"),u.textContent="Hard (longest game)",c=w(),_=p("br"),h=b(`
		Select a goal
		`),q=p("select"),y=p("option"),y.textContent="Fill up the grid",C=p("option"),C.textContent="Rule the world through politics",$=w(),M=p("br"),A=w(),P=p("button"),P.textContent="Start game",f.__value="0",f.value=f.__value,m.__value="1",m.value=m.__value,m.selected=!0,u.__value="2",u.value=u.__value,d(s,"id","difficulty"),y.__value="land",y.value=y.__value,y.selected=!0,C.__value="political",C.value=C.__value,d(q,"id","endGoal"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(o,v){S(o,e,v),a(e,t),a(t,l),a(t,i),a(t,r),a(t,s),a(s,f),a(s,m),a(s,u),a(t,c),a(t,_),a(t,h),a(t,q),a(q,y),a(q,C),a(t,$),a(t,M),a(t,A),a(t,P),E||(g=X(P,"click",n[0]),E=!0)},p:K,i:K,o:K,d(o){o&&I(e),E=!1,g()}}}function Wo(n){function e(){const t=document.getElementById("difficulty").value,l=document.getElementById("endGoal").value;Un(t,l)}return[e]}class Ko extends Be{constructor(e){super(),Ee(this,e,Wo,Vo,qe,{})}}function kn(n){let e,t,l,i;const r=[Qo,Xo],s=[];function f(m,u){return m[0]==null?0:1}return e=f(n),t=s[e]=r[e](n),{c(){t.c(),l=Ze()},m(m,u){s[e].m(m,u),S(m,l,u),i=!0},p(m,u){let c=e;e=f(m),e===c?s[e].p(m,u):(Ne(),W(s[c],1,1,()=>{s[c]=null}),Te(),t=s[e],t?t.p(m,u):(t=s[e]=r[e](m),t.c()),F(t,1),t.m(l.parentNode,l))},i(m){i||(F(t),i=!0)},o(m){W(t),i=!1},d(m){s[e].d(m),m&&I(l)}}}function Xo(n){let e,t,l,i,r,s,f,m,u,c,_,h,q,y,C,$,M=n[2]==!0&&In(),A=n[3]==!0&&Sn();return l=new Do({}),r=new Zn({}),f=new Yo({}),c=new ho({}),{c(){M&&M.c(),e=w(),A&&A.c(),t=w(),Oe(l.$$.fragment),i=w(),Oe(r.$$.fragment),s=w(),Oe(f.$$.fragment),m=w(),u=p("div"),Oe(c.$$.fragment),_=w(),h=p("br"),q=b(`
			outside of city`),y=w(),C=p("style"),C.textContent=`.plot_grid {
				max-width: 300%;
				max-height: 300%;
				overflow-x: scroll;
				overflow-y: scroll;
				width: 300%;
				height: 300vh;
				margin-top: 175px;
			}
			.plot_grid[data-marginRight='true'] {
				/* This is for when the balanceSheet is being shown. */
				margin-right: 224px;
			}`,d(u,"class","plot_grid"),d(u,"data-marginright",n[3])},m(P,E){M&&M.m(P,E),S(P,e,E),A&&A.m(P,E),S(P,t,E),$e(l,P,E),S(P,i,E),$e(r,P,E),S(P,s,E),$e(f,P,E),S(P,m,E),S(P,u,E),$e(c,u,null),a(u,_),a(u,h),a(u,q),S(P,y,E),S(P,C,E),$=!0},p(P,E){P[2]==!0?M?E&4&&F(M,1):(M=In(),M.c(),F(M,1),M.m(e.parentNode,e)):M&&(Ne(),W(M,1,1,()=>{M=null}),Te()),P[3]==!0?A?E&8&&F(A,1):(A=Sn(),A.c(),F(A,1),A.m(t.parentNode,t)):A&&(Ne(),W(A,1,1,()=>{A=null}),Te()),(!$||E&8)&&d(u,"data-marginright",P[3])},i(P){$||(F(M),F(A),F(l.$$.fragment,P),F(r.$$.fragment,P),F(f.$$.fragment,P),F(c.$$.fragment,P),$=!0)},o(P){W(M),W(A),W(l.$$.fragment,P),W(r.$$.fragment,P),W(f.$$.fragment,P),W(c.$$.fragment,P),$=!1},d(P){M&&M.d(P),P&&I(e),A&&A.d(P),P&&I(t),Me(l,P),P&&I(i),Me(r,P),P&&I(s),Me(f,P),P&&I(m),P&&I(u),Me(c),P&&I(y),P&&I(C)}}}function Qo(n){let e,t;return e=new Ko({}),{c(){Oe(e.$$.fragment)},m(l,i){$e(e,l,i),t=!0},p:K,i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function In(n){let e,t;return e=new Uo({}),{c(){Oe(e.$$.fragment)},m(l,i){$e(e,l,i),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function Sn(n){let e,t;return e=new $n({}),{c(){Oe(e.$$.fragment)},m(l,i){$e(e,l,i),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function Zo(n){let e,t,l=(n[1]||n[0]==null)&&kn(n);return{c(){l&&l.c(),e=Ze()},m(i,r){l&&l.m(i,r),S(i,e,r),t=!0},p(i,[r]){i[1]||i[0]==null?l?(l.p(i,r),r&3&&F(l,1)):(l=kn(i),l.c(),F(l,1),l.m(e.parentNode,e)):l&&(Ne(),W(l,1,1,()=>{l=null}),Te())},i(i){t||(F(l),t=!0)},o(i){W(l),t=!1},d(i){l&&l.d(i),i&&I(e)}}}function xo(n,e,t){let l,i,r,s,f;z(n,gt,h=>t(6,l=h)),z(n,le,h=>t(7,i=h)),z(n,ht,h=>t(2,r=h)),z(n,j,h=>t(0,s=h)),z(n,zt,h=>t(3,f=h));let m=!1,u=!1;document.addEventListener("keydown",h=>{if((document.activeElement!=null&&document.activeElement.nodeName==="INPUT"||document.activeElement!=null&&document.activeElement.nodeName=="TEXTAREA")&&h.key!=="Escape")return;switch(h.key.toLowerCase()){case"p":r==!0?ht.set(!1):(ht.set(!0),V(le,i.visible=!1,i));break;case"escape":h.shiftKey?(V(ht,r=!0,r),localStorage.setItem("reset","true"),location.reload(),nl()):i.visible==!0&&V(le,i.visible=!1,i);break;case"arrowleft":case"a":h.preventDefault(),c(0,-1,"up");break;case"arrowright":case"d":h.preventDefault(),c(0,1,"down");break;case"arrowup":case"w":h.preventDefault(),c(-1,0,"left");break;case"arrowdown":case"s":h.preventDefault(),c(1,0,"right");break}});function c(h,q,y){if(i.visible===!1&&i.x===0&&i.y===0)_(0,0,y);else{let C=i.x,$=i.y;C+h<0?C=0:C+h>s.plots.length?C=s.plots.length:C+=h,$+q<0?$=0:$+q>s.plots.length?$=s.plots.length:$+=q,_(C,$,y)}}function _(h,q,y){if(u==!0)switch(y){case"up":q-=2;break;case"down":q+=1;break;case"left":h-=2;break;case"right":h+=1;break}h<0?h=0:h>s.plots.length&&(h=s.plots.length),q<0?q=0:q>s.plots.length&&(q=s.plots.length);let C=document.querySelectorAll(".plot_container"),$;if(C.forEach(M=>{M.dataset.x=="$x"&&M.dataset.y=="$y"&&($=M)}),r==!1){if($.dataset.canBeUpgraded==="true"?V(le,i.visible=!0,i):V(le,i.visible=!1,i),$.dataset.refPlotX!==void 0&&$.dataset.refPlotY!=""?(u=!0,C.forEach(M=>{M.dataset.x==$.dataset.refPlotX&&M.dataset.y==$.dataset.refPlotY&&($=M,h=parseInt($.dataset.x),q=parseInt($.dataset.y))})):u=!1,$.dataset.size!=="1"&&$.dataset.size!==void 0&&(u=!0),V(le,i.x=h,i),V(le,i.y=q,i),C.forEach(M=>{M.classList.remove("selected"),M.style.border="none",M.style.fontWeight=""}),$.classList.add("selected"),u){let M="4px solid #00800045";$.classList.remove("selected"),$.style.borderTop=M,$.style.borderLeft=M,$.style.fontWeight="600",C.forEach(A=>{const P=parseInt(`${A.dataset.x}`),E=parseInt(`${A.dataset.y}`);P==h+1&&E==q&&(A.style.borderLeft=M,A.style.borderBottom=M),P==h&&E==q+1&&(A.style.borderTop=M,A.style.borderRight=M),P==h+1&&E==q+1&&(A.style.borderBottom=M,A.style.borderRight=M)})}$.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),V(gt,l={},l)}}return n.$$.update=()=>{n.$$.dirty&1&&(s?t(1,m=!0):t(1,m=!1))},[s,m,r,f,_]}class zo extends Be{constructor(e){super(),Ee(this,e,xo,Zo,qe,{openPlotMenu:4})}get openPlotMenu(){return this.$$.ctx[4]}}new zo({target:document.getElementById("app")});
