(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();function Q(){}function Sn(n){return n()}function Bl(){return Object.create(null)}function Qe(n){n.forEach(Sn)}function $n(n){return typeof n=="function"}function Pe(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function Mn(n){return Object.keys(n).length===0}function Cn(n,...e){if(n==null)return Q;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function le(n,e,t){n.$$.on_destroy.push(Cn(e,t))}function V(n,e,t){return n.set(t),e}function s(n,e){n.appendChild(e)}function k(n,e,t){n.insertBefore(e,t||null)}function w(n){n.parentNode.removeChild(n)}function ll(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function c(n){return document.createElement(n)}function b(n){return document.createTextNode(n)}function y(){return b(" ")}function Ze(){return b("")}function Z(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function d(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function On(n){return n===""?null:+n}function Nn(n){return Array.from(n.childNodes)}function D(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function Gl(n,e){n.value=e==null?"":e}let It;function kt(n){It=n}function Tn(){if(!It)throw new Error("Function called outside component initialization");return It}function Ft(n){Tn().$$.on_mount.push(n)}const wt=[],Qt=[],Bt=[],Dl=[],Ln=Promise.resolve();let Zt=!1;function qn(){Zt||(Zt=!0,Ln.then(Pn))}function En(){return qn(),Ln}function xt(n){Bt.push(n)}const Xt=new Set;let Et=0;function Pn(){const n=It;do{for(;Et<wt.length;){const e=wt[Et];Et++,kt(e),Bn(e.$$)}for(kt(null),wt.length=0,Et=0;Qt.length;)Qt.pop()();for(let e=0;e<Bt.length;e+=1){const t=Bt[e];Xt.has(t)||(Xt.add(t),t())}Bt.length=0}while(wt.length);for(;Dl.length;)Dl.pop()();Zt=!1,Xt.clear(),kt(n)}function Bn(n){if(n.fragment!==null){n.update(),Qe(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(xt)}}const Gt=new Set;let nt;function Ne(){nt={r:0,c:[],p:nt}}function Te(){nt.r||Qe(nt.c),nt=nt.p}function F(n,e){n&&n.i&&(Gt.delete(n),n.i(e))}function W(n,e,t,l){if(n&&n.o){if(Gt.has(n))return;Gt.add(n),nt.c.push(()=>{Gt.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function Gn(n,e){n.d(1),e.delete(n.key)}function Dn(n,e,t,l,o,r,i,f,_,u,p,h){let g=n.length,I=r.length,v=g;const M={};for(;v--;)M[n[v].key]=v;const A=[],C=new Map,P=new Map;for(v=I;v--;){const a=h(o,r,v),m=t(a);let L=i.get(m);L?l&&L.p(a,e):(L=u(m,a),L.c()),C.set(m,A[v]=L),m in M&&P.set(m,Math.abs(v-M[m]))}const q=new Set,B=new Set;function E(a){F(a,1),a.m(f,p),i.set(a.key,a),p=a.first,I--}for(;g&&I;){const a=A[I-1],m=n[g-1],L=a.key,O=m.key;a===m?(p=a.first,g--,I--):C.has(O)?!i.has(L)||q.has(L)?E(a):B.has(O)?g--:P.get(L)>P.get(O)?(B.add(L),E(a)):(q.add(O),g--):(_(m,i),g--)}for(;g--;){const a=n[g];C.has(a.key)||_(a,i)}for(;I;)E(A[I-1]);return A}function Oe(n){n&&n.c()}function $e(n,e,t,l){const{fragment:o,on_mount:r,on_destroy:i,after_update:f}=n.$$;o&&o.m(e,t),l||xt(()=>{const _=r.map(Sn).filter($n);i?i.push(..._):Qe(_),n.$$.on_mount=[]}),f.forEach(xt)}function Me(n,e){const t=n.$$;t.fragment!==null&&(Qe(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Fn(n,e){n.$$.dirty[0]===-1&&(wt.push(n),qn(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Ee(n,e,t,l,o,r,i,f=[-1]){const _=It;kt(n);const u=n.$$={fragment:null,ctx:null,props:r,update:Q,not_equal:o,bound:Bl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(_?_.$$.context:[])),callbacks:Bl(),dirty:f,skip_bound:!1,root:e.target||_.$$.root};i&&i(u.root);let p=!1;if(u.ctx=t?t(n,e.props||{},(h,g,...I)=>{const v=I.length?I[0]:g;return u.ctx&&o(u.ctx[h],u.ctx[h]=v)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](v),p&&Fn(n,h)),g}):[],u.update(),p=!0,Qe(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const h=Nn(e.target);u.fragment&&u.fragment.l(h),h.forEach(w)}else u.fragment&&u.fragment.c();e.intro&&F(n.$$.fragment),$e(n,e.target,e.anchor,e.customElement),Pn()}kt(_)}class Be{$destroy(){Me(this,1),this.$destroy=Q}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const o=l.indexOf(t);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!Mn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const _t=[];function ot(n,e=Q){let t;const l=new Set;function o(f){if(Pe(n,f)&&(n=f,t)){const _=!_t.length;for(const u of l)u[1](),_t.push(u,n);if(_){for(let u=0;u<_t.length;u+=2)_t[u][0](_t[u+1]);_t.length=0}}}function r(f){o(f(n))}function i(f,_=Q){const u=[f,_];return l.add(u),l.size===1&&(t=e(o)||Q),f(n),()=>{l.delete(u),l.size===0&&(t(),t=null)}}return{set:o,update:r,subscribe:i}}const Rn={plots:[],lastChangeDay:0,townLog:"",townInfo:{name:"Your town",gold:1e3,gold_from_tourism:0,population_count:0,population_max:0,employees:0,happiness:100,health:100,knowledge_points:0},hasCityHall:!1,hasBank:!1,modifiers:{happiness:1,health:1},economyAndLaws:{tax_rate:0,max_tax_rate:1,balance_sheet_history:[],last_month_profit:0},plotCounts:[],environment:{day:0,year:1,climate:-1},difficulty:0,endGoal:"land",endGameDetails:null},Ie="plots_active_game_db";let j=ot(JSON.parse(localStorage.getItem(Ie)||"null"));function Jn(n,e){let t={...Rn};t.economyAndLaws.max_tax_rate=Math.random()*(.5-.2)+.2,t.endGoal=e;let l=[];const o=n=="0"?6:n=="1"?Math.floor(Math.random()*4)+7:n=="2"?Math.floor(Math.random()*9)+12:35;for(let r=0;r<o;r++){l.push([]);for(let i=0;i<o;i++)l[r][i]={id:Math.random().toString(36).substring(2,9),active:!1,x:r,y:i,type:-1}}t.plots=l,localStorage.reset=!1,localStorage.setItem(Ie,JSON.stringify(t)),j.set(t),location.reload()}function nl(n=null){localStorage.removeItem(Ie),j.set(null),n&&(localStorage.setItem(Ie,JSON.stringify(n)),j.set(n)),location.reload()}let ie=ot({visible:!1,x:0,y:0}),gt=ot({}),ht=ot(!1),zt=ot(!1),Dt=ot(2e3);ot(localStorage.getItem("showUnaffordablePlotOptions")==="true");const ae=[{id:"res_small",title:"\u{1F3E0} Residential (small)",subtitle:"for living",type:"residential",description:"A few basic homes that can hold 16 people.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:16},styling:"background-color: #e15f00"},{id:"res_medium",title:"\u{1F3D8}\uFE0F Residential (medium)",subtitle:"for living",type:"residential",description:"A few high-density buildings that can hold 64 people.",revenue_per_week:0,requirements:{gold:500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:64},styling:"background-color: #e15f00"},{id:"res_large",title:"\u{1F3E2} Residential (large)",subtitle:"for living",type:"residential",description:"Many high-density buildings that can hold 256 people.",revenue_per_week:0,requirements:{gold:1500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:256},styling:"background-color: #e15f00"},{id:"cafe",title:"\u2615\uFE0F Small caf\xE9",subtitle:"for recreation & food",type:"food",description:"Great for eating & relaxing, not great for long-term health.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:16,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:.95},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #d24646;"},{id:"carrot_farm",title:"\u{1F955} Carrot farm",subtitle:"for farming",type:"farm",description:"Farm for making carrots, makes money by selling them.",revenue_per_week:6,requirements:{gold:25,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"apple_orchard",title:"\u{1F34E} Apple orchard",subtitle:"for farming",type:"farm",description:"A bunch of trees that make apples, makes money by selling them and by selling apple-related products.",revenue_per_week:8,requirements:{gold:50,plots:[],employees:4,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"bakery",title:"\u{1F956} Bakery",subtitle:"for baking",type:"farm",description:"Makes money by selling bread.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:3,climate:null,knowledge:0},effect_modifiers:{happiness:1.11,health:.92},immediate_variable_changes:{happiness:25,health:0,population:0},styling:"background-color: #008000;"},{id:"grocery",title:"\u{1F3EA} Grocery store",subtitle:"for living",type:"food",description:"People get hungry. This is where they go to get food.",revenue_per_week:40,requirements:{gold:320,plots:[],employees:24,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"fishery",title:"\u{1F420} Fishery",subtitle:"for fishing",type:"food",description:"Carve out some land, pour some water, and fish for fun & food.",revenue_per_week:25,requirements:{gold:400,plots:[],employees:9,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"library",title:"\u{1F4D5} Library",subtitle:"for reading",type:"recreation",description:"Reading makes people very happy, but doesn't make money.",revenue_per_week:0,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:1},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #4169e1;"},{id:"pub",title:"\u{1F37B} Pub",subtitle:"for hanging",type:"recreation",description:"Makes money, and somehow generates communal knowledge.",revenue_per_week:50,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:.7},immediate_variable_changes:{happiness:10,health:-25,population:0},styling:"background-color: #4169e1;"},{id:"church",title:"\u26EA\uFE0F Church",subtitle:"for worship & community",type:"recreation",description:"This can make some people happy, but doesn't make money.",revenue_per_week:0,requirements:{gold:100,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"stables",title:"\u{1F434} Stables",subtitle:"for friends",type:"recreation",description:"People love horses. This makes them happy, and can generate some money through lessons.",revenue_per_week:10,requirements:{gold:220,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"blacksmith",title:"\u2694\uFE0F Blacksmith",subtitle:"for making shiny things",type:"shop",description:"Sometimes problems can only be dealt with by a hunk of metal. Makes money by selling weapons, tools, & armor.",revenue_per_week:50,requirements:{gold:1300,plots:[],employees:13,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1.5},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"inn",title:"\u{1F6CC} Village Inn",subtitle:"for a night out",type:"tourism",description:"Generates tourism gold that can be used if you have a bank.",revenue_per_week:0,enables_tourism:!0,tourism_revenue_per_week:15,requirements:{gold:1500,plots:[],employees:14,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"park_small",title:"\u{1F332} Small park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"A few benches and a small grassy area.",revenue_per_week:0,requirements:{gold:80,plots:[],employees:1,climate:null,knowledge:0},effect_modifiers:{happiness:1.01,health:1.07},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_medium",title:"\u{1F6DD} Medium park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Benches, grass, and a couple of swing-sets.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.02,health:1.15},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_large",title:"\u{1F3AA} Large park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Same as the medium park, with a nice fountain in the middle and occasional events run by the employees.",revenue_per_week:0,requirements:{gold:300,plots:[],employees:4,climate:null,size:2,knowledge:0},effect_modifiers:{happiness:1.09,health:1.25},immediate_variable_changes:{happiness:30,health:0,population:0},styling:"background-color: #ffff00;"},{id:"school_small",title:"\u{1F4DA} Small school",subtitle:"for learning",type:"education",description:"A place where children can learn and grow, and where adults can learn new skills. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:2,requirements:{gold:850,plots:[],employees:20,climate:null,size:1,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:15,health:3,population:0},styling:"background-color: #4caf50;"},{id:"school_large",title:"\u{1F68C} Large school",subtitle:"for learning",type:"education",description:"A larger school. Produces knowledge",revenue_per_week:0,knowledge_points_per_month:8,requirements:{gold:1300,plots:[],employees:40,climate:null,size:2,knowledge:10},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:5,health:3,population:0},styling:"background-color: #4caf50;"},{id:"university",title:"\u{1F3EB} University",subtitle:"for learning",type:"education",description:"The supreme learning institution. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:25,requirements:{gold:3500,plots:[],employees:64,climate:null,size:2,knowledge:100},effect_modifiers:{happiness:1.25,health:1},immediate_variable_changes:{happiness:25,health:25,population:0},styling:"background-color: #4caf50;"},{id:"small_hospital",title:"\u{1F691} Small hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from minor injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:800,plots:[],employees:8,climate:null,size:1,knowledge:50},effect_modifiers:{happiness:1.25,health:1.5},immediate_variable_changes:{happiness:5,health:50,population:0},styling:"background-color: #ff0000;"},{id:"large_hospital",title:"\u{1F3E5} Large hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from all injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:4e3,plots:[],employees:64,climate:null,size:1,knowledge:200},effect_modifiers:{happiness:1.25,health:2.5},immediate_variable_changes:{happiness:5,health:75,population:0},styling:"background-color: #ff0000;"},{id:"bank",title:"\u{1F3E6} Bank",subtitle:"for storing and accessing funds",type:"bank",description:"Rich get richer.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:64,climate:null,size:1,knowledge:300},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"},{id:"city-hall",title:"\u{1F5F3}\uFE0F City Hall",subtitle:"for bureaucracy",type:"federal",description:"For running the government.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:24,climate:null,size:1,knowledge:500},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"}],ke={unemployment_num:" people can't find jobs.",bored:"People are bored. Try making some new buildings.",vairety:"People don't like going to the same places over and over again. Try making some new buildings.",nobody_home:"Nobody can live here. Build some residential buildings.",leave_town_num:" people left town because they were unhappy.",new_people_num:" new people moved to town.",people_want_to_move_in:"People want to move in. Build more homes.",high_tax_rate:"People are unhappy with the high tax rate.",very_high_tax_rate:"People are extremely unhappy with the high tax rate.",sickAndDying:"People are sick and dying.",sickAndLeaving:"People are sick and leaving town.",happiness_zero:"The town has fallen into chaos due to extreme unhappiness.",health_zero:"The town has fallen into chaos due to extreme sickness.",population_zero:"The town has been condemned due to lack of population.",win:{land:"You have filled the grid with buildings. You win!"}};function Fl(n){let e,t,l=ae[n[0].type].title+"",o,r;return{c(){e=c("div"),t=c("span"),o=b(l),d(t,"data-size",r=ae[n[0].type].requirements.size),d(t,"class","svelte-18cb8zy"),d(e,"class","svelte-18cb8zy")},m(i,f){k(i,e,f),s(e,t),s(t,o)},p(i,f){f&1&&l!==(l=ae[i[0].type].title+"")&&D(o,l),f&1&&r!==(r=ae[i[0].type].requirements.size)&&d(t,"data-size",r)},d(i){i&&w(e)}}}function Un(n){let e,t,l,o,r,i,f,_,u,p,h,g,I=n[0].type>-1&&Fl(n);return{c(){e=c("div"),I&&I.c(),d(e,"class","plot_container svelte-18cb8zy"),d(e,"data-active",t=n[0].active),d(e,"data-id",l=n[0].id),d(e,"data-x",o=n[0].x),d(e,"data-y",r=n[0].y),d(e,"data-optionindex",i=n[0].optionIndex),d(e,"data-canbeupgraded",n[1]),d(e,"style",n[2]),d(e,"data-type",f=n[0].type),d(e,"data-referenceplotx",_=n[0].referencePlot!==void 0?n[0].referencePlot[0]:null),d(e,"data-referenceploty",u=n[0].referencePlot!==void 0?n[0].referencePlot[1]:null),d(e,"data-size",p=n[0].type>-1?ae[n[0].type].requirements.size:null)},m(v,M){k(v,e,M),I&&I.m(e,null),h||(g=Z(e,"click",n[3]),h=!0)},p(v,[M]){v[0].type>-1?I?I.p(v,M):(I=Fl(v),I.c(),I.m(e,null)):I&&(I.d(1),I=null),M&1&&t!==(t=v[0].active)&&d(e,"data-active",t),M&1&&l!==(l=v[0].id)&&d(e,"data-id",l),M&1&&o!==(o=v[0].x)&&d(e,"data-x",o),M&1&&r!==(r=v[0].y)&&d(e,"data-y",r),M&1&&i!==(i=v[0].optionIndex)&&d(e,"data-optionindex",i),M&2&&d(e,"data-canbeupgraded",v[1]),M&4&&d(e,"style",v[2]),M&1&&f!==(f=v[0].type)&&d(e,"data-type",f),M&1&&_!==(_=v[0].referencePlot!==void 0?v[0].referencePlot[0]:null)&&d(e,"data-referenceplotx",_),M&1&&u!==(u=v[0].referencePlot!==void 0?v[0].referencePlot[1]:null)&&d(e,"data-referenceploty",u),M&1&&p!==(p=v[0].type>-1?ae[v[0].type].requirements.size:null)&&d(e,"data-size",p)},i:Q,o:Q,d(v){v&&w(e),I&&I.d(),h=!1,g()}}}function Hn(n,e,t){let l,o,r,i;le(n,ie,v=>t(5,l=v)),le(n,j,v=>t(6,o=v)),le(n,ht,v=>t(7,r=v)),le(n,gt,v=>t(8,i=v));let{data:f={id:0,active:!1,x:0,y:0,type:-1,styling:"",referencePlot:[]}}=e,{canBeUpgraded:_=!1}=e;function u(...v){h()}let p=f.styling;Ft(async()=>{f.type>=0&&ae[f.type].styling&&t(2,p=ae[f.type].styling)});function h(){f.type>=0&&ae[f.type].styling&&t(2,p=ae[f.type].styling),f.type<0&&t(2,p="")}function g(v,M,A){let C=document.querySelectorAll(".plot_container");if(r==!1){if(f.referencePlot!=null&&f.referencePlot[0]!==null&&M==null&&A==null&&f.referencePlot[1]!==void 0)return g(v,f.referencePlot[0],f.referencePlot[1]);!f.active&&!_?(V(gt,i={},i),V(ie,l.visible=!1,l),C.forEach(P=>{P.classList.remove("selected")})):(M!=null&&A!=null?(V(ie,l.x=M,l),V(ie,l.y=A,l)):(V(ie,l.x=f.x,l),V(ie,l.y=f.y,l)),V(ie,l.visible=!0,l),C.forEach(P=>{P.classList.remove("selected")}),M!=null&&A!=null?document.querySelector(`.plot_container[data-x="${M}"][data-y="${A}"]`).classList.add("selected"):document.querySelector(`.plot_container[data-id="${f.id}"]`).classList.add("selected"))}}function I(v){r==!1&&(V(j,o.plots[f.x][f.y].type=v,o),V(ie,l.visible=!1,l))}return n.$$set=v=>{"data"in v&&t(0,f=v.data),"canBeUpgraded"in v&&t(1,_=v.canBeUpgraded)},n.$$.update=()=>{n.$$.dirty&1&&u(f)},[f,_,p,g,I]}class jn extends Be{constructor(e){super(),Ee(this,e,Hn,Un,Pe,{data:0,canBeUpgraded:1,changePlotType:4})}get changePlotType(){return this.$$.ctx[4]}}const mt={land:{short_title:"Fill the grid",description_title:"You win by filling up all possible plots in the grid, and by meeting some requirements.",win:"You have filled the grid with buildings. You win!",requirements:{0:{population_count:200,happiness:100,health:100,employment:1},1:{population_count:500,happiness:100,health:100,employment:1},2:{population_count:1e3,happiness:100,health:100,employment:1}}}};function Yn(n){return n.hasBank,n}function Vn(n){return n.hasCityHall,n}function el(n){if(n.modifiers.happiness>1){let e=n.modifiers.happiness-1;n.modifiers.happiness-=e*.08,n.modifiers.happiness<1.05&&(n.modifiers.happiness=1)}if(n.modifiers.health>1){let e=n.modifiers.health-1;n.modifiers.health-=e*.08,n.modifiers.health<1.05&&(n.modifiers.health=1)}return n}function tl(n){if(n.townInfo.happiness>150){let t=n.townInfo.happiness-150;n.townInfo.happiness-=t*.08,n.townInfo.happiness<150&&(n.townInfo.happiness=150)}if(n.townInfo.health>150){let t=n.townInfo.health-150;n.townInfo.health-=t*.08,n.townInfo.health<150&&(n.townInfo.health=150)}return n}function Wn(n){return n.townInfo.happiness*=n.modifiers.happiness,n.townInfo.health*=n.modifiers.health,n}function Kn(n,e){let t=e.townInfo.happiness/100;t>1.25?t=1.25:t<.75&&(t=.75);let l=n*e.economyAndLaws.tax_rate*(e.townInfo.population_count/e.townInfo.population_max)*t;return Xe(l,2)}function Xe(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Xn(n,e,t){let l,o,r;le(n,Dt,a=>t(4,l=a)),le(n,j,a=>t(5,o=a)),le(n,ht,a=>t(6,r=a));function i(a){return a=I(a),a=C(a),a=q(a),a=Wn(a),a=v(a),a=el(a),a}function f(a){return a=B(a),a=A(a),a=Yn(a),a=Vn(a),a}function _(a){return a=M(a),a=tl(a),a}function u(a){return a=P(a),a=g(a),a=h(a),a}function p(){j.update(a=>{if(r||!a||a.endGameDetails)return a;try{return a.environment.day+=1,a.environment.day%7===0&&(a=i(a)),a.environment.day%30===0&&(a=f(a)),a.environment.day%90===0&&(a=_(a)),a=u(a),a}catch(m){return console.error("Error in game loop:",m),a}})}j.subscribe(a=>{a&&localStorage.setItem(Ie,JSON.stringify(a))});function h(a){if(a.endGoal=="land"&&a.townInfo.population_max==a.townInfo.population_count&&a.townInfo.happiness>=mt.land.requirements[a.difficulty].happiness&&a.townInfo.health>=mt.land.requirements[a.difficulty].health&&a.townInfo.employees/a.townInfo.population_count>=mt.land.requirements[a.difficulty].employment&&a.townInfo.population_count>mt.land.requirements[a.difficulty].population){let L=!0;for(let O=0;O<a.plots.length;O++)for(let $=0;$<a.plots[O].length;$++)if(a.plots[O][$].active==!1){L=!1;break}L&&(a.endGameDetails={msg:mt.land.win,win:!0})}return a}function g(a){return a.townInfo.happiness<=0&&(a.townInfo.happiness=0,a.endGameDetails={msg:ke.happiness_zero,win:!1}),a.townInfo.health<=0&&(a.townInfo.health=0,a.endGameDetails={msg:ke.health_zero,win:!1}),a.townInfo.population_count<=0&&a.townInfo.population_max>0&&(a.townInfo.population_count=0,a.endGameDetails={msg:ke.population_zero,win:!1}),a}function I(a){let m=a.townInfo.population_count-a.townInfo.employees;return m>0&&(a.modifiers.happiness-=m*9e-4,a=E(m+ke.unemployment_num,a)),a}function v(a){let m=a.townInfo.health,L=0;return m>50||m<Math.random()*50&&(m<25?(a=E(ke.sickAndDying,a),a.townInfo.happiness-=10,L=Math.round(a.townInfo.population_count*.1)):(a=E(ke.sickAndLeaving,a),a.townInfo.happiness-=5,L=Math.round(a.townInfo.population_count*.05)),a.townInfo.population_count-=L,a.townInfo.employees-=L),a}function M(a){return a.lastChangeDay+(Math.random()*160+50)<a.environment.day&&(a.townInfo.population_count>0&&(a.townInfo.population_count-=1,a.townInfo.employees-=1,a.modifiers.happiness-=.01),a=E(ke.bored,a)),a}function A(a){if(a.townInfo.population_count<a.townInfo.population_max&&a.townInfo.happiness>50){let m=a.townInfo.population_max-a.townInfo.population_count,L=Math.round(a.townInfo.happiness/100*m);a.townInfo.population_count+=L,a.townInfo.population_count>a.townInfo.population_max&&(a.townInfo.population_count=a.townInfo.population_max),a.townInfo.employees+=L,a.townInfo.employees>a.townInfo.population_count&&(a.townInfo.employees=a.townInfo.population_count),a=E(L+ke.new_people_num,a)}if(a.townInfo.happiness<50&&a.townInfo.population_count>0){let m=Math.round((100-a.townInfo.happiness)/5);a.townInfo.population_count-=m,a.townInfo.employees>0&&(a.townInfo.employees-=m),a=E(m+ke.leave_town_num,a)}else a.townInfo.population_count==a.townInfo.population_max&&(a=E(ke.people_want_to_move_in,a));return a}function C(a){const m=Math.random();if(a.economyAndLaws.tax_rate>a.economyAndLaws.max_tax_rate){const L=a.difficulty==0?.7:a.difficulty==1?.4:.2;m<L&&a.economyAndLaws.tax_rate>a.economyAndLaws.max_tax_rate*2?(a.modifiers.happiness-=.03,a=E(ke.very_high_tax_rate+"  ("+a.economyAndLaws.tax_rate+"%)",a)):(a.modifiers.happiness-=.01,a=E(ke.high_tax_rate+"  ("+a.economyAndLaws.tax_rate*100+"%)",a))}return a}function P(a){return a.townInfo.happiness<0&&(a.townInfo.happiness=0),a.townInfo.health<0&&(a.townInfo.health=0),a.townInfo.gold<0&&(a.townInfo.gold=0),a.townInfo.employees<0&&(a.townInfo.employees=0),a.townInfo.knowledge_points<0&&(a.townInfo.knowledge_points=0),a.townInfo.population_count<0&&(a.townInfo.population_count=0),a.townInfo.population_max==0&&(a=E(ke.nobody_home,a)),a.economyAndLaws.last_month_profit=Xe(a.economyAndLaws.last_month_profit,2),a.townInfo.gold=Xe(a.townInfo.gold,2),a.townInfo.population_count=Xe(a.townInfo.population_count,0),a.townInfo.employees=Xe(a.townInfo.employees,0),a.townInfo.population_max=Xe(a.townInfo.population_max,0),a.townInfo.happiness=Xe(a.townInfo.happiness,2),a.townInfo.health=Xe(a.townInfo.health,2),a.townInfo.happiness>300&&(a.townInfo.happiness=300),a.townInfo.health>300&&(a.townInfo.health=300),a.modifiers.happiness<.5&&(a.modifiers.happiness=.5),a.modifiers.health<.5&&(a.modifiers.health=.5),a}function q(a){a.economyAndLaws.last_month_profit=0;for(let m=0;m<a.plots.length;m++)for(let L=0;L<a.plots[m].length;L++)if(a.plots[m][L].active==!0&&a.plots[m][L].type>-1){let O=ae[a.plots[m][L].type],$=Kn(O.revenue_per_week,a);a.townInfo.gold+=$,a.economyAndLaws.last_month_profit+=$,$>0&&(a.economyAndLaws.balance_sheet_history=[{day:a.environment.day,plot:`${m},${L}`,profits:$,taxRate:a.economyAndLaws.tax_rate},...a.economyAndLaws.balance_sheet_history],a.economyAndLaws.balance_sheet_history.length>250&&(a.economyAndLaws.balance_sheet_history=a.economyAndLaws.balance_sheet_history.slice(0,250))),O.enables_tourism==!0&&(a.townInfo.gold_from_tourism+=O.tourism_revenue_per_week*a.economyAndLaws.tax_rate*a.townInfo.population_count)}return a}function B(a){for(let m=0;m<a.plots.length;m++)for(let L=0;L<a.plots[m].length;L++)if(a.plots[m][L].active==!0&&a.plots[m][L].type>-1){let O=ae[a.plots[m][L].type];O.knowledge_points_per_month!=null&&(a.townInfo.knowledge_points+=O.knowledge_points_per_month)}return a}function E(a,m){return m.townLog="Day "+o.environment.day+" - "+a+`
`+m.townLog,m}return Ft(async()=>{for(;;)localStorage.reset=="true"&&(nl(),localStorage.setItem("reset","false")),p(),await new Promise(a=>setTimeout(a,l))}),[p,P,el,tl]}class Qn extends Be{constructor(e){super(),Ee(this,e,Xn,null,Pe,{mainGameThreadLoop:0,_fixVariables:1,_bringModifiersBackToNormal:2,_bringStatsBackToNormal:3})}get mainGameThreadLoop(){return this.$$.ctx[0]}get _fixVariables(){return this.$$.ctx[1]}get _bringModifiersBackToNormal(){return el}get _bringStatsBackToNormal(){return tl}}function Rl(n,e,t){const l=n.slice();return l[21]=e[t],l}function Jl(n){let e,t;return{c(){e=c("div"),t=b(n[0]),d(e,"class","message")},m(l,o){k(l,e,o),s(e,t)},p(l,o){o&1&&D(t,l[0])},d(l){l&&w(e)}}}function Ul(n){let e,t,l;return{c(){e=c("button"),e.textContent="\u{1F525}",d(e,"id","bulldoze"),d(e,"class","svelte-bdghnw")},m(o,r){k(o,e,r),t||(l=Z(e,"click",n[11]),t=!0)},p:Q,d(o){o&&w(e),t=!1,l()}}}function Hl(n){let e,t,l,o;return{c(){e=c("span"),t=b("("),l=b(n[8]),o=b(")"),d(e,"class","text_s")},m(r,i){k(r,e,i),s(e,t),s(e,l),s(e,o)},p(r,i){i&256&&D(l,r[8])},d(r){r&&w(e)}}}function jl(n){let e;return{c(){e=c("span"),e.textContent="(0)",d(e,"class","text_s")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Yl(n){let e,t,l,o,r,i,f=n[21].revenue_per_week>0&&Vl(n),_=n[21].tourism_revenue_per_week>0&&Wl(n);return{c(){e=c("div"),t=c("span"),t.textContent="Profits",l=y(),o=c("br"),r=y(),f&&f.c(),i=y(),_&&_.c(),d(t,"class","subheading_m"),d(e,"class","profits svelte-bdghnw")},m(u,p){k(u,e,p),s(e,t),s(e,l),s(e,o),s(e,r),f&&f.m(e,null),s(e,i),_&&_.m(e,null)},p(u,p){u[21].revenue_per_week>0?f?f.p(u,p):(f=Vl(u),f.c(),f.m(e,i)):f&&(f.d(1),f=null),u[21].tourism_revenue_per_week>0?_?_.p(u,p):(_=Wl(u),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},d(u){u&&w(e),f&&f.d(),_&&_.d()}}}function Vl(n){let e,t,l=n[21].revenue_per_week+"",o,r,i=Ue(n[6].economyAndLaws.tax_rate*n[21].revenue_per_week,2)+"",f,_,u,p;return{c(){e=c("span"),t=c("span"),o=b(l),r=y(),f=b(i),_=b(" gold (with tax rate)"),u=y(),p=c("br"),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(h,g){k(h,e,g),s(e,t),s(t,o),s(e,r),s(e,f),s(e,_),k(h,u,g),k(h,p,g)},p(h,g){g&32&&l!==(l=h[21].revenue_per_week+"")&&D(o,l),g&96&&i!==(i=Ue(h[6].economyAndLaws.tax_rate*h[21].revenue_per_week,2)+"")&&D(f,i)},d(h){h&&w(e),h&&w(u),h&&w(p)}}}function Wl(n){let e,t,l=n[21].tourism_revenue_per_week+"",o,r,i=Ue(n[6].economyAndLaws.tax_rate*n[21].tourism_revenue_per_week*n[6].townInfo.population_count,2)+"",f,_,u,p=n[6].hasABank!==!0&&Kl();return{c(){e=c("span"),t=c("span"),o=b(l),r=y(),f=b(i),_=b(` tourism gold (
											`),p&&p.c(),u=b(`

											)`),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(h,g){k(h,e,g),s(e,t),s(t,o),s(e,r),s(e,f),s(e,_),p&&p.m(e,null),s(e,u)},p(h,g){g&32&&l!==(l=h[21].tourism_revenue_per_week+"")&&D(o,l),g&96&&i!==(i=Ue(h[6].economyAndLaws.tax_rate*h[21].tourism_revenue_per_week*h[6].townInfo.population_count,2)+"")&&D(f,i),h[6].hasABank!==!0?p||(p=Kl(),p.c(),p.m(e,u)):p&&(p.d(1),p=null)},d(h){h&&w(e),p&&p.d()}}}function Kl(n){let e;return{c(){e=b("get a bank to cash out")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Xl(n){let e,t;function l(i,f){return i[6].townInfo.gold<i[21].requirements.gold?xn:Zn}let o=l(n),r=o(n);return{c(){r.c(),e=y(),t=c("br")},m(i,f){r.m(i,f),k(i,e,f),k(i,t,f)},p(i,f){o===(o=l(i))&&r?r.p(i,f):(r.d(1),r=o(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){r.d(i),i&&w(e),i&&w(t)}}}function Zn(n){let e,t=n[21].requirements.gold+"",l,o;return{c(){e=c("span"),l=b(t),o=b(" gold"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,i){k(r,e,i),s(e,l),s(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.gold+"")&&D(l,t)},d(r){r&&w(e)}}}function xn(n){let e,t=n[21].requirements.gold+"",l,o;return{c(){e=c("span"),l=b(t),o=b(" gold"),d(e,"class","red text_s cost_label svelte-bdghnw")},m(r,i){k(r,e,i),s(e,l),s(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.gold+"")&&D(l,t)},d(r){r&&w(e)}}}function Ql(n){let e,t;function l(i,f){return i[6].townInfo.population_count-i[6].townInfo.employees<i[21].requirements.employees?eo:zn}let o=l(n),r=o(n);return{c(){r.c(),e=y(),t=c("br")},m(i,f){r.m(i,f),k(i,e,f),k(i,t,f)},p(i,f){o===(o=l(i))&&r?r.p(i,f):(r.d(1),r=o(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){r.d(i),i&&w(e),i&&w(t)}}}function zn(n){let e,t=n[21].requirements.employees+"",l,o;return{c(){e=c("span"),l=b(t),o=b(" employees"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,i){k(r,e,i),s(e,l),s(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.employees+"")&&D(l,t)},d(r){r&&w(e)}}}function eo(n){let e,t=n[21].requirements.employees+"",l,o;return{c(){e=c("span"),l=b(t),o=b(" employees"),d(e,"class","text_s cost_label red svelte-bdghnw")},m(r,i){k(r,e,i),s(e,l),s(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.employees+"")&&D(l,t)},d(r){r&&w(e)}}}function Zl(n){let e,t;function l(i,f){return i[6].townInfo.knowledge_points<i[21].requirements.knowledge?lo:to}let o=l(n),r=o(n);return{c(){r.c(),e=y(),t=c("br")},m(i,f){r.m(i,f),k(i,e,f),k(i,t,f)},p(i,f){o===(o=l(i))&&r?r.p(i,f):(r.d(1),r=o(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){r.d(i),i&&w(e),i&&w(t)}}}function to(n){let e,t=n[21].requirements.knowledge+"",l,o;return{c(){e=c("span"),l=b(t),o=b(" knowledge"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,i){k(r,e,i),s(e,l),s(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.knowledge+"")&&D(l,t)},d(r){r&&w(e)}}}function lo(n){let e,t=n[21].requirements.knowledge+"",l,o;return{c(){e=c("span"),l=b(t),o=b(" knowledge"),d(e,"class","text_s cost_label red svelte-bdghnw")},m(r,i){k(r,e,i),s(e,l),s(e,o)},p(r,i){i&32&&t!==(t=r[21].requirements.knowledge+"")&&D(l,t)},d(r){r&&w(e)}}}function no(n){let e,t,l=Rt(n[21].effect_modifiers.happiness)+"",o,r;return{c(){e=c("span"),t=b("\u{1F601} "),o=b(l),d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive",r=n[21].effect_modifiers.happiness>=1)},m(i,f){k(i,e,f),s(e,t),s(e,o)},p(i,f){f&32&&l!==(l=Rt(i[21].effect_modifiers.happiness)+"")&&D(o,l),f&32&&r!==(r=i[21].effect_modifiers.happiness>=1)&&d(e,"data-positive",r)},d(i){i&&w(e)}}}function oo(n){let e;return{c(){e=c("span"),e.textContent="\u{1F601} No effect",d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive","true")},m(t,l){k(t,e,l)},p:Q,d(t){t&&w(e)}}}function io(n){let e,t,l=Rt(n[21].effect_modifiers.health)+"",o,r;return{c(){e=c("span"),t=b("\u{1F3E5} "),o=b(l),d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive",r=n[21].effect_modifiers.health>=1)},m(i,f){k(i,e,f),s(e,t),s(e,o)},p(i,f){f&32&&l!==(l=Rt(i[21].effect_modifiers.health)+"")&&D(o,l),f&32&&r!==(r=i[21].effect_modifiers.health>=1)&&d(e,"data-positive",r)},d(i){i&&w(e)}}}function so(n){let e;return{c(){e=c("span"),e.textContent="\u{1F3E5} No effect",d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive","true")},m(t,l){k(t,e,l)},p:Q,d(t){t&&w(e)}}}function xl(n){let e,t,l,o,r,i=n[21].immediate_variable_changes.happiness!==0&&zl(n),f=n[21].immediate_variable_changes.happiness!==0&&n[21].immediate_variable_changes.health!==0&&en(),_=n[21].immediate_variable_changes.health!==0&&tn(n);return{c(){e=c("div"),t=c("span"),l=b(`Instant changes:
										`),i&&i.c(),o=y(),f&&f.c(),r=y(),_&&_.c(),d(t,"class","subheading_m"),d(e,"class","immediate_changes svelte-bdghnw")},m(u,p){k(u,e,p),s(e,t),s(t,l),i&&i.m(t,null),s(t,o),f&&f.m(t,null),s(t,r),_&&_.m(t,null)},p(u,p){u[21].immediate_variable_changes.happiness!==0?i?i.p(u,p):(i=zl(u),i.c(),i.m(t,o)):i&&(i.d(1),i=null),u[21].immediate_variable_changes.happiness!==0&&u[21].immediate_variable_changes.health!==0?f||(f=en(),f.c(),f.m(t,r)):f&&(f.d(1),f=null),u[21].immediate_variable_changes.health!==0?_?_.p(u,p):(_=tn(u),_.c(),_.m(t,null)):_&&(_.d(1),_=null)},d(u){u&&w(e),i&&i.d(),f&&f.d(),_&&_.d()}}}function zl(n){let e,t,l=n[21].immediate_variable_changes.happiness+"",o;return{c(){e=b(`\u{1F601}
											`),t=c("span"),o=b(l),d(t,"class","green")},m(r,i){k(r,e,i),k(r,t,i),s(t,o)},p(r,i){i&32&&l!==(l=r[21].immediate_variable_changes.happiness+"")&&D(o,l)},d(r){r&&w(e),r&&w(t)}}}function en(n){let e;return{c(){e=b(",")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function tn(n){let e,t,l=n[21].immediate_variable_changes.health+"",o;return{c(){e=b(`\u{1F3E5}
											`),t=c("span"),o=b(l),d(t,"class","green")},m(r,i){k(r,e,i),k(r,t,i),s(t,o)},p(r,i){i&32&&l!==(l=r[21].immediate_variable_changes.health+"")&&D(o,l)},d(r){r&&w(e),r&&w(t)}}}function ln(n,e){let t,l,o,r=e[21].title+"",i,f,_,u,p,h=e[21].subtitle+"",g,I,v,M,A,C=e[21].description+"",P,q,B,E,a,m,L,O,$,X,S,K,U,J,fe,te,R,H,x,z,oe,he,T,N,ee,ge,xe,re=(e[21].revenue_per_week>0||e[21].tourism_revenue_per_week>0)&&Yl(e),ue=e[21].requirements.gold!==0&&Xl(e),de=e[21].requirements.employees!==0&&Ql(e),pe=e[21].requirements.knowledge!=null&&e[21].requirements.knowledge!==0&&Zl(e);function ze(ve,se){return ve[21].effect_modifiers.happiness==1?oo:no}let Ye=ze(e),Se=Ye(e);function Ge(ve,se){return ve[21].effect_modifiers.health==1?so:io}let je=Ge(e),Le=je(e),ne=(e[21].immediate_variable_changes.happiness!==0||e[21].immediate_variable_changes.health!==0)&&xl(e);return{key:n,first:null,c(){t=c("div"),l=c("div"),o=c("span"),i=b(r),f=y(),_=c("br"),u=y(),p=c("span"),g=b(h),I=y(),v=c("br"),M=y(),A=c("span"),P=b(C),q=y(),B=c("div"),re&&re.c(),E=y(),a=c("div"),m=c("div"),L=c("span"),L.textContent="Requirements",O=y(),$=c("br"),X=y(),ue&&ue.c(),S=y(),de&&de.c(),K=y(),pe&&pe.c(),U=y(),J=c("div"),fe=c("span"),fe.textContent="Multiplier",te=y(),R=c("br"),H=y(),Se.c(),x=y(),z=c("br"),oe=y(),Le.c(),he=y(),ne&&ne.c(),T=y(),d(o,"class","heading_m"),d(p,"class","subheading_m"),d(A,"class","text_s"),d(L,"class","subheading_m"),d(m,"class","svelte-bdghnw"),d(fe,"class","subheading_m"),d(J,"class","svelte-bdghnw"),d(a,"class","reqs_and_mods svelte-bdghnw"),d(B,"class","bottom svelte-bdghnw"),d(t,"class",N="plotOption background-lightgray "+(e[21].affordable?"":"unaffordable")+" svelte-bdghnw"),d(t,"data-active",ee=e[21].selected),d(t,"data-affordable",ge=e[21].affordable),d(t,"data-plotoptionid",xe=e[21].id),this.first=t},m(ve,se){k(ve,t,se),s(t,l),s(l,o),s(o,i),s(l,f),s(l,_),s(l,u),s(l,p),s(p,g),s(l,I),s(l,v),s(l,M),s(l,A),s(A,P),s(t,q),s(t,B),re&&re.m(B,null),s(B,E),s(B,a),s(a,m),s(m,L),s(m,O),s(m,$),s(m,X),ue&&ue.m(m,null),s(m,S),de&&de.m(m,null),s(m,K),pe&&pe.m(m,null),s(a,U),s(a,J),s(J,fe),s(J,te),s(J,R),s(J,H),Se.m(J,null),s(J,x),s(J,z),s(J,oe),Le.m(J,null),s(B,he),ne&&ne.m(B,null),s(t,T)},p(ve,se){e=ve,se&32&&r!==(r=e[21].title+"")&&D(i,r),se&32&&h!==(h=e[21].subtitle+"")&&D(g,h),se&32&&C!==(C=e[21].description+"")&&D(P,C),e[21].revenue_per_week>0||e[21].tourism_revenue_per_week>0?re?re.p(e,se):(re=Yl(e),re.c(),re.m(B,E)):re&&(re.d(1),re=null),e[21].requirements.gold!==0?ue?ue.p(e,se):(ue=Xl(e),ue.c(),ue.m(m,S)):ue&&(ue.d(1),ue=null),e[21].requirements.employees!==0?de?de.p(e,se):(de=Ql(e),de.c(),de.m(m,K)):de&&(de.d(1),de=null),e[21].requirements.knowledge!=null&&e[21].requirements.knowledge!==0?pe?pe.p(e,se):(pe=Zl(e),pe.c(),pe.m(m,null)):pe&&(pe.d(1),pe=null),Ye===(Ye=ze(e))&&Se?Se.p(e,se):(Se.d(1),Se=Ye(e),Se&&(Se.c(),Se.m(J,x))),je===(je=Ge(e))&&Le?Le.p(e,se):(Le.d(1),Le=je(e),Le&&(Le.c(),Le.m(J,null))),e[21].immediate_variable_changes.happiness!==0||e[21].immediate_variable_changes.health!==0?ne?ne.p(e,se):(ne=xl(e),ne.c(),ne.m(B,null)):ne&&(ne.d(1),ne=null),se&32&&N!==(N="plotOption background-lightgray "+(e[21].affordable?"":"unaffordable")+" svelte-bdghnw")&&d(t,"class",N),se&32&&ee!==(ee=e[21].selected)&&d(t,"data-active",ee),se&32&&ge!==(ge=e[21].affordable)&&d(t,"data-affordable",ge),se&32&&xe!==(xe=e[21].id)&&d(t,"data-plotoptionid",xe)},d(ve){ve&&w(t),re&&re.d(),ue&&ue.d(),de&&de.d(),pe&&pe.d(),Se.d(),Le.d(),ne&&ne.d()}}}function ao(n){let e,t,l,o,r,i,f=n[2]+1+"",_,u,p=n[1]+1+"",h,g,I,v,M,A,C=n[6].plots[n[1]][n[2]].type!==-1&&n[3](n[2],n[1]),P,q,B,E,a,m,L,O,$,X,S,K,U,J=[],fe=new Map,te,R,H=n[0]!==""&&Jl(n),x=C&&Ul(n),z=n[8]>0&&Hl(n),oe=n[5].length==0&&jl(),he=n[5];const T=N=>N[21].id;for(let N=0;N<he.length;N+=1){let ee=Rl(n,he,N),ge=T(ee);fe.set(ge,J[N]=ln(ge,ee))}return{c(){e=c("div"),t=c("div"),l=c("div"),o=c("div"),r=c("span"),i=b("Modify Plot: "),_=b(f),u=b("-"),h=b(p),g=y(),H&&H.c(),I=y(),v=c("input"),M=y(),A=c("div"),x&&x.c(),P=y(),q=c("button"),q.textContent="Close",B=y(),E=c("div"),a=c("label"),m=b(`options
				`),z&&z.c(),L=y(),oe&&oe.c(),O=y(),$=c("br"),X=y(),S=c("br"),K=y(),U=c("div");for(let N=0;N<J.length;N+=1)J[N].c();d(r,"class","heading_l"),d(o,"class","svelte-bdghnw"),d(v,"type","text"),d(v,"id","search-bar"),d(v,"placeholder","Search Plot Options..."),v.value=n[4],d(v,"class","svelte-bdghnw"),d(q,"id","close"),d(q,"class","svelte-bdghnw"),d(A,"class","svelte-bdghnw"),d(l,"class","header svelte-bdghnw"),d(a,"for","plotType"),d(U,"class","plotOptions svelte-bdghnw"),d(E,"class","scrollable-y svelte-bdghnw"),d(t,"class","dialog-content svelte-bdghnw"),d(e,"class","dialog svelte-bdghnw")},m(N,ee){k(N,e,ee),s(e,t),s(t,l),s(l,o),s(o,r),s(r,i),s(r,_),s(r,u),s(r,h),s(o,g),H&&H.m(o,null),s(l,I),s(l,v),n[16](v),s(l,M),s(l,A),x&&x.m(A,null),s(A,P),s(A,q),s(t,B),s(t,E),s(E,a),s(a,m),z&&z.m(a,null),s(a,L),oe&&oe.m(a,null),s(E,O),s(E,$),s(E,X),s(E,S),s(E,K),s(E,U);for(let ge=0;ge<J.length;ge+=1)J[ge].m(U,null);te||(R=[Z(v,"input",n[9]),Z(q,"click",n[10]),Z(U,"click",n[12])],te=!0)},p(N,[ee]){ee&4&&f!==(f=N[2]+1+"")&&D(_,f),ee&2&&p!==(p=N[1]+1+"")&&D(h,p),N[0]!==""?H?H.p(N,ee):(H=Jl(N),H.c(),H.m(o,null)):H&&(H.d(1),H=null),ee&16&&v.value!==N[4]&&(v.value=N[4]),ee&70&&(C=N[6].plots[N[1]][N[2]].type!==-1&&N[3](N[2],N[1])),C?x?x.p(N,ee):(x=Ul(N),x.c(),x.m(A,P)):x&&(x.d(1),x=null),N[8]>0?z?z.p(N,ee):(z=Hl(N),z.c(),z.m(a,L)):z&&(z.d(1),z=null),N[5].length==0?oe||(oe=jl(),oe.c(),oe.m(a,null)):oe&&(oe.d(1),oe=null),ee&96&&(he=N[5],J=Dn(J,ee,T,1,N,he,fe,U,Gn,ln,null,Rl))},i:Q,o:Q,d(N){N&&w(e),H&&H.d(),n[16](null),x&&x.d(),z&&z.d(),oe&&oe.d();for(let ee=0;ee<J.length;ee+=1)J[ee].d();te=!1,Qe(R)}}}function Ue(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Rt(n){return n.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}function ro(n,e){let t=!0;n.requirements.gold>e.townInfo.gold&&(t=!1);let l=e.townInfo.population_count-e.townInfo.employees;return n.requirements.employees!==void 0&&n.requirements.employees>0&&n.requirements.employees>l&&(t=!1),n.requirements.knowledge!==void 0&&n.requirements.knowledge>e.townInfo.knowledge_points&&(t=!1),t}function fo(n,e,t){let l,o;le(n,j,m=>t(6,l=m)),le(n,ie,m=>t(17,o=m));let{x:r=0}=e,{y:i=0}=e,f="",_=ae,{tooltip:u=""}=e,p,h;Ft(async()=>{await En(),p&&p.focus()});let g=[];function I(m){t(4,f=m.target.value),m.stopPropagation()}Ft(()=>{const m=document.querySelectorAll(".plotOption");l.plots[r][i].type!==-1&&l.plots[r][i].type>-1&&(m[l.plots[r][i].type].classList.add("active"),m[l.plots[r][i].type].scrollIntoView({behavior:"smooth",block:"center"}))});function v(m,L){let O={x:m,y:L};return O.x===0&&O.y===0?!0:[{x:O.x-1,y:O.y},{x:O.x+1,y:O.y},{x:O.x,y:O.y-1},{x:O.x,y:O.y+1}].some(X=>X.x<0||X.x>l.plots.length-1||X.y<0||X.y>l.plots.length-1?!1:l.plots[X.x][X.y].active)}function M(){V(ie,o.visible=!1,o)}function A(){document.querySelectorAll(".plotOption").forEach(L=>{L.classList.remove("active")}),B(r,i)}function C(m){document.querySelectorAll(".plotOption").forEach($=>{$.classList.remove("active")}),document.querySelector(`[data-plotoptionid="${m}"]`).classList.add("active"),q(r,i,m)}function P(m,L){let O=0;return m>0&&l.plots[m-1][L].type!==-1&&O++,m<l.plots.length-1&&l.plots[m+1][L].type!==-1&&O++,L>0&&l.plots[m][L-1].type!==-1&&O++,L<l.plots[0].length-1&&l.plots[m][L+1].type!==-1&&O++,O<=4}function q(m,L,O){let $=l;const X=ae.findIndex(U=>U.id===O);let S=ae[X],K=!0;if((S.requirements.gold>$.townInfo.gold||S.requirements.employees>$.townInfo.population_count-$.townInfo.employees)&&(K=!1),S.requirements.size!=null&&K){let U=S.requirements.size,J=[],fe=_[X].title.toLowerCase().indexOf("school")!=-1;for(let te=0;te<4;te++){let R=[[m,L]];te===0?(R.push([m-(U-1),L-(U-1)]),R.push([m-(U-1),L]),R.push([m,L-(U-1)])):te===1?(R.push([m,L-(U-1)]),R.push([m+(U-1),L-(U-1)]),R.push([m+(U-1),L])):te===2?(R.push([m-(U-1),L]),R.push([m-(U-1),L+(U-1)]),R.push([m,L+(U-1)])):te===3&&(R.push([m,L+(U-1)]),R.push([m+(U-1),L+(U-1)]),R.push([m+(U-1),L])),J.push(R)}J=J.filter(te=>te.every(R=>R[0]>=0&&R[0]<=$.plots.length-1&&R[1]>=0&&R[1]<=$.plots.length-1&&!$.plots[R[0]][R[1]].active&&v(R[0],R[1])==!0)),J.length===0?K=!1:J.length>0&&J[0].forEach(R=>{$.plots[R[0]][R[1]].active=!0,$.plots[R[0]][R[1]].type=fe?-3:-2,$.plots[R[0]][R[1]].referencePlot=[m,L]})}if(K===!0){switch($.plots[m][L].type!==-1&&B(m,L),t(0,u=""),$.plots[m][L].type=X,$.plots[m][L].active=!0,$.plots[m][L].referencePlot=[],$.townInfo.gold-=S.requirements.gold,$.townInfo.gold=Ue($.townInfo.gold,2),$.townInfo.population_count+=S.immediate_variable_changes.population,$.townInfo.population_max+=S.immediate_variable_changes.population,$.townInfo.happiness+=S.immediate_variable_changes.happiness,$.townInfo.health+=S.immediate_variable_changes.health,$.modifiers.happiness=Ue($.modifiers.happiness*S.effect_modifiers.happiness,2),$.modifiers.health=Ue($.modifiers.health*S.effect_modifiers.health,2),$.townInfo.employees+=S.requirements.employees,($.plotCounts[X]===void 0||$.plotCounts[X]===null)&&($.plotCounts[X]=0),$.plotCounts[X]++,$.lastChangeDay=$.environment.day,$.economyAndLaws.balance_sheet_history=[{day:$.environment.day,plot:`${m},${L}`,profits:S.requirements.gold*-1,balance:Ue($.townInfo.gold,2)},...$.economyAndLaws.balance_sheet_history],S.id){case"city-hall":$.hasCityHall=!0;break;case"bank":$.hasBank=!0;break}j.set($),localStorage.setItem(Ie,JSON.stringify($)),V(ie,o.visible=!1,o)}else t(0,u="You do not have enough resources to purchase this plot."),document.querySelectorAll(".plotOption").forEach(J=>{J.classList.remove("active")})}function B(m,L){let O=l,$=O.plots[m][L].type;O.plots[m][L].type=-1,O.plots[m][L].active=!1,$>-1&&(O.townInfo.population_count-=ae[$].immediate_variable_changes.population,O.townInfo.population_max-=ae[$].immediate_variable_changes.population,O.townInfo.happiness-=ae[$].immediate_variable_changes.happiness,O.townInfo.health-=ae[$].immediate_variable_changes.health,O.modifiers.happiness=Ue(O.modifiers.happiness/ae[$].effect_modifiers.happiness,2),O.modifiers.health=Ue(O.modifiers.health/ae[$].effect_modifiers.health,2),O.townInfo.employees-=ae[$].requirements.employees,(O.plotCounts[$]===void 0||O.plotCounts[$]===null)&&(O.plotCounts[$]=0),O.plotCounts[$]--),O.lastChangeDay=O.environment.day,j.set(O),localStorage.setItem(Ie,JSON.stringify(O))}function E(m){const L=m.target.closest(".plotOption");if(L){const O=L.dataset.plotoptionid;C(O)}}function a(m){Qt[m?"unshift":"push"](()=>{p=m,t(7,p)})}return n.$$set=m=>{"x"in m&&t(1,r=m.x),"y"in m&&t(2,i=m.y),"tooltip"in m&&t(0,u=m.tooltip)},n.$$.update=()=>{n.$$.dirty&64&&l&&t(5,g=_.map(m=>({...m,affordable:ro(m,l)}))),n.$$.dirty&48&&t(5,g=f?g.filter(m=>m.title.toLowerCase().includes(f.toLowerCase())):g),n.$$.dirty&32&&t(8,h=g.filter(m=>m.affordable==!0).length)},[u,r,i,P,f,g,l,p,h,I,M,A,E,v,q,B,a]}class uo extends Be{constructor(e){super(),Ee(this,e,fo,ao,Pe,{x:1,y:2,tooltip:0,checkIfPlotCanBeUpgraded:13,canBulldoze:3,purchasePlot:14,reverseClear:15})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[13]}get canBulldoze(){return this.$$.ctx[3]}get purchasePlot(){return this.$$.ctx[14]}get reverseClear(){return this.$$.ctx[15]}}function nn(n,e,t){const l=n.slice();return l[6]=e[t],l}function on(n,e,t){const l=n.slice();return l[9]=e[t],l}function sn(n){let e,t,l=n[3],o,r,i=n[2].plots,f=[];for(let p=0;p<i.length;p+=1)f[p]=rn(nn(n,i,p));const _=p=>W(f[p],1,1,()=>{f[p]=null});let u=un(n);return{c(){e=c("div");for(let p=0;p<f.length;p+=1)f[p].c();t=y(),u.c(),o=Ze(),d(e,"class","grid svelte-3cpxwu")},m(p,h){k(p,e,h);for(let g=0;g<f.length;g+=1)f[g].m(e,null);k(p,t,h),u.m(p,h),k(p,o,h),r=!0},p(p,h){if(h&7){i=p[2].plots;let g;for(g=0;g<i.length;g+=1){const I=nn(p,i,g);f[g]?(f[g].p(I,h),F(f[g],1)):(f[g]=rn(I),f[g].c(),F(f[g],1),f[g].m(e,null))}for(Ne(),g=i.length;g<f.length;g+=1)_(g);Te()}h&8&&Pe(l,l=p[3])?(Ne(),W(u,1,1,Q),Te(),u=un(p),u.c(),F(u,1),u.m(o.parentNode,o)):u.p(p,h)},i(p){if(!r){for(let h=0;h<i.length;h+=1)F(f[h]);F(u),r=!0}},o(p){f=f.filter(Boolean);for(let h=0;h<f.length;h+=1)W(f[h]);W(u),r=!1},d(p){p&&w(e),ll(f,p),p&&w(t),p&&w(o),u.d(p)}}}function an(n){let e,t;return e=new jn({props:{data:n[9],canBeUpgraded:n[0](n[9].x,n[9].y)}}),{c(){Oe(e.$$.fragment)},m(l,o){$e(e,l,o),t=!0},p(l,o){const r={};o&4&&(r.data=l[9]),o&4&&(r.canBeUpgraded=l[0](l[9].x,l[9].y)),e.$set(r)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function rn(n){let e,t,l,o,r,i=n[6],f=[];for(let u=0;u<i.length;u+=1)f[u]=an(on(n,i,u));const _=u=>W(f[u],1,1,()=>{f[u]=null});return{c(){e=c("div");for(let u=0;u<f.length;u+=1)f[u].c();t=y(),d(e,"class","row svelte-3cpxwu")},m(u,p){k(u,e,p);for(let h=0;h<f.length;h+=1)f[h].m(e,null);s(e,t),l=!0,o||(r=Z(e,"click",n[1]),o=!0)},p(u,p){if(p&5){i=u[6];let h;for(h=0;h<i.length;h+=1){const g=on(u,i,h);f[h]?(f[h].p(g,p),F(f[h],1)):(f[h]=an(g),f[h].c(),F(f[h],1),f[h].m(e,t))}for(Ne(),h=i.length;h<f.length;h+=1)_(h);Te()}},i(u){if(!l){for(let p=0;p<i.length;p+=1)F(f[p]);l=!0}},o(u){f=f.filter(Boolean);for(let p=0;p<f.length;p+=1)W(f[p]);l=!1},d(u){u&&w(e),ll(f,u),o=!1,r()}}}function fn(n){let e,t;return e=new uo({props:{x:n[4].x,y:n[4].y}}),{c(){Oe(e.$$.fragment)},m(l,o){$e(e,l,o),t=!0},p(l,o){const r={};o&16&&(r.x=l[4].x),o&16&&(r.y=l[4].y),e.$set(r)},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function un(n){let e,t,l=n[4].visible&&fn(n);return{c(){l&&l.c(),e=Ze()},m(o,r){l&&l.m(o,r),k(o,e,r),t=!0},p(o,r){o[4].visible?l?(l.p(o,r),r&16&&F(l,1)):(l=fn(o),l.c(),F(l,1),l.m(e.parentNode,e)):l&&(Ne(),W(l,1,1,()=>{l=null}),Te())},i(o){t||(F(l),t=!0)},o(o){W(l),t=!1},d(o){l&&l.d(o),o&&w(e)}}}function po(n){let e,t,l=n[2]!=null&&sn(n);return{c(){l&&l.c(),e=Ze()},m(o,r){l&&l.m(o,r),k(o,e,r),t=!0},p(o,[r]){o[2]!=null?l?(l.p(o,r),r&4&&F(l,1)):(l=sn(o),l.c(),F(l,1),l.m(e.parentNode,e)):l&&(Ne(),W(l,1,1,()=>{l=null}),Te())},i(o){t||(F(l),t=!0)},o(o){W(l),t=!1},d(o){l&&l.d(o),o&&w(e)}}}function co(n,e,t){let l,o,r;le(n,j,u=>t(2,l=u)),le(n,gt,u=>t(3,o=u)),le(n,ie,u=>t(4,r=u));function i(u,p){let h={x:u,y:p};return h.x===0&&h.y===0?!0:[{x:h.x-1,y:h.y},{x:h.x+1,y:h.y},{x:h.x,y:h.y-1},{x:h.x,y:h.y+1}].some(I=>I.x<0||I.x>=l.plots.length||I.y<0||I.y>=l.plots[I.x].length?!1:l.plots[I.x][I.y].active)}function f(){let u=[];for(let p=0;p<l.plots.length;p++)for(let h=0;h<l.plots.length;h++)i(p,h)&&l.plots[p][h].active==!1&&u.push(l.plots[p][h])}function _(){V(gt,o={},o)}return window.location.search.includes("dev=true")&&(V(j,l.townInfo.name="DevTown",l),V(j,l.townInfo.gold=1e8,l),V(j,l.townInfo.population=0,l),V(j,l.townInfo.happiness=1e5,l),V(j,l.townInfo.health=1e5,l),V(j,l.modifiers.happiness=1e5,l),V(j,l.modifiers.health=1e5,l),V(j,l.townInfo.knowledge_points=1e4,l)),n.$$.update=()=>{n.$$.dirty&4&&l&&f()},[i,_,l,o,r]}class _o extends Be{constructor(e){super(),Ee(this,e,co,po,Pe,{checkIfPlotCanBeUpgraded:0,restartModifyPlotMenu:1})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[0]}get restartModifyPlotMenu(){return this.$$.ctx[1]}}function pn(n,e,t){const l=n.slice();return l[4]=e[t],l}function mo(n){let e,t,l,o,r=n[0].economyAndLaws.balance_sheet_history,i=[];for(let f=0;f<r.length;f+=1)i[f]=cn(pn(n,r,f));return{c(){e=c("table"),t=c("thead"),t.innerHTML=`<tr class="svelte-1m5x2x2"><th>Day</th> 
						<th>Plot</th> 
						<th>Profits</th> 
						<th>Tax rate</th></tr>`,l=y(),o=c("tbody");for(let f=0;f<i.length;f+=1)i[f].c();d(e,"class","svelte-1m5x2x2")},m(f,_){k(f,e,_),s(e,t),s(e,l),s(e,o);for(let u=0;u<i.length;u+=1)i[u].m(o,null)},p(f,_){if(_&3){r=f[0].economyAndLaws.balance_sheet_history;let u;for(u=0;u<r.length;u+=1){const p=pn(f,r,u);i[u]?i[u].p(p,_):(i[u]=cn(p),i[u].c(),i[u].m(o,null))}for(;u<i.length;u+=1)i[u].d(1);i.length=r.length}},d(f){f&&w(e),ll(i,f)}}}function ho(n){let e;return{c(){e=c("div"),e.textContent=`No data to display yet. Build some buildings and make sure that the tax
				rate is above 0%.`,d(e,"class","text-center padding-sides")},m(t,l){k(t,e,l)},p:Q,d(t){t&&w(e)}}}function cn(n){let e,t,l=n[4].day+"",o,r,i,f=n[4].plot+"",_,u,p,h=n[4].profits+"",g,I,v,M=n[4].taxRate+"",A,C,P,q;function B(){return n[2](n[4])}return{c(){e=c("tr"),t=c("td"),o=b(l),r=y(),i=c("th"),_=b(f),u=y(),p=c("td"),g=b(h),I=y(),v=c("td"),A=b(M),C=y(),d(t,"class","svelte-1m5x2x2"),d(i,"class","plot_link svelte-1m5x2x2"),d(p,"class","svelte-1m5x2x2"),d(v,"class","svelte-1m5x2x2"),d(e,"class","svelte-1m5x2x2")},m(E,a){k(E,e,a),s(e,t),s(t,o),s(e,r),s(e,i),s(i,_),s(e,u),s(e,p),s(p,g),s(e,I),s(e,v),s(v,A),s(e,C),P||(q=Z(i,"click",B),P=!0)},p(E,a){n=E,a&1&&l!==(l=n[4].day+"")&&D(o,l),a&1&&f!==(f=n[4].plot+"")&&D(_,f),a&1&&h!==(h=n[4].profits+"")&&D(g,h),a&1&&M!==(M=n[4].taxRate+"")&&D(A,M)},d(E){E&&w(e),P=!1,q()}}}function go(n){let e,t,l,o,r,i;function f(p,h){return p[0].economyAndLaws.balance_sheet_history.length==0?ho:mo}let _=f(n),u=_(n);return{c(){e=c("div"),t=c("div"),l=c("div"),l.textContent="Balance Sheet",o=y(),r=c("br"),i=y(),u.c(),d(l,"class","heading_m svelte-1m5x2x2"),d(t,"class","dialog-content svelte-1m5x2x2"),d(e,"class","dialog svelte-1m5x2x2")},m(p,h){k(p,e,h),s(e,t),s(t,l),s(t,o),s(t,r),s(t,i),u.m(t,null)},p(p,[h]){_===(_=f(p))&&u?u.p(p,h):(u.d(1),u=_(p),u&&(u.c(),u.m(t,null)))},i:Q,o:Q,d(p){p&&w(e),u.d()}}}function vo(n,e,t){let l,o;le(n,ie,f=>t(3,l=f)),le(n,j,f=>t(0,o=f));function r(f){let _=parseInt(f.split(",")[0]),u=parseInt(f.split(",")[1]);V(ie,l.x=_,l),V(ie,l.y=u,l),V(ie,l.visible=!0,l)}return[o,r,f=>{r(f.plot)}]}class An extends Be{constructor(e){super(),Ee(this,e,vo,go,Pe,{})}}const bo={0:"Easy",1:"Normal",2:"Hard"};function dn(n){let e,t,l,o=n[3].short_title+"",r,i,f,_,u,p,h,g,I,v,M,A,C,P=n[0].endGoal=="land"&&_n(n);return{c(){e=c("div"),t=c("div"),l=b("HOW TO PLAY ("),r=b(o),i=b(`)
			`),f=c("br"),_=y(),u=c("hr"),p=y(),P&&P.c(),h=y(),g=c("br"),I=y(),v=c("hr"),M=y(),A=c("br"),C=b(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(q,B){k(q,e,B),s(e,t),s(t,l),s(t,r),s(t,i),s(t,f),s(t,_),s(t,u),s(t,p),P&&P.m(t,null),s(t,h),s(t,g),s(t,I),s(t,v),s(t,M),s(t,A),s(t,C)},p(q,B){q[0].endGoal=="land"?P?P.p(q,B):(P=_n(q),P.c(),P.m(t,h)):P&&(P.d(1),P=null)},d(q){q&&w(e),P&&P.d()}}}function _n(n){let e=n[3].description_title+"",t,l,o,r,i,f,_,u,p,h,g,I,v,M,A=JSON.stringify(n[3].requirements[n[0].difficulty].population_count)+"",C,P,q,B,E,a,m=JSON.stringify(n[3].requirements[n[0].difficulty].happiness)+"",L,O,$,X,S,K,U=JSON.stringify(n[3].requirements[n[0].difficulty].health)+"",J,fe,te,R,H,x,z=JSON.stringify(n[3].requirements[n[0].difficulty].employment*100)+"",oe,he;return{c(){t=b(e),l=y(),o=c("br"),r=y(),i=c("br"),f=b(`
				With your difficulty (`),_=b(n[4]),u=b(`), you must also have:
				`),p=c("br"),h=y(),g=c("br"),I=y(),v=c("li"),M=b("Population: "),C=b(A),P=y(),q=c("br"),B=y(),E=c("li"),a=b("Happiness: "),L=b(m),O=y(),$=c("br"),X=y(),S=c("li"),K=b("Health: "),J=b(U),fe=y(),te=c("br"),R=y(),H=c("li"),x=b("Employment at "),oe=b(z),he=b("%")},m(T,N){k(T,t,N),k(T,l,N),k(T,o,N),k(T,r,N),k(T,i,N),k(T,f,N),k(T,_,N),k(T,u,N),k(T,p,N),k(T,h,N),k(T,g,N),k(T,I,N),k(T,v,N),s(v,M),s(v,C),k(T,P,N),k(T,q,N),k(T,B,N),k(T,E,N),s(E,a),s(E,L),k(T,O,N),k(T,$,N),k(T,X,N),k(T,S,N),s(S,K),s(S,J),k(T,fe,N),k(T,te,N),k(T,R,N),k(T,H,N),s(H,x),s(H,oe),s(H,he)},p(T,N){N&1&&A!==(A=JSON.stringify(T[3].requirements[T[0].difficulty].population_count)+"")&&D(C,A),N&1&&m!==(m=JSON.stringify(T[3].requirements[T[0].difficulty].happiness)+"")&&D(L,m),N&1&&U!==(U=JSON.stringify(T[3].requirements[T[0].difficulty].health)+"")&&D(J,U),N&1&&z!==(z=JSON.stringify(T[3].requirements[T[0].difficulty].employment*100)+"")&&D(oe,z)},d(T){T&&w(t),T&&w(l),T&&w(o),T&&w(r),T&&w(i),T&&w(f),T&&w(_),T&&w(u),T&&w(p),T&&w(h),T&&w(g),T&&w(I),T&&w(v),T&&w(P),T&&w(q),T&&w(B),T&&w(E),T&&w(O),T&&w($),T&&w(X),T&&w(S),T&&w(fe),T&&w(te),T&&w(R),T&&w(H)}}}function yo(n){let e,t=n[2]&&n[0]!=null&&n[1]&&dn(n);return{c(){t&&t.c(),e=Ze()},m(l,o){t&&t.m(l,o),k(l,e,o)},p(l,[o]){l[2]&&l[0]!=null&&l[1]?t?t.p(l,o):(t=dn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Q,o:Q,d(l){t&&t.d(l),l&&w(e)}}}function wo(n,e,t){let l;le(n,j,u=>t(0,l=u));let o=!0;const i=mt[l.endGoal],f=bo[l.difficulty]||0;let _=!1;return n.$$.update=()=>{n.$$.dirty&1&&(l?t(2,_=!0):t(2,_=!1))},[l,o,_,i,f]}class ko extends Be{constructor(e){super(),Ee(this,e,wo,yo,Pe,{})}}function mn(n){let e,t=n[1].townLog+"",l,o,r;return{c(){e=c("div"),l=b(t),d(e,"class","townLog message")},m(i,f){k(i,e,f),s(e,l),o||(r=Z(e,"click",n[12]),o=!0)},p(i,f){f&2&&t!==(t=i[1].townLog+"")&&D(l,t)},d(i){i&&w(e),o=!1,r()}}}function hn(n){let e,t,l=n[1].townInfo.population_count-n[1].townInfo.employees+"",o,r;return{c(){e=c("span"),t=b("("),o=b(l),r=b(" unemployed)"),d(e,"class","text_ss gray")},m(i,f){k(i,e,f),s(e,t),s(e,o),s(e,r)},p(i,f){f&2&&l!==(l=i[1].townInfo.population_count-i[1].townInfo.employees+"")&&D(o,l)},d(i){i&&w(e)}}}function Io(n){let e,t,l=n[1].economyAndLaws.last_month_profit+"",o,r;return{c(){e=c("span"),t=b("("),o=b(l),r=b(")"),d(e,"class","text_s red")},m(i,f){k(i,e,f),s(e,t),s(e,o),s(e,r)},p(i,f){f&2&&l!==(l=i[1].economyAndLaws.last_month_profit+"")&&D(o,l)},d(i){i&&w(e)}}}function So(n){let e,t,l=n[1].economyAndLaws.last_month_profit+"",o,r;return{c(){e=c("span"),t=b("(+"),o=b(l),r=b(")"),d(e,"class","text_s green")},m(i,f){k(i,e,f),s(e,t),s(e,o),s(e,r)},p(i,f){f&2&&l!==(l=i[1].economyAndLaws.last_month_profit+"")&&D(o,l)},d(i){i&&w(e)}}}function Lo(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=c("span"),l=b(t),d(e,"class","red")},m(o,r){k(o,e,r),s(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.happiness+"")&&D(l,t)},d(o){o&&w(e)}}}function qo(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=c("span"),l=b(t),d(e,"class","green")},m(o,r){k(o,e,r),s(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.happiness+"")&&D(l,t)},d(o){o&&w(e)}}}function Po(n){let e;return{c(){e=c("span"),e.textContent="\u{1F44E}"},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Ao(n){let e;return{c(){e=c("span"),e.textContent="\u{1F44D}"},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function $o(n){let e;return{c(){e=c("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Mo(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=c("span"),l=b(t),d(e,"class","red")},m(o,r){k(o,e,r),s(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.health+"")&&D(l,t)},d(o){o&&w(e)}}}function Co(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=c("span"),l=b(t),d(e,"class","green")},m(o,r){k(o,e,r),s(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.health+"")&&D(l,t)},d(o){o&&w(e)}}}function gn(n){let e;return{c(){e=c("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Oo(n){let e;return{c(){e=b("How to play")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function No(n){let e;return{c(){e=b("Close")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function vn(n){let e,t;return e=new ko({}),{c(){Oe(e.$$.fragment)},m(l,o){$e(e,l,o),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function bn(n){let e,t;return e=new An({}),{c(){Oe(e.$$.fragment)},m(l,o){$e(e,l,o),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function To(n){let e,t,l,o=n[1].townInfo.name+"",r,i,f,_,u,p,h,g,I,v,M,A,C,P,q,B,E,a,m,L,O,$=n[1].townInfo.population_count+"",X,S,K=n[1].townInfo.population_max+"",U,J,fe,te,R,H,x=n[1].townInfo.employees+"",z,oe,he=n[1].townInfo.population_count+"",T,N,ee,ge,xe,re,ue,de,pe,ze=n[1].townInfo.knowledge_points+"",Ye,Se,Ge,je,Le,ne,ve=n[1].townInfo.gold+"",se,ol,il,sl,al,et,St,rl,vt,fl,Lt=n[1].townInfo.gold_from_tourism+"",Jt,ul,it,qt,pl,De,Ut,st,cl,Pt=He(n[1].modifiers.happiness,2)+"",Ht,dl,_l,ml,at,At,hl,Fe,jt,rt,gl,$t=He(n[1].modifiers.health,2)+"",Yt,vl,bl,yl,tt,lt,wl,kl,Il,Sl,Ve,Mt,Ll,Ce,ql,We,ft,Pl,ut,Ct=(n[1].economyAndLaws.tax_rate*100).toFixed(0)+"",Vt,Al,$l,pt,Wt,bt,yt,ce,Kt,Ml,be=n[1].townLog.length>0&&mn(n),ye=n[1].townInfo.population_count-n[1].townInfo.employees>0&&hn(n);function Cl(G,Y){if(G[1].economyAndLaws.last_month_profit>=0)return So;if(G[1].economyAndLaws.last_month_profit<0)return Io}let ct=Cl(n),we=ct&&ct(n);function Ol(G,Y){return G[1].townInfo.happiness>=50?qo:Lo}let Ot=Ol(n),Re=Ot(n);function Nl(G,Y){if(G[1].townInfo.happiness>=300)return $o;if(G[1].townInfo.happiness>=150)return Ao;if(G[1].townInfo.happiness<150)return Po}let dt=Nl(n),Ae=dt&&dt(n);function Tl(G,Y){return G[1].townInfo.health>=50?Co:Mo}let Nt=Tl(n),Je=Nt(n),qe=n[1].townInfo.health>=300&&gn();function El(G,Y){return G[5]?No:Oo}let Tt=El(n),Ke=Tt(n),_e=n[5]&&vn(),me=n[6]&&bn();return{c(){e=c("div"),t=c("div"),l=c("div"),r=b(o),i=y(),f=c("div"),f.textContent="double click to change name",_=y(),u=c("div"),p=c("span"),p.textContent="\u23EA",h=y(),g=c("span"),g.textContent="\u23E9",I=y(),v=b(n[0]),M=b("x - year "),A=b(n[2]),C=b(" day "),P=b(n[3]),q=y(),be&&be.c(),B=y(),E=c("div"),a=c("div"),m=c("div"),m.textContent="\u{1F46A} Population",L=y(),O=c("div"),X=b($),S=b("/"),U=b(K),J=y(),fe=c("div"),te=c("div"),te.textContent="\u{1F9D1}\u200D\u{1F33E} Employees",R=y(),H=c("div"),z=b(x),oe=b("/"),T=b(he),N=y(),ee=c("br"),ge=y(),ye&&ye.c(),xe=y(),re=c("div"),ue=c("div"),ue.textContent="\u{1F9E0} Knowledge",de=y(),pe=c("div"),Ye=b(ze),Se=y(),Ge=c("div"),je=c("div"),je.textContent="\u{1F4B0} Gold",Le=y(),ne=c("div"),se=b(ve),ol=y(),il=c("br"),sl=y(),we&&we.c(),al=y(),et=c("div"),St=c("div"),St.textContent="\u{1F4B0} Tourism Gold",rl=y(),vt=c("div"),fl=b("$"),Jt=b(Lt),ul=y(),it=c("div"),qt=c("div"),qt.textContent="\u{1F601} Happiness",pl=y(),De=c("div"),Re.c(),Ut=y(),st=c("span"),cl=b("("),Ht=b(Pt),dl=b(")"),_l=y(),Ae&&Ae.c(),ml=y(),at=c("div"),At=c("div"),At.textContent="\u{1F3E5} Health",hl=y(),Fe=c("div"),Je.c(),jt=y(),rt=c("span"),gl=b("("),Yt=b($t),vl=b(")"),bl=y(),qe&&qe.c(),yl=y(),tt=c("div"),lt=c("div"),wl=b("\u{1F3C6} "),Ke.c(),kl=y(),Il=c("br"),Sl=y(),Ve=c("div"),Mt=c("div"),Mt.textContent="Tax rate (more tax = less happiness)",Ll=y(),Ce=c("input"),ql=y(),We=c("div"),ft=c("button"),ft.textContent="-",Pl=y(),ut=c("div"),Vt=b(Ct),Al=b("%"),$l=y(),pt=c("button"),pt.textContent="+",Wt=y(),_e&&_e.c(),bt=y(),me&&me.c(),yt=Ze(),d(l,"class","heading_l"),d(f,"class","subheading_m svelte-vu26gz"),d(t,"class","header__left svelte-vu26gz"),d(m,"class","subheading_m svelte-vu26gz"),d(O,"class","text_m svelte-vu26gz"),d(a,"class","svelte-vu26gz"),d(te,"class","subheading_m svelte-vu26gz"),d(H,"class","text_m svelte-vu26gz"),d(fe,"class","svelte-vu26gz"),d(ue,"class","subheading_m svelte-vu26gz"),d(pe,"class","text_m svelte-vu26gz"),d(re,"class","svelte-vu26gz"),d(je,"class","subheading_m svelte-vu26gz"),d(ne,"class","text_m svelte-vu26gz"),d(Ge,"class","svelte-vu26gz"),d(St,"class","subheading_m svelte-vu26gz"),d(vt,"class","text_m svelte-vu26gz"),d(et,"class","svelte-vu26gz"),d(qt,"class","subheading_m svelte-vu26gz"),d(st,"class","text_ss gray"),d(De,"class","text_m svelte-vu26gz"),d(it,"class","svelte-vu26gz"),d(At,"class","subheading_m svelte-vu26gz"),d(rt,"class","text_ss gray"),d(Fe,"class","text_m svelte-vu26gz"),d(at,"class","svelte-vu26gz"),d(E,"class","header__right svelte-vu26gz"),d(lt,"class","text_m pointer"),d(Mt,"class","subheading_m svelte-vu26gz"),d(Ce,"type","range"),d(Ce,"min","0"),d(Ce,"max","1"),d(Ce,"step","0.01"),d(ut,"class","text_m"),d(We,"class","incrementalButtons svelte-vu26gz"),d(Ve,"class","taxInfo svelte-vu26gz"),d(e,"class","header noselect svelte-vu26gz")},m(G,Y){k(G,e,Y),s(e,t),s(t,l),s(l,r),s(t,i),s(t,f),s(t,_),s(t,u),s(u,p),s(u,h),s(u,g),s(u,I),s(u,v),s(u,M),s(u,A),s(u,C),s(u,P),s(t,q),be&&be.m(t,null),s(e,B),s(e,E),s(E,a),s(a,m),s(a,L),s(a,O),s(O,X),s(O,S),s(O,U),s(E,J),s(E,fe),s(fe,te),s(fe,R),s(fe,H),s(H,z),s(H,oe),s(H,T),s(H,N),s(H,ee),s(H,ge),ye&&ye.m(H,null),s(E,xe),s(E,re),s(re,ue),s(re,de),s(re,pe),s(pe,Ye),s(E,Se),s(E,Ge),s(Ge,je),s(Ge,Le),s(Ge,ne),s(ne,se),s(ne,ol),s(ne,il),s(ne,sl),we&&we.m(ne,null),s(E,al),s(E,et),s(et,St),s(et,rl),s(et,vt),s(vt,fl),s(vt,Jt),s(E,ul),s(E,it),s(it,qt),s(it,pl),s(it,De),Re.m(De,null),s(De,Ut),s(De,st),s(st,cl),s(st,Ht),s(st,dl),s(De,_l),Ae&&Ae.m(De,null),s(E,ml),s(E,at),s(at,At),s(at,hl),s(at,Fe),Je.m(Fe,null),s(Fe,jt),s(Fe,rt),s(rt,gl),s(rt,Yt),s(rt,vl),s(Fe,bl),qe&&qe.m(Fe,null),s(e,yl),s(e,tt),s(tt,lt),s(lt,wl),Ke.m(lt,null),s(tt,kl),s(tt,Il),s(tt,Sl),s(tt,Ve),s(Ve,Mt),s(Ve,Ll),s(Ve,Ce),Gl(Ce,n[1].economyAndLaws.tax_rate),s(Ve,ql),s(Ve,We),s(We,ft),s(We,Pl),s(We,ut),s(ut,Vt),s(ut,Al),s(We,$l),s(We,pt),k(G,Wt,Y),_e&&_e.m(G,Y),k(G,bt,Y),me&&me.m(G,Y),k(G,yt,Y),ce=!0,Kt||(Ml=[Z(l,"dblclick",n[7]),Z(p,"click",n[8]),Z(g,"click",n[9]),Z(Ge,"click",n[13]),Z(et,"click",n[14]),Z(lt,"click",n[15]),Z(Ce,"change",n[16]),Z(Ce,"input",n[16]),Z(Ce,"change",n[10]),Z(ft,"mousedown",n[17]),Z(ft,"mouseup",n[18]),Z(ft,"click",n[19]),Z(ut,"dblclick",n[20]),Z(pt,"mousedown",n[21]),Z(pt,"mouseup",n[22]),Z(pt,"click",n[23])],Kt=!0)},p(G,[Y]){(!ce||Y&2)&&o!==(o=G[1].townInfo.name+"")&&D(r,o),(!ce||Y&1)&&D(v,G[0]),(!ce||Y&4)&&D(A,G[2]),(!ce||Y&8)&&D(P,G[3]),G[1].townLog.length>0?be?be.p(G,Y):(be=mn(G),be.c(),be.m(t,null)):be&&(be.d(1),be=null),(!ce||Y&2)&&$!==($=G[1].townInfo.population_count+"")&&D(X,$),(!ce||Y&2)&&K!==(K=G[1].townInfo.population_max+"")&&D(U,K),(!ce||Y&2)&&x!==(x=G[1].townInfo.employees+"")&&D(z,x),(!ce||Y&2)&&he!==(he=G[1].townInfo.population_count+"")&&D(T,he),G[1].townInfo.population_count-G[1].townInfo.employees>0?ye?ye.p(G,Y):(ye=hn(G),ye.c(),ye.m(H,null)):ye&&(ye.d(1),ye=null),(!ce||Y&2)&&ze!==(ze=G[1].townInfo.knowledge_points+"")&&D(Ye,ze),(!ce||Y&2)&&ve!==(ve=G[1].townInfo.gold+"")&&D(se,ve),ct===(ct=Cl(G))&&we?we.p(G,Y):(we&&we.d(1),we=ct&&ct(G),we&&(we.c(),we.m(ne,null))),(!ce||Y&2)&&Lt!==(Lt=G[1].townInfo.gold_from_tourism+"")&&D(Jt,Lt),Ot===(Ot=Ol(G))&&Re?Re.p(G,Y):(Re.d(1),Re=Ot(G),Re&&(Re.c(),Re.m(De,Ut))),(!ce||Y&2)&&Pt!==(Pt=He(G[1].modifiers.happiness,2)+"")&&D(Ht,Pt),dt!==(dt=Nl(G))&&(Ae&&Ae.d(1),Ae=dt&&dt(G),Ae&&(Ae.c(),Ae.m(De,null))),Nt===(Nt=Tl(G))&&Je?Je.p(G,Y):(Je.d(1),Je=Nt(G),Je&&(Je.c(),Je.m(Fe,jt))),(!ce||Y&2)&&$t!==($t=He(G[1].modifiers.health,2)+"")&&D(Yt,$t),G[1].townInfo.health>=300?qe||(qe=gn(),qe.c(),qe.m(Fe,null)):qe&&(qe.d(1),qe=null),Tt!==(Tt=El(G))&&(Ke.d(1),Ke=Tt(G),Ke&&(Ke.c(),Ke.m(lt,null))),Y&2&&Gl(Ce,G[1].economyAndLaws.tax_rate),(!ce||Y&2)&&Ct!==(Ct=(G[1].economyAndLaws.tax_rate*100).toFixed(0)+"")&&D(Vt,Ct),G[5]?_e?Y&32&&F(_e,1):(_e=vn(),_e.c(),F(_e,1),_e.m(bt.parentNode,bt)):_e&&(Ne(),W(_e,1,1,()=>{_e=null}),Te()),G[6]?me?Y&64&&F(me,1):(me=bn(),me.c(),F(me,1),me.m(yt.parentNode,yt)):me&&(Ne(),W(me,1,1,()=>{me=null}),Te())},i(G){ce||(F(_e),F(me),ce=!0)},o(G){W(_e),W(me),ce=!1},d(G){G&&w(e),be&&be.d(),ye&&ye.d(),we&&we.d(),Re.d(),Ae&&Ae.d(),Je.d(),qe&&qe.d(),Ke.d(),G&&w(Wt),_e&&_e.d(G),G&&w(bt),me&&me.d(G),G&&w(yt),Kt=!1,Qe(Ml)}}}function He(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Eo(n,e,t){let l,o,r;le(n,j,S=>t(1,l=S)),le(n,Dt,S=>t(24,o=S)),le(n,zt,S=>t(6,r=S));let i=Math.floor(l.environment.day/365)+1,f=l.environment.day%365;function _(){let S=prompt("Enter a new name for your town (under 200 chars)");if(S&&S.length<200){let K=l;K.townInfo.name=S,j.set(K),localStorage.setItem(Ie,JSON.stringify(K))}}let{speedMultiplier:u=1}=e;function p(){let S=o;S=S*2,S>=8e3&&(S=8e3),V(Dt,o=S,o),t(0,u=2e3/o)}function h(){let S=o;S=S/2,S<=250&&(S=250),V(Dt,o=S,o),t(0,u=2e3/o)}function g(S){let K=l;K.economyAndLaws.tax_rate=He(S.target.value,2),j.set(K),localStorage.setItem(Ie,JSON.stringify(K))}function I(){let S=l;S.hasABank===!0?(S.townInfo.gold+=S.townInfo.gold_from_tourism,S.townInfo.gold_from_tourism=0,j.set(S),localStorage.setItem(Ie,JSON.stringify(S))):alert("You need a bank to transfer funds from tourism activities.")}document.addEventListener("keydown",S=>{switch(S.key.toLowerCase()){case"1":S.preventDefault(),p();break;case"2":S.preventDefault(),h();break}});let v,M=!1;const A=()=>{V(j,l.townLog="",l)},C=()=>{let S=r;S=!S,zt.set(S)},P=()=>{I()},q=()=>t(5,M=!M);function B(){l.economyAndLaws.tax_rate=On(this.value),j.set(l)}const E=()=>{t(4,v=setInterval(()=>{let S=l;S.economyAndLaws.tax_rate=He(S.economyAndLaws.tax_rate-.01,2),j.set(S),localStorage.setItem(Ie,JSON.stringify(S))},100))},a=()=>{clearInterval(v)},m=()=>{let S=l;S.economyAndLaws.tax_rate=He(S.economyAndLaws.tax_rate-.01,2)},L=()=>{let S=parseFloat(prompt("Set a new tax rate (0-1)"));if(S&&S>=0&&S<=1){let K=l;K.economyAndLaws.tax_rate=He(S,2),j.set(K),localStorage.setItem(Ie,JSON.stringify(K))}},O=()=>{t(4,v=setInterval(()=>{let S=l;S.economyAndLaws.tax_rate=He(S.economyAndLaws.tax_rate+.01,2),j.set(S),localStorage.setItem(Ie,JSON.stringify(S))},100))},$=()=>{clearInterval(v)},X=()=>{let S=l;S.economyAndLaws.tax_rate=He(S.economyAndLaws.tax_rate+.01,2),j.set(S),localStorage.setItem(Ie,JSON.stringify(S))};return n.$$set=S=>{"speedMultiplier"in S&&t(0,u=S.speedMultiplier)},n.$$.update=()=>{n.$$.dirty&2&&(t(2,i=Math.floor(l.environment.day/365)+1),t(3,f=l.environment.day%365))},[u,l,i,f,v,M,r,_,p,h,g,I,A,C,P,q,B,E,a,m,L,O,$,X]}class Bo extends Be{constructor(e){super(),Ee(this,e,Eo,To,Pe,{speedMultiplier:0})}}function Go(n){let e,t,l,o,r,i,f,_,u,p,h,g,I,v,M,A,C,P,q;return{c(){e=c("div"),t=c("div"),l=b(`The game is paused!
		`),o=c("br"),r=b(`
		Load file:
		`),i=c("input"),f=y(),_=c("br"),u=b(`
		Backup save:
		`),p=c("button"),p.textContent="Save",h=y(),g=c("br"),I=b(`
		Unpause the game by pressing P
		`),v=c("br"),M=y(),A=c("br"),C=b(`
		Reset the game by pressing SHIFT+ESC`),d(i,"type","file"),d(i,"id","upload"),d(p,"id","save"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(B,E){k(B,e,E),s(e,t),s(t,l),s(t,o),s(t,r),s(t,i),s(t,f),s(t,_),s(t,u),s(t,p),s(t,h),s(t,g),s(t,I),s(t,v),s(t,M),s(t,A),s(t,C),P||(q=[Z(i,"change",n[1]),Z(p,"click",n[0])],P=!0)},p:Q,i:Q,o:Q,d(B){B&&w(e),P=!1,Qe(q)}}}function Do(n){const e=JSON.parse(n);return e.townInfo!=null&&e.difficulty!=null}function Fo(n,e,t){let l;le(n,j,i=>t(2,l=i));function o(){const i=JSON.stringify(l),f=new Blob([i],{type:"text/plain"}),_=URL.createObjectURL(f),u=document.createElement("a");u.href=_,u.download=`${new Date().toISOString()}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(_)}function r(){const f=document.getElementById("upload").files[0],_=new FileReader;_.onload=function(u){const p=u.target.result;if(typeof p=="string"){if(!Do(p)){alert("Invalid game file");return}nl(JSON.parse(p))}else alert("Invalid game file: is not String.")},_.readAsText(f)}return[o,r]}class Ro extends Be{constructor(e){super(),Ee(this,e,Fo,Go,Pe,{})}}function yn(n){let e,t,l,o,r,i=n[0].endGameDetails.msg+"",f,_,u,p,h,g;return{c(){e=c("div"),t=c("div"),l=b(`GAME OVER
			`),o=c("br"),r=y(),f=b(i),_=y(),u=c("br"),p=y(),h=c("br"),g=b(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(I,v){k(I,e,v),s(e,t),s(t,l),s(t,o),s(t,r),s(t,f),s(t,_),s(t,u),s(t,p),s(t,h),s(t,g)},p(I,v){v&1&&i!==(i=I[0].endGameDetails.msg+"")&&D(f,i)},d(I){I&&w(e)}}}function Jo(n){let e,t=n[0].endGameDetails!=null&&yn(n);return{c(){t&&t.c(),e=Ze()},m(l,o){t&&t.m(l,o),k(l,e,o)},p(l,[o]){l[0].endGameDetails!=null?t?t.p(l,o):(t=yn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Q,o:Q,d(l){t&&t.d(l),l&&w(e)}}}function Uo(n,e,t){let l;return le(n,j,o=>t(0,l=o)),[l]}class Ho extends Be{constructor(e){super(),Ee(this,e,Uo,Jo,Pe,{})}}function jo(n){let e,t,l,o,r,i,f,_,u,p,h,g,I,v,M,A,C,P,q,B,E;return{c(){e=c("div"),t=c("div"),l=b(`Welcome to Plots!
		`),o=c("br"),r=b(`
		Select a difficulty
		`),i=c("select"),f=c("option"),f.textContent="Easy (quick game)",_=c("option"),_.textContent="Normal (longer game)",u=c("option"),u.textContent="Hard (longest game)",p=y(),h=c("br"),g=b(`
		Select a goal
		`),I=c("select"),v=c("option"),v.textContent="Fill up the grid",M=c("option"),M.textContent="Rule the world through politics",A=y(),C=c("br"),P=y(),q=c("button"),q.textContent="Start game",f.__value="0",f.value=f.__value,_.__value="1",_.value=_.__value,_.selected=!0,u.__value="2",u.value=u.__value,d(i,"id","difficulty"),v.__value="land",v.value=v.__value,v.selected=!0,M.__value="political",M.value=M.__value,d(I,"id","endGoal"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(a,m){k(a,e,m),s(e,t),s(t,l),s(t,o),s(t,r),s(t,i),s(i,f),s(i,_),s(i,u),s(t,p),s(t,h),s(t,g),s(t,I),s(I,v),s(I,M),s(t,A),s(t,C),s(t,P),s(t,q),B||(E=Z(q,"click",n[0]),B=!0)},p:Q,i:Q,o:Q,d(a){a&&w(e),B=!1,E()}}}function Yo(n){function e(){const t=document.getElementById("difficulty").value,l=document.getElementById("endGoal").value;Jn(t,l)}return[e]}class Vo extends Be{constructor(e){super(),Ee(this,e,Yo,jo,Pe,{})}}function wn(n){let e,t,l,o;const r=[Ko,Wo],i=[];function f(_,u){return _[0]==null?0:1}return e=f(n),t=i[e]=r[e](n),{c(){t.c(),l=Ze()},m(_,u){i[e].m(_,u),k(_,l,u),o=!0},p(_,u){let p=e;e=f(_),e===p?i[e].p(_,u):(Ne(),W(i[p],1,1,()=>{i[p]=null}),Te(),t=i[e],t?t.p(_,u):(t=i[e]=r[e](_),t.c()),F(t,1),t.m(l.parentNode,l))},i(_){o||(F(t),o=!0)},o(_){W(t),o=!1},d(_){i[e].d(_),_&&w(l)}}}function Wo(n){let e,t,l,o,r,i,f,_,u,p,h,g,I,v,M,A,C=n[2]==!0&&kn(),P=n[3]==!0&&In();return l=new Bo({}),r=new Qn({}),f=new Ho({}),p=new _o({}),{c(){C&&C.c(),e=y(),P&&P.c(),t=y(),Oe(l.$$.fragment),o=y(),Oe(r.$$.fragment),i=y(),Oe(f.$$.fragment),_=y(),u=c("div"),Oe(p.$$.fragment),h=y(),g=c("br"),I=b(`
			outside of city`),v=y(),M=c("style"),M.textContent=`.plot_grid {
				max-width: 300%;
				max-height: 300%;
				overflow-x: scroll;
				overflow-y: scroll;
				width: 300%;
				height: 300vh;
				margin-top: 175px;
			}
			.plot_grid[data-marginRight='true'] {
				/* This is for when the balanceSheet is being shown. */
				margin-right: 224px;
			}`,d(u,"class","plot_grid"),d(u,"data-marginright",n[3])},m(q,B){C&&C.m(q,B),k(q,e,B),P&&P.m(q,B),k(q,t,B),$e(l,q,B),k(q,o,B),$e(r,q,B),k(q,i,B),$e(f,q,B),k(q,_,B),k(q,u,B),$e(p,u,null),s(u,h),s(u,g),s(u,I),k(q,v,B),k(q,M,B),A=!0},p(q,B){q[2]==!0?C?B&4&&F(C,1):(C=kn(),C.c(),F(C,1),C.m(e.parentNode,e)):C&&(Ne(),W(C,1,1,()=>{C=null}),Te()),q[3]==!0?P?B&8&&F(P,1):(P=In(),P.c(),F(P,1),P.m(t.parentNode,t)):P&&(Ne(),W(P,1,1,()=>{P=null}),Te()),(!A||B&8)&&d(u,"data-marginright",q[3])},i(q){A||(F(C),F(P),F(l.$$.fragment,q),F(r.$$.fragment,q),F(f.$$.fragment,q),F(p.$$.fragment,q),A=!0)},o(q){W(C),W(P),W(l.$$.fragment,q),W(r.$$.fragment,q),W(f.$$.fragment,q),W(p.$$.fragment,q),A=!1},d(q){C&&C.d(q),q&&w(e),P&&P.d(q),q&&w(t),Me(l,q),q&&w(o),Me(r,q),q&&w(i),Me(f,q),q&&w(_),q&&w(u),Me(p),q&&w(v),q&&w(M)}}}function Ko(n){let e,t;return e=new Vo({}),{c(){Oe(e.$$.fragment)},m(l,o){$e(e,l,o),t=!0},p:Q,i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function kn(n){let e,t;return e=new Ro({}),{c(){Oe(e.$$.fragment)},m(l,o){$e(e,l,o),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function In(n){let e,t;return e=new An({}),{c(){Oe(e.$$.fragment)},m(l,o){$e(e,l,o),t=!0},i(l){t||(F(e.$$.fragment,l),t=!0)},o(l){W(e.$$.fragment,l),t=!1},d(l){Me(e,l)}}}function Xo(n){let e,t,l=(n[1]||n[0]==null)&&wn(n);return{c(){l&&l.c(),e=Ze()},m(o,r){l&&l.m(o,r),k(o,e,r),t=!0},p(o,[r]){o[1]||o[0]==null?l?(l.p(o,r),r&3&&F(l,1)):(l=wn(o),l.c(),F(l,1),l.m(e.parentNode,e)):l&&(Ne(),W(l,1,1,()=>{l=null}),Te())},i(o){t||(F(l),t=!0)},o(o){W(l),t=!1},d(o){l&&l.d(o),o&&w(e)}}}function Qo(n,e,t){let l,o,r,i,f;le(n,gt,g=>t(6,l=g)),le(n,ie,g=>t(7,o=g)),le(n,ht,g=>t(2,r=g)),le(n,j,g=>t(0,i=g)),le(n,zt,g=>t(3,f=g));let _=!1,u=!1;document.addEventListener("keydown",g=>{if((document.activeElement!=null&&document.activeElement.nodeName==="INPUT"||document.activeElement!=null&&document.activeElement.nodeName=="TEXTAREA")&&g.key!=="Escape")return;switch(g.key.toLowerCase()){case"p":r==!0?ht.set(!1):(ht.set(!0),V(ie,o.visible=!1,o));break;case"escape":g.shiftKey?(V(ht,r=!0,r),localStorage.setItem("reset","true"),location.reload(),nl()):o.visible==!0&&V(ie,o.visible=!1,o);break;case"arrowleft":case"a":g.preventDefault(),p(0,-1,"up");break;case"arrowright":case"d":g.preventDefault(),p(0,1,"down");break;case"arrowup":case"w":g.preventDefault(),p(-1,0,"left");break;case"arrowdown":case"s":g.preventDefault(),p(1,0,"right");break}});function p(g,I,v){if(o.visible===!1&&o.x===0&&o.y===0)h(0,0,v);else{let M=o.x,A=o.y;M+g<0?M=0:M+g>i.plots.length?M=i.plots.length:M+=g,A+I<0?A=0:A+I>i.plots.length?A=i.plots.length:A+=I,h(M,A,v)}}function h(g,I,v){if(u==!0)switch(v){case"up":I-=2;break;case"down":I+=1;break;case"left":g-=2;break;case"right":g+=1;break}g<0?g=0:g>i.plots.length&&(g=i.plots.length),I<0?I=0:I>i.plots.length&&(I=i.plots.length);let M=document.querySelectorAll(".plot_container"),A;if(M.forEach(C=>{C.dataset.x=="$x"&&C.dataset.y=="$y"&&(A=C)}),r==!1){if(A.dataset.canBeUpgraded==="true"?V(ie,o.visible=!0,o):V(ie,o.visible=!1,o),A.dataset.refPlotX!==void 0&&A.dataset.refPlotY!=""?(u=!0,M.forEach(C=>{C.dataset.x==A.dataset.refPlotX&&C.dataset.y==A.dataset.refPlotY&&(A=C,g=parseInt(A.dataset.x),I=parseInt(A.dataset.y))})):u=!1,A.dataset.size!=="1"&&A.dataset.size!==void 0&&(u=!0),V(ie,o.x=g,o),V(ie,o.y=I,o),M.forEach(C=>{C.classList.remove("selected"),C.style.border="none",C.style.fontWeight=""}),A.classList.add("selected"),u){let C="4px solid #00800045";A.classList.remove("selected"),A.style.borderTop=C,A.style.borderLeft=C,A.style.fontWeight="600",M.forEach(P=>{const q=parseInt(`${P.dataset.x}`),B=parseInt(`${P.dataset.y}`);q==g+1&&B==I&&(P.style.borderLeft=C,P.style.borderBottom=C),q==g&&B==I+1&&(P.style.borderTop=C,P.style.borderRight=C),q==g+1&&B==I+1&&(P.style.borderBottom=C,P.style.borderRight=C)})}A.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),V(gt,l={},l)}}return n.$$.update=()=>{n.$$.dirty&1&&(i?t(1,_=!0):t(1,_=!1))},[i,_,r,f,h]}class Zo extends Be{constructor(e){super(),Ee(this,e,Qo,Xo,Pe,{openPlotMenu:4})}get openPlotMenu(){return this.$$.ctx[4]}}new Zo({target:document.getElementById("app")});
