(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerpolicy&&(r.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?r.credentials="include":o.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();function Z(){}function Pn(n){return n()}function Al(){return Object.create(null)}function Ze(n){n.forEach(Pn)}function On(n){return typeof n=="function"}function Me(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function Nn(n){return Object.keys(n).length===0}function Ln(n,...e){if(n==null)return Z;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function ee(n,e,t){n.$$.on_destroy.push(Ln(e,t))}function Y(n,e,t){return n.set(t),e}function a(n,e){n.appendChild(e)}function I(n,e,t){n.insertBefore(e,t||null)}function w(n){n.parentNode.removeChild(n)}function ll(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function c(n){return document.createElement(n)}function v(n){return document.createTextNode(n)}function y(){return v(" ")}function xe(){return v("")}function x(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function d(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function Tn(n){return n===""?null:+n}function Bn(n){return Array.from(n.childNodes)}function F(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function Gl(n,e){n.value=e==null?"":e}let It;function kt(n){It=n}function En(){if(!It)throw new Error("Function called outside component initialization");return It}function Dt(n){En().$$.on_mount.push(n)}const wt=[],Qt=[],At=[],Hl=[],qn=Promise.resolve();let Zt=!1;function Mn(){Zt||(Zt=!0,qn.then(Cn))}function An(){return Mn(),qn}function xt(n){At.push(n)}const Xt=new Set;let Et=0;function Cn(){const n=It;do{for(;Et<wt.length;){const e=wt[Et];Et++,kt(e),Gn(e.$$)}for(kt(null),wt.length=0,Et=0;Qt.length;)Qt.pop()();for(let e=0;e<At.length;e+=1){const t=At[e];Xt.has(t)||(Xt.add(t),t())}At.length=0}while(wt.length);for(;Hl.length;)Hl.pop()();Zt=!1,Xt.clear(),kt(n)}function Gn(n){if(n.fragment!==null){n.update(),Ze(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(xt)}}const Gt=new Set;let ot;function Be(){ot={r:0,c:[],p:ot}}function Ee(){ot.r||Ze(ot.c),ot=ot.p}function U(n,e){n&&n.i&&(Gt.delete(n),n.i(e))}function V(n,e,t,l){if(n&&n.o){if(Gt.has(n))return;Gt.add(n),ot.c.push(()=>{Gt.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function Hn(n,e){n.d(1),e.delete(n.key)}function Dn(n,e,t,l,o,r,i,f,_,u,p,m){let h=n.length,k=r.length,b=h;const C={};for(;b--;)C[n[b].key]=b;const O=[],N=new Map,q=new Map;for(b=k;b--;){const s=m(o,r,b),$=t(s);let g=i.get($);g?l&&g.p(s,e):(g=u($,s),g.c()),N.set($,O[b]=g),$ in C&&q.set($,Math.abs(b-C[$]))}const M=new Set,H=new Set;function E(s){U(s,1),s.m(f,p),i.set(s.key,s),p=s.first,k--}for(;h&&k;){const s=O[k-1],$=n[h-1],g=s.key,L=$.key;s===$?(p=s.first,h--,k--):N.has(L)?!i.has(g)||M.has(g)?E(s):H.has(L)?h--:q.get(g)>q.get(L)?(H.add(g),E(s)):(M.add(L),h--):(_($,i),h--)}for(;h--;){const s=n[h];N.has(s.key)||_(s,i)}for(;k;)E(O[k-1]);return O}function Te(n){n&&n.c()}function Oe(n,e,t,l){const{fragment:o,on_mount:r,on_destroy:i,after_update:f}=n.$$;o&&o.m(e,t),l||xt(()=>{const _=r.map(Pn).filter(On);i?i.push(..._):Ze(_),n.$$.on_mount=[]}),f.forEach(xt)}function Ne(n,e){const t=n.$$;t.fragment!==null&&(Ze(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Fn(n,e){n.$$.dirty[0]===-1&&(wt.push(n),Mn(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Ae(n,e,t,l,o,r,i,f=[-1]){const _=It;kt(n);const u=n.$$={fragment:null,ctx:null,props:r,update:Z,not_equal:o,bound:Al(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(_?_.$$.context:[])),callbacks:Al(),dirty:f,skip_bound:!1,root:e.target||_.$$.root};i&&i(u.root);let p=!1;if(u.ctx=t?t(n,e.props||{},(m,h,...k)=>{const b=k.length?k[0]:h;return u.ctx&&o(u.ctx[m],u.ctx[m]=b)&&(!u.skip_bound&&u.bound[m]&&u.bound[m](b),p&&Fn(n,m)),h}):[],u.update(),p=!0,Ze(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const m=Bn(e.target);u.fragment&&u.fragment.l(m),m.forEach(w)}else u.fragment&&u.fragment.c();e.intro&&U(n.$$.fragment),Oe(n,e.target,e.anchor,e.customElement),Cn()}kt(_)}class Ge{$destroy(){Ne(this,1),this.$destroy=Z}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const o=l.indexOf(t);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!Nn(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const mt=[];function it(n,e=Z){let t;const l=new Set;function o(f){if(Me(n,f)&&(n=f,t)){const _=!mt.length;for(const u of l)u[1](),mt.push(u,n);if(_){for(let u=0;u<mt.length;u+=2)mt[u][0](mt[u+1]);mt.length=0}}}function r(f){o(f(n))}function i(f,_=Z){const u=[f,_];return l.add(u),l.size===1&&(t=e(o)||Z),f(n),()=>{l.delete(u),l.size===0&&(t(),t=null)}}return{set:o,update:r,subscribe:i}}const Rn={plots:[],lastChangeDay:0,townLog:"",townInfo:{name:"Your town",gold:1e3,gold_from_tourism:0,population_count:0,population_max:0,employees:0,happiness:100,health:100,knowledge_points:0},hasCityHall:!1,hasBank:!1,modifiers:{happiness:1,health:1},economy_and_laws:{tax_rate:0,max_tax_rate:1,balanceSheetHistory:[],lastMonthProfit:0},plotCounts:[],environment:{day:0,year:1,climate:-1},difficulty:0,endGoal:"land",endGameDetails:null},Ie="plots_db_v2";let j=it(JSON.parse(localStorage.getItem(Ie))||null);function Jn(n,e){let t={...Rn};t.economy_and_laws.max_tax_rate=Math.random()*(.5-.2)+.2,t.endGoal=e;let l=[];const o=n=="0"?6:n=="1"?Math.floor(Math.random()*4)+7:n=="2"?Math.floor(Math.random()*9)+12:35;for(let r=0;r<o;r++){l.push([]);for(let i=0;i<o;i++)l[r][i]={id:Math.random().toString(36).substring(2,9),active:!1,x:r,y:i,type:-1}}t.plots=l,localStorage.reset=!1,localStorage.setItem(Ie,JSON.stringify(t)),j.set(t),location.reload()}function nl(n){localStorage.removeItem(Ie),j.set(null),n&&(localStorage.setItem(Ie,JSON.stringify(n)),j.set(n)),location.reload()}let oe=it({visible:!1,x:0,y:0}),gt=it({}),ht=it(!1),zt=it(!1),Ht=it(2e3);it(localStorage.getItem("showUnaffordablePlotOptions")==="true");const se=[{id:"res_small",title:"\u{1F3E0} Residential (small)",subtitle:"for living",type:"residential",description:"A few basic homes that can hold 16 people.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:16},styling:"background-color: #e15f00"},{id:"res_medium",title:"\u{1F3D8}\uFE0F Residential (medium)",subtitle:"for living",type:"residential",description:"A few high-density buildings that can hold 64 people.",revenue_per_week:0,requirements:{gold:500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:64},styling:"background-color: #e15f00"},{id:"res_large",title:"\u{1F3E2} Residential (large)",subtitle:"for living",type:"residential",description:"Many high-density buildings that can hold 256 people.",revenue_per_week:0,requirements:{gold:1500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:256},styling:"background-color: #e15f00"},{id:"cafe",title:"\u2615\uFE0F Small caf\xE9",subtitle:"for recreation & food",type:"food",description:"Great for eating & relaxing, not great for long-term health.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:16,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:.95},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #d24646;"},{id:"carrot_farm",title:"\u{1F955} Carrot farm",subtitle:"for farming",type:"farm",description:"Farm for making carrots, makes money by selling them.",revenue_per_week:6,requirements:{gold:25,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"apple_orchard",title:"\u{1F34E} Apple orchard",subtitle:"for farming",type:"farm",description:"A bunch of trees that make apples, makes money by selling them and by selling apple-related products.",revenue_per_week:8,requirements:{gold:50,plots:[],employees:4,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"bakery",title:"\u{1F956} Bakery",subtitle:"for baking",type:"farm",description:"Makes money by selling bread.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:3,climate:null,knowledge:0},effect_modifiers:{happiness:1.11,health:.92},immediate_variable_changes:{happiness:25,health:0,population:0},styling:"background-color: #008000;"},{id:"grocery",title:"\u{1F3EA} Grocery store",subtitle:"for living",type:"food",description:"People get hungry. This is where they go to get food.",revenue_per_week:40,requirements:{gold:320,plots:[],employees:24,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"fishery",title:"\u{1F420} Fishery",subtitle:"for fishing",type:"food",description:"Carve out some land, pour some water, and fish for fun & food.",revenue_per_week:25,requirements:{gold:400,plots:[],employees:9,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"library",title:"\u{1F4D5} Library",subtitle:"for reading",type:"recreation",description:"Reading makes people very happy, but doesn't make money.",revenue_per_week:0,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:1},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #4169e1;"},{id:"pub",title:"\u{1F37B} Pub",subtitle:"for hanging",type:"recreation",description:"Makes money, and somehow generates communal knowledge.",revenue_per_week:50,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:.7},immediate_variable_changes:{happiness:10,health:-25,population:0},styling:"background-color: #4169e1;"},{id:"church",title:"\u26EA\uFE0F Church",subtitle:"for worship & community",type:"recreation",description:"This can make some people happy, but doesn't make money.",revenue_per_week:0,requirements:{gold:100,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"stables",title:"\u{1F434} Stables",subtitle:"for friends",type:"recreation",description:"People love horses. This makes them happy, and can generate some money through lessons.",revenue_per_week:10,requirements:{gold:220,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"blacksmith",title:"\u2694\uFE0F Blacksmith",subtitle:"for making shiny things",type:"shop",description:"Sometimes problems can only be dealt with by a hunk of metal. Makes money by selling weapons, tools, & armor.",revenue_per_week:50,requirements:{gold:1300,plots:[],employees:13,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1.5},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"inn",title:"\u{1F6CC} Village Inn",subtitle:"for a night out",type:"tourism",description:"Generates tourism gold that can be used if you have a bank.",revenue_per_week:0,enables_tourism:!0,tourism_revenue_per_week:15,requirements:{gold:1500,plots:[],employees:14,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"park_small",title:"\u{1F332} Small park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"A few benches and a small grassy area.",revenue_per_week:0,requirements:{gold:80,plots:[],employees:1,climate:null,knowledge:0},effect_modifiers:{happiness:1.01,health:1.07},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_medium",title:"\u{1F6DD} Medium park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Benches, grass, and a couple of swing-sets.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.02,health:1.15},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_large",title:"\u{1F3AA} Large park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Same as the medium park, with a nice fountain in the middle and occasional events run by the employees.",revenue_per_week:0,requirements:{gold:300,plots:[],employees:4,climate:null,size:2,knowledge:0},effect_modifiers:{happiness:1.09,health:1.25},immediate_variable_changes:{happiness:30,health:0,population:0},styling:"background-color: #ffff00;"},{id:"school_small",title:"\u{1F4DA} Small school",subtitle:"for learning",type:"education",description:"A place where children can learn and grow, and where adults can learn new skills. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:2,requirements:{gold:850,plots:[],employees:20,climate:null,size:1,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:15,health:3,population:0},styling:"background-color: #4caf50;"},{id:"school_large",title:"\u{1F68C} Large school",subtitle:"for learning",type:"education",description:"A larger school. Produces knowledge",revenue_per_week:0,knowledge_points_per_month:8,requirements:{gold:1300,plots:[],employees:40,climate:null,size:2,knowledge:10},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:5,health:3,population:0},styling:"background-color: #4caf50;"},{id:"university",title:"\u{1F3EB} University",subtitle:"for learning",type:"education",description:"The supreme learning institution. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:25,requirements:{gold:3500,plots:[],employees:64,climate:null,size:2,knowledge:100},effect_modifiers:{happiness:1.25,health:1},immediate_variable_changes:{happiness:25,health:25,population:0},styling:"background-color: #4caf50;"},{id:"small_hospital",title:"\u{1F691} Small hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from minor injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:800,plots:[],employees:8,climate:null,size:1,knowledge:50},effect_modifiers:{happiness:1.25,health:1.5},immediate_variable_changes:{happiness:5,health:50,population:0},styling:"background-color: #ff0000;"},{id:"large_hospital",title:"\u{1F3E5} Large hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from all injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:4e3,plots:[],employees:64,climate:null,size:1,knowledge:200},effect_modifiers:{happiness:1.25,health:2.5},immediate_variable_changes:{happiness:5,health:75,population:0},styling:"background-color: #ff0000;"},{id:"bank",title:"\u{1F3E6} Bank",subtitle:"for storing and accessing funds",type:"bank",description:"Rich get richer.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:64,climate:null,size:1,knowledge:300},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"},{id:"city-hall",title:"\u{1F5F3}\uFE0F City Hall",subtitle:"for bureaucracy",type:"federal",description:"For running the government.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:24,climate:null,size:1,knowledge:500},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"}],ke={unemployment_num:" people can't find jobs.",bored:"People are bored. Try making some new buildings.",vairety:"People don't like going to the same places over and over again. Try making some new buildings.",nobody_home:"Nobody can live here. Build some residential buildings.",leave_town_num:" people left town because they were unhappy.",new_people_num:" new people moved to town.",people_want_to_move_in:"People want to move in. Build more homes.",high_tax_rate:"People are unhappy with the high tax rate.",very_high_tax_rate:"People are extremely unhappy with the high tax rate.",sickAndDying:"People are sick and dying.",sickAndLeaving:"People are sick and leaving town.",happiness_zero:"The town has fallen into chaos due to extreme unhappiness.",health_zero:"The town has fallen into chaos due to extreme sickness.",population_zero:"The town has been condemned due to lack of population.",win:{land:"You have filled the grid with buildings. You win!"}};function Dl(n){let e,t,l=se[n[0].type].title+"",o,r;return{c(){e=c("div"),t=c("span"),o=v(l),d(t,"data-size",r=se[n[0].type].requirements.size),d(t,"class","svelte-18cb8zy"),d(e,"class","svelte-18cb8zy")},m(i,f){I(i,e,f),a(e,t),a(t,o)},p(i,f){f&1&&l!==(l=se[i[0].type].title+"")&&F(o,l),f&1&&r!==(r=se[i[0].type].requirements.size)&&d(t,"data-size",r)},d(i){i&&w(e)}}}function Un(n){let e,t,l,o,r,i,f,_,u,p,m,h,k=n[0].type>-1&&Dl(n);return{c(){e=c("div"),k&&k.c(),d(e,"class","plot_container svelte-18cb8zy"),d(e,"data-active",t=n[0].active),d(e,"data-id",l=n[0].id),d(e,"data-x",o=n[0].x),d(e,"data-y",r=n[0].y),d(e,"data-optionindex",i=n[0].optionIndex),d(e,"data-canbeupgraded",n[1]),d(e,"style",n[2]),d(e,"data-type",f=n[0].type),d(e,"data-referenceplotx",_=n[0].referencePlot!==void 0?n[0].referencePlot[0]:null),d(e,"data-referenceploty",u=n[0].referencePlot!==void 0?n[0].referencePlot[1]:null),d(e,"data-size",p=n[0].type>-1?se[n[0].type].requirements.size:null)},m(b,C){I(b,e,C),k&&k.m(e,null),m||(h=x(e,"click",n[3]),m=!0)},p(b,[C]){b[0].type>-1?k?k.p(b,C):(k=Dl(b),k.c(),k.m(e,null)):k&&(k.d(1),k=null),C&1&&t!==(t=b[0].active)&&d(e,"data-active",t),C&1&&l!==(l=b[0].id)&&d(e,"data-id",l),C&1&&o!==(o=b[0].x)&&d(e,"data-x",o),C&1&&r!==(r=b[0].y)&&d(e,"data-y",r),C&1&&i!==(i=b[0].optionIndex)&&d(e,"data-optionindex",i),C&2&&d(e,"data-canbeupgraded",b[1]),C&4&&d(e,"style",b[2]),C&1&&f!==(f=b[0].type)&&d(e,"data-type",f),C&1&&_!==(_=b[0].referencePlot!==void 0?b[0].referencePlot[0]:null)&&d(e,"data-referenceplotx",_),C&1&&u!==(u=b[0].referencePlot!==void 0?b[0].referencePlot[1]:null)&&d(e,"data-referenceploty",u),C&1&&p!==(p=b[0].type>-1?se[b[0].type].requirements.size:null)&&d(e,"data-size",p)},i:Z,o:Z,d(b){b&&w(e),k&&k.d(),m=!1,h()}}}function jn(n,e,t){let l,o,r,i;ee(n,oe,b=>t(5,l=b)),ee(n,j,b=>t(6,o=b)),ee(n,ht,b=>t(7,r=b)),ee(n,gt,b=>t(8,i=b));let{data:f={id:0,active:!1,x:0,y:0,type:-1,styling:"",referencePlot:[]}}=e,{canBeUpgraded:_=!1}=e;function u(...b){m()}let p=f.styling;Dt(async()=>{f.type>=0&&se[f.type].styling&&t(2,p=se[f.type].styling)});function m(){f.type>=0&&se[f.type].styling&&t(2,p=se[f.type].styling),f.type<0&&t(2,p="")}function h(b,C,O){let N=document.querySelectorAll(".plot_container");if(r==!1){if(f.referencePlot!=null&&f.referencePlot[0]!==null&&C==null&&O==null&&f.referencePlot[1]!==void 0)return h(b,f.referencePlot[0],f.referencePlot[1]);!f.active&&!_?(Y(gt,i={},i),Y(oe,l.visible=!1,l),N.forEach(q=>{q.classList.remove("selected")})):(C!=null&&O!=null?(Y(oe,l.x=C,l),Y(oe,l.y=O,l)):(Y(oe,l.x=f.x,l),Y(oe,l.y=f.y,l)),Y(oe,l.visible=!0,l),N.forEach(q=>{q.classList.remove("selected")}),C!=null&&O!=null?document.querySelector(`.plot_container[data-x="${C}"][data-y="${O}"]`).classList.add("selected"):document.querySelector(`.plot_container[data-id="${f.id}"]`).classList.add("selected"))}}function k(b){r==!1&&(Y(j,o.plots[f.x][f.y].type=b,o),Y(oe,l.visible=!1,l))}return n.$$set=b=>{"data"in b&&t(0,f=b.data),"canBeUpgraded"in b&&t(1,_=b.canBeUpgraded)},n.$$.update=()=>{n.$$.dirty&1&&u(f)},[f,_,p,h,k]}class Wn extends Ge{constructor(e){super(),Ae(this,e,jn,Un,Me,{data:0,canBeUpgraded:1,changePlotType:4})}get changePlotType(){return this.$$.ctx[4]}}const me={land:{short_title:"Fill the grid",description_title:"You win by filling up all possible plots in the grid, and by meeting some requirements.",win:"You have filled the grid with buildings. You win!",requirements:{0:{population_count:200,happiness:100,health:100,employment:1},1:{population_count:500,happiness:100,health:100,employment:1},2:{population_count:1e3,happiness:100,health:100,employment:1}}}};function Yn(n){return n.hasBank,n}function Vn(n){return n.hasCityHall,n}function el(n){if(n.modifiers.happiness>1){let e=n.modifiers.happiness-1;n.modifiers.happiness-=e*.08,n.modifiers.happiness<1.05&&(n.modifiers.happiness=1)}if(n.modifiers.health>1){let e=n.modifiers.health-1;n.modifiers.health-=e*.08,n.modifiers.health<1.05&&(n.modifiers.health=1)}return n}function tl(n){if(n.townInfo.happiness>150){let t=n.townInfo.happiness-150;n.townInfo.happiness-=t*.08,n.townInfo.happiness<150&&(n.townInfo.happiness=150)}if(n.townInfo.health>150){let t=n.townInfo.health-150;n.townInfo.health-=t*.08,n.townInfo.health<150&&(n.townInfo.health=150)}return n}function Kn(n){return n.townInfo.happiness*=n.modifiers.happiness,n.townInfo.health*=n.modifiers.health,n}function Xn(n,e){let t=e.townInfo.happiness/100;t>1.25?t=1.25:t<.75&&(t=.75);let l=n*e.economy_and_laws.tax_rate*(e.townInfo.population_count/e.townInfo.population_max)*t;return Qe(l,2)}function Qe(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Qn(n,e,t){let l,o,r;ee(n,Ht,s=>t(4,l=s)),ee(n,j,s=>t(5,o=s)),ee(n,ht,s=>t(6,r=s));function i(s){return s=k(s),s=N(s),s=M(s),s=Kn(s),s=b(s),s=el(s),s}function f(s){return s=H(s),s=O(s),s=Yn(s),s=Vn(s),s}function _(s){return s=C(s),s=tl(s),s}function u(s){return s=q(s),s=h(s),s=m(s),s}function p(){j.update(s=>{if(r||!s||s.endGameDetails)return s;try{return s.environment.day+=1,s.environment.day%7===0&&(s=i(s)),s.environment.day%30===0&&(s=f(s)),s.environment.day%90===0&&(s=_(s)),s=u(s),s}catch($){return console.error("Error in game loop:",$),s}})}j.subscribe(s=>{s&&localStorage.setItem(Ie,JSON.stringify(s))});function m(s){if(s.endGoal=="land"&&s.townInfo.population_max==s.townInfo.population_count&&s.townInfo.happiness>=me.land.requirements[s.difficulty].happiness&&s.townInfo.health>=me.land.requirements[s.difficulty].health&&s.townInfo.employees/s.townInfo.population_count>=me.land.requirements[s.difficulty].employment&&s.townInfo.population_count>me.land.requirements[s.difficulty].population){let g=!0;for(let L=0;L<s.plots.length;L++)for(let B=0;B<s.plots[L].length;B++)if(s.plots[L][B].active==!1){g=!1;break}g&&(s.endGameDetails={msg:me.land.win,win:!0})}return s}function h(s){return s.townInfo.happiness<=0&&(s.townInfo.happiness=0,s.endGameDetails={msg:ke.happiness_zero,win:!1}),s.townInfo.health<=0&&(s.townInfo.health=0,s.endGameDetails={msg:ke.health_zero,win:!1}),s.townInfo.population_count<=0&&s.townInfo.population_max>0&&(s.townInfo.population_count=0,s.endGameDetails={msg:ke.population_zero,win:!1}),s}function k(s){let $=s.townInfo.population_count-s.townInfo.employees;return $>0&&(s.modifiers.happiness-=$*9e-4,s=E($+ke.unemployment_num,s)),s}function b(s){let $=s.townInfo.health,g=0;return $>50||$<Math.random()*50&&($<25?(s=E(ke.sickAndDying,s),s.townInfo.happiness-=10,g=Math.round(s.townInfo.population_count*.1)):(s=E(ke.sickAndLeaving,s),s.townInfo.happiness-=5,g=Math.round(s.townInfo.population_count*.05)),s.townInfo.population_count-=g,s.townInfo.employees-=g),s}function C(s){return s.lastChangeDay+(Math.random()*160+50)<s.environment.day&&(s.townInfo.population_count>0&&(s.townInfo.population_count-=1,s.townInfo.employees-=1,s.modifiers.happiness-=.01),s=E(ke.bored,s)),s}function O(s){if(s.townInfo.population_count<s.townInfo.population_max&&s.townInfo.happiness>50){let $=s.townInfo.population_max-s.townInfo.population_count,g=Math.round(s.townInfo.happiness/100*$);s.townInfo.population_count+=g,s.townInfo.population_count>s.townInfo.population_max&&(s.townInfo.population_count=s.townInfo.population_max),s.townInfo.employees+=g,s.townInfo.employees>s.townInfo.population_count&&(s.townInfo.employees=s.townInfo.population_count),s=E(g+ke.new_people_num,s)}if(s.townInfo.happiness<50&&s.townInfo.population_count>0){let $=Math.round((100-s.townInfo.happiness)/5);s.townInfo.population_count-=$,s.townInfo.employees>0&&(s.townInfo.employees-=$),s=E($+ke.leave_town_num,s)}else s.townInfo.population_count==s.townInfo.population_max&&(s=E(ke.people_want_to_move_in,s));return s}function N(s){const $=Math.random();if(s.economy_and_laws.tax_rate>s.economy_and_laws.max_tax_rate){const g=s.difficulty==0?.7:s.difficulty==1?.4:.2;$<g&&s.economy_and_laws.tax_rate>s.economy_and_laws.max_tax_rate*2?(s.modifiers.happiness-=.03,s=E(ke.very_high_tax_rate+"  ("+s.economy_and_laws.tax_rate+"%)",s)):(s.modifiers.happiness-=.01,s=E(ke.high_tax_rate+"  ("+s.economy_and_laws.tax_rate*100+"%)",s))}return s}function q(s){return s.townInfo.happiness<0&&(s.townInfo.happiness=0),s.townInfo.health<0&&(s.townInfo.health=0),s.townInfo.gold<0&&(s.townInfo.gold=0),s.townInfo.employees<0&&(s.townInfo.employees=0),s.townInfo.knowledge_points<0&&(s.townInfo.knowledge_points=0),s.townInfo.population_count<0&&(s.townInfo.population_count=0),s.townInfo.population_max==0&&(s=E(ke.nobody_home,s)),s.economy_and_laws.lastMonthProfit=Qe(s.economy_and_laws.lastMonthProfit,2),s.townInfo.gold=Qe(s.townInfo.gold,2),s.townInfo.population_count=Qe(s.townInfo.population_count,0),s.townInfo.employees=Qe(s.townInfo.employees,0),s.townInfo.population_max=Qe(s.townInfo.population_max,0),s.townInfo.happiness=Qe(s.townInfo.happiness,2),s.townInfo.health=Qe(s.townInfo.health,2),s.townInfo.happiness>300&&(s.townInfo.happiness=300),s.townInfo.health>300&&(s.townInfo.health=300),s.modifiers.happiness<.5&&(s.modifiers.happiness=.5),s.modifiers.health<.5&&(s.modifiers.health=.5),s}function M(s){s.economy_and_laws.lastMonthProfit=0;for(let $=0;$<s.plots.length;$++)for(let g=0;g<s.plots[$].length;g++)if(s.plots[$][g].active==!0&&s.plots[$][g].type>-1){let L=se[s.plots[$][g].type],B=Xn(L.revenue_per_week,s);s.townInfo.gold+=B,s.economy_and_laws.lastMonthProfit+=B,B>0&&(s.economy_and_laws.balanceSheetHistory=[{day:s.environment.day,plot:`${$},${g}`,profits:B,taxRate:s.economy_and_laws.tax_rate},...s.economy_and_laws.balanceSheetHistory],s.economy_and_laws.balanceSheetHistory.length>250&&(s.economy_and_laws.balanceSheetHistory=s.economy_and_laws.balanceSheetHistory.slice(0,250))),L.enables_tourism==!0&&(s.townInfo.gold_from_tourism+=L.tourism_revenue_per_week*s.economy_and_laws.tax_rate*s.townInfo.population_count)}return s}function H(s){for(let $=0;$<s.plots.length;$++)for(let g=0;g<s.plots[$].length;g++)if(s.plots[$][g].active==!0&&s.plots[$][g].type>-1){let L=se[s.plots[$][g].type];L.knowledge_points_per_month!=null&&(s.townInfo.knowledge_points+=L.knowledge_points_per_month)}return s}function E(s,$){return $.townLog="Day "+o.environment.day+" - "+s+`
`+$.townLog,$}return Dt(async()=>{for(;;)localStorage.reset=="true"&&(nl(),localStorage.setItem("reset","false")),p(),await new Promise(s=>setTimeout(s,l))}),[p,q,el,tl]}class Zn extends Ge{constructor(e){super(),Ae(this,e,Qn,null,Me,{mainGameThreadLoop:0,_fixVariables:1,_bringModifiersBackToNormal:2,_bringStatsBackToNormal:3})}get mainGameThreadLoop(){return this.$$.ctx[0]}get _fixVariables(){return this.$$.ctx[1]}get _bringModifiersBackToNormal(){return el}get _bringStatsBackToNormal(){return tl}}function Fl(n,e,t){const l=n.slice();return l[22]=e[t],l}function Rl(n){let e,t;return{c(){e=c("div"),t=v(n[0]),d(e,"class","message")},m(l,o){I(l,e,o),a(e,t)},p(l,o){o&1&&F(t,l[0])},d(l){l&&w(e)}}}function Jl(n){let e,t,l;return{c(){e=c("button"),e.textContent="\u{1F525}",d(e,"id","bulldoze"),d(e,"class","svelte-bdghnw")},m(o,r){I(o,e,r),t||(l=x(e,"click",n[11]),t=!0)},p:Z,d(o){o&&w(e),t=!1,l()}}}function Ul(n){let e,t,l,o;return{c(){e=c("span"),t=v("("),l=v(n[8]),o=v(")"),d(e,"class","text_s")},m(r,i){I(r,e,i),a(e,t),a(e,l),a(e,o)},p(r,i){i&256&&F(l,r[8])},d(r){r&&w(e)}}}function jl(n){let e;return{c(){e=c("span"),e.textContent="(0)",d(e,"class","text_s")},m(t,l){I(t,e,l)},d(t){t&&w(e)}}}function Wl(n){let e,t,l,o,r,i,f=n[22].revenue_per_week>0&&Yl(n),_=n[22].tourism_revenue_per_week>0&&Vl(n);return{c(){e=c("div"),t=c("span"),t.textContent="Profits",l=y(),o=c("br"),r=y(),f&&f.c(),i=y(),_&&_.c(),d(t,"class","subheading_m"),d(e,"class","profits svelte-bdghnw")},m(u,p){I(u,e,p),a(e,t),a(e,l),a(e,o),a(e,r),f&&f.m(e,null),a(e,i),_&&_.m(e,null)},p(u,p){u[22].revenue_per_week>0?f?f.p(u,p):(f=Yl(u),f.c(),f.m(e,i)):f&&(f.d(1),f=null),u[22].tourism_revenue_per_week>0?_?_.p(u,p):(_=Vl(u),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},d(u){u&&w(e),f&&f.d(),_&&_.d()}}}function Yl(n){let e,t,l=n[22].revenue_per_week+"",o,r,i=Ue(n[6].economy_and_laws.tax_rate*n[22].revenue_per_week,2)+"",f,_,u,p;return{c(){e=c("span"),t=c("span"),o=v(l),r=y(),f=v(i),_=v(" gold (with tax rate)"),u=y(),p=c("br"),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(m,h){I(m,e,h),a(e,t),a(t,o),a(e,r),a(e,f),a(e,_),I(m,u,h),I(m,p,h)},p(m,h){h&32&&l!==(l=m[22].revenue_per_week+"")&&F(o,l),h&96&&i!==(i=Ue(m[6].economy_and_laws.tax_rate*m[22].revenue_per_week,2)+"")&&F(f,i)},d(m){m&&w(e),m&&w(u),m&&w(p)}}}function Vl(n){let e,t,l=n[22].tourism_revenue_per_week+"",o,r,i=Ue(n[6].economy_and_laws.tax_rate*n[22].tourism_revenue_per_week*n[6].townInfo.population_count,2)+"",f,_,u,p=n[6].hasABank!==!0&&Kl();return{c(){e=c("span"),t=c("span"),o=v(l),r=y(),f=v(i),_=v(` tourism gold (
											`),p&&p.c(),u=v(`

											)`),d(t,"class","strikethrough"),d(e,"class","text_s gold")},m(m,h){I(m,e,h),a(e,t),a(t,o),a(e,r),a(e,f),a(e,_),p&&p.m(e,null),a(e,u)},p(m,h){h&32&&l!==(l=m[22].tourism_revenue_per_week+"")&&F(o,l),h&96&&i!==(i=Ue(m[6].economy_and_laws.tax_rate*m[22].tourism_revenue_per_week*m[6].townInfo.population_count,2)+"")&&F(f,i),m[6].hasABank!==!0?p||(p=Kl(),p.c(),p.m(e,u)):p&&(p.d(1),p=null)},d(m){m&&w(e),p&&p.d()}}}function Kl(n){let e;return{c(){e=v("get a bank to cash out")},m(t,l){I(t,e,l)},d(t){t&&w(e)}}}function Xl(n){let e,t;function l(i,f){return i[6].townInfo.gold<i[22].requirements.gold?zn:xn}let o=l(n),r=o(n);return{c(){r.c(),e=y(),t=c("br")},m(i,f){r.m(i,f),I(i,e,f),I(i,t,f)},p(i,f){o===(o=l(i))&&r?r.p(i,f):(r.d(1),r=o(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){r.d(i),i&&w(e),i&&w(t)}}}function xn(n){let e,t=n[22].requirements.gold+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" gold"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,i){I(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[22].requirements.gold+"")&&F(l,t)},d(r){r&&w(e)}}}function zn(n){let e,t=n[22].requirements.gold+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" gold"),d(e,"class","red text_s cost_label svelte-bdghnw")},m(r,i){I(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[22].requirements.gold+"")&&F(l,t)},d(r){r&&w(e)}}}function Ql(n){let e,t;function l(i,f){return i[6].townInfo.population_count-i[6].townInfo.employees<i[22].requirements.employees?to:eo}let o=l(n),r=o(n);return{c(){r.c(),e=y(),t=c("br")},m(i,f){r.m(i,f),I(i,e,f),I(i,t,f)},p(i,f){o===(o=l(i))&&r?r.p(i,f):(r.d(1),r=o(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){r.d(i),i&&w(e),i&&w(t)}}}function eo(n){let e,t=n[22].requirements.employees+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" employees"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,i){I(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[22].requirements.employees+"")&&F(l,t)},d(r){r&&w(e)}}}function to(n){let e,t=n[22].requirements.employees+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" employees"),d(e,"class","text_s cost_label red svelte-bdghnw")},m(r,i){I(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[22].requirements.employees+"")&&F(l,t)},d(r){r&&w(e)}}}function Zl(n){let e,t;function l(i,f){return i[6].townInfo.knowledge_points<i[22].requirements.knowledge?no:lo}let o=l(n),r=o(n);return{c(){r.c(),e=y(),t=c("br")},m(i,f){r.m(i,f),I(i,e,f),I(i,t,f)},p(i,f){o===(o=l(i))&&r?r.p(i,f):(r.d(1),r=o(i),r&&(r.c(),r.m(e.parentNode,e)))},d(i){r.d(i),i&&w(e),i&&w(t)}}}function lo(n){let e,t=n[22].requirements.knowledge+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" knowledge"),d(e,"class","text_s cost_label svelte-bdghnw")},m(r,i){I(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[22].requirements.knowledge+"")&&F(l,t)},d(r){r&&w(e)}}}function no(n){let e,t=n[22].requirements.knowledge+"",l,o;return{c(){e=c("span"),l=v(t),o=v(" knowledge"),d(e,"class","text_s cost_label red svelte-bdghnw")},m(r,i){I(r,e,i),a(e,l),a(e,o)},p(r,i){i&32&&t!==(t=r[22].requirements.knowledge+"")&&F(l,t)},d(r){r&&w(e)}}}function oo(n){let e,t,l=Ft(n[22].effect_modifiers.happiness)+"",o,r;return{c(){e=c("span"),t=v("\u{1F601} "),o=v(l),d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive",r=n[22].effect_modifiers.happiness>=1)},m(i,f){I(i,e,f),a(e,t),a(e,o)},p(i,f){f&32&&l!==(l=Ft(i[22].effect_modifiers.happiness)+"")&&F(o,l),f&32&&r!==(r=i[22].effect_modifiers.happiness>=1)&&d(e,"data-positive",r)},d(i){i&&w(e)}}}function io(n){let e;return{c(){e=c("span"),e.textContent="\u{1F601} No effect",d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive","true")},m(t,l){I(t,e,l)},p:Z,d(t){t&&w(e)}}}function so(n){let e,t,l=Ft(n[22].effect_modifiers.health)+"",o,r;return{c(){e=c("span"),t=v("\u{1F3E5} "),o=v(l),d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive",r=n[22].effect_modifiers.health>=1)},m(i,f){I(i,e,f),a(e,t),a(e,o)},p(i,f){f&32&&l!==(l=Ft(i[22].effect_modifiers.health)+"")&&F(o,l),f&32&&r!==(r=i[22].effect_modifiers.health>=1)&&d(e,"data-positive",r)},d(i){i&&w(e)}}}function ao(n){let e;return{c(){e=c("span"),e.textContent="\u{1F3E5} No effect",d(e,"class","text_s svelte-bdghnw"),d(e,"data-positive","true")},m(t,l){I(t,e,l)},p:Z,d(t){t&&w(e)}}}function xl(n){let e,t,l,o,r,i=n[22].immediate_variable_changes.happiness!==0&&zl(n),f=n[22].immediate_variable_changes.happiness!==0&&n[22].immediate_variable_changes.health!==0&&en(),_=n[22].immediate_variable_changes.health!==0&&tn(n);return{c(){e=c("div"),t=c("span"),l=v(`Instant changes:
										`),i&&i.c(),o=y(),f&&f.c(),r=y(),_&&_.c(),d(t,"class","subheading_m"),d(e,"class","immediate_changes svelte-bdghnw")},m(u,p){I(u,e,p),a(e,t),a(t,l),i&&i.m(t,null),a(t,o),f&&f.m(t,null),a(t,r),_&&_.m(t,null)},p(u,p){u[22].immediate_variable_changes.happiness!==0?i?i.p(u,p):(i=zl(u),i.c(),i.m(t,o)):i&&(i.d(1),i=null),u[22].immediate_variable_changes.happiness!==0&&u[22].immediate_variable_changes.health!==0?f||(f=en(),f.c(),f.m(t,r)):f&&(f.d(1),f=null),u[22].immediate_variable_changes.health!==0?_?_.p(u,p):(_=tn(u),_.c(),_.m(t,null)):_&&(_.d(1),_=null)},d(u){u&&w(e),i&&i.d(),f&&f.d(),_&&_.d()}}}function zl(n){let e,t,l=n[22].immediate_variable_changes.happiness+"",o;return{c(){e=v(`\u{1F601}
											`),t=c("span"),o=v(l),d(t,"class","green")},m(r,i){I(r,e,i),I(r,t,i),a(t,o)},p(r,i){i&32&&l!==(l=r[22].immediate_variable_changes.happiness+"")&&F(o,l)},d(r){r&&w(e),r&&w(t)}}}function en(n){let e;return{c(){e=v(",")},m(t,l){I(t,e,l)},d(t){t&&w(e)}}}function tn(n){let e,t,l=n[22].immediate_variable_changes.health+"",o;return{c(){e=v(`\u{1F3E5}
											`),t=c("span"),o=v(l),d(t,"class","green")},m(r,i){I(r,e,i),I(r,t,i),a(t,o)},p(r,i){i&32&&l!==(l=r[22].immediate_variable_changes.health+"")&&F(o,l)},d(r){r&&w(e),r&&w(t)}}}function ln(n,e){let t,l,o,r=e[22].title+"",i,f,_,u,p,m=e[22].subtitle+"",h,k,b,C,O,N=e[22].description+"",q,M,H,E,s,$,g,L,B,T,P,J,z,R,Q,ae,K,A,X,te,le,he,Ce,S,D,ge,ze,re=(e[22].revenue_per_week>0||e[22].tourism_revenue_per_week>0)&&Wl(e),fe=e[22].requirements.gold!==0&&Xl(e),ce=e[22].requirements.employees!==0&&Ql(e),ue=e[22].requirements.knowledge!=null&&e[22].requirements.knowledge!==0&&Zl(e);function et(ve,ie){return ve[22].effect_modifiers.happiness==1?io:oo}let Ye=et(e),Se=Ye(e);function He(ve,ie){return ve[22].effect_modifiers.health==1?ao:so}let We=He(e),Pe=We(e),ne=(e[22].immediate_variable_changes.happiness!==0||e[22].immediate_variable_changes.health!==0)&&xl(e);return{key:n,first:null,c(){t=c("div"),l=c("div"),o=c("span"),i=v(r),f=y(),_=c("br"),u=y(),p=c("span"),h=v(m),k=y(),b=c("br"),C=y(),O=c("span"),q=v(N),M=y(),H=c("div"),re&&re.c(),E=y(),s=c("div"),$=c("div"),g=c("span"),g.textContent="Requirements",L=y(),B=c("br"),T=y(),fe&&fe.c(),P=y(),ce&&ce.c(),J=y(),ue&&ue.c(),z=y(),R=c("div"),Q=c("span"),Q.textContent="Multiplier",ae=y(),K=c("br"),A=y(),Se.c(),X=y(),te=c("br"),le=y(),Pe.c(),he=y(),ne&&ne.c(),Ce=y(),d(o,"class","heading_m"),d(p,"class","subheading_m"),d(O,"class","text_s"),d(g,"class","subheading_m"),d($,"class","svelte-bdghnw"),d(Q,"class","subheading_m"),d(R,"class","svelte-bdghnw"),d(s,"class","reqs_and_mods svelte-bdghnw"),d(H,"class","bottom svelte-bdghnw"),d(t,"class",S="plotOption background-lightgray "+(e[22].affordable?"":"unaffordable")+" svelte-bdghnw"),d(t,"data-active",D=e[22].selected),d(t,"data-affordable",ge=e[22].affordable),d(t,"data-plotoptionid",ze=e[22].id),this.first=t},m(ve,ie){I(ve,t,ie),a(t,l),a(l,o),a(o,i),a(l,f),a(l,_),a(l,u),a(l,p),a(p,h),a(l,k),a(l,b),a(l,C),a(l,O),a(O,q),a(t,M),a(t,H),re&&re.m(H,null),a(H,E),a(H,s),a(s,$),a($,g),a($,L),a($,B),a($,T),fe&&fe.m($,null),a($,P),ce&&ce.m($,null),a($,J),ue&&ue.m($,null),a(s,z),a(s,R),a(R,Q),a(R,ae),a(R,K),a(R,A),Se.m(R,null),a(R,X),a(R,te),a(R,le),Pe.m(R,null),a(H,he),ne&&ne.m(H,null),a(t,Ce)},p(ve,ie){e=ve,ie&32&&r!==(r=e[22].title+"")&&F(i,r),ie&32&&m!==(m=e[22].subtitle+"")&&F(h,m),ie&32&&N!==(N=e[22].description+"")&&F(q,N),e[22].revenue_per_week>0||e[22].tourism_revenue_per_week>0?re?re.p(e,ie):(re=Wl(e),re.c(),re.m(H,E)):re&&(re.d(1),re=null),e[22].requirements.gold!==0?fe?fe.p(e,ie):(fe=Xl(e),fe.c(),fe.m($,P)):fe&&(fe.d(1),fe=null),e[22].requirements.employees!==0?ce?ce.p(e,ie):(ce=Ql(e),ce.c(),ce.m($,J)):ce&&(ce.d(1),ce=null),e[22].requirements.knowledge!=null&&e[22].requirements.knowledge!==0?ue?ue.p(e,ie):(ue=Zl(e),ue.c(),ue.m($,null)):ue&&(ue.d(1),ue=null),Ye===(Ye=et(e))&&Se?Se.p(e,ie):(Se.d(1),Se=Ye(e),Se&&(Se.c(),Se.m(R,X))),We===(We=He(e))&&Pe?Pe.p(e,ie):(Pe.d(1),Pe=We(e),Pe&&(Pe.c(),Pe.m(R,null))),e[22].immediate_variable_changes.happiness!==0||e[22].immediate_variable_changes.health!==0?ne?ne.p(e,ie):(ne=xl(e),ne.c(),ne.m(H,null)):ne&&(ne.d(1),ne=null),ie&32&&S!==(S="plotOption background-lightgray "+(e[22].affordable?"":"unaffordable")+" svelte-bdghnw")&&d(t,"class",S),ie&32&&D!==(D=e[22].selected)&&d(t,"data-active",D),ie&32&&ge!==(ge=e[22].affordable)&&d(t,"data-affordable",ge),ie&32&&ze!==(ze=e[22].id)&&d(t,"data-plotoptionid",ze)},d(ve){ve&&w(t),re&&re.d(),fe&&fe.d(),ce&&ce.d(),ue&&ue.d(),Se.d(),Pe.d(),ne&&ne.d()}}}function ro(n){let e,t,l,o,r,i,f=n[2]+1+"",_,u,p=n[1]+1+"",m,h,k,b,C,O,N=n[6].plots[n[1]][n[2]].type!==-1&&n[3](n[2],n[1]),q,M,H,E,s,$,g,L,B,T,P,J,z,R=[],Q=new Map,ae,K,A=n[0]!==""&&Rl(n),X=N&&Jl(n),te=n[8]>0&&Ul(n),le=n[5].length==0&&jl(),he=n[5];const Ce=S=>S[22].id;for(let S=0;S<he.length;S+=1){let D=Fl(n,he,S),ge=Ce(D);Q.set(ge,R[S]=ln(ge,D))}return{c(){e=c("div"),t=c("div"),l=c("div"),o=c("div"),r=c("span"),i=v("Modify Plot: "),_=v(f),u=v("-"),m=v(p),h=y(),A&&A.c(),k=y(),b=c("input"),C=y(),O=c("div"),X&&X.c(),q=y(),M=c("button"),M.textContent="Close",H=y(),E=c("div"),s=c("label"),$=v(`options
				`),te&&te.c(),g=y(),le&&le.c(),L=y(),B=c("br"),T=y(),P=c("br"),J=y(),z=c("div");for(let S=0;S<R.length;S+=1)R[S].c();d(r,"class","heading_l"),d(o,"class","svelte-bdghnw"),d(b,"type","text"),d(b,"id","search-bar"),d(b,"placeholder","Search Plot Options..."),b.value=n[4],d(b,"class","svelte-bdghnw"),d(M,"id","close"),d(M,"class","svelte-bdghnw"),d(O,"class","svelte-bdghnw"),d(l,"class","header svelte-bdghnw"),d(s,"for","plotType"),d(z,"class","plotOptions svelte-bdghnw"),d(E,"class","scrollable-y svelte-bdghnw"),d(t,"class","dialog-content svelte-bdghnw"),d(e,"class","dialog svelte-bdghnw")},m(S,D){I(S,e,D),a(e,t),a(t,l),a(l,o),a(o,r),a(r,i),a(r,_),a(r,u),a(r,m),a(o,h),A&&A.m(o,null),a(l,k),a(l,b),n[16](b),a(l,C),a(l,O),X&&X.m(O,null),a(O,q),a(O,M),a(t,H),a(t,E),a(E,s),a(s,$),te&&te.m(s,null),a(s,g),le&&le.m(s,null),a(E,L),a(E,B),a(E,T),a(E,P),a(E,J),a(E,z);for(let ge=0;ge<R.length;ge+=1)R[ge].m(z,null);ae||(K=[x(b,"input",n[9]),x(M,"click",n[10]),x(z,"click",n[12])],ae=!0)},p(S,[D]){D&4&&f!==(f=S[2]+1+"")&&F(_,f),D&2&&p!==(p=S[1]+1+"")&&F(m,p),S[0]!==""?A?A.p(S,D):(A=Rl(S),A.c(),A.m(o,null)):A&&(A.d(1),A=null),D&16&&b.value!==S[4]&&(b.value=S[4]),D&70&&(N=S[6].plots[S[1]][S[2]].type!==-1&&S[3](S[2],S[1])),N?X?X.p(S,D):(X=Jl(S),X.c(),X.m(O,q)):X&&(X.d(1),X=null),S[8]>0?te?te.p(S,D):(te=Ul(S),te.c(),te.m(s,g)):te&&(te.d(1),te=null),S[5].length==0?le||(le=jl(),le.c(),le.m(s,null)):le&&(le.d(1),le=null),D&96&&(he=S[5],R=Dn(R,D,Ce,1,S,he,Q,z,Hn,ln,null,Fl))},i:Z,o:Z,d(S){S&&w(e),A&&A.d(),n[16](null),X&&X.d(),te&&te.d(),le&&le.d();for(let D=0;D<R.length;D+=1)R[D].d();ae=!1,Ze(K)}}}function Ue(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Ft(n){return n.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}function fo(n,e){let t=!0;n.requirements.gold>e.townInfo.gold&&(t=!1);let l=e.townInfo.population_count-e.townInfo.employees;return n.requirements.employees!==void 0&&n.requirements.employees>0&&n.requirements.employees>l&&(t=!1),n.requirements.knowledge!==void 0&&n.requirements.knowledge>e.townInfo.knowledge_points&&(t=!1),t}function uo(n,e,t){let l,o;ee(n,j,g=>t(6,l=g)),ee(n,oe,g=>t(17,o=g));var r=this&&this.__awaiter||function(g,L,B,T){function P(J){return J instanceof B?J:new B(function(z){z(J)})}return new(B||(B=Promise))(function(J,z){function R(K){try{ae(T.next(K))}catch(A){z(A)}}function Q(K){try{ae(T.throw(K))}catch(A){z(A)}}function ae(K){K.done?J(K.value):P(K.value).then(R,Q)}ae((T=T.apply(g,L||[])).next())})};let{x:i=0}=e,{y:f=0}=e,_="",u=se,{tooltip:p=""}=e,m,h;Dt(()=>r(void 0,void 0,void 0,function*(){yield An(),m&&m.focus()}));let k=[];function b(g){t(4,_=g.target.value),g.stopPropagation()}Dt(()=>{const g=document.querySelectorAll(".plotOption");l.plots[i][f].type!==-1&&l.plots[i][f].type>-1&&(g[l.plots[i][f].type].classList.add("active"),g[l.plots[i][f].type].scrollIntoView({behavior:"smooth",block:"center"}))});function C(g,L){let B={x:g,y:L};return B.x===0&&B.y===0?!0:[{x:B.x-1,y:B.y},{x:B.x+1,y:B.y},{x:B.x,y:B.y-1},{x:B.x,y:B.y+1}].some(P=>P.x<0||P.x>l.plots.length-1||P.y<0||P.y>l.plots.length-1?!1:l.plots[P.x][P.y].active)}function O(){Y(oe,o.visible=!1,o)}function N(){document.querySelectorAll(".plotOption").forEach(L=>{L.classList.remove("active")}),E(i,f)}function q(g){document.querySelectorAll(".plotOption").forEach(T=>{T.classList.remove("active")}),document.querySelector(`[data-plotoptionid="${g}"]`).classList.add("active"),H(i,f,g)}function M(g,L){let B=0;return g>0&&l.plots[g-1][L].type!==-1&&B++,g<l.plots.length-1&&l.plots[g+1][L].type!==-1&&B++,L>0&&l.plots[g][L-1].type!==-1&&B++,L<l.plots[0].length-1&&l.plots[g][L+1].type!==-1&&B++,B<=4}function H(g,L,B){let T=l;const P=se.findIndex(R=>R.id===B);let J=se[P],z=!0;if((J.requirements.gold>T.townInfo.gold||J.requirements.employees>T.townInfo.population_count-T.townInfo.employees)&&(z=!1),J.requirements.size!=null&&z){let R=J.requirements.size,Q=[],ae=u[P].title.toLowerCase().indexOf("school")!=-1;for(let K=0;K<4;K++){let A=[[g,L]];K===0?(A.push([g-(R-1),L-(R-1)]),A.push([g-(R-1),L]),A.push([g,L-(R-1)])):K===1?(A.push([g,L-(R-1)]),A.push([g+(R-1),L-(R-1)]),A.push([g+(R-1),L])):K===2?(A.push([g-(R-1),L]),A.push([g-(R-1),L+(R-1)]),A.push([g,L+(R-1)])):K===3&&(A.push([g,L+(R-1)]),A.push([g+(R-1),L+(R-1)]),A.push([g+(R-1),L])),Q.push(A)}Q=Q.filter(K=>K.every(A=>A[0]>=0&&A[0]<=T.plots.length-1&&A[1]>=0&&A[1]<=T.plots.length-1&&!T.plots[A[0]][A[1]].active&&C(A[0],A[1])==!0)),Q.length===0?z=!1:Q.length>0&&Q[0].forEach(A=>{T.plots[A[0]][A[1]].active=!0,T.plots[A[0]][A[1]].type=ae?-3:-2,T.plots[A[0]][A[1]].referencePlot=[g,L]})}if(z===!0){switch(T.plots[g][L].type!==-1&&E(g,L),t(0,p=""),T.plots[g][L].type=P,T.plots[g][L].active=!0,T.plots[g][L].referencePlot=[],T.townInfo.gold-=J.requirements.gold,T.townInfo.gold=Ue(T.townInfo.gold,2),T.townInfo.population_count+=J.immediate_variable_changes.population,T.townInfo.population_max+=J.immediate_variable_changes.population,T.townInfo.happiness+=J.immediate_variable_changes.happiness,T.townInfo.health+=J.immediate_variable_changes.health,T.modifiers.happiness=Ue(T.modifiers.happiness*J.effect_modifiers.happiness,2),T.modifiers.health=Ue(T.modifiers.health*J.effect_modifiers.health,2),T.townInfo.employees+=J.requirements.employees,(T.plotCounts[P]===void 0||T.plotCounts[P]===null)&&(T.plotCounts[P]=0),T.plotCounts[P]++,T.lastChangeDay=T.environment.day,T.economy_and_laws.balanceSheetHistory=[{day:T.environment.day,plot:`${g},${L}`,profits:J.requirements.gold*-1,balance:Ue(T.townInfo.gold,2)},...T.economy_and_laws.balanceSheetHistory],J.id){case"city-hall":T.hasCityHall=!0;break;case"bank":T.hasBank=!0;break}j.set(T),localStorage.setItem(Ie,JSON.stringify(T)),Y(oe,o.visible=!1,o)}else t(0,p="You do not have enough resources to purchase this plot."),document.querySelectorAll(".plotOption").forEach(Q=>{Q.classList.remove("active")})}function E(g,L){let B=l,T=B.plots[g][L].type;B.plots[g][L].type=-1,B.plots[g][L].active=!1,T>-1&&(B.townInfo.population_count-=se[T].immediate_variable_changes.population,B.townInfo.population_max-=se[T].immediate_variable_changes.population,B.townInfo.happiness-=se[T].immediate_variable_changes.happiness,B.townInfo.health-=se[T].immediate_variable_changes.health,B.modifiers.happiness=Ue(B.modifiers.happiness/se[T].effect_modifiers.happiness,2),B.modifiers.health=Ue(B.modifiers.health/se[T].effect_modifiers.health,2),B.townInfo.employees-=se[T].requirements.employees,(B.plotCounts[T]===void 0||B.plotCounts[T]===null)&&(B.plotCounts[T]=0),B.plotCounts[T]--),B.lastChangeDay=B.environment.day,j.set(B),localStorage.setItem(Ie,JSON.stringify(B))}function s(g){const L=g.target.closest(".plotOption");if(L){const B=L.dataset.plotoptionid;q(B)}}function $(g){Qt[g?"unshift":"push"](()=>{m=g,t(7,m)})}return n.$$set=g=>{"x"in g&&t(1,i=g.x),"y"in g&&t(2,f=g.y),"tooltip"in g&&t(0,p=g.tooltip)},n.$$.update=()=>{n.$$.dirty&64&&l&&t(5,k=u.map(g=>Object.assign(Object.assign({},g),{affordable:fo(g,l)}))),n.$$.dirty&48&&t(5,k=_?k.filter(g=>g.title.toLowerCase().includes(_.toLowerCase())):k),n.$$.dirty&32&&t(8,h=k.filter(g=>g.affordable==!0).length)},[p,i,f,M,_,k,l,m,h,b,O,N,s,C,H,E,$]}class po extends Ge{constructor(e){super(),Ae(this,e,uo,ro,Me,{x:1,y:2,tooltip:0,checkIfPlotCanBeUpgraded:13,canBulldoze:3,purchasePlot:14,reverseClear:15})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[13]}get canBulldoze(){return this.$$.ctx[3]}get purchasePlot(){return this.$$.ctx[14]}get reverseClear(){return this.$$.ctx[15]}}function nn(n,e,t){const l=n.slice();return l[6]=e[t],l}function on(n,e,t){const l=n.slice();return l[9]=e[t],l}function sn(n){let e,t,l=n[3],o,r,i=n[2].plots,f=[];for(let p=0;p<i.length;p+=1)f[p]=rn(nn(n,i,p));const _=p=>V(f[p],1,1,()=>{f[p]=null});let u=un(n);return{c(){e=c("div");for(let p=0;p<f.length;p+=1)f[p].c();t=y(),u.c(),o=xe(),d(e,"class","grid svelte-3cpxwu")},m(p,m){I(p,e,m);for(let h=0;h<f.length;h+=1)f[h].m(e,null);I(p,t,m),u.m(p,m),I(p,o,m),r=!0},p(p,m){if(m&7){i=p[2].plots;let h;for(h=0;h<i.length;h+=1){const k=nn(p,i,h);f[h]?(f[h].p(k,m),U(f[h],1)):(f[h]=rn(k),f[h].c(),U(f[h],1),f[h].m(e,null))}for(Be(),h=i.length;h<f.length;h+=1)_(h);Ee()}m&8&&Me(l,l=p[3])?(Be(),V(u,1,1,Z),Ee(),u=un(p),u.c(),U(u,1),u.m(o.parentNode,o)):u.p(p,m)},i(p){if(!r){for(let m=0;m<i.length;m+=1)U(f[m]);U(u),r=!0}},o(p){f=f.filter(Boolean);for(let m=0;m<f.length;m+=1)V(f[m]);V(u),r=!1},d(p){p&&w(e),ll(f,p),p&&w(t),p&&w(o),u.d(p)}}}function an(n){let e,t;return e=new Wn({props:{data:n[9],canBeUpgraded:n[0](n[9].x,n[9].y)}}),{c(){Te(e.$$.fragment)},m(l,o){Oe(e,l,o),t=!0},p(l,o){const r={};o&4&&(r.data=l[9]),o&4&&(r.canBeUpgraded=l[0](l[9].x,l[9].y)),e.$set(r)},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){Ne(e,l)}}}function rn(n){let e,t,l,o,r,i=n[6],f=[];for(let u=0;u<i.length;u+=1)f[u]=an(on(n,i,u));const _=u=>V(f[u],1,1,()=>{f[u]=null});return{c(){e=c("div");for(let u=0;u<f.length;u+=1)f[u].c();t=y(),d(e,"class","row svelte-3cpxwu")},m(u,p){I(u,e,p);for(let m=0;m<f.length;m+=1)f[m].m(e,null);a(e,t),l=!0,o||(r=x(e,"click",n[1]),o=!0)},p(u,p){if(p&5){i=u[6];let m;for(m=0;m<i.length;m+=1){const h=on(u,i,m);f[m]?(f[m].p(h,p),U(f[m],1)):(f[m]=an(h),f[m].c(),U(f[m],1),f[m].m(e,t))}for(Be(),m=i.length;m<f.length;m+=1)_(m);Ee()}},i(u){if(!l){for(let p=0;p<i.length;p+=1)U(f[p]);l=!0}},o(u){f=f.filter(Boolean);for(let p=0;p<f.length;p+=1)V(f[p]);l=!1},d(u){u&&w(e),ll(f,u),o=!1,r()}}}function fn(n){let e,t;return e=new po({props:{x:n[4].x,y:n[4].y}}),{c(){Te(e.$$.fragment)},m(l,o){Oe(e,l,o),t=!0},p(l,o){const r={};o&16&&(r.x=l[4].x),o&16&&(r.y=l[4].y),e.$set(r)},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){Ne(e,l)}}}function un(n){let e,t,l=n[4].visible&&fn(n);return{c(){l&&l.c(),e=xe()},m(o,r){l&&l.m(o,r),I(o,e,r),t=!0},p(o,r){o[4].visible?l?(l.p(o,r),r&16&&U(l,1)):(l=fn(o),l.c(),U(l,1),l.m(e.parentNode,e)):l&&(Be(),V(l,1,1,()=>{l=null}),Ee())},i(o){t||(U(l),t=!0)},o(o){V(l),t=!1},d(o){l&&l.d(o),o&&w(e)}}}function co(n){let e,t,l=n[2]!=null&&sn(n);return{c(){l&&l.c(),e=xe()},m(o,r){l&&l.m(o,r),I(o,e,r),t=!0},p(o,[r]){o[2]!=null?l?(l.p(o,r),r&4&&U(l,1)):(l=sn(o),l.c(),U(l,1),l.m(e.parentNode,e)):l&&(Be(),V(l,1,1,()=>{l=null}),Ee())},i(o){t||(U(l),t=!0)},o(o){V(l),t=!1},d(o){l&&l.d(o),o&&w(e)}}}function _o(n,e,t){let l,o,r;ee(n,j,u=>t(2,l=u)),ee(n,gt,u=>t(3,o=u)),ee(n,oe,u=>t(4,r=u));function i(u,p){let m={x:u,y:p};return m.x===0&&m.y===0?!0:[{x:m.x-1,y:m.y},{x:m.x+1,y:m.y},{x:m.x,y:m.y-1},{x:m.x,y:m.y+1}].some(k=>k.x<0||k.x>=l.plots.length||k.y<0||k.y>=l.plots[k.x].length?!1:l.plots[k.x][k.y].active)}function f(){let u=[];for(let p=0;p<l.plots.length;p++)for(let m=0;m<l.plots.length;m++)i(p,m)&&l.plots[p][m].active==!1&&u.push(l.plots[p][m])}function _(){Y(gt,o={},o)}return window.location.search.includes("dev=true")&&(Y(j,l.townInfo.name="DevTown",l),Y(j,l.townInfo.gold=1e8,l),Y(j,l.townInfo.population=0,l),Y(j,l.townInfo.happiness=1e5,l),Y(j,l.townInfo.health=1e5,l),Y(j,l.modifiers.happiness=1e5,l),Y(j,l.modifiers.health=1e5,l),Y(j,l.townInfo.knowledge_points=1e4,l)),n.$$.update=()=>{n.$$.dirty&4&&l&&f()},[i,_,l,o,r]}class mo extends Ge{constructor(e){super(),Ae(this,e,_o,co,Me,{checkIfPlotCanBeUpgraded:0,restartModifyPlotMenu:1})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[0]}get restartModifyPlotMenu(){return this.$$.ctx[1]}}function pn(n,e,t){const l=n.slice();return l[4]=e[t],l}function ho(n){let e,t,l,o,r=n[0].economy_and_laws.balanceSheetHistory,i=[];for(let f=0;f<r.length;f+=1)i[f]=cn(pn(n,r,f));return{c(){e=c("table"),t=c("thead"),t.innerHTML=`<tr class="svelte-1m5x2x2"><th>Day</th> 
						<th>Plot</th> 
						<th>Profits</th> 
						<th>Tax rate</th></tr>`,l=y(),o=c("tbody");for(let f=0;f<i.length;f+=1)i[f].c();d(e,"class","svelte-1m5x2x2")},m(f,_){I(f,e,_),a(e,t),a(e,l),a(e,o);for(let u=0;u<i.length;u+=1)i[u].m(o,null)},p(f,_){if(_&3){r=f[0].economy_and_laws.balanceSheetHistory;let u;for(u=0;u<r.length;u+=1){const p=pn(f,r,u);i[u]?i[u].p(p,_):(i[u]=cn(p),i[u].c(),i[u].m(o,null))}for(;u<i.length;u+=1)i[u].d(1);i.length=r.length}},d(f){f&&w(e),ll(i,f)}}}function go(n){let e;return{c(){e=c("div"),e.textContent=`No data to display yet. Build some buildings and make sure that the tax
				rate is above 0%.`,d(e,"class","text-center padding-sides")},m(t,l){I(t,e,l)},p:Z,d(t){t&&w(e)}}}function cn(n){let e,t,l=n[4].day+"",o,r,i,f=n[4].plot+"",_,u,p,m=n[4].profits+"",h,k,b,C=n[4].taxRate+"",O,N,q,M;function H(){return n[2](n[4])}return{c(){e=c("tr"),t=c("td"),o=v(l),r=y(),i=c("th"),_=v(f),u=y(),p=c("td"),h=v(m),k=y(),b=c("td"),O=v(C),N=y(),d(t,"class","svelte-1m5x2x2"),d(i,"class","plot_link svelte-1m5x2x2"),d(p,"class","svelte-1m5x2x2"),d(b,"class","svelte-1m5x2x2"),d(e,"class","svelte-1m5x2x2")},m(E,s){I(E,e,s),a(e,t),a(t,o),a(e,r),a(e,i),a(i,_),a(e,u),a(e,p),a(p,h),a(e,k),a(e,b),a(b,O),a(e,N),q||(M=x(i,"click",H),q=!0)},p(E,s){n=E,s&1&&l!==(l=n[4].day+"")&&F(o,l),s&1&&f!==(f=n[4].plot+"")&&F(_,f),s&1&&m!==(m=n[4].profits+"")&&F(h,m),s&1&&C!==(C=n[4].taxRate+"")&&F(O,C)},d(E){E&&w(e),q=!1,M()}}}function vo(n){let e,t,l,o,r,i;function f(p,m){return p[0].economy_and_laws.balanceSheetHistory.length==0?go:ho}let _=f(n),u=_(n);return{c(){e=c("div"),t=c("div"),l=c("div"),l.textContent="Balance Sheet",o=y(),r=c("br"),i=y(),u.c(),d(l,"class","heading_m svelte-1m5x2x2"),d(t,"class","dialog-content svelte-1m5x2x2"),d(e,"class","dialog svelte-1m5x2x2")},m(p,m){I(p,e,m),a(e,t),a(t,l),a(t,o),a(t,r),a(t,i),u.m(t,null)},p(p,[m]){_===(_=f(p))&&u?u.p(p,m):(u.d(1),u=_(p),u&&(u.c(),u.m(t,null)))},i:Z,o:Z,d(p){p&&w(e),u.d()}}}function bo(n,e,t){let l,o;ee(n,oe,f=>t(3,l=f)),ee(n,j,f=>t(0,o=f));function r(f){let _=parseInt(f.split(",")[0]),u=parseInt(f.split(",")[1]);Y(oe,l.x=_,l),Y(oe,l.y=u,l),Y(oe,l.visible=!0,l)}return[o,r,f=>{r(f.plot)}]}class $n extends Ge{constructor(e){super(),Ae(this,e,bo,vo,Me,{})}}const dn={0:"Easy",1:"Normal",2:"Hard"};function _n(n){let e,t,l,o=me[n[0].endGoal].short_title+"",r,i,f,_,u,p,m,h,k,b,C,O,N,q=n[0].endGoal=="land"&&mn(n);return{c(){e=c("div"),t=c("div"),l=v("HOW TO PLAY ("),r=v(o),i=v(`)
			`),f=c("br"),_=y(),u=c("hr"),p=y(),q&&q.c(),m=y(),h=c("br"),k=y(),b=c("hr"),C=y(),O=c("br"),N=v(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(M,H){I(M,e,H),a(e,t),a(t,l),a(t,r),a(t,i),a(t,f),a(t,_),a(t,u),a(t,p),q&&q.m(t,null),a(t,m),a(t,h),a(t,k),a(t,b),a(t,C),a(t,O),a(t,N)},p(M,H){H&1&&o!==(o=me[M[0].endGoal].short_title+"")&&F(r,o),M[0].endGoal=="land"?q?q.p(M,H):(q=mn(M),q.c(),q.m(t,m)):q&&(q.d(1),q=null)},d(M){M&&w(e),q&&q.d()}}}function mn(n){let e=me[n[0].endGoal].description_title+"",t,l,o,r,i,f,_=dn[n[0].difficulty]+"",u,p,m,h,k,b,C,O,N=JSON.stringify(me.land.requirements[n[0].difficulty].population_count)+"",q,M,H,E,s,$,g=JSON.stringify(me.land.requirements[n[0].difficulty].happiness)+"",L,B,T,P,J,z,R=JSON.stringify(me.land.requirements[n[0].difficulty].health)+"",Q,ae,K,A,X,te,le=JSON.stringify(me.land.requirements[n[0].difficulty].employment*100)+"",he,Ce;return{c(){t=v(e),l=y(),o=c("br"),r=y(),i=c("br"),f=v(`
				With your difficulty (`),u=v(_),p=v(`), you must
				also have:
				`),m=c("br"),h=y(),k=c("br"),b=y(),C=c("li"),O=v("Population: "),q=v(N),M=y(),H=c("br"),E=y(),s=c("li"),$=v("Happiness: "),L=v(g),B=y(),T=c("br"),P=y(),J=c("li"),z=v("Health: "),Q=v(R),ae=y(),K=c("br"),A=y(),X=c("li"),te=v("Employment at "),he=v(le),Ce=v("%")},m(S,D){I(S,t,D),I(S,l,D),I(S,o,D),I(S,r,D),I(S,i,D),I(S,f,D),I(S,u,D),I(S,p,D),I(S,m,D),I(S,h,D),I(S,k,D),I(S,b,D),I(S,C,D),a(C,O),a(C,q),I(S,M,D),I(S,H,D),I(S,E,D),I(S,s,D),a(s,$),a(s,L),I(S,B,D),I(S,T,D),I(S,P,D),I(S,J,D),a(J,z),a(J,Q),I(S,ae,D),I(S,K,D),I(S,A,D),I(S,X,D),a(X,te),a(X,he),a(X,Ce)},p(S,D){D&1&&e!==(e=me[S[0].endGoal].description_title+"")&&F(t,e),D&1&&_!==(_=dn[S[0].difficulty]+"")&&F(u,_),D&1&&N!==(N=JSON.stringify(me.land.requirements[S[0].difficulty].population_count)+"")&&F(q,N),D&1&&g!==(g=JSON.stringify(me.land.requirements[S[0].difficulty].happiness)+"")&&F(L,g),D&1&&R!==(R=JSON.stringify(me.land.requirements[S[0].difficulty].health)+"")&&F(Q,R),D&1&&le!==(le=JSON.stringify(me.land.requirements[S[0].difficulty].employment*100)+"")&&F(he,le)},d(S){S&&w(t),S&&w(l),S&&w(o),S&&w(r),S&&w(i),S&&w(f),S&&w(u),S&&w(p),S&&w(m),S&&w(h),S&&w(k),S&&w(b),S&&w(C),S&&w(M),S&&w(H),S&&w(E),S&&w(s),S&&w(B),S&&w(T),S&&w(P),S&&w(J),S&&w(ae),S&&w(K),S&&w(A),S&&w(X)}}}function yo(n){let e,t=n[2]&&n[0]!=null&&n[1]&&_n(n);return{c(){t&&t.c(),e=xe()},m(l,o){t&&t.m(l,o),I(l,e,o)},p(l,[o]){l[2]&&l[0]!=null&&l[1]?t?t.p(l,o):(t=_n(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Z,o:Z,d(l){t&&t.d(l),l&&w(e)}}}function wo(n,e,t){let l;ee(n,j,i=>t(0,l=i));let o=!0,r=!1;return n.$$.update=()=>{n.$$.dirty&1&&(l?t(2,r=!0):t(2,r=!1))},[l,o,r]}class ko extends Ge{constructor(e){super(),Ae(this,e,wo,yo,Me,{})}}function hn(n){let e,t=n[1].townLog+"",l,o,r;return{c(){e=c("div"),l=v(t),d(e,"class","townLog message")},m(i,f){I(i,e,f),a(e,l),o||(r=x(e,"click",n[12]),o=!0)},p(i,f){f&2&&t!==(t=i[1].townLog+"")&&F(l,t)},d(i){i&&w(e),o=!1,r()}}}function gn(n){let e,t,l=n[1].townInfo.population_count-n[1].townInfo.employees+"",o,r;return{c(){e=c("span"),t=v("("),o=v(l),r=v(" unemployed)"),d(e,"class","text_ss gray")},m(i,f){I(i,e,f),a(e,t),a(e,o),a(e,r)},p(i,f){f&2&&l!==(l=i[1].townInfo.population_count-i[1].townInfo.employees+"")&&F(o,l)},d(i){i&&w(e)}}}function Io(n){let e,t,l=n[1].economy_and_laws.lastMonthProfit+"",o,r;return{c(){e=c("span"),t=v("("),o=v(l),r=v(")"),d(e,"class","text_s red")},m(i,f){I(i,e,f),a(e,t),a(e,o),a(e,r)},p(i,f){f&2&&l!==(l=i[1].economy_and_laws.lastMonthProfit+"")&&F(o,l)},d(i){i&&w(e)}}}function So(n){let e,t,l=n[1].economy_and_laws.lastMonthProfit+"",o,r;return{c(){e=c("span"),t=v("(+"),o=v(l),r=v(")"),d(e,"class","text_s green")},m(i,f){I(i,e,f),a(e,t),a(e,o),a(e,r)},p(i,f){f&2&&l!==(l=i[1].economy_and_laws.lastMonthProfit+"")&&F(o,l)},d(i){i&&w(e)}}}function Po(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=c("span"),l=v(t),d(e,"class","red")},m(o,r){I(o,e,r),a(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.happiness+"")&&F(l,t)},d(o){o&&w(e)}}}function qo(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=c("span"),l=v(t),d(e,"class","green")},m(o,r){I(o,e,r),a(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.happiness+"")&&F(l,t)},d(o){o&&w(e)}}}function Mo(n){let e;return{c(){e=c("span"),e.textContent="\u{1F44E}"},m(t,l){I(t,e,l)},d(t){t&&w(e)}}}function Co(n){let e;return{c(){e=c("span"),e.textContent="\u{1F44D}"},m(t,l){I(t,e,l)},d(t){t&&w(e)}}}function $o(n){let e;return{c(){e=c("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,l){I(t,e,l)},d(t){t&&w(e)}}}function Oo(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=c("span"),l=v(t),d(e,"class","red")},m(o,r){I(o,e,r),a(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.health+"")&&F(l,t)},d(o){o&&w(e)}}}function No(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=c("span"),l=v(t),d(e,"class","green")},m(o,r){I(o,e,r),a(e,l)},p(o,r){r&2&&t!==(t=o[1].townInfo.health+"")&&F(l,t)},d(o){o&&w(e)}}}function vn(n){let e;return{c(){e=c("span"),e.textContent="MAX",d(e,"class","yellow max_label svelte-vu26gz")},m(t,l){I(t,e,l)},d(t){t&&w(e)}}}function Lo(n){let e;return{c(){e=v("How to play")},m(t,l){I(t,e,l)},d(t){t&&w(e)}}}function To(n){let e;return{c(){e=v("Close")},m(t,l){I(t,e,l)},d(t){t&&w(e)}}}function bn(n){let e,t;return e=new ko({}),{c(){Te(e.$$.fragment)},m(l,o){Oe(e,l,o),t=!0},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){Ne(e,l)}}}function yn(n){let e,t;return e=new $n({}),{c(){Te(e.$$.fragment)},m(l,o){Oe(e,l,o),t=!0},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){Ne(e,l)}}}function Bo(n){let e,t,l,o=n[1].townInfo.name+"",r,i,f,_,u,p,m,h,k,b,C,O,N,q,M,H,E,s,$,g,L,B=n[1].townInfo.population_count+"",T,P,J=n[1].townInfo.population_max+"",z,R,Q,ae,K,A,X=n[1].townInfo.employees+"",te,le,he=n[1].townInfo.population_count+"",Ce,S,D,ge,ze,re,fe,ce,ue,et=n[1].townInfo.knowledge_points+"",Ye,Se,He,We,Pe,ne,ve=n[1].townInfo.gold+"",ie,ol,il,sl,al,tt,St,rl,vt,fl,Pt=n[1].townInfo.gold_from_tourism+"",Rt,ul,st,qt,pl,De,Jt,at,cl,Mt=je(n[1].modifiers.happiness,2)+"",Ut,dl,_l,ml,rt,Ct,hl,Fe,jt,ft,gl,$t=je(n[1].modifiers.health,2)+"",Wt,vl,bl,yl,lt,nt,wl,kl,Il,Sl,Ve,Ot,Pl,Le,ql,Ke,ut,Ml,pt,Nt=(n[1].economy_and_laws.tax_rate*100).toFixed(0)+"",Yt,Cl,$l,ct,Vt,bt,yt,pe,Kt,Ol,be=n[1].townLog.length>0&&hn(n),ye=n[1].townInfo.population_count-n[1].townInfo.employees>0&&gn(n);function Nl(G,W){if(G[1].economy_and_laws.lastMonthProfit>=0)return So;if(G[1].economy_and_laws.lastMonthProfit<0)return Io}let dt=Nl(n),we=dt&&dt(n);function Ll(G,W){return G[1].townInfo.happiness>=50?qo:Po}let Lt=Ll(n),Re=Lt(n);function Tl(G,W){if(G[1].townInfo.happiness>=300)return $o;if(G[1].townInfo.happiness>=150)return Co;if(G[1].townInfo.happiness<150)return Mo}let _t=Tl(n),$e=_t&&_t(n);function Bl(G,W){return G[1].townInfo.health>=50?No:Oo}let Tt=Bl(n),Je=Tt(n),qe=n[1].townInfo.health>=300&&vn();function El(G,W){return G[5]?To:Lo}let Bt=El(n),Xe=Bt(n),de=n[5]&&bn(),_e=n[6]&&yn();return{c(){e=c("div"),t=c("div"),l=c("div"),r=v(o),i=y(),f=c("div"),f.textContent="double click to change name",_=y(),u=c("div"),p=c("span"),p.textContent="\u23EA",m=y(),h=c("span"),h.textContent="\u23E9",k=y(),b=v(n[0]),C=v("x - year "),O=v(n[2]),N=v(" day "),q=v(n[3]),M=y(),be&&be.c(),H=y(),E=c("div"),s=c("div"),$=c("div"),$.textContent="\u{1F46A} Population",g=y(),L=c("div"),T=v(B),P=v("/"),z=v(J),R=y(),Q=c("div"),ae=c("div"),ae.textContent="\u{1F9D1}\u200D\u{1F33E} Employees",K=y(),A=c("div"),te=v(X),le=v("/"),Ce=v(he),S=y(),D=c("br"),ge=y(),ye&&ye.c(),ze=y(),re=c("div"),fe=c("div"),fe.textContent="\u{1F9E0} Knowledge",ce=y(),ue=c("div"),Ye=v(et),Se=y(),He=c("div"),We=c("div"),We.textContent="\u{1F4B0} Gold",Pe=y(),ne=c("div"),ie=v(ve),ol=y(),il=c("br"),sl=y(),we&&we.c(),al=y(),tt=c("div"),St=c("div"),St.textContent="\u{1F4B0} Tourism Gold",rl=y(),vt=c("div"),fl=v("$"),Rt=v(Pt),ul=y(),st=c("div"),qt=c("div"),qt.textContent="\u{1F601} Happiness",pl=y(),De=c("div"),Re.c(),Jt=y(),at=c("span"),cl=v("("),Ut=v(Mt),dl=v(")"),_l=y(),$e&&$e.c(),ml=y(),rt=c("div"),Ct=c("div"),Ct.textContent="\u{1F3E5} Health",hl=y(),Fe=c("div"),Je.c(),jt=y(),ft=c("span"),gl=v("("),Wt=v($t),vl=v(")"),bl=y(),qe&&qe.c(),yl=y(),lt=c("div"),nt=c("div"),wl=v("\u{1F3C6} "),Xe.c(),kl=y(),Il=c("br"),Sl=y(),Ve=c("div"),Ot=c("div"),Ot.textContent="Tax rate (more tax = less happiness)",Pl=y(),Le=c("input"),ql=y(),Ke=c("div"),ut=c("button"),ut.textContent="-",Ml=y(),pt=c("div"),Yt=v(Nt),Cl=v("%"),$l=y(),ct=c("button"),ct.textContent="+",Vt=y(),de&&de.c(),bt=y(),_e&&_e.c(),yt=xe(),d(l,"class","heading_l"),d(f,"class","subheading_m svelte-vu26gz"),d(t,"class","header__left svelte-vu26gz"),d($,"class","subheading_m svelte-vu26gz"),d(L,"class","text_m svelte-vu26gz"),d(s,"class","svelte-vu26gz"),d(ae,"class","subheading_m svelte-vu26gz"),d(A,"class","text_m svelte-vu26gz"),d(Q,"class","svelte-vu26gz"),d(fe,"class","subheading_m svelte-vu26gz"),d(ue,"class","text_m svelte-vu26gz"),d(re,"class","svelte-vu26gz"),d(We,"class","subheading_m svelte-vu26gz"),d(ne,"class","text_m svelte-vu26gz"),d(He,"class","svelte-vu26gz"),d(St,"class","subheading_m svelte-vu26gz"),d(vt,"class","text_m svelte-vu26gz"),d(tt,"class","svelte-vu26gz"),d(qt,"class","subheading_m svelte-vu26gz"),d(at,"class","text_ss gray"),d(De,"class","text_m svelte-vu26gz"),d(st,"class","svelte-vu26gz"),d(Ct,"class","subheading_m svelte-vu26gz"),d(ft,"class","text_ss gray"),d(Fe,"class","text_m svelte-vu26gz"),d(rt,"class","svelte-vu26gz"),d(E,"class","header__right svelte-vu26gz"),d(nt,"class","text_m pointer"),d(Ot,"class","subheading_m svelte-vu26gz"),d(Le,"type","range"),d(Le,"min","0"),d(Le,"max","1"),d(Le,"step","0.01"),d(pt,"class","text_m"),d(Ke,"class","incrementalButtons svelte-vu26gz"),d(Ve,"class","taxInfo svelte-vu26gz"),d(e,"class","header noselect svelte-vu26gz")},m(G,W){I(G,e,W),a(e,t),a(t,l),a(l,r),a(t,i),a(t,f),a(t,_),a(t,u),a(u,p),a(u,m),a(u,h),a(u,k),a(u,b),a(u,C),a(u,O),a(u,N),a(u,q),a(t,M),be&&be.m(t,null),a(e,H),a(e,E),a(E,s),a(s,$),a(s,g),a(s,L),a(L,T),a(L,P),a(L,z),a(E,R),a(E,Q),a(Q,ae),a(Q,K),a(Q,A),a(A,te),a(A,le),a(A,Ce),a(A,S),a(A,D),a(A,ge),ye&&ye.m(A,null),a(E,ze),a(E,re),a(re,fe),a(re,ce),a(re,ue),a(ue,Ye),a(E,Se),a(E,He),a(He,We),a(He,Pe),a(He,ne),a(ne,ie),a(ne,ol),a(ne,il),a(ne,sl),we&&we.m(ne,null),a(E,al),a(E,tt),a(tt,St),a(tt,rl),a(tt,vt),a(vt,fl),a(vt,Rt),a(E,ul),a(E,st),a(st,qt),a(st,pl),a(st,De),Re.m(De,null),a(De,Jt),a(De,at),a(at,cl),a(at,Ut),a(at,dl),a(De,_l),$e&&$e.m(De,null),a(E,ml),a(E,rt),a(rt,Ct),a(rt,hl),a(rt,Fe),Je.m(Fe,null),a(Fe,jt),a(Fe,ft),a(ft,gl),a(ft,Wt),a(ft,vl),a(Fe,bl),qe&&qe.m(Fe,null),a(e,yl),a(e,lt),a(lt,nt),a(nt,wl),Xe.m(nt,null),a(lt,kl),a(lt,Il),a(lt,Sl),a(lt,Ve),a(Ve,Ot),a(Ve,Pl),a(Ve,Le),Gl(Le,n[1].economy_and_laws.tax_rate),a(Ve,ql),a(Ve,Ke),a(Ke,ut),a(Ke,Ml),a(Ke,pt),a(pt,Yt),a(pt,Cl),a(Ke,$l),a(Ke,ct),I(G,Vt,W),de&&de.m(G,W),I(G,bt,W),_e&&_e.m(G,W),I(G,yt,W),pe=!0,Kt||(Ol=[x(l,"dblclick",n[7]),x(p,"click",n[8]),x(h,"click",n[9]),x(He,"click",n[13]),x(tt,"click",n[14]),x(nt,"click",n[15]),x(Le,"change",n[16]),x(Le,"input",n[16]),x(Le,"change",n[10]),x(ut,"mousedown",n[17]),x(ut,"mouseup",n[18]),x(ut,"click",n[19]),x(pt,"dblclick",n[20]),x(ct,"mousedown",n[21]),x(ct,"mouseup",n[22]),x(ct,"click",n[23])],Kt=!0)},p(G,[W]){(!pe||W&2)&&o!==(o=G[1].townInfo.name+"")&&F(r,o),(!pe||W&1)&&F(b,G[0]),(!pe||W&4)&&F(O,G[2]),(!pe||W&8)&&F(q,G[3]),G[1].townLog.length>0?be?be.p(G,W):(be=hn(G),be.c(),be.m(t,null)):be&&(be.d(1),be=null),(!pe||W&2)&&B!==(B=G[1].townInfo.population_count+"")&&F(T,B),(!pe||W&2)&&J!==(J=G[1].townInfo.population_max+"")&&F(z,J),(!pe||W&2)&&X!==(X=G[1].townInfo.employees+"")&&F(te,X),(!pe||W&2)&&he!==(he=G[1].townInfo.population_count+"")&&F(Ce,he),G[1].townInfo.population_count-G[1].townInfo.employees>0?ye?ye.p(G,W):(ye=gn(G),ye.c(),ye.m(A,null)):ye&&(ye.d(1),ye=null),(!pe||W&2)&&et!==(et=G[1].townInfo.knowledge_points+"")&&F(Ye,et),(!pe||W&2)&&ve!==(ve=G[1].townInfo.gold+"")&&F(ie,ve),dt===(dt=Nl(G))&&we?we.p(G,W):(we&&we.d(1),we=dt&&dt(G),we&&(we.c(),we.m(ne,null))),(!pe||W&2)&&Pt!==(Pt=G[1].townInfo.gold_from_tourism+"")&&F(Rt,Pt),Lt===(Lt=Ll(G))&&Re?Re.p(G,W):(Re.d(1),Re=Lt(G),Re&&(Re.c(),Re.m(De,Jt))),(!pe||W&2)&&Mt!==(Mt=je(G[1].modifiers.happiness,2)+"")&&F(Ut,Mt),_t!==(_t=Tl(G))&&($e&&$e.d(1),$e=_t&&_t(G),$e&&($e.c(),$e.m(De,null))),Tt===(Tt=Bl(G))&&Je?Je.p(G,W):(Je.d(1),Je=Tt(G),Je&&(Je.c(),Je.m(Fe,jt))),(!pe||W&2)&&$t!==($t=je(G[1].modifiers.health,2)+"")&&F(Wt,$t),G[1].townInfo.health>=300?qe||(qe=vn(),qe.c(),qe.m(Fe,null)):qe&&(qe.d(1),qe=null),Bt!==(Bt=El(G))&&(Xe.d(1),Xe=Bt(G),Xe&&(Xe.c(),Xe.m(nt,null))),W&2&&Gl(Le,G[1].economy_and_laws.tax_rate),(!pe||W&2)&&Nt!==(Nt=(G[1].economy_and_laws.tax_rate*100).toFixed(0)+"")&&F(Yt,Nt),G[5]?de?W&32&&U(de,1):(de=bn(),de.c(),U(de,1),de.m(bt.parentNode,bt)):de&&(Be(),V(de,1,1,()=>{de=null}),Ee()),G[6]?_e?W&64&&U(_e,1):(_e=yn(),_e.c(),U(_e,1),_e.m(yt.parentNode,yt)):_e&&(Be(),V(_e,1,1,()=>{_e=null}),Ee())},i(G){pe||(U(de),U(_e),pe=!0)},o(G){V(de),V(_e),pe=!1},d(G){G&&w(e),be&&be.d(),ye&&ye.d(),we&&we.d(),Re.d(),$e&&$e.d(),Je.d(),qe&&qe.d(),Xe.d(),G&&w(Vt),de&&de.d(G),G&&w(bt),_e&&_e.d(G),G&&w(yt),Kt=!1,Ze(Ol)}}}function je(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Eo(n,e,t){let l,o,r;ee(n,j,P=>t(1,l=P)),ee(n,Ht,P=>t(24,o=P)),ee(n,zt,P=>t(6,r=P));let i=Math.floor(l.environment.day/365)+1,f=l.environment.day%365;function _(){let P=prompt("Enter a new name for your town (under 200 chars)");if(P&&P.length<200){let J=l;J.townInfo.name=P,j.set(J),localStorage.setItem(Ie,JSON.stringify(J))}}let{speedMultiplier:u=1}=e;function p(){let P=o;P=P*2,P>=8e3&&(P=8e3),Y(Ht,o=P,o),t(0,u=2e3/o)}function m(){let P=o;P=P/2,P<=250&&(P=250),Y(Ht,o=P,o),t(0,u=2e3/o)}function h(P){let J=l;J.economy_and_laws.tax_rate=je(P.target.value,2),j.set(J),localStorage.setItem(Ie,JSON.stringify(J))}function k(){let P=l;P.hasABank===!0?(P.townInfo.gold+=P.townInfo.gold_from_tourism,P.townInfo.gold_from_tourism=0,j.set(P),localStorage.setItem(Ie,JSON.stringify(P))):alert("You need a bank to transfer funds from tourism activities.")}document.addEventListener("keydown",P=>{switch(P.key.toLowerCase()){case"1":P.preventDefault(),p();break;case"2":P.preventDefault(),m();break}});let b,C=!1;const O=()=>{Y(j,l.townLog="",l)},N=()=>{let P=r;P=!P,zt.set(P)},q=()=>{k()},M=()=>t(5,C=!C);function H(){l.economy_and_laws.tax_rate=Tn(this.value),j.set(l)}const E=()=>{t(4,b=setInterval(()=>{let P=l;P.economy_and_laws.tax_rate=je(P.economy_and_laws.tax_rate-.01,2),j.set(P),localStorage.setItem(Ie,JSON.stringify(P))},100))},s=()=>{clearInterval(b)},$=()=>{let P=l;P.economy_and_laws.tax_rate=je(P.economy_and_laws.tax_rate-.01,2)},g=()=>{let P=parseFloat(prompt("Set a new tax rate (0-1)"));if(P&&P>=0&&P<=1){let J=l;J.economy_and_laws.tax_rate=je(P,2),j.set(J),localStorage.setItem(Ie,JSON.stringify(J))}},L=()=>{t(4,b=setInterval(()=>{let P=l;P.economy_and_laws.tax_rate=je(P.economy_and_laws.tax_rate+.01,2),j.set(P),localStorage.setItem(Ie,JSON.stringify(P))},100))},B=()=>{clearInterval(b)},T=()=>{let P=l;P.economy_and_laws.tax_rate=je(P.economy_and_laws.tax_rate+.01,2),j.set(P),localStorage.setItem(Ie,JSON.stringify(P))};return n.$$set=P=>{"speedMultiplier"in P&&t(0,u=P.speedMultiplier)},n.$$.update=()=>{n.$$.dirty&2&&(t(2,i=Math.floor(l.environment.day/365)+1),t(3,f=l.environment.day%365))},[u,l,i,f,b,C,r,_,p,m,h,k,O,N,q,M,H,E,s,$,g,L,B,T]}class Ao extends Ge{constructor(e){super(),Ae(this,e,Eo,Bo,Me,{speedMultiplier:0})}}function Go(n){let e,t,l,o,r,i,f,_,u,p,m,h,k,b,C,O,N,q,M;return{c(){e=c("div"),t=c("div"),l=v(`The game is paused!
		`),o=c("br"),r=v(`
		Load file:
		`),i=c("input"),f=y(),_=c("br"),u=v(`
		Backup save:
		`),p=c("button"),p.textContent="Save",m=y(),h=c("br"),k=v(`
		Unpause the game by pressing P
		`),b=c("br"),C=y(),O=c("br"),N=v(`
		Reset the game by pressing SHIFT+ESC`),d(i,"type","file"),d(i,"id","upload"),d(p,"id","save"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(H,E){I(H,e,E),a(e,t),a(t,l),a(t,o),a(t,r),a(t,i),a(t,f),a(t,_),a(t,u),a(t,p),a(t,m),a(t,h),a(t,k),a(t,b),a(t,C),a(t,O),a(t,N),q||(M=[x(i,"change",n[1]),x(p,"click",n[0])],q=!0)},p:Z,i:Z,o:Z,d(H){H&&w(e),q=!1,Ze(M)}}}function Ho(n){const e=JSON.parse(n);return e.townInfo!=null&&e.difficulty!=null}function Do(n,e,t){let l;ee(n,j,i=>t(2,l=i));function o(){const i=JSON.stringify(l),f=new Blob([i],{type:"text/plain"}),_=URL.createObjectURL(f),u=document.createElement("a");u.href=_,u.download=`${new Date().toISOString()}.json`,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(_)}function r(){const f=document.getElementById("upload").files[0],_=new FileReader;_.onload=function(u){const p=u.target.result;if(typeof p=="string"){if(!Ho(p)){alert("Invalid game file");return}nl(JSON.parse(p))}else alert("Invalid game file: is not String.")},_.readAsText(f)}return[o,r]}class Fo extends Ge{constructor(e){super(),Ae(this,e,Do,Go,Me,{})}}function wn(n){let e,t,l,o,r,i=n[0].endGameDetails.msg+"",f,_,u,p,m,h;return{c(){e=c("div"),t=c("div"),l=v(`GAME OVER
			`),o=c("br"),r=y(),f=v(i),_=y(),u=c("br"),p=y(),m=c("br"),h=v(`
			Reset the game by pressing SHIFT+ESC`),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(k,b){I(k,e,b),a(e,t),a(t,l),a(t,o),a(t,r),a(t,f),a(t,_),a(t,u),a(t,p),a(t,m),a(t,h)},p(k,b){b&1&&i!==(i=k[0].endGameDetails.msg+"")&&F(f,i)},d(k){k&&w(e)}}}function Ro(n){let e,t=n[0].endGameDetails!=null&&wn(n);return{c(){t&&t.c(),e=xe()},m(l,o){t&&t.m(l,o),I(l,e,o)},p(l,[o]){l[0].endGameDetails!=null?t?t.p(l,o):(t=wn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Z,o:Z,d(l){t&&t.d(l),l&&w(e)}}}function Jo(n,e,t){let l;return ee(n,j,o=>t(0,l=o)),[l]}class Uo extends Ge{constructor(e){super(),Ae(this,e,Jo,Ro,Me,{})}}function jo(n){let e,t,l,o,r,i,f,_,u,p,m,h,k,b,C,O,N,q,M,H,E;return{c(){e=c("div"),t=c("div"),l=v(`Welcome to Plots!
		`),o=c("br"),r=v(`
		Select a difficulty
		`),i=c("select"),f=c("option"),f.textContent="Easy (quick game)",_=c("option"),_.textContent="Normal (longer game)",u=c("option"),u.textContent="Hard (longest game)",p=y(),m=c("br"),h=v(`
		Select a goal
		`),k=c("select"),b=c("option"),b.textContent="Fill up the grid",C=c("option"),C.textContent="Rule the world through politics",O=y(),N=c("br"),q=y(),M=c("button"),M.textContent="Start game",f.__value="0",f.value=f.__value,_.__value="1",_.value=_.__value,_.selected=!0,u.__value="2",u.value=u.__value,d(i,"id","difficulty"),b.__value="land",b.value=b.__value,b.selected=!0,C.__value="political",C.value=C.__value,d(k,"id","endGoal"),d(t,"class","dialog-content svelte-2ih7px"),d(e,"class","dialog svelte-2ih7px")},m(s,$){I(s,e,$),a(e,t),a(t,l),a(t,o),a(t,r),a(t,i),a(i,f),a(i,_),a(i,u),a(t,p),a(t,m),a(t,h),a(t,k),a(k,b),a(k,C),a(t,O),a(t,N),a(t,q),a(t,M),H||(E=x(M,"click",n[0]),H=!0)},p:Z,i:Z,o:Z,d(s){s&&w(e),H=!1,E()}}}function Wo(n){function e(){const t=document.getElementById("difficulty").value,l=document.getElementById("endGoal").value;Jn(t,l)}return[e]}class Yo extends Ge{constructor(e){super(),Ae(this,e,Wo,jo,Me,{})}}function kn(n){let e,t,l,o;const r=[Ko,Vo],i=[];function f(_,u){return _[0]==null?0:1}return e=f(n),t=i[e]=r[e](n),{c(){t.c(),l=xe()},m(_,u){i[e].m(_,u),I(_,l,u),o=!0},p(_,u){let p=e;e=f(_),e===p?i[e].p(_,u):(Be(),V(i[p],1,1,()=>{i[p]=null}),Ee(),t=i[e],t?t.p(_,u):(t=i[e]=r[e](_),t.c()),U(t,1),t.m(l.parentNode,l))},i(_){o||(U(t),o=!0)},o(_){V(t),o=!1},d(_){i[e].d(_),_&&w(l)}}}function Vo(n){let e,t,l,o,r,i,f,_,u,p,m,h,k,b,C,O,N=n[2]==!0&&In(),q=n[3]==!0&&Sn();return l=new Ao({}),r=new Zn({}),f=new Uo({}),p=new mo({}),{c(){N&&N.c(),e=y(),q&&q.c(),t=y(),Te(l.$$.fragment),o=y(),Te(r.$$.fragment),i=y(),Te(f.$$.fragment),_=y(),u=c("div"),Te(p.$$.fragment),m=y(),h=c("br"),k=v(`
			outside of city`),b=y(),C=c("style"),C.textContent=`.plot_grid {
				max-width: 300%;
				max-height: 300%;
				overflow-x: scroll;
				overflow-y: scroll;
				width: 300%;
				height: 300vh;
				margin-top: 175px;
			}
			.plot_grid[data-marginRight='true'] {
				/* This is for when the balanceSheet is being shown. */
				margin-right: 224px;
			}`,d(u,"class","plot_grid"),d(u,"data-marginright",n[3])},m(M,H){N&&N.m(M,H),I(M,e,H),q&&q.m(M,H),I(M,t,H),Oe(l,M,H),I(M,o,H),Oe(r,M,H),I(M,i,H),Oe(f,M,H),I(M,_,H),I(M,u,H),Oe(p,u,null),a(u,m),a(u,h),a(u,k),I(M,b,H),I(M,C,H),O=!0},p(M,H){M[2]==!0?N?H&4&&U(N,1):(N=In(),N.c(),U(N,1),N.m(e.parentNode,e)):N&&(Be(),V(N,1,1,()=>{N=null}),Ee()),M[3]==!0?q?H&8&&U(q,1):(q=Sn(),q.c(),U(q,1),q.m(t.parentNode,t)):q&&(Be(),V(q,1,1,()=>{q=null}),Ee()),(!O||H&8)&&d(u,"data-marginright",M[3])},i(M){O||(U(N),U(q),U(l.$$.fragment,M),U(r.$$.fragment,M),U(f.$$.fragment,M),U(p.$$.fragment,M),O=!0)},o(M){V(N),V(q),V(l.$$.fragment,M),V(r.$$.fragment,M),V(f.$$.fragment,M),V(p.$$.fragment,M),O=!1},d(M){N&&N.d(M),M&&w(e),q&&q.d(M),M&&w(t),Ne(l,M),M&&w(o),Ne(r,M),M&&w(i),Ne(f,M),M&&w(_),M&&w(u),Ne(p),M&&w(b),M&&w(C)}}}function Ko(n){let e,t;return e=new Yo({}),{c(){Te(e.$$.fragment)},m(l,o){Oe(e,l,o),t=!0},p:Z,i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){Ne(e,l)}}}function In(n){let e,t;return e=new Fo({}),{c(){Te(e.$$.fragment)},m(l,o){Oe(e,l,o),t=!0},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){Ne(e,l)}}}function Sn(n){let e,t;return e=new $n({}),{c(){Te(e.$$.fragment)},m(l,o){Oe(e,l,o),t=!0},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){Ne(e,l)}}}function Xo(n){let e,t,l=(n[1]||n[0]==null)&&kn(n);return{c(){l&&l.c(),e=xe()},m(o,r){l&&l.m(o,r),I(o,e,r),t=!0},p(o,[r]){o[1]||o[0]==null?l?(l.p(o,r),r&3&&U(l,1)):(l=kn(o),l.c(),U(l,1),l.m(e.parentNode,e)):l&&(Be(),V(l,1,1,()=>{l=null}),Ee())},i(o){t||(U(l),t=!0)},o(o){V(l),t=!1},d(o){l&&l.d(o),o&&w(e)}}}function Qo(n,e,t){let l,o,r,i,f;ee(n,gt,h=>t(6,l=h)),ee(n,oe,h=>t(7,o=h)),ee(n,ht,h=>t(2,r=h)),ee(n,j,h=>t(0,i=h)),ee(n,zt,h=>t(3,f=h));let _=!1,u=!1;document.addEventListener("keydown",h=>{if((document.activeElement.nodeName==="INPUT"||document.activeElement.nodeName=="TEXTAREA")&&h.key!=="Escape")return;switch(h.key.toLowerCase()){case"p":r==!0?ht.set(!1):(ht.set(!0),Y(oe,o.visible=!1,o));break;case"escape":h.shiftKey?(Y(ht,r=!0,r),localStorage.setItem("reset","true"),location.reload(),nl()):o.visible==!0&&Y(oe,o.visible=!1,o);break;case"arrowleft":case"a":h.preventDefault(),p(0,-1,"up");break;case"arrowright":case"d":h.preventDefault(),p(0,1,"down");break;case"arrowup":case"w":h.preventDefault(),p(-1,0,"left");break;case"arrowdown":case"s":h.preventDefault(),p(1,0,"right");break}});function p(h,k,b){if(o.visible===!1&&o.x===0&&o.y===0)m(0,0,b);else{let C=o.x,O=o.y;C+h<0?C=0:C+h>i.plots.length?C=i.plots.length:C+=h,O+k<0?O=0:O+k>i.plots.length?O=i.plots.length:O+=k,m(C,O,b)}}function m(h,k,b){if(u==!0)switch(b){case"up":k-=2;break;case"down":k+=1;break;case"left":h-=2;break;case"right":h+=1;break}h<0?h=0:h>i.plots.length&&(h=i.plots.length),k<0?k=0:k>i.plots.length&&(k=i.plots.length);let C=document.querySelectorAll(".plot_container"),O;if(C.forEach(N=>{N.dataset.x==h&&N.dataset.y==k&&(O=N)}),r==!1){if(O.dataset.canBeUpgraded==="true"?Y(oe,o.visible=!0,o):Y(oe,o.visible=!1,o),O.dataset.refPlotX!==void 0&&O.dataset.refPlotY!=""?(u=!0,C.forEach(N=>{N.dataset.x==O.dataset.refPlotX&&N.dataset.y==O.dataset.refPlotY&&(O=N,h=parseInt(O.dataset.x),k=parseInt(O.dataset.y))})):u=!1,O.dataset.size!=="1"&&O.dataset.size!==void 0&&(u=!0),Y(oe,o.x=h,o),Y(oe,o.y=k,o),C.forEach(N=>{N.classList.remove("selected"),N.style.border="none",N.style.fontWeight=""}),O.classList.add("selected"),u){let N="4px solid #00800045";O.classList.remove("selected"),O.style.borderTop=N,O.style.borderLeft=N,O.style.fontWeight="600",C.forEach(q=>{q.dataset.x==h+1&&q.dataset.y==k&&(q.style.borderLeft=N,q.style.borderBottom=N),q.dataset.x==h&&q.dataset.y==k+1&&(q.style.borderTop=N,q.style.borderRight=N),q.dataset.x==h+1&&q.dataset.y==k+1&&(q.style.borderBottom=N,q.style.borderRight=N)})}O.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),Y(gt,l={},l)}}return n.$$.update=()=>{n.$$.dirty&1&&(i?t(1,_=!0):t(1,_=!1))},[i,_,r,f,m]}class Zo extends Ge{constructor(e){super(),Ae(this,e,Qo,Xo,Me,{openPlotMenu:4})}get openPlotMenu(){return this.$$.ctx[4]}}new Zo({target:document.getElementById("app")});
