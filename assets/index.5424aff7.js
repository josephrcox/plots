(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function Z(){}function kn(n){return n()}function Nl(){return Object.create(null)}function nt(n){n.forEach(kn)}function Mn(n){return typeof n=="function"}function Me(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function $n(n){return Object.keys(n).length===0}function Cn(n,...e){if(n==null)return Z;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function oe(n,e,t){n.$$.on_destroy.push(Cn(e,t))}function V(n,e,t){return n.set(t),e}function a(n,e){n.appendChild(e)}function k(n,e,t){n.insertBefore(e,t||null)}function w(n){n.parentNode.removeChild(n)}function el(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function u(n){return document.createElement(n)}function g(n){return document.createTextNode(n)}function y(){return g(" ")}function je(){return g("")}function ee(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function c(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function On(n){return n===""?null:+n}function Bn(n){return Array.from(n.childNodes)}function D(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function Tl(n,e){n.value=e==null?"":e}let It;function wt(n){It=n}function Nn(){if(!It)throw new Error("Function called outside component initialization");return It}function Gt(n){Nn().$$.on_mount.push(n)}const yt=[],Xt=[],Et=[],Ll=[],In=Promise.resolve();let Qt=!1;function qn(){Qt||(Qt=!0,In.then(zn))}function Tn(){return qn(),In}function Zt(n){Et.push(n)}const Kt=new Set;let Lt=0;function zn(){const n=It;do{for(;Lt<yt.length;){const e=yt[Lt];Lt++,wt(e),Ln(e.$$)}for(wt(null),yt.length=0,Lt=0;Xt.length;)Xt.pop()();for(let e=0;e<Et.length;e+=1){const t=Et[e];Kt.has(t)||(Kt.add(t),t())}Et.length=0}while(yt.length);for(;Ll.length;)Ll.pop()();Qt=!1,Kt.clear(),wt(n)}function Ln(n){if(n.fragment!==null){n.update(),nt(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Zt)}}const At=new Set;let lt;function Te(){lt={r:0,c:[],p:lt}}function Le(){lt.r||nt(lt.c),lt=lt.p}function U(n,e){n&&n.i&&(At.delete(n),n.i(e))}function K(n,e,t,l){if(n&&n.o){if(At.has(n))return;At.add(n),lt.c.push(()=>{At.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function En(n,e){n.d(1),e.delete(n.key)}function An(n,e,t,l,i,s,o,r,_,f,p,d){let m=n.length,S=s.length,v=m;const $={};for(;v--;)$[n[v].key]=v;const O=[],B=new Map,C=new Map;for(v=S;v--;){const N=d(i,s,v),F=t(N);let z=o.get(F);z?l&&z.p(N,e):(z=f(F,N),z.c()),B.set(F,O[v]=z),F in $&&C.set(F,Math.abs(v-$[F]))}const M=new Set,G=new Set;function E(N){U(N,1),N.m(r,p),o.set(N.key,N),p=N.first,S--}for(;m&&S;){const N=O[S-1],F=n[m-1],z=N.key,h=F.key;N===F?(p=N.first,m--,S--):B.has(h)?!o.has(z)||M.has(z)?E(N):G.has(h)?m--:C.get(z)>C.get(h)?(G.add(z),E(N)):(M.add(h),m--):(_(F,o),m--)}for(;m--;){const N=n[m];B.has(N.key)||_(N,o)}for(;S;)E(O[S-1]);return O}function Ne(n){n&&n.c()}function Ce(n,e,t,l){const{fragment:i,on_mount:s,on_destroy:o,after_update:r}=n.$$;i&&i.m(e,t),l||Zt(()=>{const _=s.map(kn).filter(Mn);o?o.push(..._):nt(_),n.$$.on_mount=[]}),r.forEach(Zt)}function Oe(n,e){const t=n.$$;t.fragment!==null&&(nt(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Dn(n,e){n.$$.dirty[0]===-1&&(yt.push(n),qn(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Ee(n,e,t,l,i,s,o,r=[-1]){const _=It;wt(n);const f=n.$$={fragment:null,ctx:null,props:s,update:Z,not_equal:i,bound:Nl(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(_?_.$$.context:[])),callbacks:Nl(),dirty:r,skip_bound:!1,root:e.target||_.$$.root};o&&o(f.root);let p=!1;if(f.ctx=t?t(n,e.props||{},(d,m,...S)=>{const v=S.length?S[0]:m;return f.ctx&&i(f.ctx[d],f.ctx[d]=v)&&(!f.skip_bound&&f.bound[d]&&f.bound[d](v),p&&Dn(n,d)),m}):[],f.update(),p=!0,nt(f.before_update),f.fragment=l?l(f.ctx):!1,e.target){if(e.hydrate){const d=Bn(e.target);f.fragment&&f.fragment.l(d),d.forEach(w)}else f.fragment&&f.fragment.c();e.intro&&U(n.$$.fragment),Ce(n,e.target,e.anchor,e.customElement),zn()}wt(_)}class Ae{$destroy(){Oe(this,1),this.$destroy=Z}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const i=l.indexOf(t);i!==-1&&l.splice(i,1)}}$set(e){this.$$set&&!$n(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const _t=[];function ot(n,e=Z){let t;const l=new Set;function i(r){if(Me(n,r)&&(n=r,t)){const _=!_t.length;for(const f of l)f[1](),_t.push(f,n);if(_){for(let f=0;f<_t.length;f+=2)_t[f][0](_t[f+1]);_t.length=0}}}function s(r){i(r(n))}function o(r,_=Z){const f=[r,_];return l.add(f),l.size===1&&(t=e(i)||Z),r(n),()=>{l.delete(f),l.size===0&&(t(),t=null)}}return{set:i,update:s,subscribe:o}}const Gn={plots:[],lastChangeDay:0,townLog:"",townInfo:{name:"Your town",gold:1e3,gold_from_tourism:0,population_count:0,population_max:0,employees:0,happiness:100,health:100,knowledge_points:0},hasCityHall:!1,hasBank:!1,modifiers:{happiness:1,health:1},economy_and_laws:{tax_rate:0,max_tax_rate:1,balanceSheetHistory:[],lastMonthProfit:0},plotCounts:[],environment:{day:0,year:1,climate:-1},difficulty:0,endGoal:"land",endGameDetails:null},Ie="plots_db_v2";let W=ot(JSON.parse(localStorage.getItem(Ie))||null);function Hn(n,e){let t={...Gn};t.economy_and_laws.max_tax_rate=Math.random()*(.5-.2)+.2,t.endGoal=e;let l=[];const i=n=="0"?6:n=="1"?Math.floor(Math.random()*4)+7:n=="2"?Math.floor(Math.random()*9)+12:35;for(let s=0;s<i;s++){l.push([]);for(let o=0;o<i;o++)l[s][o]={id:Math.random().toString(36).substring(2,9),active:!1,x:s,y:o,type:-1}}t.plots=l,localStorage.reset=!1,localStorage.setItem(Ie,JSON.stringify(t)),W.set(t),location.reload()}function Sn(){console.log("RELOADING"),localStorage.removeItem(Ie),W.set(null),location.reload()}let ie=ot({visible:!1,x:0,y:0}),mt=ot({}),kt=ot(!1),xt=ot(!1),Dt=ot(2e3);ot(localStorage.getItem("showUnaffordablePlotOptions")==="true");const se=[{id:"res_small",title:"\u{1F3E0} Residential (small)",subtitle:"for living",type:"residential",description:"A few basic homes that can hold 16 people.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:16},styling:"background-color: #e15f00"},{id:"res_medium",title:"\u{1F3D8}\uFE0F Residential (medium)",subtitle:"for living",type:"residential",description:"A few high-density buildings that can hold 64 people.",revenue_per_week:0,requirements:{gold:500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:64},styling:"background-color: #e15f00"},{id:"res_large",title:"\u{1F3E2} Residential (large)",subtitle:"for living",type:"residential",description:"Many high-density buildings that can hold 256 people.",revenue_per_week:0,requirements:{gold:1500,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1,health:1},immediate_variable_changes:{happiness:0,health:0,population:256},styling:"background-color: #e15f00"},{id:"cafe",title:"\u2615\uFE0F Small caf\xE9",subtitle:"for recreation & food",type:"food",description:"Great for eating & relaxing, not great for long-term health.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:16,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:.95},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #d24646;"},{id:"carrot_farm",title:"\u{1F955} Carrot farm",subtitle:"for farming",type:"farm",description:"Farm for making carrots, makes money by selling them.",revenue_per_week:6,requirements:{gold:25,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"apple_orchard",title:"\u{1F34E} Apple orchard",subtitle:"for farming",type:"farm",description:"A bunch of trees that make apples, makes money by selling them and by selling apple-related products.",revenue_per_week:8,requirements:{gold:50,plots:[],employees:4,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #008000;"},{id:"bakery",title:"\u{1F956} Bakery",subtitle:"for baking",type:"farm",description:"Makes money by selling bread.",revenue_per_week:12,requirements:{gold:100,plots:[],employees:3,climate:null,knowledge:0},effect_modifiers:{happiness:1.11,health:.92},immediate_variable_changes:{happiness:25,health:0,population:0},styling:"background-color: #008000;"},{id:"grocery",title:"\u{1F3EA} Grocery store",subtitle:"for living",type:"food",description:"People get hungry. This is where they go to get food.",revenue_per_week:40,requirements:{gold:320,plots:[],employees:24,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"fishery",title:"\u{1F420} Fishery",subtitle:"for fishing",type:"food",description:"Carve out some land, pour some water, and fish for fun & food.",revenue_per_week:25,requirements:{gold:400,plots:[],employees:9,climate:null,knowledge:0},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #d24646;"},{id:"library",title:"\u{1F4D5} Library",subtitle:"for reading",type:"recreation",description:"Reading makes people very happy, but doesn't make money.",revenue_per_week:0,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:1},immediate_variable_changes:{happiness:10,health:0,population:0},styling:"background-color: #4169e1;"},{id:"pub",title:"\u{1F37B} Pub",subtitle:"for hanging",type:"recreation",description:"Makes money, and somehow generates communal knowledge.",revenue_per_week:50,knowledge_points_per_month:1,requirements:{gold:500,plots:[],employees:6,climate:null,knowledge:0},effect_modifiers:{happiness:1.2,health:.7},immediate_variable_changes:{happiness:10,health:-25,population:0},styling:"background-color: #4169e1;"},{id:"church",title:"\u26EA\uFE0F Church",subtitle:"for worship & community",type:"recreation",description:"This can make some people happy, but doesn't make money.",revenue_per_week:0,requirements:{gold:100,plots:[],employees:0,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"stables",title:"\u{1F434} Stables",subtitle:"for friends",type:"recreation",description:"People love horses. This makes them happy, and can generate some money through lessons.",revenue_per_week:10,requirements:{gold:220,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.1,health:1},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #4169e1;"},{id:"blacksmith",title:"\u2694\uFE0F Blacksmith",subtitle:"for making shiny things",type:"shop",description:"Sometimes problems can only be dealt with by a hunk of metal. Makes money by selling weapons, tools, & armor.",revenue_per_week:50,requirements:{gold:1300,plots:[],employees:13,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1.5},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"inn",title:"\u{1F6CC} Village Inn",subtitle:"for a night out",type:"tourism",description:"Generates tourism gold that can be used if you have a bank.",revenue_per_week:0,enables_tourism:!0,tourism_revenue_per_week:15,requirements:{gold:1500,plots:[],employees:14,climate:null,knowledge:0},effect_modifiers:{happiness:.9,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #ff00ff;"},{id:"park_small",title:"\u{1F332} Small park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"A few benches and a small grassy area.",revenue_per_week:0,requirements:{gold:80,plots:[],employees:1,climate:null,knowledge:0},effect_modifiers:{happiness:1.01,health:1.05},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_medium",title:"\u{1F6DD} Medium park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Benches, grass, and a couple of swingsets.",revenue_per_week:0,requirements:{gold:150,plots:[],employees:2,climate:null,knowledge:0},effect_modifiers:{happiness:1.02,health:1.08},immediate_variable_changes:{happiness:5,health:0,population:0},styling:"background-color: #ffff00;"},{id:"park_large",title:"\u{1F3AA} Large park",subtitle:"for bringing your dog, or eating a sandwich",type:"recreation",description:"Same as the medium park, with a nice fountain in the middle and occasional events run by the employees.",revenue_per_week:0,requirements:{gold:300,plots:[],employees:4,climate:null,size:2,knowledge:0},effect_modifiers:{happiness:1.09,health:1.1},immediate_variable_changes:{happiness:15,health:0,population:0},styling:"background-color: #ffff00;"},{id:"school_small",title:"\u{1F4DA} Small school",subtitle:"for learning",type:"education",description:"A place where children can learn and grow, and where adults can learn new skills. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:2,requirements:{gold:850,plots:[],employees:20,climate:null,size:1,knowledge:0},effect_modifiers:{happiness:1.05,health:1.1},immediate_variable_changes:{happiness:15,health:3,population:0},styling:"background-color: #4caf50;"},{id:"school_large",title:"\u{1F68C} Large school",subtitle:"for learning",type:"education",description:"A larger school. Produces knowledge",revenue_per_week:0,knowledge_points_per_month:8,requirements:{gold:1300,plots:[],employees:40,climate:null,size:2,knowledge:10},effect_modifiers:{happiness:1.05,health:1},immediate_variable_changes:{happiness:5,health:3,population:0},styling:"background-color: #4caf50;"},{id:"university",title:"\u{1F3EB} University",subtitle:"for learning",type:"education",description:"The supreme learning institution. Produces knowledge.",revenue_per_week:0,knowledge_points_per_month:25,requirements:{gold:3500,plots:[],employees:64,climate:null,size:2,knowledge:100},effect_modifiers:{happiness:1.25,health:1},immediate_variable_changes:{happiness:25,health:25,population:0},styling:"background-color: #4caf50;"},{id:"small_hospital",title:"\u{1F691} Small hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from minor injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:800,plots:[],employees:8,climate:null,size:1,knowledge:50},effect_modifiers:{happiness:1.25,health:1.5},immediate_variable_changes:{happiness:5,health:50,population:0},styling:"background-color: #ff0000;"},{id:"large_hospital",title:"\u{1F3E5} Large hospital",subtitle:"for healing",type:"medical",description:"A great place to get fixed up from all injuries.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:4e3,plots:[],employees:64,climate:null,size:1,knowledge:200},effect_modifiers:{happiness:1.25,health:2.5},immediate_variable_changes:{happiness:5,health:75,population:0},styling:"background-color: #ff0000;"},{id:"bank",title:"\u{1F3E6} Bank",subtitle:"for storing and accessing funds",type:"bank",description:"Rich get richer.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:64,climate:null,size:1,knowledge:300},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"},{id:"city-hall",title:"\u{1F5F3}\uFE0F City Hall",subtitle:"for bureaucracy",type:"federal",description:"For running the government.",revenue_per_week:0,knowledge_points_per_month:0,requirements:{gold:3e4,plots:[],employees:24,climate:null,size:1,knowledge:500},effect_modifiers:{happiness:.8,health:1},immediate_variable_changes:{happiness:0,health:0,population:0},styling:"background-color: #7b68ee;"}],ke={unemployment_num:" people can't find jobs.",bored:"People are bored. Try making some new buildings.",vairety:"People don't like going to the same places over and over again. Try making some new buildings.",nobody_home:"Nobody can live here. Build some residential buildings.",leave_town_num:" people left town because they were unhappy.",new_people_num:" new people moved to town.",people_want_to_move_in:"People want to move in. Build more homes.",high_tax_rate:"People are unhappy with the high tax rate.",very_high_tax_rate:"People are extremely unhappy with the high tax rate.",sickAndDying:"People are sick and dying.",sickAndLeaving:"People are sick and leaving town.",happiness_zero:"The town has fallen into chaos due to extreme unhappiness.",health_zero:"The town has fallen into chaos due to extreme sickness.",population_zero:"The town has been condemned due to lack of population.",win:{land:"You have filled the grid with buildings. You win!"}};function El(n){let e,t,l=se[n[0].type].title+"",i,s;return{c(){e=u("div"),t=u("span"),i=g(l),c(t,"data-size",s=se[n[0].type].requirements.size),c(t,"class","svelte-18cb8zy"),c(e,"class","svelte-18cb8zy")},m(o,r){k(o,e,r),a(e,t),a(t,i)},p(o,r){r&1&&l!==(l=se[o[0].type].title+"")&&D(i,l),r&1&&s!==(s=se[o[0].type].requirements.size)&&c(t,"data-size",s)},d(o){o&&w(e)}}}function Fn(n){let e,t,l,i,s,o,r,_,f,p,d,m,S=n[0].type>-1&&El(n);return{c(){e=u("div"),S&&S.c(),c(e,"class","plot_container svelte-18cb8zy"),c(e,"data-active",t=n[0].active),c(e,"data-id",l=n[0].id),c(e,"data-x",i=n[0].x),c(e,"data-y",s=n[0].y),c(e,"data-optionindex",o=n[0].optionIndex),c(e,"data-canbeupgraded",n[1]),c(e,"style",n[2]),c(e,"data-type",r=n[0].type),c(e,"data-referenceplotx",_=n[0].referencePlot!==void 0?n[0].referencePlot[0]:null),c(e,"data-referenceploty",f=n[0].referencePlot!==void 0?n[0].referencePlot[1]:null),c(e,"data-size",p=n[0].type>-1?se[n[0].type].requirements.size:null)},m(v,$){k(v,e,$),S&&S.m(e,null),d||(m=ee(e,"click",n[3]),d=!0)},p(v,[$]){v[0].type>-1?S?S.p(v,$):(S=El(v),S.c(),S.m(e,null)):S&&(S.d(1),S=null),$&1&&t!==(t=v[0].active)&&c(e,"data-active",t),$&1&&l!==(l=v[0].id)&&c(e,"data-id",l),$&1&&i!==(i=v[0].x)&&c(e,"data-x",i),$&1&&s!==(s=v[0].y)&&c(e,"data-y",s),$&1&&o!==(o=v[0].optionIndex)&&c(e,"data-optionindex",o),$&2&&c(e,"data-canbeupgraded",v[1]),$&4&&c(e,"style",v[2]),$&1&&r!==(r=v[0].type)&&c(e,"data-type",r),$&1&&_!==(_=v[0].referencePlot!==void 0?v[0].referencePlot[0]:null)&&c(e,"data-referenceplotx",_),$&1&&f!==(f=v[0].referencePlot!==void 0?v[0].referencePlot[1]:null)&&c(e,"data-referenceploty",f),$&1&&p!==(p=v[0].type>-1?se[v[0].type].requirements.size:null)&&c(e,"data-size",p)},i:Z,o:Z,d(v){v&&w(e),S&&S.d(),d=!1,m()}}}function Rn(n,e,t){let l,i,s,o;oe(n,ie,v=>t(5,l=v)),oe(n,W,v=>t(6,i=v)),oe(n,kt,v=>t(7,s=v)),oe(n,mt,v=>t(8,o=v));let{data:r={id:0,active:!1,x:0,y:0,type:-1,styling:"",referencePlot:[]}}=e,{canBeUpgraded:_=!1}=e;function f(...v){d()}let p=r.styling;Gt(async()=>{r.type>=0&&se[r.type].styling&&t(2,p=se[r.type].styling)});function d(){r.type>=0&&se[r.type].styling&&t(2,p=se[r.type].styling),r.type<0&&t(2,p="")}function m(v,$,O){let B=document.querySelectorAll(".plot_container");if(s==!1){if(r.referencePlot!=null&&r.referencePlot[0]!==null&&$==null&&O==null&&r.referencePlot[1]!==void 0)return m(v,r.referencePlot[0],r.referencePlot[1]);!r.active&&!_?(V(mt,o={},o),V(ie,l.visible=!1,l),B.forEach(C=>{C.classList.remove("selected")})):($!=null&&O!=null?(V(ie,l.x=$,l),V(ie,l.y=O,l)):(V(ie,l.x=r.x,l),V(ie,l.y=r.y,l)),V(ie,l.visible=!0,l),B.forEach(C=>{C.classList.remove("selected")}),$!=null&&O!=null?document.querySelector(`.plot_container[data-x="${$}"][data-y="${O}"]`).classList.add("selected"):document.querySelector(`.plot_container[data-id="${r.id}"]`).classList.add("selected"))}}function S(v){s==!1&&(V(W,i.plots[r.x][r.y].type=v,i),V(ie,l.visible=!1,l))}return n.$$set=v=>{"data"in v&&t(0,r=v.data),"canBeUpgraded"in v&&t(1,_=v.canBeUpgraded)},n.$$.update=()=>{n.$$.dirty&1&&f(r)},[r,_,p,m,S]}class Jn extends Ae{constructor(e){super(),Ee(this,e,Rn,Fn,Me,{data:0,canBeUpgraded:1,changePlotType:4})}get changePlotType(){return this.$$.ctx[4]}}const ge={land:{short_title:"Fill the grid",description_title:"You win by filling up all possible plots in the grid, and by meeting some requirements.",win:"You have filled the grid with buildings. You win!",requirements:{0:{population_count:200,happiness:100,health:100,employment:1},1:{population_count:500,happiness:100,health:100,employment:1},2:{population_count:1e3,happiness:100,health:100,employment:1}}}};function Qe(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Un(n,e,t){let l,i,s;oe(n,Dt,h=>t(5,l=h)),oe(n,W,h=>t(6,i=h)),oe(n,kt,h=>t(7,s=h));let o=i;function r(){s==!1&&o.endGameDetails==null&&W!=null&&(o.environment.day+=1,o.environment.day%7==0&&(p(),O(),G(),E(),S(),C()),o.environment.day%30===0&&(N(),$(),d(),m()),o.environment.day%90==0&&(v(),M()),B(),f(),_(),W.set(o),localStorage.setItem(Ie,JSON.stringify(o)))}function _(){if(o.endGoal=="land"&&o.townInfo.population_max==o.townInfo.population_count&&o.townInfo.happiness>=ge.land.requirements[o.difficulty].happiness&&o.townInfo.health>=ge.land.requirements[o.difficulty].health&&o.townInfo.employees/o.townInfo.population_count>=ge.land.requirements[o.difficulty].employment){let b=!0;for(let P=0;P<o.plots.length;P++)for(let j=0;j<o.plots[P].length;j++)if(o.plots[P][j].active==!1){b=!1;break}b&&(o.endGameDetails={msg:ge.land.win,win:!0})}}function f(){o.townInfo.happiness<=0&&(o.townInfo.happiness=0,o.endGameDetails={msg:ke.happiness_zero,win:!1}),o.townInfo.health<=0&&(o.townInfo.health=0,o.endGameDetails={msg:ke.health_zero,win:!1}),o.townInfo.population_count<=0&&o.townInfo.population_max>0&&(o.townInfo.population_count=0,o.endGameDetails={msg:ke.population_zero,win:!1})}function p(){let h=o.townInfo.population_count-o.townInfo.employees;h>0&&(o.modifiers.happiness-=h*9e-4,F(h+ke.unemployment_num))}function d(){i.hasBank}function m(){i.hasCityHall}function S(){let h=o.townInfo.health,b=0;h>50||h<Math.random()*50&&(h<25?(F(ke.sickAndDying),o.townInfo.happiness-=10,b=Math.round(o.townInfo.population_count*.1)):(F(ke.sickAndLeaving),o.townInfo.happiness-=5,b=Math.round(o.townInfo.population_count*.05)),o.townInfo.population_count-=b,o.townInfo.employees-=b)}function v(){o.lastChangeDay+(Math.random()*160+50)<o.environment.day&&(o.townInfo.population_count>0&&(o.townInfo.population_count-=1,o.townInfo.employees-=1,o.modifiers.happiness-=.01),F(ke.bored))}function $(){if(o.townInfo.population_count<o.townInfo.population_max&&o.townInfo.happiness>50){let h=o.townInfo.population_max-o.townInfo.population_count,b=Math.round(o.townInfo.happiness/100*h);o.townInfo.population_count+=b,o.townInfo.population_count>o.townInfo.population_max&&(o.townInfo.population_count=o.townInfo.population_max),o.townInfo.employees+=b,o.townInfo.employees>o.townInfo.population_count&&(o.townInfo.employees=o.townInfo.population_count),F(b+ke.new_people_num)}if(o.townInfo.happiness<50&&o.townInfo.population_count>0){let h=Math.round((100-o.townInfo.happiness)/5);o.townInfo.population_count-=h,o.townInfo.employees>0&&(o.townInfo.employees-=h),F(h+ke.leave_town_num)}else o.townInfo.population_count==o.townInfo.population_max&&F(ke.people_want_to_move_in)}function O(){const h=Math.random();if(o.economy_and_laws.tax_rate>o.economy_and_laws.max_tax_rate){const b=o.difficulty==0?.7:o.difficulty==1?.4:.2;h<b&&o.economy_and_laws.tax_rate>o.economy_and_laws.max_tax_rate*2?(o.modifiers.happiness-=.03,F(ke.very_high_tax_rate+"  ("+o.economy_and_laws.tax_rate+"%)")):(o.modifiers.happiness-=.01,F(ke.high_tax_rate+"  ("+o.economy_and_laws.tax_rate*100+"%)"))}}function B(){o.townInfo.happiness<0&&(o.townInfo.happiness=0),o.townInfo.health<0&&(o.townInfo.health=0),o.townInfo.gold<0&&(o.townInfo.gold=0),o.townInfo.employees<0&&(o.townInfo.employees=0),o.townInfo.knowledge_points<0&&(o.townInfo.knowledge_points=0),o.townInfo.population_count<0&&(o.townInfo.population_count=0),o.townInfo.population_max==0&&F(ke.nobody_home),o.economy_and_laws.lastMonthProfit=Qe(o.economy_and_laws.lastMonthProfit,2),o.townInfo.gold=Qe(o.townInfo.gold,2),o.townInfo.population_count=Qe(o.townInfo.population_count,0),o.townInfo.employees=Qe(o.townInfo.employees,0),o.townInfo.population_max=Qe(o.townInfo.population_max,0),o.townInfo.happiness=Qe(o.townInfo.happiness,2),o.townInfo.health=Qe(o.townInfo.health,2),o.townInfo.happiness>300&&(o.townInfo.happiness=300),o.townInfo.health>300&&(o.townInfo.health=300),o.modifiers.happiness<.5&&(o.modifiers.happiness=.5),o.modifiers.health<.5&&(o.modifiers.health=.5)}function C(){if(o.modifiers.happiness>1){let h=o.modifiers.happiness-1;o.modifiers.happiness-=h*.08,o.modifiers.happiness<1.05&&(o.modifiers.happiness=1)}if(o.modifiers.health>1){let h=o.modifiers.health-1;o.modifiers.health-=h*.08,o.modifiers.health<1.05&&(o.modifiers.health=1)}}function M(){if(o.townInfo.happiness>150){let b=o.townInfo.happiness-150;o.townInfo.happiness-=b*.08,o.townInfo.happiness<150&&(o.townInfo.happiness=150)}if(o.townInfo.health>150){let b=o.townInfo.health-150;o.townInfo.health-=b*.08,o.townInfo.health<150&&(o.townInfo.health=150)}}function G(){o.economy_and_laws.lastMonthProfit=0;for(let h=0;h<o.plots.length;h++)for(let b=0;b<o.plots[h].length;b++)if(o.plots[h][b].active==!0&&o.plots[h][b].type>-1){let P=se[o.plots[h][b].type],j=z(P.revenue_per_week);o.townInfo.gold+=j,o.economy_and_laws.lastMonthProfit+=j,j>0&&(o.economy_and_laws.balanceSheetHistory=[{day:o.environment.day,plot:`${h},${b}`,profits:j,taxRate:o.economy_and_laws.tax_rate},...o.economy_and_laws.balanceSheetHistory],o.economy_and_laws.balanceSheetHistory.length>250&&(o.economy_and_laws.balanceSheetHistory=o.economy_and_laws.balanceSheetHistory.slice(0,250))),P.enables_tourism==!0&&(o.townInfo.gold_from_tourism+=P.tourism_revenue_per_week*o.economy_and_laws.tax_rate*o.townInfo.population_count)}}function E(){o.townInfo.happiness*=o.modifiers.happiness,o.townInfo.health*=o.modifiers.health}function N(){for(let h=0;h<o.plots.length;h++)for(let b=0;b<o.plots[h].length;b++)if(o.plots[h][b].active==!0&&o.plots[h][b].type>-1){let P=se[o.plots[h][b].type];P.knowledge_points_per_month!=null&&(o.townInfo.knowledge_points+=P.knowledge_points_per_month)}}function F(h){let b=i;b.townLog="Day "+i.environment.day+" - "+h+`
`+b.townLog,W.set(b),localStorage.setItem(Ie,JSON.stringify(b))}function z(h){let b=i,P=b.townInfo.happiness/100;P>1.25?P=1.25:P<.75&&(P=.75);let j=h*b.economy_and_laws.tax_rate*(b.townInfo.population_count/b.townInfo.population_max)*P;return Qe(j,2)}return Gt(async()=>{for(;;)localStorage.reset=="true"&&(Sn(),localStorage.setItem("reset","false")),r(),await new Promise(h=>setTimeout(h,l))}),[r,B,C,M]}class jn extends Ae{constructor(e){super(),Ee(this,e,Un,null,Me,{mainGameThreadLoop:0,_fixVariables:1,_bringModifiersBackToNormal:2,_bringStatsBackToNormal:3})}get mainGameThreadLoop(){return this.$$.ctx[0]}get _fixVariables(){return this.$$.ctx[1]}get _bringModifiersBackToNormal(){return this.$$.ctx[2]}get _bringStatsBackToNormal(){return this.$$.ctx[3]}}function Al(n,e,t){const l=n.slice();return l[21]=e[t],l}function Dl(n){let e,t;return{c(){e=u("div"),t=g(n[0]),c(e,"class","message")},m(l,i){k(l,e,i),a(e,t)},p(l,i){i&1&&D(t,l[0])},d(l){l&&w(e)}}}function Gl(n){let e,t,l;return{c(){e=u("button"),e.textContent="\u{1F525}",c(e,"id","bulldoze"),c(e,"class","svelte-1ppqz9a")},m(i,s){k(i,e,s),t||(l=ee(e,"click",n[11]),t=!0)},p:Z,d(i){i&&w(e),t=!1,l()}}}function Hl(n){let e,t,l,i;return{c(){e=u("span"),t=g("("),l=g(n[7]),i=g(")"),c(e,"class","text_s")},m(s,o){k(s,e,o),a(e,t),a(e,l),a(e,i)},p(s,o){o&128&&D(l,s[7])},d(s){s&&w(e)}}}function Fl(n){let e;return{c(){e=u("span"),e.textContent="(0)",c(e,"class","text_s")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Yn(n){let e,t,l,i=n[21].title+"",s,o,r,_,f,p=n[21].subtitle+"",d,m,S,v,$,O=n[21].description+"",B,C,M,G,E,N,F,z,h,b,P,j,I,H,R,x,ae,X,T,Q,te,le,he,ve,q,A,qe,ht,re=(n[21].revenue_per_week>0||n[21].tourism_revenue_per_week>0)&&Rl(n),ue=n[21].requirements.gold!==0&&Yl(n),de=n[21].requirements.employees!==0&&Wl(n),pe=n[21].requirements.knowledge!=null&&n[21].requirements.knowledge!==0&&Vl(n);function Ze(J,fe){return J[21].effect_modifiers.happiness==1?eo:xn}let We=Ze(n),ze=We(n);function De(J,fe){return J[21].effect_modifiers.health==1?lo:to}let Ye=De(n),Se=Ye(n),ne=(n[21].immediate_variable_changes.happiness!==0||n[21].immediate_variable_changes.health!==0)&&Kl(n);return{c(){e=u("div"),t=u("div"),l=u("span"),s=g(i),o=y(),r=u("br"),_=y(),f=u("span"),d=g(p),m=y(),S=u("br"),v=y(),$=u("span"),B=g(O),C=y(),M=u("div"),re&&re.c(),G=y(),E=u("div"),N=u("div"),F=u("span"),F.textContent="Requirements",z=y(),h=u("br"),b=y(),ue&&ue.c(),P=y(),de&&de.c(),j=y(),pe&&pe.c(),I=y(),H=u("div"),R=u("span"),R.textContent="Multiplier",x=y(),ae=u("br"),X=y(),ze.c(),T=y(),Q=u("br"),te=y(),Se.c(),le=y(),ne&&ne.c(),he=y(),c(l,"class","heading_m"),c(f,"class","subheading_m"),c($,"class","text_s"),c(F,"class","subheading_m"),c(N,"class","svelte-1ppqz9a"),c(R,"class","subheading_m"),c(H,"class","svelte-1ppqz9a"),c(E,"class","reqs_and_mods svelte-1ppqz9a"),c(M,"class","bottom svelte-1ppqz9a"),c(e,"class","plotOption background-lightgray svelte-1ppqz9a"),c(e,"data-active",ve=n[21].selected),c(e,"data-affordable",q=n[13](n[21])),c(e,"data-plotoptionid",A=n[21].id)},m(J,fe){k(J,e,fe),a(e,t),a(t,l),a(l,s),a(t,o),a(t,r),a(t,_),a(t,f),a(f,d),a(t,m),a(t,S),a(t,v),a(t,$),a($,B),a(e,C),a(e,M),re&&re.m(M,null),a(M,G),a(M,E),a(E,N),a(N,F),a(N,z),a(N,h),a(N,b),ue&&ue.m(N,null),a(N,P),de&&de.m(N,null),a(N,j),pe&&pe.m(N,null),a(E,I),a(E,H),a(H,R),a(H,x),a(H,ae),a(H,X),ze.m(H,null),a(H,T),a(H,Q),a(H,te),Se.m(H,null),a(M,le),ne&&ne.m(M,null),a(e,he),qe||(ht=ee(e,"click",n[12]),qe=!0)},p(J,fe){fe&32&&i!==(i=J[21].title+"")&&D(s,i),fe&32&&p!==(p=J[21].subtitle+"")&&D(d,p),fe&32&&O!==(O=J[21].description+"")&&D(B,O),J[21].revenue_per_week>0||J[21].tourism_revenue_per_week>0?re?re.p(J,fe):(re=Rl(J),re.c(),re.m(M,G)):re&&(re.d(1),re=null),J[21].requirements.gold!==0?ue?ue.p(J,fe):(ue=Yl(J),ue.c(),ue.m(N,P)):ue&&(ue.d(1),ue=null),J[21].requirements.employees!==0?de?de.p(J,fe):(de=Wl(J),de.c(),de.m(N,j)):de&&(de.d(1),de=null),J[21].requirements.knowledge!=null&&J[21].requirements.knowledge!==0?pe?pe.p(J,fe):(pe=Vl(J),pe.c(),pe.m(N,null)):pe&&(pe.d(1),pe=null),We===(We=Ze(J))&&ze?ze.p(J,fe):(ze.d(1),ze=We(J),ze&&(ze.c(),ze.m(H,T))),Ye===(Ye=De(J))&&Se?Se.p(J,fe):(Se.d(1),Se=Ye(J),Se&&(Se.c(),Se.m(H,null))),J[21].immediate_variable_changes.happiness!==0||J[21].immediate_variable_changes.health!==0?ne?ne.p(J,fe):(ne=Kl(J),ne.c(),ne.m(M,null)):ne&&(ne.d(1),ne=null),fe&32&&ve!==(ve=J[21].selected)&&c(e,"data-active",ve),fe&32&&q!==(q=J[13](J[21]))&&c(e,"data-affordable",q),fe&32&&A!==(A=J[21].id)&&c(e,"data-plotoptionid",A)},d(J){J&&w(e),re&&re.d(),ue&&ue.d(),de&&de.d(),pe&&pe.d(),ze.d(),Se.d(),ne&&ne.d(),qe=!1,ht()}}}function Rl(n){let e,t,l,i,s,o,r=n[21].revenue_per_week>0&&Jl(n),_=n[21].tourism_revenue_per_week>0&&Ul(n);return{c(){e=u("div"),t=u("span"),t.textContent="Profits",l=y(),i=u("br"),s=y(),r&&r.c(),o=y(),_&&_.c(),c(t,"class","subheading_m"),c(e,"class","profits svelte-1ppqz9a")},m(f,p){k(f,e,p),a(e,t),a(e,l),a(e,i),a(e,s),r&&r.m(e,null),a(e,o),_&&_.m(e,null)},p(f,p){f[21].revenue_per_week>0?r?r.p(f,p):(r=Jl(f),r.c(),r.m(e,o)):r&&(r.d(1),r=null),f[21].tourism_revenue_per_week>0?_?_.p(f,p):(_=Ul(f),_.c(),_.m(e,null)):_&&(_.d(1),_=null)},d(f){f&&w(e),r&&r.d(),_&&_.d()}}}function Jl(n){let e,t,l=n[21].revenue_per_week+"",i,s,o=Je(n[8].economy_and_laws.tax_rate*n[21].revenue_per_week,2)+"",r,_,f,p;return{c(){e=u("span"),t=u("span"),i=g(l),s=y(),r=g(o),_=g(" gold (with tax rate)"),f=y(),p=u("br"),c(t,"class","strikethrough"),c(e,"class","text_s gold")},m(d,m){k(d,e,m),a(e,t),a(t,i),a(e,s),a(e,r),a(e,_),k(d,f,m),k(d,p,m)},p(d,m){m&32&&l!==(l=d[21].revenue_per_week+"")&&D(i,l),m&288&&o!==(o=Je(d[8].economy_and_laws.tax_rate*d[21].revenue_per_week,2)+"")&&D(r,o)},d(d){d&&w(e),d&&w(f),d&&w(p)}}}function Ul(n){let e,t,l=n[21].tourism_revenue_per_week+"",i,s,o=Je(n[8].economy_and_laws.tax_rate*n[21].tourism_revenue_per_week*n[8].townInfo.population_count,2)+"",r,_,f,p=n[8].hasABank!==!0&&jl();return{c(){e=u("span"),t=u("span"),i=g(l),s=y(),r=g(o),_=g(` tourism gold (
												`),p&&p.c(),f=g(`

												)`),c(t,"class","strikethrough"),c(e,"class","text_s gold")},m(d,m){k(d,e,m),a(e,t),a(t,i),a(e,s),a(e,r),a(e,_),p&&p.m(e,null),a(e,f)},p(d,m){m&32&&l!==(l=d[21].tourism_revenue_per_week+"")&&D(i,l),m&288&&o!==(o=Je(d[8].economy_and_laws.tax_rate*d[21].tourism_revenue_per_week*d[8].townInfo.population_count,2)+"")&&D(r,o),d[8].hasABank!==!0?p||(p=jl(),p.c(),p.m(e,f)):p&&(p.d(1),p=null)},d(d){d&&w(e),p&&p.d()}}}function jl(n){let e;return{c(){e=g("get a bank to cash out")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Yl(n){let e,t;function l(o,r){return o[8].townInfo.gold<o[21].requirements.gold?Vn:Wn}let i=l(n),s=i(n);return{c(){s.c(),e=y(),t=u("br")},m(o,r){s.m(o,r),k(o,e,r),k(o,t,r)},p(o,r){i===(i=l(o))&&s?s.p(o,r):(s.d(1),s=i(o),s&&(s.c(),s.m(e.parentNode,e)))},d(o){s.d(o),o&&w(e),o&&w(t)}}}function Wn(n){let e,t=n[21].requirements.gold+"",l,i;return{c(){e=u("span"),l=g(t),i=g(" gold"),c(e,"class","text_s cost_label svelte-1ppqz9a")},m(s,o){k(s,e,o),a(e,l),a(e,i)},p(s,o){o&32&&t!==(t=s[21].requirements.gold+"")&&D(l,t)},d(s){s&&w(e)}}}function Vn(n){let e,t=n[21].requirements.gold+"",l,i;return{c(){e=u("span"),l=g(t),i=g(" gold"),c(e,"class","red text_s cost_label svelte-1ppqz9a")},m(s,o){k(s,e,o),a(e,l),a(e,i)},p(s,o){o&32&&t!==(t=s[21].requirements.gold+"")&&D(l,t)},d(s){s&&w(e)}}}function Wl(n){let e,t;function l(o,r){return o[8].townInfo.population_count-o[8].townInfo.employees<o[21].requirements.employees?Xn:Kn}let i=l(n),s=i(n);return{c(){s.c(),e=y(),t=u("br")},m(o,r){s.m(o,r),k(o,e,r),k(o,t,r)},p(o,r){i===(i=l(o))&&s?s.p(o,r):(s.d(1),s=i(o),s&&(s.c(),s.m(e.parentNode,e)))},d(o){s.d(o),o&&w(e),o&&w(t)}}}function Kn(n){let e,t=n[21].requirements.employees+"",l,i;return{c(){e=u("span"),l=g(t),i=g(" employees"),c(e,"class","text_s cost_label svelte-1ppqz9a")},m(s,o){k(s,e,o),a(e,l),a(e,i)},p(s,o){o&32&&t!==(t=s[21].requirements.employees+"")&&D(l,t)},d(s){s&&w(e)}}}function Xn(n){let e,t=n[21].requirements.employees+"",l,i;return{c(){e=u("span"),l=g(t),i=g(" employees"),c(e,"class","text_s cost_label red svelte-1ppqz9a")},m(s,o){k(s,e,o),a(e,l),a(e,i)},p(s,o){o&32&&t!==(t=s[21].requirements.employees+"")&&D(l,t)},d(s){s&&w(e)}}}function Vl(n){let e,t;function l(o,r){return o[8].townInfo.knowledge_points<o[21].requirements.knowledge?Zn:Qn}let i=l(n),s=i(n);return{c(){s.c(),e=y(),t=u("br")},m(o,r){s.m(o,r),k(o,e,r),k(o,t,r)},p(o,r){i===(i=l(o))&&s?s.p(o,r):(s.d(1),s=i(o),s&&(s.c(),s.m(e.parentNode,e)))},d(o){s.d(o),o&&w(e),o&&w(t)}}}function Qn(n){let e,t=n[21].requirements.knowledge+"",l,i;return{c(){e=u("span"),l=g(t),i=g(" knowledge"),c(e,"class","text_s cost_label svelte-1ppqz9a")},m(s,o){k(s,e,o),a(e,l),a(e,i)},p(s,o){o&32&&t!==(t=s[21].requirements.knowledge+"")&&D(l,t)},d(s){s&&w(e)}}}function Zn(n){let e,t=n[21].requirements.knowledge+"",l,i;return{c(){e=u("span"),l=g(t),i=g(" knowledge"),c(e,"class","text_s cost_label red svelte-1ppqz9a")},m(s,o){k(s,e,o),a(e,l),a(e,i)},p(s,o){o&32&&t!==(t=s[21].requirements.knowledge+"")&&D(l,t)},d(s){s&&w(e)}}}function xn(n){let e,t,l=Ht(n[21].effect_modifiers.happiness)+"",i,s;return{c(){e=u("span"),t=g("\u{1F601} "),i=g(l),c(e,"class","text_s svelte-1ppqz9a"),c(e,"data-positive",s=n[21].effect_modifiers.happiness>=1)},m(o,r){k(o,e,r),a(e,t),a(e,i)},p(o,r){r&32&&l!==(l=Ht(o[21].effect_modifiers.happiness)+"")&&D(i,l),r&32&&s!==(s=o[21].effect_modifiers.happiness>=1)&&c(e,"data-positive",s)},d(o){o&&w(e)}}}function eo(n){let e;return{c(){e=u("span"),e.textContent="\u{1F601} No effect",c(e,"class","text_s svelte-1ppqz9a"),c(e,"data-positive","true")},m(t,l){k(t,e,l)},p:Z,d(t){t&&w(e)}}}function to(n){let e,t,l=Ht(n[21].effect_modifiers.health)+"",i,s;return{c(){e=u("span"),t=g("\u{1F3E5} "),i=g(l),c(e,"class","text_s svelte-1ppqz9a"),c(e,"data-positive",s=n[21].effect_modifiers.health>=1)},m(o,r){k(o,e,r),a(e,t),a(e,i)},p(o,r){r&32&&l!==(l=Ht(o[21].effect_modifiers.health)+"")&&D(i,l),r&32&&s!==(s=o[21].effect_modifiers.health>=1)&&c(e,"data-positive",s)},d(o){o&&w(e)}}}function lo(n){let e;return{c(){e=u("span"),e.textContent="\u{1F3E5} No effect",c(e,"class","text_s svelte-1ppqz9a"),c(e,"data-positive","true")},m(t,l){k(t,e,l)},p:Z,d(t){t&&w(e)}}}function Kl(n){let e,t,l,i,s,o=n[21].immediate_variable_changes.happiness!==0&&Xl(n),r=n[21].immediate_variable_changes.happiness!==0&&n[21].immediate_variable_changes.health!==0&&Ql(),_=n[21].immediate_variable_changes.health!==0&&Zl(n);return{c(){e=u("div"),t=u("span"),l=g(`Instant changes:
											`),o&&o.c(),i=y(),r&&r.c(),s=y(),_&&_.c(),c(t,"class","subheading_m"),c(e,"class","immediate_changes svelte-1ppqz9a")},m(f,p){k(f,e,p),a(e,t),a(t,l),o&&o.m(t,null),a(t,i),r&&r.m(t,null),a(t,s),_&&_.m(t,null)},p(f,p){f[21].immediate_variable_changes.happiness!==0?o?o.p(f,p):(o=Xl(f),o.c(),o.m(t,i)):o&&(o.d(1),o=null),f[21].immediate_variable_changes.happiness!==0&&f[21].immediate_variable_changes.health!==0?r||(r=Ql(),r.c(),r.m(t,s)):r&&(r.d(1),r=null),f[21].immediate_variable_changes.health!==0?_?_.p(f,p):(_=Zl(f),_.c(),_.m(t,null)):_&&(_.d(1),_=null)},d(f){f&&w(e),o&&o.d(),r&&r.d(),_&&_.d()}}}function Xl(n){let e,t,l=n[21].immediate_variable_changes.happiness+"",i;return{c(){e=g(`\u{1F601}
												`),t=u("span"),i=g(l),c(t,"class","green")},m(s,o){k(s,e,o),k(s,t,o),a(t,i)},p(s,o){o&32&&l!==(l=s[21].immediate_variable_changes.happiness+"")&&D(i,l)},d(s){s&&w(e),s&&w(t)}}}function Ql(n){let e;return{c(){e=g(",")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Zl(n){let e,t,l=n[21].immediate_variable_changes.health+"",i;return{c(){e=g(`\u{1F3E5}
												`),t=u("span"),i=g(l),c(t,"class","green")},m(s,o){k(s,e,o),k(s,t,o),a(t,i)},p(s,o){o&32&&l!==(l=s[21].immediate_variable_changes.health+"")&&D(i,l)},d(s){s&&w(e),s&&w(t)}}}function xl(n,e){let t,l,i=Yn(e);return{key:n,first:null,c(){t=je(),i&&i.c(),l=je(),this.first=t},m(s,o){k(s,t,o),i&&i.m(s,o),k(s,l,o)},p(s,o){e=s,i.p(e,o)},d(s){s&&w(t),i&&i.d(s),s&&w(l)}}}function no(n){let e,t,l,i,s,o,r=n[2]+1+"",_,f,p=n[1]+1+"",d,m,S,v,$,O,B=n[8].plots[n[1]][n[2]].type!==-1&&n[3](n[2],n[1]),C,M,G,E,N,F,z,h,b,P,j,I,H,R=[],x=new Map,ae,X,T=n[0]!==""&&Dl(n),Q=B&&Gl(n),te=n[7]>0&&Hl(n),le=n[5].length==0&&Fl(),he=n[5];const ve=q=>q[21];for(let q=0;q<he.length;q+=1){let A=Al(n,he,q),qe=ve(A);x.set(qe,R[q]=xl(qe,A))}return{c(){e=u("div"),t=u("div"),l=u("div"),i=u("div"),s=u("span"),o=g("Modify Plot: "),_=g(r),f=g("-"),d=g(p),m=y(),T&&T.c(),S=y(),v=u("input"),$=y(),O=u("div"),Q&&Q.c(),C=y(),M=u("button"),M.textContent="Close",G=y(),E=u("div"),N=u("label"),F=g(`options
				`),te&&te.c(),z=y(),le&&le.c(),h=y(),b=u("br"),P=y(),j=u("br"),I=y(),H=u("div");for(let q=0;q<R.length;q+=1)R[q].c();c(s,"class","heading_l"),c(i,"class","svelte-1ppqz9a"),c(v,"type","text"),c(v,"id","search-bar"),c(v,"placeholder","Search Plot Options..."),v.value=n[4],c(v,"class","svelte-1ppqz9a"),c(M,"id","close"),c(M,"class","svelte-1ppqz9a"),c(O,"class","svelte-1ppqz9a"),c(l,"class","header svelte-1ppqz9a"),c(N,"for","plotType"),c(H,"class","plotOptions svelte-1ppqz9a"),c(E,"class","scrollable-y svelte-1ppqz9a"),c(t,"class","dialog-content svelte-1ppqz9a"),c(e,"class","dialog svelte-1ppqz9a")},m(q,A){k(q,e,A),a(e,t),a(t,l),a(l,i),a(i,s),a(s,o),a(s,_),a(s,f),a(s,d),a(i,m),T&&T.m(i,null),a(l,S),a(l,v),n[17](v),a(l,$),a(l,O),Q&&Q.m(O,null),a(O,C),a(O,M),a(t,G),a(t,E),a(E,N),a(N,F),te&&te.m(N,null),a(N,z),le&&le.m(N,null),a(E,h),a(E,b),a(E,P),a(E,j),a(E,I),a(E,H);for(let qe=0;qe<R.length;qe+=1)R[qe].m(H,null);ae||(X=[ee(v,"input",n[9]),ee(M,"click",n[10])],ae=!0)},p(q,[A]){A&4&&r!==(r=q[2]+1+"")&&D(_,r),A&2&&p!==(p=q[1]+1+"")&&D(d,p),q[0]!==""?T?T.p(q,A):(T=Dl(q),T.c(),T.m(i,null)):T&&(T.d(1),T=null),A&16&&v.value!==q[4]&&(v.value=q[4]),A&262&&(B=q[8].plots[q[1]][q[2]].type!==-1&&q[3](q[2],q[1])),B?Q?Q.p(q,A):(Q=Gl(q),Q.c(),Q.m(O,C)):Q&&(Q.d(1),Q=null),q[7]>0?te?te.p(q,A):(te=Hl(q),te.c(),te.m(N,z)):te&&(te.d(1),te=null),q[5].length==0?le||(le=Fl(),le.c(),le.m(N,null)):le&&(le.d(1),le=null),A&12576&&(he=q[5],R=An(R,A,ve,1,q,he,x,H,En,xl,null,Al))},i:Z,o:Z,d(q){q&&w(e),T&&T.d(),n[17](null),Q&&Q.d(),te&&te.d(),le&&le.d();for(let A=0;A<R.length;A+=1)R[A].d();ae=!1,nt(X)}}}function Je(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function Ht(n){return n.toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,")}function oo(n,e,t){let l,i;oe(n,W,z=>t(8,l=z)),oe(n,ie,z=>t(18,i=z));var s=this&&this.__awaiter||function(z,h,b,P){function j(I){return I instanceof b?I:new b(function(H){H(I)})}return new(b||(b=Promise))(function(I,H){function R(X){try{ae(P.next(X))}catch(T){H(T)}}function x(X){try{ae(P.throw(X))}catch(T){H(T)}}function ae(X){X.done?I(X.value):j(X.value).then(R,x)}ae((P=P.apply(z,h||[])).next())})};let{x:o=0}=e,{y:r=0}=e,_="",f=se,{tooltip:p=""}=e,d=f,m,S;Gt(()=>s(void 0,void 0,void 0,function*(){yield Tn(),m&&m.focus()}));function v(z){t(4,_=z.target.value),z.stopPropagation()}Gt(()=>{const z=document.querySelectorAll(".plotOption");l.plots[o][r].type!==-1&&l.plots[o][r].type>-1&&(z[l.plots[o][r].type].classList.add("active"),z[l.plots[o][r].type].scrollIntoView({behavior:"smooth",block:"center"}))});function $(z,h){let b={x:z,y:h};return b.x===0&&b.y===0?!0:[{x:b.x-1,y:b.y},{x:b.x+1,y:b.y},{x:b.x,y:b.y-1},{x:b.x,y:b.y+1}].some(j=>(console.log(l.plots.length),j.x<0||j.x>l.plots.length-1||j.y<0||j.y>l.plots.length-1?!1:l.plots[j.x][j.y].active))}function O(){V(ie,i.visible=!1,i)}function B(){document.querySelectorAll(".plotOption").forEach(h=>{h.classList.remove("active")}),E(o,r)}function C(z){if(z.currentTarget.classList.contains("plotOption")){document.querySelectorAll(".plotOption").forEach(P=>{P.classList.remove("active")}),z.currentTarget.classList.add("active");const b=z.currentTarget.dataset.plotoptionid;G(o,r,b)}}function M(z,h){let b=0;return z>0&&l.plots[z-1][h].type!==-1&&b++,z<l.plots.length-1&&l.plots[z+1][h].type!==-1&&b++,h>0&&l.plots[z][h-1].type!==-1&&b++,h<l.plots[0].length-1&&l.plots[z][h+1].type!==-1&&b++,console.log(b),b<=4}function G(z,h,b){let P=l;const j=se.findIndex(R=>R.id===b);let I=se[j],H=!0;if((I.requirements.gold>P.townInfo.gold||I.requirements.employees>P.townInfo.population_count-P.townInfo.employees)&&(H=!1),I.requirements.size!=null&&H){let R=I.requirements.size,x=[],ae=f[j].title.toLowerCase().indexOf("school")!=-1;for(let X=0;X<4;X++){let T=[[z,h]];X===0?(T.push([z-(R-1),h-(R-1)]),T.push([z-(R-1),h]),T.push([z,h-(R-1)])):X===1?(T.push([z,h-(R-1)]),T.push([z+(R-1),h-(R-1)]),T.push([z+(R-1),h])):X===2?(T.push([z-(R-1),h]),T.push([z-(R-1),h+(R-1)]),T.push([z,h+(R-1)])):X===3&&(T.push([z,h+(R-1)]),T.push([z+(R-1),h+(R-1)]),T.push([z+(R-1),h])),x.push(T)}x=x.filter(X=>(console.log(P.plots.length),X.every(T=>T[0]>=0&&T[0]<=P.plots.length-1&&T[1]>=0&&T[1]<=P.plots.length-1&&!P.plots[T[0]][T[1]].active&&$(T[0],T[1])==!0))),x.length===0?H=!1:x.length>0&&x[0].forEach(T=>{P.plots[T[0]][T[1]].active=!0,P.plots[T[0]][T[1]].type=ae?-3:-2,P.plots[T[0]][T[1]].referencePlot=[z,h]})}if(H===!0){switch(P.plots[z][h].type!==-1&&E(z,h),t(0,p=""),P.plots[z][h].type=j,P.plots[z][h].active=!0,P.plots[z][h].referencePlot=[],P.townInfo.gold-=I.requirements.gold,P.townInfo.gold=Je(P.townInfo.gold,2),P.townInfo.population_count+=I.immediate_variable_changes.population,P.townInfo.population_max+=I.immediate_variable_changes.population,P.townInfo.happiness+=I.immediate_variable_changes.happiness,P.townInfo.health+=I.immediate_variable_changes.health,P.modifiers.happiness=Je(P.modifiers.happiness*I.effect_modifiers.happiness,2),P.modifiers.health=Je(P.modifiers.health*I.effect_modifiers.health,2),P.townInfo.employees+=I.requirements.employees,(P.plotCounts[j]===void 0||P.plotCounts[j]===null)&&(P.plotCounts[j]=0),P.plotCounts[j]++,P.lastChangeDay=P.environment.day,P.economy_and_laws.balanceSheetHistory=[{day:P.environment.day,plot:`${z},${h}`,profits:I.requirements.gold*-1,balance:Je(P.townInfo.gold,2)},...P.economy_and_laws.balanceSheetHistory],I.id){case"city-hall":P.hasCityHall=!0;break;case"bank":P.hasBank=!0;break}W.set(P),localStorage.setItem(Ie,JSON.stringify(P)),V(ie,i.visible=!1,i)}else t(0,p="You do not have enough resources to purchase this plot."),document.querySelectorAll(".plotOption").forEach(x=>{x.classList.remove("active")})}function E(z,h){let b=l,P=b.plots[z][h].type;b.plots[z][h].type=-1,b.plots[z][h].active=!1,P>-1&&(b.townInfo.population_count-=se[P].immediate_variable_changes.population,b.townInfo.population_max-=se[P].immediate_variable_changes.population,b.townInfo.happiness-=se[P].immediate_variable_changes.happiness,b.townInfo.health-=se[P].immediate_variable_changes.health,b.modifiers.happiness=Je(b.modifiers.happiness/se[P].effect_modifiers.happiness,2),b.modifiers.health=Je(b.modifiers.health/se[P].effect_modifiers.health,2),b.townInfo.employees-=se[P].requirements.employees,(b.plotCounts[P]===void 0||b.plotCounts[P]===null)&&(b.plotCounts[P]=0),b.plotCounts[P]--),b.lastChangeDay=b.environment.day,W.set(b),localStorage.setItem(Ie,JSON.stringify(b))}function N(z){let h=l,b=!0;z.requirements.gold>h.townInfo.gold&&(b=!1);let P=h.townInfo.population_count-h.townInfo.employees;return z.requirements.employees!==void 0&&z.requirements.employees>0&&z.requirements.employees>P&&(b=!1),z.requirements.knowledge!==void 0&&z.requirements.knowledge>h.townInfo.knowledge_points&&(b=!1),b}function F(z){Xt[z?"unshift":"push"](()=>{m=z,t(6,m)})}return n.$$set=z=>{"x"in z&&t(1,o=z.x),"y"in z&&t(2,r=z.y),"tooltip"in z&&t(0,p=z.tooltip)},n.$$.update=()=>{n.$$.dirty&16&&t(5,d=_?f.filter(z=>z.title.toLowerCase().includes(_.toLowerCase())):f),n.$$.dirty&32&&t(7,S=d.filter(z=>N(z)).length)},[p,o,r,M,_,d,m,S,l,v,O,B,C,N,$,G,E,F]}class io extends Ae{constructor(e){super(),Ee(this,e,oo,no,Me,{x:1,y:2,tooltip:0,checkIfPlotCanBeUpgraded:14,canBulldoze:3,purchasePlot:15,reverseClear:16})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[14]}get canBulldoze(){return this.$$.ctx[3]}get purchasePlot(){return this.$$.ctx[15]}get reverseClear(){return this.$$.ctx[16]}}function en(n,e,t){const l=n.slice();return l[6]=e[t],l}function tn(n,e,t){const l=n.slice();return l[9]=e[t],l}function ln(n){let e,t,l=n[3],i,s,o=n[2].plots,r=[];for(let p=0;p<o.length;p+=1)r[p]=on(en(n,o,p));const _=p=>K(r[p],1,1,()=>{r[p]=null});let f=an(n);return{c(){e=u("div");for(let p=0;p<r.length;p+=1)r[p].c();t=y(),f.c(),i=je(),c(e,"class","grid svelte-3cpxwu")},m(p,d){k(p,e,d);for(let m=0;m<r.length;m+=1)r[m].m(e,null);k(p,t,d),f.m(p,d),k(p,i,d),s=!0},p(p,d){if(d&7){o=p[2].plots;let m;for(m=0;m<o.length;m+=1){const S=en(p,o,m);r[m]?(r[m].p(S,d),U(r[m],1)):(r[m]=on(S),r[m].c(),U(r[m],1),r[m].m(e,null))}for(Te(),m=o.length;m<r.length;m+=1)_(m);Le()}d&8&&Me(l,l=p[3])?(Te(),K(f,1,1,Z),Le(),f=an(p),f.c(),U(f,1),f.m(i.parentNode,i)):f.p(p,d)},i(p){if(!s){for(let d=0;d<o.length;d+=1)U(r[d]);U(f),s=!0}},o(p){r=r.filter(Boolean);for(let d=0;d<r.length;d+=1)K(r[d]);K(f),s=!1},d(p){p&&w(e),el(r,p),p&&w(t),p&&w(i),f.d(p)}}}function nn(n){let e,t;return e=new Jn({props:{data:n[9],canBeUpgraded:n[0](n[9].x,n[9].y)}}),{c(){Ne(e.$$.fragment)},m(l,i){Ce(e,l,i),t=!0},p(l,i){const s={};i&4&&(s.data=l[9]),i&4&&(s.canBeUpgraded=l[0](l[9].x,l[9].y)),e.$set(s)},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function on(n){let e,t,l,i,s,o=n[6],r=[];for(let f=0;f<o.length;f+=1)r[f]=nn(tn(n,o,f));const _=f=>K(r[f],1,1,()=>{r[f]=null});return{c(){e=u("div");for(let f=0;f<r.length;f+=1)r[f].c();t=y(),c(e,"class","row svelte-3cpxwu")},m(f,p){k(f,e,p);for(let d=0;d<r.length;d+=1)r[d].m(e,null);a(e,t),l=!0,i||(s=ee(e,"click",n[1]),i=!0)},p(f,p){if(p&5){o=f[6];let d;for(d=0;d<o.length;d+=1){const m=tn(f,o,d);r[d]?(r[d].p(m,p),U(r[d],1)):(r[d]=nn(m),r[d].c(),U(r[d],1),r[d].m(e,t))}for(Te(),d=o.length;d<r.length;d+=1)_(d);Le()}},i(f){if(!l){for(let p=0;p<o.length;p+=1)U(r[p]);l=!0}},o(f){r=r.filter(Boolean);for(let p=0;p<r.length;p+=1)K(r[p]);l=!1},d(f){f&&w(e),el(r,f),i=!1,s()}}}function sn(n){let e,t;return e=new io({props:{x:n[4].x,y:n[4].y}}),{c(){Ne(e.$$.fragment)},m(l,i){Ce(e,l,i),t=!0},p(l,i){const s={};i&16&&(s.x=l[4].x),i&16&&(s.y=l[4].y),e.$set(s)},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function an(n){let e,t,l=n[4].visible&&sn(n);return{c(){l&&l.c(),e=je()},m(i,s){l&&l.m(i,s),k(i,e,s),t=!0},p(i,s){i[4].visible?l?(l.p(i,s),s&16&&U(l,1)):(l=sn(i),l.c(),U(l,1),l.m(e.parentNode,e)):l&&(Te(),K(l,1,1,()=>{l=null}),Le())},i(i){t||(U(l),t=!0)},o(i){K(l),t=!1},d(i){l&&l.d(i),i&&w(e)}}}function so(n){let e,t,l=n[2]!=null&&ln(n);return{c(){l&&l.c(),e=je()},m(i,s){l&&l.m(i,s),k(i,e,s),t=!0},p(i,[s]){i[2]!=null?l?(l.p(i,s),s&4&&U(l,1)):(l=ln(i),l.c(),U(l,1),l.m(e.parentNode,e)):l&&(Te(),K(l,1,1,()=>{l=null}),Le())},i(i){t||(U(l),t=!0)},o(i){K(l),t=!1},d(i){l&&l.d(i),i&&w(e)}}}function ao(n,e,t){let l,i,s;oe(n,W,f=>t(2,l=f)),oe(n,mt,f=>t(3,i=f)),oe(n,ie,f=>t(4,s=f));function o(f,p){let d={x:f,y:p};return d.x===0&&d.y===0?!0:[{x:d.x-1,y:d.y},{x:d.x+1,y:d.y},{x:d.x,y:d.y-1},{x:d.x,y:d.y+1}].some(S=>S.x<0||S.x>=l.plots.length||S.y<0||S.y>=l.plots[S.x].length?!1:l.plots[S.x][S.y].active)}function r(){let f=[];for(let p=0;p<l.plots.length;p++)for(let d=0;d<l.plots.length;d++)o(p,d)&&l.plots[p][d].active==!1&&f.push(l.plots[p][d])}function _(){V(mt,i={},i)}return window.location.search.includes("dev=true")&&(V(W,l.townInfo.name="DevTown",l),V(W,l.townInfo.gold=1e8,l),V(W,l.townInfo.population=0,l),V(W,l.townInfo.happiness=1e5,l),V(W,l.townInfo.health=1e5,l),V(W,l.modifiers.happiness=1e5,l),V(W,l.modifiers.health=1e5,l),V(W,l.townInfo.knowledge_points=1e4,l)),n.$$.update=()=>{n.$$.dirty&4&&l&&r()},[o,_,l,i,s]}class ro extends Ae{constructor(e){super(),Ee(this,e,ao,so,Me,{checkIfPlotCanBeUpgraded:0,restartModifyPlotMenu:1})}get checkIfPlotCanBeUpgraded(){return this.$$.ctx[0]}get restartModifyPlotMenu(){return this.$$.ctx[1]}}function rn(n,e,t){const l=n.slice();return l[4]=e[t],l}function fo(n){let e,t,l,i,s=n[0].economy_and_laws.balanceSheetHistory,o=[];for(let r=0;r<s.length;r+=1)o[r]=fn(rn(n,s,r));return{c(){e=u("table"),t=u("thead"),t.innerHTML=`<tr class="svelte-1m5x2x2"><th>Day</th> 
						<th>Plot</th> 
						<th>Profits</th> 
						<th>Tax rate</th></tr>`,l=y(),i=u("tbody");for(let r=0;r<o.length;r+=1)o[r].c();c(e,"class","svelte-1m5x2x2")},m(r,_){k(r,e,_),a(e,t),a(e,l),a(e,i);for(let f=0;f<o.length;f+=1)o[f].m(i,null)},p(r,_){if(_&3){s=r[0].economy_and_laws.balanceSheetHistory;let f;for(f=0;f<s.length;f+=1){const p=rn(r,s,f);o[f]?o[f].p(p,_):(o[f]=fn(p),o[f].c(),o[f].m(i,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=s.length}},d(r){r&&w(e),el(o,r)}}}function uo(n){let e;return{c(){e=u("div"),e.textContent=`No data to display yet. Build some buildings and make sure that the tax
				rate is above 0%.`,c(e,"class","text-center padding-sides")},m(t,l){k(t,e,l)},p:Z,d(t){t&&w(e)}}}function fn(n){let e,t,l=n[4].day+"",i,s,o,r=n[4].plot+"",_,f,p,d=n[4].profits+"",m,S,v,$=n[4].taxRate+"",O,B,C,M;function G(){return n[2](n[4])}return{c(){e=u("tr"),t=u("td"),i=g(l),s=y(),o=u("th"),_=g(r),f=y(),p=u("td"),m=g(d),S=y(),v=u("td"),O=g($),B=y(),c(t,"class","svelte-1m5x2x2"),c(o,"class","plot_link svelte-1m5x2x2"),c(p,"class","svelte-1m5x2x2"),c(v,"class","svelte-1m5x2x2"),c(e,"class","svelte-1m5x2x2")},m(E,N){k(E,e,N),a(e,t),a(t,i),a(e,s),a(e,o),a(o,_),a(e,f),a(e,p),a(p,m),a(e,S),a(e,v),a(v,O),a(e,B),C||(M=ee(o,"click",G),C=!0)},p(E,N){n=E,N&1&&l!==(l=n[4].day+"")&&D(i,l),N&1&&r!==(r=n[4].plot+"")&&D(_,r),N&1&&d!==(d=n[4].profits+"")&&D(m,d),N&1&&$!==($=n[4].taxRate+"")&&D(O,$)},d(E){E&&w(e),C=!1,M()}}}function po(n){let e,t,l,i,s,o;function r(p,d){return p[0].economy_and_laws.balanceSheetHistory.length==0?uo:fo}let _=r(n),f=_(n);return{c(){e=u("div"),t=u("div"),l=u("div"),l.textContent="Balance Sheet",i=y(),s=u("br"),o=y(),f.c(),c(l,"class","heading_m svelte-1m5x2x2"),c(t,"class","dialog-content svelte-1m5x2x2"),c(e,"class","dialog svelte-1m5x2x2")},m(p,d){k(p,e,d),a(e,t),a(t,l),a(t,i),a(t,s),a(t,o),f.m(t,null)},p(p,[d]){_===(_=r(p))&&f?f.p(p,d):(f.d(1),f=_(p),f&&(f.c(),f.m(t,null)))},i:Z,o:Z,d(p){p&&w(e),f.d()}}}function co(n,e,t){let l,i;oe(n,ie,r=>t(3,l=r)),oe(n,W,r=>t(0,i=r));function s(r){let _=parseInt(r.split(",")[0]),f=parseInt(r.split(",")[1]);V(ie,l.x=_,l),V(ie,l.y=f,l),V(ie,l.visible=!0,l)}return[i,s,r=>{s(r.plot)}]}class Pn extends Ae{constructor(e){super(),Ee(this,e,co,po,Me,{})}}const un={0:"Easy",1:"Normal",2:"Hard"};function pn(n){let e,t,l,i=ge[n[0].endGoal].short_title+"",s,o,r,_,f,p,d,m,S,v,$,O,B,C=n[0].endGoal=="land"&&cn(n);return{c(){e=u("div"),t=u("div"),l=g("HOW TO PLAY ("),s=g(i),o=g(`)
			`),r=u("br"),_=y(),f=u("hr"),p=y(),C&&C.c(),d=y(),m=u("br"),S=y(),v=u("hr"),$=y(),O=u("br"),B=g(`
			Reset the game by pressing SHIFT+ESC`),c(t,"class","dialog-content svelte-2ih7px"),c(e,"class","dialog svelte-2ih7px")},m(M,G){k(M,e,G),a(e,t),a(t,l),a(t,s),a(t,o),a(t,r),a(t,_),a(t,f),a(t,p),C&&C.m(t,null),a(t,d),a(t,m),a(t,S),a(t,v),a(t,$),a(t,O),a(t,B)},p(M,G){G&1&&i!==(i=ge[M[0].endGoal].short_title+"")&&D(s,i),M[0].endGoal=="land"?C?C.p(M,G):(C=cn(M),C.c(),C.m(t,d)):C&&(C.d(1),C=null)},d(M){M&&w(e),C&&C.d()}}}function cn(n){let e=ge[n[0].endGoal].description_title+"",t,l,i,s,o,r,_=un[n[0].difficulty]+"",f,p,d,m,S,v,$,O,B=JSON.stringify(ge.land.requirements[n[0].difficulty].population_count)+"",C,M,G,E,N,F,z=JSON.stringify(ge.land.requirements[n[0].difficulty].happiness)+"",h,b,P,j,I,H,R=JSON.stringify(ge.land.requirements[n[0].difficulty].health)+"",x,ae,X,T,Q,te,le=JSON.stringify(ge.land.requirements[n[0].difficulty].employment*100)+"",he,ve;return{c(){t=g(e),l=y(),i=u("br"),s=y(),o=u("br"),r=g(`
				With your difficulty (`),f=g(_),p=g(`), you must
				also have:
				`),d=u("br"),m=y(),S=u("br"),v=y(),$=u("li"),O=g("Population: "),C=g(B),M=y(),G=u("br"),E=y(),N=u("li"),F=g("Happiness: "),h=g(z),b=y(),P=u("br"),j=y(),I=u("li"),H=g("Health: "),x=g(R),ae=y(),X=u("br"),T=y(),Q=u("li"),te=g("Employment at "),he=g(le),ve=g("%")},m(q,A){k(q,t,A),k(q,l,A),k(q,i,A),k(q,s,A),k(q,o,A),k(q,r,A),k(q,f,A),k(q,p,A),k(q,d,A),k(q,m,A),k(q,S,A),k(q,v,A),k(q,$,A),a($,O),a($,C),k(q,M,A),k(q,G,A),k(q,E,A),k(q,N,A),a(N,F),a(N,h),k(q,b,A),k(q,P,A),k(q,j,A),k(q,I,A),a(I,H),a(I,x),k(q,ae,A),k(q,X,A),k(q,T,A),k(q,Q,A),a(Q,te),a(Q,he),a(Q,ve)},p(q,A){A&1&&e!==(e=ge[q[0].endGoal].description_title+"")&&D(t,e),A&1&&_!==(_=un[q[0].difficulty]+"")&&D(f,_),A&1&&B!==(B=JSON.stringify(ge.land.requirements[q[0].difficulty].population_count)+"")&&D(C,B),A&1&&z!==(z=JSON.stringify(ge.land.requirements[q[0].difficulty].happiness)+"")&&D(h,z),A&1&&R!==(R=JSON.stringify(ge.land.requirements[q[0].difficulty].health)+"")&&D(x,R),A&1&&le!==(le=JSON.stringify(ge.land.requirements[q[0].difficulty].employment*100)+"")&&D(he,le)},d(q){q&&w(t),q&&w(l),q&&w(i),q&&w(s),q&&w(o),q&&w(r),q&&w(f),q&&w(p),q&&w(d),q&&w(m),q&&w(S),q&&w(v),q&&w($),q&&w(M),q&&w(G),q&&w(E),q&&w(N),q&&w(b),q&&w(P),q&&w(j),q&&w(I),q&&w(ae),q&&w(X),q&&w(T),q&&w(Q)}}}function _o(n){let e,t=n[2]&&n[0]!=null&&n[1]&&pn(n);return{c(){t&&t.c(),e=je()},m(l,i){t&&t.m(l,i),k(l,e,i)},p(l,[i]){l[2]&&l[0]!=null&&l[1]?t?t.p(l,i):(t=pn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Z,o:Z,d(l){t&&t.d(l),l&&w(e)}}}function mo(n,e,t){let l;oe(n,W,o=>t(0,l=o));let i=!0,s=!1;return n.$$.update=()=>{n.$$.dirty&1&&(l?t(2,s=!0):t(2,s=!1))},[l,i,s]}class ho extends Ae{constructor(e){super(),Ee(this,e,mo,_o,Me,{})}}function dn(n){let e,t=n[1].townLog+"",l,i,s;return{c(){e=u("div"),l=g(t),c(e,"class","townLog message")},m(o,r){k(o,e,r),a(e,l),i||(s=ee(e,"click",n[12]),i=!0)},p(o,r){r&2&&t!==(t=o[1].townLog+"")&&D(l,t)},d(o){o&&w(e),i=!1,s()}}}function _n(n){let e,t,l=n[1].townInfo.population_count-n[1].townInfo.employees+"",i,s;return{c(){e=u("span"),t=g("("),i=g(l),s=g(" unemployed)"),c(e,"class","text_ss gray")},m(o,r){k(o,e,r),a(e,t),a(e,i),a(e,s)},p(o,r){r&2&&l!==(l=o[1].townInfo.population_count-o[1].townInfo.employees+"")&&D(i,l)},d(o){o&&w(e)}}}function go(n){let e,t,l=n[1].economy_and_laws.lastMonthProfit+"",i,s;return{c(){e=u("span"),t=g("("),i=g(l),s=g(")"),c(e,"class","text_s red")},m(o,r){k(o,e,r),a(e,t),a(e,i),a(e,s)},p(o,r){r&2&&l!==(l=o[1].economy_and_laws.lastMonthProfit+"")&&D(i,l)},d(o){o&&w(e)}}}function vo(n){let e,t,l=n[1].economy_and_laws.lastMonthProfit+"",i,s;return{c(){e=u("span"),t=g("(+"),i=g(l),s=g(")"),c(e,"class","text_s green")},m(o,r){k(o,e,r),a(e,t),a(e,i),a(e,s)},p(o,r){r&2&&l!==(l=o[1].economy_and_laws.lastMonthProfit+"")&&D(i,l)},d(o){o&&w(e)}}}function bo(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=u("span"),l=g(t),c(e,"class","red")},m(i,s){k(i,e,s),a(e,l)},p(i,s){s&2&&t!==(t=i[1].townInfo.happiness+"")&&D(l,t)},d(i){i&&w(e)}}}function yo(n){let e,t=n[1].townInfo.happiness+"",l;return{c(){e=u("span"),l=g(t),c(e,"class","green")},m(i,s){k(i,e,s),a(e,l)},p(i,s){s&2&&t!==(t=i[1].townInfo.happiness+"")&&D(l,t)},d(i){i&&w(e)}}}function wo(n){let e;return{c(){e=u("span"),e.textContent="\u{1F44E}"},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function ko(n){let e;return{c(){e=u("span"),e.textContent="\u{1F44D}"},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Io(n){let e;return{c(){e=u("span"),e.textContent="MAX",c(e,"class","yellow max_label svelte-vu26gz")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function qo(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=u("span"),l=g(t),c(e,"class","red")},m(i,s){k(i,e,s),a(e,l)},p(i,s){s&2&&t!==(t=i[1].townInfo.health+"")&&D(l,t)},d(i){i&&w(e)}}}function zo(n){let e,t=n[1].townInfo.health+"",l;return{c(){e=u("span"),l=g(t),c(e,"class","green")},m(i,s){k(i,e,s),a(e,l)},p(i,s){s&2&&t!==(t=i[1].townInfo.health+"")&&D(l,t)},d(i){i&&w(e)}}}function mn(n){let e;return{c(){e=u("span"),e.textContent="MAX",c(e,"class","yellow max_label svelte-vu26gz")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function So(n){let e;return{c(){e=g("How to play")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function Po(n){let e;return{c(){e=g("Close")},m(t,l){k(t,e,l)},d(t){t&&w(e)}}}function hn(n){let e,t;return e=new ho({}),{c(){Ne(e.$$.fragment)},m(l,i){Ce(e,l,i),t=!0},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function gn(n){let e,t;return e=new Pn({}),{c(){Ne(e.$$.fragment)},m(l,i){Ce(e,l,i),t=!0},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function Mo(n){let e,t,l,i=n[1].townInfo.name+"",s,o,r,_,f,p,d,m,S,v,$,O,B,C,M,G,E,N,F,z,h,b=n[1].townInfo.population_count+"",P,j,I=n[1].townInfo.population_max+"",H,R,x,ae,X,T,Q=n[1].townInfo.employees+"",te,le,he=n[1].townInfo.population_count+"",ve,q,A,qe,ht,re,ue,de,pe,Ze=n[1].townInfo.knowledge_points+"",We,ze,De,Ye,Se,ne,J=n[1].townInfo.gold+"",fe,tl,ll,nl,ol,xe,qt,il,gt,sl,zt=n[1].townInfo.gold_from_tourism+"",Ft,al,it,St,rl,Ge,Rt,st,fl,Pt=Ue(n[1].modifiers.happiness,2)+"",Jt,ul,pl,cl,at,Mt,dl,He,Ut,rt,_l,$t=Ue(n[1].modifiers.health,2)+"",jt,ml,hl,gl,et,tt,vl,bl,yl,wl,Ve,Ct,kl,Be,Il,Ke,ft,ql,ut,Ot=(n[1].economy_and_laws.tax_rate*100).toFixed(0)+"",Yt,zl,Sl,pt,Wt,vt,bt,ce,Vt,Pl,be=n[1].townLog.length>0&&dn(n),ye=n[1].townInfo.population_count-n[1].townInfo.employees>0&&_n(n);function Ml(L,Y){if(L[1].economy_and_laws.lastMonthProfit>=0)return vo;if(L[1].economy_and_laws.lastMonthProfit<0)return go}let ct=Ml(n),we=ct&&ct(n);function $l(L,Y){return L[1].townInfo.happiness>=50?yo:bo}let Bt=$l(n),Fe=Bt(n);function Cl(L,Y){if(L[1].townInfo.happiness>=300)return Io;if(L[1].townInfo.happiness>=150)return ko;if(L[1].townInfo.happiness<150)return wo}let dt=Cl(n),$e=dt&&dt(n);function Ol(L,Y){return L[1].townInfo.health>=50?zo:qo}let Nt=Ol(n),Re=Nt(n),Pe=n[1].townInfo.health>=300&&mn();function Bl(L,Y){return L[5]?Po:So}let Tt=Bl(n),Xe=Tt(n),_e=n[5]&&hn(),me=n[6]&&gn();return{c(){e=u("div"),t=u("div"),l=u("div"),s=g(i),o=y(),r=u("div"),r.textContent="double click to change name",_=y(),f=u("div"),p=u("span"),p.textContent="\u23EA",d=y(),m=u("span"),m.textContent="\u23E9",S=y(),v=g(n[0]),$=g("x - year "),O=g(n[2]),B=g(" day "),C=g(n[3]),M=y(),be&&be.c(),G=y(),E=u("div"),N=u("div"),F=u("div"),F.textContent="\u{1F46A} Population",z=y(),h=u("div"),P=g(b),j=g("/"),H=g(I),R=y(),x=u("div"),ae=u("div"),ae.textContent="\u{1F9D1}\u200D\u{1F33E} Employees",X=y(),T=u("div"),te=g(Q),le=g("/"),ve=g(he),q=y(),A=u("br"),qe=y(),ye&&ye.c(),ht=y(),re=u("div"),ue=u("div"),ue.textContent="\u{1F9E0} Knowledge",de=y(),pe=u("div"),We=g(Ze),ze=y(),De=u("div"),Ye=u("div"),Ye.textContent="\u{1F4B0} Gold",Se=y(),ne=u("div"),fe=g(J),tl=y(),ll=u("br"),nl=y(),we&&we.c(),ol=y(),xe=u("div"),qt=u("div"),qt.textContent="\u{1F4B0} Tourism Gold",il=y(),gt=u("div"),sl=g("$"),Ft=g(zt),al=y(),it=u("div"),St=u("div"),St.textContent="\u{1F601} Happiness",rl=y(),Ge=u("div"),Fe.c(),Rt=y(),st=u("span"),fl=g("("),Jt=g(Pt),ul=g(")"),pl=y(),$e&&$e.c(),cl=y(),at=u("div"),Mt=u("div"),Mt.textContent="\u{1F3E5} Health",dl=y(),He=u("div"),Re.c(),Ut=y(),rt=u("span"),_l=g("("),jt=g($t),ml=g(")"),hl=y(),Pe&&Pe.c(),gl=y(),et=u("div"),tt=u("div"),vl=g("\u{1F3C6} "),Xe.c(),bl=y(),yl=u("br"),wl=y(),Ve=u("div"),Ct=u("div"),Ct.textContent="Tax rate (more tax = less happiness)",kl=y(),Be=u("input"),Il=y(),Ke=u("div"),ft=u("button"),ft.textContent="-",ql=y(),ut=u("div"),Yt=g(Ot),zl=g("%"),Sl=y(),pt=u("button"),pt.textContent="+",Wt=y(),_e&&_e.c(),vt=y(),me&&me.c(),bt=je(),c(l,"class","heading_l"),c(r,"class","subheading_m svelte-vu26gz"),c(t,"class","header__left svelte-vu26gz"),c(F,"class","subheading_m svelte-vu26gz"),c(h,"class","text_m svelte-vu26gz"),c(N,"class","svelte-vu26gz"),c(ae,"class","subheading_m svelte-vu26gz"),c(T,"class","text_m svelte-vu26gz"),c(x,"class","svelte-vu26gz"),c(ue,"class","subheading_m svelte-vu26gz"),c(pe,"class","text_m svelte-vu26gz"),c(re,"class","svelte-vu26gz"),c(Ye,"class","subheading_m svelte-vu26gz"),c(ne,"class","text_m svelte-vu26gz"),c(De,"class","svelte-vu26gz"),c(qt,"class","subheading_m svelte-vu26gz"),c(gt,"class","text_m svelte-vu26gz"),c(xe,"class","svelte-vu26gz"),c(St,"class","subheading_m svelte-vu26gz"),c(st,"class","text_ss gray"),c(Ge,"class","text_m svelte-vu26gz"),c(it,"class","svelte-vu26gz"),c(Mt,"class","subheading_m svelte-vu26gz"),c(rt,"class","text_ss gray"),c(He,"class","text_m svelte-vu26gz"),c(at,"class","svelte-vu26gz"),c(E,"class","header__right svelte-vu26gz"),c(tt,"class","text_m pointer"),c(Ct,"class","subheading_m svelte-vu26gz"),c(Be,"type","range"),c(Be,"min","0"),c(Be,"max","1"),c(Be,"step","0.01"),c(ut,"class","text_m"),c(Ke,"class","incrementalButtons svelte-vu26gz"),c(Ve,"class","taxInfo svelte-vu26gz"),c(e,"class","header noselect svelte-vu26gz")},m(L,Y){k(L,e,Y),a(e,t),a(t,l),a(l,s),a(t,o),a(t,r),a(t,_),a(t,f),a(f,p),a(f,d),a(f,m),a(f,S),a(f,v),a(f,$),a(f,O),a(f,B),a(f,C),a(t,M),be&&be.m(t,null),a(e,G),a(e,E),a(E,N),a(N,F),a(N,z),a(N,h),a(h,P),a(h,j),a(h,H),a(E,R),a(E,x),a(x,ae),a(x,X),a(x,T),a(T,te),a(T,le),a(T,ve),a(T,q),a(T,A),a(T,qe),ye&&ye.m(T,null),a(E,ht),a(E,re),a(re,ue),a(re,de),a(re,pe),a(pe,We),a(E,ze),a(E,De),a(De,Ye),a(De,Se),a(De,ne),a(ne,fe),a(ne,tl),a(ne,ll),a(ne,nl),we&&we.m(ne,null),a(E,ol),a(E,xe),a(xe,qt),a(xe,il),a(xe,gt),a(gt,sl),a(gt,Ft),a(E,al),a(E,it),a(it,St),a(it,rl),a(it,Ge),Fe.m(Ge,null),a(Ge,Rt),a(Ge,st),a(st,fl),a(st,Jt),a(st,ul),a(Ge,pl),$e&&$e.m(Ge,null),a(E,cl),a(E,at),a(at,Mt),a(at,dl),a(at,He),Re.m(He,null),a(He,Ut),a(He,rt),a(rt,_l),a(rt,jt),a(rt,ml),a(He,hl),Pe&&Pe.m(He,null),a(e,gl),a(e,et),a(et,tt),a(tt,vl),Xe.m(tt,null),a(et,bl),a(et,yl),a(et,wl),a(et,Ve),a(Ve,Ct),a(Ve,kl),a(Ve,Be),Tl(Be,n[1].economy_and_laws.tax_rate),a(Ve,Il),a(Ve,Ke),a(Ke,ft),a(Ke,ql),a(Ke,ut),a(ut,Yt),a(ut,zl),a(Ke,Sl),a(Ke,pt),k(L,Wt,Y),_e&&_e.m(L,Y),k(L,vt,Y),me&&me.m(L,Y),k(L,bt,Y),ce=!0,Vt||(Pl=[ee(l,"dblclick",n[7]),ee(p,"click",n[8]),ee(m,"click",n[9]),ee(De,"click",n[13]),ee(xe,"click",n[14]),ee(tt,"click",n[15]),ee(Be,"change",n[16]),ee(Be,"input",n[16]),ee(Be,"change",n[10]),ee(ft,"mousedown",n[17]),ee(ft,"mouseup",n[18]),ee(ft,"click",n[19]),ee(ut,"dblclick",n[20]),ee(pt,"mousedown",n[21]),ee(pt,"mouseup",n[22]),ee(pt,"click",n[23])],Vt=!0)},p(L,[Y]){(!ce||Y&2)&&i!==(i=L[1].townInfo.name+"")&&D(s,i),(!ce||Y&1)&&D(v,L[0]),(!ce||Y&4)&&D(O,L[2]),(!ce||Y&8)&&D(C,L[3]),L[1].townLog.length>0?be?be.p(L,Y):(be=dn(L),be.c(),be.m(t,null)):be&&(be.d(1),be=null),(!ce||Y&2)&&b!==(b=L[1].townInfo.population_count+"")&&D(P,b),(!ce||Y&2)&&I!==(I=L[1].townInfo.population_max+"")&&D(H,I),(!ce||Y&2)&&Q!==(Q=L[1].townInfo.employees+"")&&D(te,Q),(!ce||Y&2)&&he!==(he=L[1].townInfo.population_count+"")&&D(ve,he),L[1].townInfo.population_count-L[1].townInfo.employees>0?ye?ye.p(L,Y):(ye=_n(L),ye.c(),ye.m(T,null)):ye&&(ye.d(1),ye=null),(!ce||Y&2)&&Ze!==(Ze=L[1].townInfo.knowledge_points+"")&&D(We,Ze),(!ce||Y&2)&&J!==(J=L[1].townInfo.gold+"")&&D(fe,J),ct===(ct=Ml(L))&&we?we.p(L,Y):(we&&we.d(1),we=ct&&ct(L),we&&(we.c(),we.m(ne,null))),(!ce||Y&2)&&zt!==(zt=L[1].townInfo.gold_from_tourism+"")&&D(Ft,zt),Bt===(Bt=$l(L))&&Fe?Fe.p(L,Y):(Fe.d(1),Fe=Bt(L),Fe&&(Fe.c(),Fe.m(Ge,Rt))),(!ce||Y&2)&&Pt!==(Pt=Ue(L[1].modifiers.happiness,2)+"")&&D(Jt,Pt),dt!==(dt=Cl(L))&&($e&&$e.d(1),$e=dt&&dt(L),$e&&($e.c(),$e.m(Ge,null))),Nt===(Nt=Ol(L))&&Re?Re.p(L,Y):(Re.d(1),Re=Nt(L),Re&&(Re.c(),Re.m(He,Ut))),(!ce||Y&2)&&$t!==($t=Ue(L[1].modifiers.health,2)+"")&&D(jt,$t),L[1].townInfo.health>=300?Pe||(Pe=mn(),Pe.c(),Pe.m(He,null)):Pe&&(Pe.d(1),Pe=null),Tt!==(Tt=Bl(L))&&(Xe.d(1),Xe=Tt(L),Xe&&(Xe.c(),Xe.m(tt,null))),Y&2&&Tl(Be,L[1].economy_and_laws.tax_rate),(!ce||Y&2)&&Ot!==(Ot=(L[1].economy_and_laws.tax_rate*100).toFixed(0)+"")&&D(Yt,Ot),L[5]?_e?Y&32&&U(_e,1):(_e=hn(),_e.c(),U(_e,1),_e.m(vt.parentNode,vt)):_e&&(Te(),K(_e,1,1,()=>{_e=null}),Le()),L[6]?me?Y&64&&U(me,1):(me=gn(),me.c(),U(me,1),me.m(bt.parentNode,bt)):me&&(Te(),K(me,1,1,()=>{me=null}),Le())},i(L){ce||(U(_e),U(me),ce=!0)},o(L){K(_e),K(me),ce=!1},d(L){L&&w(e),be&&be.d(),ye&&ye.d(),we&&we.d(),Fe.d(),$e&&$e.d(),Re.d(),Pe&&Pe.d(),Xe.d(),L&&w(Wt),_e&&_e.d(L),L&&w(vt),me&&me.d(L),L&&w(bt),Vt=!1,nt(Pl)}}}function Ue(n,e){e===void 0&&(e=0);var t=Math.pow(10,e);n=parseFloat((n*t).toFixed(11));var l=Math.round(n)/t;return+l.toFixed(e)}function $o(n,e,t){let l,i,s;oe(n,W,I=>t(1,l=I)),oe(n,Dt,I=>t(25,i=I)),oe(n,xt,I=>t(6,s=I));let o=Math.floor(l.environment.day/365)+1,r=l.environment.day%365;function _(){let I=prompt("Enter a new name for your town (under 200 chars)");if(I&&I.length<200){let H=l;H.townInfo.name=I,W.set(H),localStorage.setItem(Ie,JSON.stringify(H))}}let{speedMultiplier:f=1}=e;function p(){let I=i;I=I*2,I>=8e3&&(I=8e3),V(Dt,i=I,i),t(0,f=2e3/i)}function d(){let I=i;I=I/2,I<=250&&(I=250),V(Dt,i=I,i),t(0,f=2e3/i)}function m(I){let H=l;H.economy_and_laws.tax_rate=Ue(I.target.value,2),W.set(H),localStorage.setItem(Ie,JSON.stringify(H))}function S(){l.hasCityHall}function v(){let I=l;I.hasABank===!0?(I.townInfo.gold+=I.townInfo.gold_from_tourism,I.townInfo.gold_from_tourism=0,W.set(I),localStorage.setItem(Ie,JSON.stringify(I))):alert("You need a bank to transfer funds from tourism activities.")}document.addEventListener("keydown",I=>{switch(I.key.toLowerCase()){case"1":I.preventDefault(),p();break;case"2":I.preventDefault(),d();break}}),document.addEventListener("click",()=>{S()});let $;S();let O=!1;const B=()=>{V(W,l.townLog="",l)},C=()=>{let I=s;I=!I,xt.set(I)},M=()=>{v()},G=()=>t(5,O=!O);function E(){l.economy_and_laws.tax_rate=On(this.value),W.set(l)}const N=()=>{t(4,$=setInterval(()=>{let I=l;I.economy_and_laws.tax_rate=Ue(I.economy_and_laws.tax_rate-.01,2),W.set(I),localStorage.setItem(Ie,JSON.stringify(I))},100))},F=()=>{clearInterval($)},z=()=>{let I=l;I.economy_and_laws.tax_rate=Ue(I.economy_and_laws.tax_rate-.01,2)},h=()=>{let I=parseFloat(prompt("Set a new tax rate (0-1)"));if(I&&I>=0&&I<=1){let H=l;H.economy_and_laws.tax_rate=Ue(I,2),W.set(H),localStorage.setItem(Ie,JSON.stringify(H))}},b=()=>{t(4,$=setInterval(()=>{let I=l;I.economy_and_laws.tax_rate=Ue(I.economy_and_laws.tax_rate+.01,2),W.set(I),localStorage.setItem(Ie,JSON.stringify(I))},100))},P=()=>{clearInterval($)},j=()=>{let I=l;I.economy_and_laws.tax_rate=Ue(I.economy_and_laws.tax_rate+.01,2),W.set(I),localStorage.setItem(Ie,JSON.stringify(I))};return n.$$set=I=>{"speedMultiplier"in I&&t(0,f=I.speedMultiplier)},n.$$.update=()=>{n.$$.dirty&2&&(t(2,o=Math.floor(l.environment.day/365)+1),t(3,r=l.environment.day%365))},[f,l,o,r,$,O,s,_,p,d,m,v,B,C,M,G,E,N,F,z,h,b,P,j]}class Co extends Ae{constructor(e){super(),Ee(this,e,$o,Mo,Me,{speedMultiplier:0})}}function Oo(n){let e;return{c(){e=u("div"),e.innerHTML=`<div class="dialog-content svelte-2ih7px">The game is paused.
		<br/>
		Unpause the game by pressing P
		<br/> 
		<br/>
		Reset the game by pressing SHIFT+ESC</div>`,c(e,"class","dialog svelte-2ih7px")},m(t,l){k(t,e,l)},p:Z,i:Z,o:Z,d(t){t&&w(e)}}}class Bo extends Ae{constructor(e){super(),Ee(this,e,null,Oo,Me,{})}}function vn(n){let e,t,l,i,s,o=n[0].endGameDetails.msg+"",r,_,f,p,d,m;return{c(){e=u("div"),t=u("div"),l=g(`GAME OVER
			`),i=u("br"),s=y(),r=g(o),_=y(),f=u("br"),p=y(),d=u("br"),m=g(`
			Reset the game by pressing SHIFT+ESC`),c(t,"class","dialog-content svelte-2ih7px"),c(e,"class","dialog svelte-2ih7px")},m(S,v){k(S,e,v),a(e,t),a(t,l),a(t,i),a(t,s),a(t,r),a(t,_),a(t,f),a(t,p),a(t,d),a(t,m)},p(S,v){v&1&&o!==(o=S[0].endGameDetails.msg+"")&&D(r,o)},d(S){S&&w(e)}}}function No(n){let e,t=n[0].endGameDetails!=null&&vn(n);return{c(){t&&t.c(),e=je()},m(l,i){t&&t.m(l,i),k(l,e,i)},p(l,[i]){l[0].endGameDetails!=null?t?t.p(l,i):(t=vn(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Z,o:Z,d(l){t&&t.d(l),l&&w(e)}}}function To(n,e,t){let l;return oe(n,W,i=>t(0,l=i)),[l]}class Lo extends Ae{constructor(e){super(),Ee(this,e,To,No,Me,{})}}function Eo(n){let e,t,l,i,s,o,r,_,f,p,d,m,S,v,$,O,B,C,M,G,E;return{c(){e=u("div"),t=u("div"),l=g(`Welcome to Plots!
		`),i=u("br"),s=g(`
		Select a difficulty
		`),o=u("select"),r=u("option"),r.textContent="Easy (quick game)",_=u("option"),_.textContent="Normal (longer game)",f=u("option"),f.textContent="Hard (longest game)",p=y(),d=u("br"),m=g(`
		Select a goal
		`),S=u("select"),v=u("option"),v.textContent="Fill up the grid",$=u("option"),$.textContent="Rule the world through politics",O=y(),B=u("br"),C=y(),M=u("button"),M.textContent="Start game",r.__value="0",r.value=r.__value,_.__value="1",_.value=_.__value,_.selected=!0,f.__value="2",f.value=f.__value,c(o,"id","difficulty"),v.__value="land",v.value=v.__value,v.selected=!0,$.__value="political",$.value=$.__value,c(S,"id","endGoal"),c(t,"class","dialog-content svelte-2ih7px"),c(e,"class","dialog svelte-2ih7px")},m(N,F){k(N,e,F),a(e,t),a(t,l),a(t,i),a(t,s),a(t,o),a(o,r),a(o,_),a(o,f),a(t,p),a(t,d),a(t,m),a(t,S),a(S,v),a(S,$),a(t,O),a(t,B),a(t,C),a(t,M),G||(E=ee(M,"click",n[0]),G=!0)},p:Z,i:Z,o:Z,d(N){N&&w(e),G=!1,E()}}}function Ao(n){function e(){const t=document.getElementById("difficulty").value,l=document.getElementById("endGoal").value;Hn(t,l)}return[e]}class Do extends Ae{constructor(e){super(),Ee(this,e,Ao,Eo,Me,{})}}function bn(n){let e,t,l,i;const s=[Ho,Go],o=[];function r(_,f){return _[0]==null?0:1}return e=r(n),t=o[e]=s[e](n),{c(){t.c(),l=je()},m(_,f){o[e].m(_,f),k(_,l,f),i=!0},p(_,f){let p=e;e=r(_),e===p?o[e].p(_,f):(Te(),K(o[p],1,1,()=>{o[p]=null}),Le(),t=o[e],t?t.p(_,f):(t=o[e]=s[e](_),t.c()),U(t,1),t.m(l.parentNode,l))},i(_){i||(U(t),i=!0)},o(_){K(t),i=!1},d(_){o[e].d(_),_&&w(l)}}}function Go(n){let e,t,l,i,s,o,r,_,f,p,d,m,S,v,$,O,B=n[2]==!0&&yn(),C=n[3]==!0&&wn();return l=new Co({}),s=new jn({}),r=new Lo({}),p=new ro({}),{c(){B&&B.c(),e=y(),C&&C.c(),t=y(),Ne(l.$$.fragment),i=y(),Ne(s.$$.fragment),o=y(),Ne(r.$$.fragment),_=y(),f=u("div"),Ne(p.$$.fragment),d=y(),m=u("br"),S=g(`
			outside of city`),v=y(),$=u("style"),$.textContent=`.plot_grid {
				max-width: 300%;
				max-height: 300%;
				overflow-x: scroll;
				overflow-y: scroll;
				width: 300%;
				height: 300vh;
				margin-top: 175px;
			}
			.plot_grid[data-marginRight='true'] {
				/* This is for when the balanceSheet is being shown. */
				margin-right: 224px;
			}`,c(f,"class","plot_grid"),c(f,"data-marginright",n[3])},m(M,G){B&&B.m(M,G),k(M,e,G),C&&C.m(M,G),k(M,t,G),Ce(l,M,G),k(M,i,G),Ce(s,M,G),k(M,o,G),Ce(r,M,G),k(M,_,G),k(M,f,G),Ce(p,f,null),a(f,d),a(f,m),a(f,S),k(M,v,G),k(M,$,G),O=!0},p(M,G){M[2]==!0?B?G&4&&U(B,1):(B=yn(),B.c(),U(B,1),B.m(e.parentNode,e)):B&&(Te(),K(B,1,1,()=>{B=null}),Le()),M[3]==!0?C?G&8&&U(C,1):(C=wn(),C.c(),U(C,1),C.m(t.parentNode,t)):C&&(Te(),K(C,1,1,()=>{C=null}),Le()),(!O||G&8)&&c(f,"data-marginright",M[3])},i(M){O||(U(B),U(C),U(l.$$.fragment,M),U(s.$$.fragment,M),U(r.$$.fragment,M),U(p.$$.fragment,M),O=!0)},o(M){K(B),K(C),K(l.$$.fragment,M),K(s.$$.fragment,M),K(r.$$.fragment,M),K(p.$$.fragment,M),O=!1},d(M){B&&B.d(M),M&&w(e),C&&C.d(M),M&&w(t),Oe(l,M),M&&w(i),Oe(s,M),M&&w(o),Oe(r,M),M&&w(_),M&&w(f),Oe(p),M&&w(v),M&&w($)}}}function Ho(n){let e,t;return e=new Do({}),{c(){Ne(e.$$.fragment)},m(l,i){Ce(e,l,i),t=!0},p:Z,i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function yn(n){let e,t;return e=new Bo({}),{c(){Ne(e.$$.fragment)},m(l,i){Ce(e,l,i),t=!0},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function wn(n){let e,t;return e=new Pn({}),{c(){Ne(e.$$.fragment)},m(l,i){Ce(e,l,i),t=!0},i(l){t||(U(e.$$.fragment,l),t=!0)},o(l){K(e.$$.fragment,l),t=!1},d(l){Oe(e,l)}}}function Fo(n){let e,t,l=(n[1]||n[0]==null)&&bn(n);return{c(){l&&l.c(),e=je()},m(i,s){l&&l.m(i,s),k(i,e,s),t=!0},p(i,[s]){i[1]||i[0]==null?l?(l.p(i,s),s&3&&U(l,1)):(l=bn(i),l.c(),U(l,1),l.m(e.parentNode,e)):l&&(Te(),K(l,1,1,()=>{l=null}),Le())},i(i){t||(U(l),t=!0)},o(i){K(l),t=!1},d(i){l&&l.d(i),i&&w(e)}}}function Ro(n,e,t){let l,i,s,o,r;oe(n,mt,m=>t(6,l=m)),oe(n,ie,m=>t(7,i=m)),oe(n,kt,m=>t(2,s=m)),oe(n,W,m=>t(0,o=m)),oe(n,xt,m=>t(3,r=m));let _=!1,f=!1;document.addEventListener("keydown",m=>{if((document.activeElement.nodeName==="INPUT"||document.activeElement.nodeName=="TEXTAREA")&&m.key!=="Escape")return;switch(m.key.toLowerCase()){case"p":s==!0?kt.set(!1):(kt.set(!0),V(ie,i.visible=!1,i));break;case"escape":m.shiftKey?(localStorage.setItem("reset","true"),location.reload(),Sn()):i.visible==!0&&V(ie,i.visible=!1,i);break;case"arrowleft":case"a":m.preventDefault(),p(0,-1,"up");break;case"arrowright":case"d":m.preventDefault(),p(0,1,"down");break;case"arrowup":case"w":m.preventDefault(),p(-1,0,"left");break;case"arrowdown":case"s":m.preventDefault(),p(1,0,"right");break}});function p(m,S,v){if(i.visible===!1&&i.x===0&&i.y===0)d(0,0,v);else{let $=i.x,O=i.y;$+m<0?$=0:$+m>o.plots.length?$=o.plots.length:$+=m,O+S<0?O=0:O+S>o.plots.length?O=o.plots.length:O+=S,d($,O,v)}}function d(m,S,v){if(f==!0)switch(v){case"up":S-=2;break;case"down":S+=1;break;case"left":m-=2;break;case"right":m+=1;break}m<0?m=0:m>o.plots.length&&(m=o.plots.length),S<0?S=0:S>o.plots.length&&(S=o.plots.length);let $=document.querySelectorAll(".plot_container"),O;if($.forEach(B=>{B.dataset.x==m&&B.dataset.y==S&&(O=B)}),s==!1){if(O.dataset.canBeUpgraded==="true"?V(ie,i.visible=!0,i):V(ie,i.visible=!1,i),O.dataset.refPlotX!==void 0&&O.dataset.refPlotY!=""?(f=!0,$.forEach(B=>{B.dataset.x==O.dataset.refPlotX&&B.dataset.y==O.dataset.refPlotY&&(O=B,m=parseInt(O.dataset.x),S=parseInt(O.dataset.y))})):f=!1,O.dataset.size!=="1"&&O.dataset.size!==void 0&&(f=!0),V(ie,i.x=m,i),V(ie,i.y=S,i),$.forEach(B=>{B.classList.remove("selected"),B.style.border="none",B.style.fontWeight=""}),O.classList.add("selected"),f){let B="4px solid #00800045";O.classList.remove("selected"),O.style.borderTop=B,O.style.borderLeft=B,O.style.fontWeight="600",$.forEach(C=>{C.dataset.x==m+1&&C.dataset.y==S&&(C.style.borderLeft=B,C.style.borderBottom=B),C.dataset.x==m&&C.dataset.y==S+1&&(C.style.borderTop=B,C.style.borderRight=B),C.dataset.x==m+1&&C.dataset.y==S+1&&(C.style.borderBottom=B,C.style.borderRight=B)})}O.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),V(mt,l={},l)}}return n.$$.update=()=>{n.$$.dirty&1&&(o?t(1,_=!0):t(1,_=!1))},[o,_,s,r,d]}class Jo extends Ae{constructor(e){super(),Ee(this,e,Ro,Fo,Me,{openPlotMenu:4})}get openPlotMenu(){return this.$$.ctx[4]}}new Jo({target:document.getElementById("app")});
